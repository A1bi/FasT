var w="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var tt={};(function(w,et){tt=et()})(tt,(function(){var tt,et,rt;function define(w,it){if(tt)if(et){var nt="var sharedChunk = {}; ("+tt+")(sharedChunk); ("+et+")(sharedChunk);";var ot={};tt(ot);rt=it(ot);"undefined"!==typeof window&&(rt.workerUrl=window.URL.createObjectURL(new Blob([nt],{type:"text/javascript"})))}else et=it;else tt=it}define(["exports"],(function(tt){function e(w,tt){return w(tt={exports:{}},tt.exports),tt.exports}var et=n;function n(tt,et,rt,it){(this||w).cx=3*tt,(this||w).bx=3*(rt-tt)-(this||w).cx,(this||w).ax=1-(this||w).cx-(this||w).bx,(this||w).cy=3*et,(this||w).by=3*(it-et)-(this||w).cy,(this||w).ay=1-(this||w).cy-(this||w).by,(this||w).p1x=tt,(this||w).p1y=it,(this||w).p2x=rt,(this||w).p2y=it}n.prototype.sampleCurveX=function(tt){return(((this||w).ax*tt+(this||w).bx)*tt+(this||w).cx)*tt},n.prototype.sampleCurveY=function(tt){return(((this||w).ay*tt+(this||w).by)*tt+(this||w).cy)*tt},n.prototype.sampleCurveDerivativeX=function(tt){return(3*(this||w).ax*tt+2*(this||w).bx)*tt+(this||w).cx},n.prototype.solveCurveX=function(w,tt){var et,rt,it,nt,ot;for(void 0===tt&&(tt=1e-6),it=w,ot=0;ot<8;ot++){if(nt=this.sampleCurveX(it)-w,Math.abs(nt)<tt)return it;var at=this.sampleCurveDerivativeX(it);if(Math.abs(at)<1e-6)break;it-=nt/at}if((it=w)<(et=0))return et;if(it>(rt=1))return rt;for(;et<rt;){if(nt=this.sampleCurveX(it),Math.abs(nt-w)<tt)return it;w>nt?et=it:rt=it,it=.5*(rt-et)+et}return it},n.prototype.solve=function(w,tt){return this.sampleCurveY(this.solveCurveX(w,tt))};var rt=a;function a(tt,et){(this||w).x=tt,(this||w).y=et}a.prototype={clone:function(){return new a((this||w).x,(this||w).y)},add:function(w){return this.clone()._add(w)},sub:function(w){return this.clone()._sub(w)},multByPoint:function(w){return this.clone()._multByPoint(w)},divByPoint:function(w){return this.clone()._divByPoint(w)},mult:function(w){return this.clone()._mult(w)},div:function(w){return this.clone()._div(w)},rotate:function(w){return this.clone()._rotate(w)},rotateAround:function(w,tt){return this.clone()._rotateAround(w,tt)},matMult:function(w){return this.clone()._matMult(w)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt((this||w).x*(this||w).x+(this||w).y*(this||w).y)},equals:function(tt){return(this||w).x===tt.x&&(this||w).y===tt.y},dist:function(w){return Math.sqrt(this.distSqr(w))},distSqr:function(tt){var et=tt.x-(this||w).x,rt=tt.y-(this||w).y;return et*et+rt*rt},angle:function(){return Math.atan2((this||w).y,(this||w).x)},angleTo:function(tt){return Math.atan2((this||w).y-tt.y,(this||w).x-tt.x)},angleWith:function(w){return this.angleWithSep(w.x,w.y)},angleWithSep:function(tt,et){return Math.atan2((this||w).x*et-(this||w).y*tt,(this||w).x*tt+(this||w).y*et)},_matMult:function(tt){var et=tt[2]*(this||w).x+tt[3]*(this||w).y;return(this||w).x=tt[0]*(this||w).x+tt[1]*(this||w).y,(this||w).y=et,this||w},_add:function(tt){return(this||w).x+=tt.x,(this||w).y+=tt.y,this||w},_sub:function(tt){return(this||w).x-=tt.x,(this||w).y-=tt.y,this||w},_mult:function(tt){return(this||w).x*=tt,(this||w).y*=tt,this||w},_div:function(tt){return(this||w).x/=tt,(this||w).y/=tt,this||w},_multByPoint:function(tt){return(this||w).x*=tt.x,(this||w).y*=tt.y,this||w},_divByPoint:function(tt){return(this||w).x/=tt.x,(this||w).y/=tt.y,this||w},_unit:function(){return this._div(this.mag()),this||w},_perp:function(){var tt=(this||w).y;return(this||w).y=(this||w).x,(this||w).x=-tt,this||w},_rotate:function(tt){var et=Math.cos(tt),rt=Math.sin(tt),it=rt*(this||w).x+et*(this||w).y;return(this||w).x=et*(this||w).x-rt*(this||w).y,(this||w).y=it,this||w},_rotateAround:function(tt,et){var rt=Math.cos(tt),it=Math.sin(tt),nt=et.y+it*((this||w).x-et.x)+rt*((this||w).y-et.y);return(this||w).x=et.x+rt*((this||w).x-et.x)-it*((this||w).y-et.y),(this||w).y=nt,this||w},_round:function(){return(this||w).x=Math.round((this||w).x),(this||w).y=Math.round((this||w).y),this||w}},a.convert=function(w){return w instanceof a?w:Array.isArray(w)?new a(w[0],w[1]):w};var it="undefined"!=typeof self?self:{};function s(w,tt,rt,it){var nt=new et(w,tt,rt,it);return function(w){return nt.solve(w)}}var nt=s(.25,.1,.25,1);function l(w,tt,et){return Math.min(et,Math.max(tt,w))}function p(w,tt,et){var rt=et-tt,it=((w-tt)%rt+rt)%rt+tt;return it===tt?et:it}function c(w){for(var tt=[],et=arguments.length-1;et-- >0;)tt[et]=arguments[et+1];for(var rt=0,it=tt;rt<it.length;rt+=1){var nt=it[rt];for(var ot in nt)w[ot]=nt[ot]}return w}var ot=1;function f(){return ot++}function y(){return function t(w){return w?(w^16*Math.random()>>w/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function d(w){return!!w&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(w)}function m(w,tt){w.forEach((function(w){tt[w]&&(tt[w]=tt[w].bind(tt))}))}function v(w,tt){return-1!==w.indexOf(tt,w.length-tt.length)}function g(tt,et,rt){var it={};for(var nt in tt)it[nt]=et.call(rt||this||w,tt[nt],nt,tt);return it}function x(tt,et,rt){var it={};for(var nt in tt)et.call(rt||this||w,tt[nt],nt,tt)&&(it[nt]=tt[nt]);return it}function b(w){return Array.isArray(w)?w.map(b):"object"==typeof w&&w?g(w,b):w}var at={};function _(w){at[w]||("undefined"!=typeof console&&console.warn(w),at[w]=!0)}function A(w,tt,et){return(et.y-w.y)*(tt.x-w.x)>(tt.y-w.y)*(et.x-w.x)}function S(w){for(var tt=0,et=0,rt=w.length,it=rt-1,nt=void 0,ot=void 0;et<rt;it=et++)tt+=((ot=w[it]).x-(nt=w[et]).x)*(nt.y+ot.y);return tt}function k(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function I(w){var tt={};if(w.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(function(w,et,rt,it){var nt=rt||it;return tt[et]=!nt||nt.toLowerCase(),""})),tt["max-age"]){var et=parseInt(tt["max-age"],10);isNaN(et)?delete tt["max-age"]:tt["max-age"]=et}return tt}var st=null;function C(w){if(null==st){var tt=w.navigator?w.navigator.userAgent:null;st=!!w.safari||!(!tt||!(/\b(iPad|iPhone|iPod)\b/.test(tt)||tt.match("Safari")&&!tt.match("Chrome")))}return st}function M(w){try{var tt=it[w];return tt.setItem("_mapbox_test_",1),tt.removeItem("_mapbox_test_"),!0}catch(w){return!1}}var ct,pt,ft,dt,mt=it.performance&&it.performance.now?it.performance.now.bind(it.performance):Date.now.bind(Date),yt=it.requestAnimationFrame||it.mozRequestAnimationFrame||it.webkitRequestAnimationFrame||it.msRequestAnimationFrame,vt=it.cancelAnimationFrame||it.mozCancelAnimationFrame||it.webkitCancelAnimationFrame||it.msCancelAnimationFrame,Dt={now:mt,frame:function(w){var tt=yt(w);return{cancel:function(){return vt(tt)}}},getImageData:function(w,tt){void 0===tt&&(tt=0);var et=it.document.createElement("canvas"),rt=et.getContext("2d");if(!rt)throw new Error("failed to create canvas 2d context");return et.width=w.width,et.height=w.height,rt.drawImage(w,0,0,w.width,w.height),rt.getImageData(-tt,-tt,w.width+2*tt,w.height+2*tt)},resolveURL:function(w){return ct||(ct=it.document.createElement("a")),ct.href=w,ct.href},hardwareConcurrency:it.navigator&&it.navigator.hardwareConcurrency||4,get devicePixelRatio(){return it.devicePixelRatio},get prefersReducedMotion(){return!!it.matchMedia&&(null==pt&&(pt=it.matchMedia("(prefers-reduced-motion: reduce)")),pt.matches)}},Rt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return(this||w).API_URL?0===(this||w).API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===(this||w).API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Bt={supported:!1,testSupport:function(w){!Ot&&dt&&(Ne?q(w):ft=w)}},Ot=!1,Ne=!1;function q(w){var tt=w.createTexture();w.bindTexture(w.TEXTURE_2D,tt);try{if(w.texImage2D(w.TEXTURE_2D,0,w.RGBA,w.RGBA,w.UNSIGNED_BYTE,dt),w.isContextLost())return;Bt.supported=!0}catch(w){}w.deleteTexture(tt),Ot=!0}it.document&&((dt=it.document.createElement("img")).onload=function(){ft&&q(ft),ft=null,Ne=!0},dt.onerror=function(){Ot=!0,ft=null},dt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var Ze="01",K=function(tt,et){(this||w)._transformRequestFn=tt,(this||w)._customAccessToken=et,this._createSkuToken()};function G(w){return 0===w.indexOf("mapbox:")}K.prototype._createSkuToken=function(){var tt=function(){for(var w="",tt=0;tt<10;tt++)w+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ze,w].join(""),tokenExpiresAt:Date.now()+432e5}}();(this||w)._skuToken=tt.token,(this||w)._skuTokenExpiresAt=tt.tokenExpiresAt},K.prototype._isSkuTokenExpired=function(){return Date.now()>(this||w)._skuTokenExpiresAt},K.prototype.transformRequest=function(tt,et){return(this||w)._transformRequestFn&&this._transformRequestFn(tt,et)||{url:tt}},K.prototype.normalizeStyleURL=function(tt,et){if(!G(tt))return tt;var rt=H(tt);return rt.path="/styles/v1"+rt.path,this._makeAPIURL(rt,(this||w)._customAccessToken||et)},K.prototype.normalizeGlyphsURL=function(tt,et){if(!G(tt))return tt;var rt=H(tt);return rt.path="/fonts/v1"+rt.path,this._makeAPIURL(rt,(this||w)._customAccessToken||et)},K.prototype.normalizeSourceURL=function(tt,et){if(!G(tt))return tt;var rt=H(tt);return rt.path="/v4/"+rt.authority+".json",rt.params.push("secure"),this._makeAPIURL(rt,(this||w)._customAccessToken||et)},K.prototype.normalizeSpriteURL=function(tt,et,rt,it){var nt=H(tt);return G(tt)?(nt.path="/styles/v1"+nt.path+"/sprite"+et+rt,this._makeAPIURL(nt,(this||w)._customAccessToken||it)):(nt.path+=""+et+rt,Y(nt))},K.prototype.normalizeTileURL=function(tt,et){if(this._isSkuTokenExpired()&&this._createSkuToken(),tt&&!G(tt))return tt;var rt=H(tt);rt.path=rt.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Dt.devicePixelRatio>=2||512===et?"@2x":"")+(Bt.supported?".webp":"$1")),rt.path=rt.path.replace(/^.+\/v4\//,"/"),rt.path="/v4"+rt.path;var it=(this||w)._customAccessToken||function(w){for(var tt=0,et=w;tt<et.length;tt+=1){var rt=et[tt].match(/^access_token=(.*)$/);if(rt)return rt[1]}return null}(rt.params)||Rt.ACCESS_TOKEN;return Rt.REQUIRE_ACCESS_TOKEN&&it&&(this||w)._skuToken&&rt.params.push("sku="+(this||w)._skuToken),this._makeAPIURL(rt,it)},K.prototype.canonicalizeTileURL=function(w,tt){var et=H(w);if(!et.path.match(/(^\/v4\/)/)||!et.path.match(/\.[\w]+$/))return w;var rt="mapbox://tiles/";rt+=et.path.replace("/v4/","");var it=et.params;return tt&&(it=it.filter((function(w){return!w.match(/^access_token=/)}))),it.length&&(rt+="?"+it.join("&")),rt},K.prototype.canonicalizeTileset=function(w,tt){for(var et=!!tt&&G(tt),rt=[],it=0,nt=w.tiles||[];it<nt.length;it+=1){var ot=nt[it];X(ot)?rt.push(this.canonicalizeTileURL(ot,et)):rt.push(ot)}return rt},K.prototype._makeAPIURL=function(w,tt){var et="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",rt=H(Rt.API_URL);if(w.protocol=rt.protocol,w.authority=rt.authority,"/"!==rt.path&&(w.path=""+rt.path+w.path),!Rt.REQUIRE_ACCESS_TOKEN)return Y(w);if(!(tt=tt||Rt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+et);if("s"===tt[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+et);return w.params=w.params.filter((function(w){return-1===w.indexOf("access_token")})),w.params.push("access_token="+tt),Y(w)};var Ge=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function X(w){return Ge.test(w)}var Ke=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function H(w){var tt=w.match(Ke);if(!tt)throw new Error("Unable to parse URL object");return{protocol:tt[1],authority:tt[2],path:tt[3]||"/",params:tt[4]?tt[4].split("&"):[]}}function Y(w){var tt=w.params.length?"?"+w.params.join("&"):"";return w.protocol+"://"+w.authority+w.path+tt}function $(w){if(!w)return null;var tt=w.split(".");if(!tt||3!==tt.length)return null;try{return JSON.parse(decodeURIComponent(it.atob(tt[1]).split("").map((function(w){return"%"+("00"+w.charCodeAt(0).toString(16)).slice(-2)})).join("")))}catch(w){return null}}var W=function(tt){(this||w).type=tt,(this||w).anonId=null,(this||w).eventData={},(this||w).queue=[],(this||w).pendingRequest=null};W.prototype.getStorageKey=function(w){var tt,et=$(Rt.ACCESS_TOKEN);return tt=et&&et.u?it.btoa(encodeURIComponent(et.u).replace(/%([0-9A-F]{2})/g,(function(w,tt){return String.fromCharCode(Number("0x"+tt))}))):Rt.ACCESS_TOKEN||"",w?"mapbox.eventData."+w+":"+tt:"mapbox.eventData:"+tt},W.prototype.fetchEventData=function(){var tt=M("localStorage"),et=this.getStorageKey(),rt=this.getStorageKey("uuid");if(tt)try{var nt=it.localStorage.getItem(et);nt&&((this||w).eventData=JSON.parse(nt));var ot=it.localStorage.getItem(rt);ot&&((this||w).anonId=ot)}catch(tt){_("Unable to read from LocalStorage")}},W.prototype.saveEventData=function(){var tt=M("localStorage"),et=this.getStorageKey(),rt=this.getStorageKey("uuid");if(tt)try{it.localStorage.setItem(rt,(this||w).anonId),Object.keys((this||w).eventData).length>=1&&it.localStorage.setItem(et,JSON.stringify((this||w).eventData))}catch(tt){_("Unable to write to LocalStorage")}},W.prototype.processRequests=function(w){},W.prototype.postEvent=function(tt,et,rt,it){var nt=this||w;if(Rt.EVENTS_URL){var ot=H(Rt.EVENTS_URL);ot.params.push("access_token="+(it||Rt.ACCESS_TOKEN||""));var at={event:(this||w).type,created:new Date(tt).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.11.0",skuId:Ze,userId:(this||w).anonId},st=et?c(at,et):at,ct={url:Y(ot),headers:{"Content-Type":"text/plain"},body:JSON.stringify([st])};(this||w).pendingRequest=bt(ct,(function(w){nt.pendingRequest=null,rt(w),nt.saveEventData(),nt.processRequests(it)}))}},W.prototype.queueRequest=function(tt,et){(this||w).queue.push(tt),this.processRequests(et)};var er,rr,vr=function(tt){function e(){tt.call(this||w,"map.load"),(this||w).success={},(this||w).skuToken=""}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.postMapLoadEvent=function(tt,et,rt,it){(this||w).skuToken=rt,(Rt.EVENTS_URL&&it||Rt.ACCESS_TOKEN&&Array.isArray(tt)&&tt.some((function(w){return G(w)||X(w)})))&&this.queueRequest({id:et,timestamp:Date.now()},it)},e.prototype.processRequests=function(tt){var et=this||w;if(!(this||w).pendingRequest&&0!==(this||w).queue.length){var rt=(this||w).queue.shift(),it=rt.id,nt=rt.timestamp;it&&(this||w).success[it]||((this||w).anonId||this.fetchEventData(),d((this||w).anonId)||((this||w).anonId=y()),this.postEvent(nt,{skuToken:(this||w).skuToken},(function(w){w||it&&(et.success[it]=!0)}),tt))}},e}(W),wr=new(function(tt){function e(et){tt.call(this||w,"appUserTurnstile"),(this||w)._customAccessToken=et}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.postTurnstileEvent=function(w,tt){Rt.EVENTS_URL&&Rt.ACCESS_TOKEN&&Array.isArray(w)&&w.some((function(w){return G(w)||X(w)}))&&this.queueRequest(Date.now(),tt)},e.prototype.processRequests=function(tt){var et=this||w;if(!(this||w).pendingRequest&&0!==(this||w).queue.length){(this||w).anonId&&(this||w).eventData.lastSuccess&&(this||w).eventData.tokenU||this.fetchEventData();var rt=$(Rt.ACCESS_TOKEN),it=rt?rt.u:Rt.ACCESS_TOKEN,nt=it!==(this||w).eventData.tokenU;d((this||w).anonId)||((this||w).anonId=y(),nt=!0);var ot=(this||w).queue.shift();if((this||w).eventData.lastSuccess){var at=new Date((this||w).eventData.lastSuccess),st=new Date(ot),ct=(ot-(this||w).eventData.lastSuccess)/864e5;nt=nt||ct>=1||ct<-1||at.getDate()!==st.getDate()}else nt=!0;if(!nt)return this.processRequests();this.postEvent(ot,{"enabled.telemetry":!1},(function(w){w||(et.eventData.lastSuccess=ot,et.eventData.tokenU=it)}),tt)}},e}(W)),Sr=wr.postTurnstileEvent.bind(wr),ei=new vr,ii=ei.postMapLoadEvent.bind(ei),mi=500,qi=50;function ut(){it.caches&&!er&&(er=it.caches.open("mapbox-tiles"))}function lt(w){var tt=w.indexOf("?");return tt<0?w:w.slice(0,tt)}var Ki,Ji=1/0;function ht(){return null==Ki&&(Ki=it.OffscreenCanvas&&new it.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof it.createImageBitmap),Ki}var rn={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(rn);var vn=function(tt){function e(et,rt,it){401===rt&&X(it)&&(et+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),tt.call(this||w,et),(this||w).status=rt,(this||w).url=it,(this||w).name=(this||w).constructor.name,(this||w).message=et}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.toString=function(){return(this||w).name+": "+(this||w).message+" ("+(this||w).status+"): "+(this||w).url},e}(Error),bn=k()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===it.location.protocol?it.parent:it).location.href};var Tn,In,gt=function(w,tt){if(!(/^file:/.test(et=w.url)||/^file:/.test(bn())&&!/^\w+:/.test(et))){if(it.fetch&&it.Request&&it.AbortController&&it.Request.prototype.hasOwnProperty("signal"))return function(w,tt){var et,rt=new it.AbortController,nt=new it.Request(w.url,{method:w.method||"GET",body:w.body,credentials:w.credentials,headers:w.headers,referrer:bn(),signal:rt.signal}),ot=!1,at=!1,st=(et=nt.url).indexOf("sku=")>0&&X(et);"json"===w.type&&nt.headers.set("Accept","application/json");var l=function(et,rt,ot){if(!at){if(et&&"SecurityError"!==et.message&&_(et),rt&&ot)return p(rt);var ct=Date.now();it.fetch(nt).then((function(et){if(et.ok){var rt=st?et.clone():null;return p(et,rt,ct)}return tt(new vn(et.statusText,et.status,w.url))})).catch((function(w){20!==w.code&&tt(new Error(w.message))}))}},p=function(et,rt,st){("arrayBuffer"===w.type?et.arrayBuffer():"json"===w.type?et.json():et.text()).then((function(w){at||(rt&&st&&function(w,tt,et){if(ut(),er){var rt={status:tt.status,statusText:tt.statusText,headers:new it.Headers};tt.headers.forEach((function(w,tt){return rt.headers.set(tt,w)}));var nt=I(tt.headers.get("Cache-Control")||"");nt["no-store"]||(nt["max-age"]&&rt.headers.set("Expires",new Date(et+1e3*nt["max-age"]).toUTCString()),new Date(rt.headers.get("Expires")).getTime()-et<42e4||function(w,tt){if(void 0===rr)try{new Response(new ReadableStream),rr=!0}catch(w){rr=!1}rr?tt(w.body):w.blob().then(tt)}(tt,(function(tt){var et=new it.Response(tt,rt);ut(),er&&er.then((function(tt){return tt.put(lt(w.url),et)})).catch((function(w){return _(w.message)}))})))}}(nt,rt,st),ot=!0,tt(null,w,et.headers.get("Cache-Control"),et.headers.get("Expires")))})).catch((function(w){at||tt(new Error(w.message))}))};return st?function(w,tt){if(ut(),!er)return tt(null);var et=lt(w.url);er.then((function(w){w.match(et).then((function(rt){var it=function(w){if(!w)return!1;var tt=new Date(w.headers.get("Expires")||0),et=I(w.headers.get("Cache-Control")||"");return tt>Date.now()&&!et["no-cache"]}(rt);w.delete(et),it&&w.put(et,rt.clone()),tt(null,rt,it)})).catch(tt)})).catch(tt)}(nt,l):l(null,null),{cancel:function(){at=!0,ot||rt.abort()}}}(w,tt);if(k()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",w,tt,void 0,!0)}var et;return function(w,tt){var et=new it.XMLHttpRequest;for(var rt in et.open(w.method||"GET",w.url,!0),"arrayBuffer"===w.type&&(et.responseType="arraybuffer"),w.headers)et.setRequestHeader(rt,w.headers[rt]);return"json"===w.type&&(et.responseType="text",et.setRequestHeader("Accept","application/json")),et.withCredentials="include"===w.credentials,et.onerror=function(){tt(new Error(et.statusText))},et.onload=function(){if((et.status>=200&&et.status<300||0===et.status)&&null!==et.response){var rt=et.response;if("json"===w.type)try{rt=JSON.parse(et.response)}catch(w){return tt(w)}tt(null,rt,et.getResponseHeader("Cache-Control"),et.getResponseHeader("Expires"))}else tt(new vn(et.statusText,et.status,w.url))},et.send(w.body),{cancel:function(){return et.abort()}}}(w,tt)},xt=function(w,tt){return gt(c(w,{type:"arrayBuffer"}),tt)},bt=function(w,tt){return gt(c(w,{method:"POST"}),tt)};Tn=[],In=0;var wt=function(tt,et){if(Bt.supported&&(tt.headers||(tt.headers={}),tt.headers.accept="image/webp,*/*"),In>=Rt.MAX_PARALLEL_IMAGE_REQUESTS){var rt={requestParameters:tt,callback:et,cancelled:!1,cancel:function(){(this||w).cancelled=!0}};return Tn.push(rt),rt}In++;var nt=!1,i=function(){if(!nt)for(nt=!0,In--;Tn.length&&In<Rt.MAX_PARALLEL_IMAGE_REQUESTS;){var w=Tn.shift();w.cancelled||(w.cancel=wt(w.requestParameters,w.callback).cancel)}},ot=xt(tt,(function(w,tt,rt,nt){i(),w?et(w):tt&&(ht()?function(w,tt){var et=new it.Blob([new Uint8Array(w)],{type:"image/png"});it.createImageBitmap(et).then((function(w){tt(null,w)})).catch((function(w){tt(new Error("Could not load image because of "+w.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))}))}(tt,et):function(w,tt,et,rt){var nt=new it.Image,ot=it.URL;nt.onload=function(){tt(null,nt),ot.revokeObjectURL(nt.src)},nt.onerror=function(){return tt(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var at=new it.Blob([new Uint8Array(w)],{type:"image/png"});nt.cacheControl=et,nt.expires=rt,nt.src=w.byteLength?ot.createObjectURL(at):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(tt,et,rt,nt))}));return{cancel:function(){ot.cancel(),i()}}};function _t(w,tt,et){et[w]&&-1!==et[w].indexOf(tt)||(et[w]=et[w]||[],et[w].push(tt))}function At(w,tt,et){if(et&&et[w]){var rt=et[w].indexOf(tt);-1!==rt&&et[w].splice(rt,1)}}var St=function(tt,et){void 0===et&&(et={}),c(this||w,et),(this||w).type=tt},zn=function(tt){function e(et,rt){void 0===rt&&(rt={}),tt.call(this||w,"error",c({error:et},rt))}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e}(St),It=function(){};It.prototype.on=function(tt,et){return(this||w)._listeners=(this||w)._listeners||{},_t(tt,et,(this||w)._listeners),this||w},It.prototype.off=function(tt,et){return At(tt,et,(this||w)._listeners),At(tt,et,(this||w)._oneTimeListeners),this||w},It.prototype.once=function(tt,et){return(this||w)._oneTimeListeners=(this||w)._oneTimeListeners||{},_t(tt,et,(this||w)._oneTimeListeners),this||w},It.prototype.fire=function(tt,et){"string"==typeof tt&&(tt=new St(tt,et||{}));var rt=tt.type;if(this.listens(rt)){tt.target=this||w;for(var it=0,nt=(this||w)._listeners&&(this||w)._listeners[rt]?(this||w)._listeners[rt].slice():[];it<nt.length;it+=1)nt[it].call(this||w,tt);for(var ot=0,at=(this||w)._oneTimeListeners&&(this||w)._oneTimeListeners[rt]?(this||w)._oneTimeListeners[rt].slice():[];ot<at.length;ot+=1){var st=at[ot];At(rt,st,(this||w)._oneTimeListeners),st.call(this||w,tt)}var ct=(this||w)._eventedParent;ct&&(c(tt,"function"==typeof(this||w)._eventedParentData?this._eventedParentData():(this||w)._eventedParentData),ct.fire(tt))}else tt instanceof zn&&console.error(tt.error);return this||w},It.prototype.listens=function(tt){return(this||w)._listeners&&(this||w)._listeners[tt]&&(this||w)._listeners[tt].length>0||(this||w)._oneTimeListeners&&(this||w)._oneTimeListeners[tt]&&(this||w)._oneTimeListeners[tt].length>0||(this||w)._eventedParent&&(this||w)._eventedParent.listens(tt)},It.prototype.setEventedParent=function(tt,et){return(this||w)._eventedParent=tt,(this||w)._eventedParentData=et,this||w};var Cn={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Ct=function(tt,et,rt,it){(this||w).message=(tt?tt+": ":"")+rt,it&&((this||w).identifier=it),null!=et&&et.__line__&&((this||w).line=et.__line__)};function Mt(w){var tt=w.value;return tt?[new Ct(w.key,tt,"constants have been deprecated as of v8")]:[]}function Et(w){for(var tt=[],et=arguments.length-1;et-- >0;)tt[et]=arguments[et+1];for(var rt=0,it=tt;rt<it.length;rt+=1){var nt=it[rt];for(var ot in nt)w[ot]=nt[ot]}return w}function Tt(w){return w instanceof Number||w instanceof String||w instanceof Boolean?w.valueOf():w}function Pt(w){if(Array.isArray(w))return w.map(Pt);if(w instanceof Object&&!(w instanceof Number||w instanceof String||w instanceof Boolean)){var tt={};for(var et in w)tt[et]=Pt(w[et]);return tt}return Tt(w)}var Mn=function(tt){function e(et,rt){tt.call(this||w,rt),(this||w).message=rt,(this||w).key=et}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e}(Error),Vt=function(tt,et){void 0===et&&(et=[]),(this||w).parent=tt,(this||w).bindings={};for(var rt=0,it=et;rt<it.length;rt+=1){var nt=it[rt];(this||w).bindings[nt[0]]=nt[1]}};Vt.prototype.concat=function(tt){return new Vt(this||w,tt)},Vt.prototype.get=function(tt){if((this||w).bindings[tt])return(this||w).bindings[tt];if((this||w).parent)return(this||w).parent.get(tt);throw new Error(tt+" not found in scope.")},Vt.prototype.has=function(tt){return!!(this||w).bindings[tt]||!!(this||w).parent&&(this||w).parent.has(tt)};var Ln={kind:"null"},Bn={kind:"number"},Fn={kind:"string"},Vn={kind:"boolean"},Nn={kind:"color"},Wn={kind:"object"},Yn={kind:"value"},$n={kind:"collator"},uo={kind:"formatted"},po={kind:"resolvedImage"};function Gt(w,tt){return{kind:"array",itemType:w,N:tt}}function Zt(w){if("array"===w.kind){var tt=Zt(w.itemType);return"number"==typeof w.N?"array<"+tt+", "+w.N+">":"value"===w.itemType.kind?"array":"array<"+tt+">"}return w.kind}var vo=[Ln,Bn,Fn,Vn,Nn,uo,Wn,Gt(Yn),po];function Jt(w,tt){if("error"===tt.kind)return null;if("array"===w.kind){if("array"===tt.kind&&(0===tt.N&&"value"===tt.itemType.kind||!Jt(w.itemType,tt.itemType))&&("number"!=typeof w.N||w.N===tt.N))return null}else{if(w.kind===tt.kind)return null;if("value"===w.kind)for(var et=0,rt=vo;et<rt.length;et+=1)if(!Jt(rt[et],tt))return null}return"Expected "+Zt(w)+" but found "+Zt(tt)+" instead."}function Ht(w,tt){return tt.some((function(tt){return tt.kind===w.kind}))}function Yt(w,tt){return tt.some((function(tt){return"null"===tt?null===w:"array"===tt?Array.isArray(w):"object"===tt?w&&!Array.isArray(w)&&"object"==typeof w:tt===typeof w}))}var So=e((function(w,tt){var et={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(w){return(w=Math.round(w))<0?0:w>255?255:w}function i(w){return n("%"===w[w.length-1]?parseFloat(w)/100*255:parseInt(w))}function a(w){return(tt="%"===w[w.length-1]?parseFloat(w)/100:parseFloat(w))<0?0:tt>1?1:tt;var tt}function o(w,tt,et){return et<0?et+=1:et>1&&(et-=1),6*et<1?w+(tt-w)*et*6:2*et<1?tt:3*et<2?w+(tt-w)*(2/3-et)*6:w}try{tt.parseCSSColor=function(w){var tt,rt=w.replace(/ /g,"").toLowerCase();if(rt in et)return et[rt].slice();if("#"===rt[0])return 4===rt.length?(tt=parseInt(rt.substr(1),16))>=0&&tt<=4095?[(3840&tt)>>4|(3840&tt)>>8,240&tt|(240&tt)>>4,15&tt|(15&tt)<<4,1]:null:7===rt.length&&(tt=parseInt(rt.substr(1),16))>=0&&tt<=16777215?[(16711680&tt)>>16,(65280&tt)>>8,255&tt,1]:null;var it=rt.indexOf("("),nt=rt.indexOf(")");if(-1!==it&&nt+1===rt.length){var ot=rt.substr(0,it),at=rt.substr(it+1,nt-(it+1)).split(","),st=1;switch(ot){case"rgba":if(4!==at.length)return null;st=a(at.pop());case"rgb":return 3!==at.length?null:[i(at[0]),i(at[1]),i(at[2]),st];case"hsla":if(4!==at.length)return null;st=a(at.pop());case"hsl":if(3!==at.length)return null;var ct=(parseFloat(at[0])%360+360)%360/360,pt=a(at[1]),ft=a(at[2]),dt=ft<=.5?ft*(pt+1):ft+pt-ft*pt,mt=2*ft-dt;return[n(255*o(mt,dt,ct+1/3)),n(255*o(mt,dt,ct)),n(255*o(mt,dt,ct-1/3)),st];default:return null}}return null}}catch(w){}})).parseCSSColor,Wt=function(tt,et,rt,it){void 0===it&&(it=1),(this||w).r=tt,(this||w).g=et,(this||w).b=rt,(this||w).a=it};Wt.parse=function(w){if(w){if(w instanceof Wt)return w;if("string"==typeof w){var tt=So(w);if(tt)return new Wt(tt[0]/255*tt[3],tt[1]/255*tt[3],tt[2]/255*tt[3],tt[3])}}},Wt.prototype.toString=function(){var w=this.toArray(),tt=w[1],et=w[2],rt=w[3];return"rgba("+Math.round(w[0])+","+Math.round(tt)+","+Math.round(et)+","+rt+")"},Wt.prototype.toArray=function(){var tt=(this||w).a;return 0===tt?[0,0,0,0]:[255*(this||w).r/tt,255*(this||w).g/tt,255*(this||w).b/tt,tt]},Wt.black=new Wt(0,0,0,1),Wt.white=new Wt(1,1,1,1),Wt.transparent=new Wt(0,0,0,0),Wt.red=new Wt(1,0,0,1);var Qt=function(tt,et,rt){(this||w).sensitivity=tt?et?"variant":"case":et?"accent":"base",(this||w).locale=rt,(this||w).collator=new Intl.Collator((this||w).locale?(this||w).locale:[],{sensitivity:(this||w).sensitivity,usage:"search"})};Qt.prototype.compare=function(tt,et){return(this||w).collator.compare(tt,et)},Qt.prototype.resolvedLocale=function(){return new Intl.Collator((this||w).locale?(this||w).locale:[]).resolvedOptions().locale};var te=function(tt,et,rt,it,nt){(this||w).text=tt,(this||w).image=et,(this||w).scale=rt,(this||w).fontStack=it,(this||w).textColor=nt},ee=function(tt){(this||w).sections=tt};ee.fromString=function(w){return new ee([new te(w,null,null,null,null)])},ee.prototype.isEmpty=function(){return 0===(this||w).sections.length||!(this||w).sections.some((function(w){return 0!==w.text.length||w.image&&0!==w.image.name.length}))},ee.factory=function(w){return w instanceof ee?w:ee.fromString(w)},ee.prototype.toString=function(){return 0===(this||w).sections.length?"":(this||w).sections.map((function(w){return w.text})).join("")},ee.prototype.serialize=function(){for(var tt=["format"],et=0,rt=(this||w).sections;et<rt.length;et+=1){var it=rt[et];if(it.image)tt.push(["image",it.image.name]);else{tt.push(it.text);var nt={};it.fontStack&&(nt["text-font"]=["literal",it.fontStack.split(",")]),it.scale&&(nt["font-scale"]=it.scale),it.textColor&&(nt["text-color"]=["rgba"].concat(it.textColor.toArray())),tt.push(nt)}}return tt};var re=function(tt){(this||w).name=tt.name,(this||w).available=tt.available};function ne(w,tt,et,rt){return"number"==typeof w&&w>=0&&w<=255&&"number"==typeof tt&&tt>=0&&tt<=255&&"number"==typeof et&&et>=0&&et<=255?void 0===rt||"number"==typeof rt&&rt>=0&&rt<=1?null:"Invalid rgba value ["+[w,tt,et,rt].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof rt?[w,tt,et,rt]:[w,tt,et]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function ie(w){if(null===w)return!0;if("string"==typeof w)return!0;if("boolean"==typeof w)return!0;if("number"==typeof w)return!0;if(w instanceof Wt)return!0;if(w instanceof Qt)return!0;if(w instanceof ee)return!0;if(w instanceof re)return!0;if(Array.isArray(w)){for(var tt=0,et=w;tt<et.length;tt+=1)if(!ie(et[tt]))return!1;return!0}if("object"==typeof w){for(var rt in w)if(!ie(w[rt]))return!1;return!0}return!1}function ae(w){if(null===w)return Ln;if("string"==typeof w)return Fn;if("boolean"==typeof w)return Vn;if("number"==typeof w)return Bn;if(w instanceof Wt)return Nn;if(w instanceof Qt)return $n;if(w instanceof ee)return uo;if(w instanceof re)return po;if(Array.isArray(w)){for(var tt,et=w.length,rt=0,it=w;rt<it.length;rt+=1){var nt=ae(it[rt]);if(tt){if(tt===nt)continue;tt=Yn;break}tt=nt}return Gt(tt||Yn,et)}return Wn}function oe(w){var tt=typeof w;return null===w?"":"string"===tt||"number"===tt||"boolean"===tt?String(w):w instanceof Wt||w instanceof ee||w instanceof re?w.toString():JSON.stringify(w)}re.prototype.toString=function(){return(this||w).name},re.fromString=function(w){return w?new re({name:w,available:!1}):null},re.prototype.serialize=function(){return["image",(this||w).name]};var se=function(tt,et){(this||w).type=tt,(this||w).value=et};se.parse=function(w,tt){if(2!==w.length)return tt.error("'literal' expression requires exactly one argument, but found "+(w.length-1)+" instead.");if(!ie(w[1]))return tt.error("invalid value");var et=w[1],rt=ae(et),it=tt.expectedType;return"array"!==rt.kind||0!==rt.N||!it||"array"!==it.kind||"number"==typeof it.N&&0!==it.N||(rt=it),new se(rt,et)},se.prototype.evaluate=function(){return(this||w).value},se.prototype.eachChild=function(){},se.prototype.outputDefined=function(){return!0},se.prototype.serialize=function(){return"array"===(this||w).type.kind||"object"===(this||w).type.kind?["literal",(this||w).value]:(this||w).value instanceof Wt?["rgba"].concat((this||w).value.toArray()):(this||w).value instanceof ee?(this||w).value.serialize():(this||w).value};var ue=function(tt){(this||w).name="ExpressionEvaluationError",(this||w).message=tt};ue.prototype.toJSON=function(){return(this||w).message};var ta={string:Fn,number:Bn,boolean:Vn,object:Wn},pe=function(tt,et){(this||w).type=tt,(this||w).args=et};pe.parse=function(w,tt){if(w.length<2)return tt.error("Expected at least one argument.");var et,rt=1,it=w[0];if("array"===it){var nt,ot;if(w.length>2){var at=w[1];if("string"!=typeof at||!(at in ta)||"object"===at)return tt.error('The item type argument of "array" must be one of string, number, boolean',1);nt=ta[at],rt++}else nt=Yn;if(w.length>3){if(null!==w[2]&&("number"!=typeof w[2]||w[2]<0||w[2]!==Math.floor(w[2])))return tt.error('The length argument to "array" must be a positive integer literal',2);ot=w[2],rt++}et=Gt(nt,ot)}else et=ta[it];for(var st=[];rt<w.length;rt++){var ct=tt.parse(w[rt],rt,Yn);if(!ct)return null;st.push(ct)}return new pe(et,st)},pe.prototype.evaluate=function(tt){for(var et=0;et<(this||w).args.length;et++){var rt=(this||w).args[et].evaluate(tt);if(!Jt((this||w).type,ae(rt)))return rt;if(et===(this||w).args.length-1)throw new ue("Expected value to be of type "+Zt((this||w).type)+", but found "+Zt(ae(rt))+" instead.")}return null},pe.prototype.eachChild=function(tt){(this||w).args.forEach(tt)},pe.prototype.outputDefined=function(){return(this||w).args.every((function(w){return w.outputDefined()}))},pe.prototype.serialize=function(){var tt=(this||w).type,et=[tt.kind];if("array"===tt.kind){var rt=tt.itemType;if("string"===rt.kind||"number"===rt.kind||"boolean"===rt.kind){et.push(rt.kind);var it=tt.N;("number"==typeof it||(this||w).args.length>1)&&et.push(it)}}return et.concat((this||w).args.map((function(w){return w.serialize()})))};var ce=function(tt){(this||w).type=uo,(this||w).sections=tt};ce.parse=function(w,tt){if(w.length<2)return tt.error("Expected at least one argument.");var et=w[1];if(!Array.isArray(et)&&"object"==typeof et)return tt.error("First argument must be an image or text section.");for(var rt=[],it=!1,nt=1;nt<=w.length-1;++nt){var ot=w[nt];if(it&&"object"==typeof ot&&!Array.isArray(ot)){it=!1;var at=null;if(ot["font-scale"]&&!(at=tt.parse(ot["font-scale"],1,Bn)))return null;var st=null;if(ot["text-font"]&&!(st=tt.parse(ot["text-font"],1,Gt(Fn))))return null;var ct=null;if(ot["text-color"]&&!(ct=tt.parse(ot["text-color"],1,Nn)))return null;var pt=rt[rt.length-1];pt.scale=at,pt.font=st,pt.textColor=ct}else{var ft=tt.parse(w[nt],1,Yn);if(!ft)return null;var dt=ft.type.kind;if("string"!==dt&&"value"!==dt&&"null"!==dt&&"resolvedImage"!==dt)return tt.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");it=!0,rt.push({content:ft,scale:null,font:null,textColor:null})}}return new ce(rt)},ce.prototype.evaluate=function(tt){return new ee((this||w).sections.map((function(w){var et=w.content.evaluate(tt);return ae(et)===po?new te("",et,null,null,null):new te(oe(et),null,w.scale?w.scale.evaluate(tt):null,w.font?w.font.evaluate(tt).join(","):null,w.textColor?w.textColor.evaluate(tt):null)})))},ce.prototype.eachChild=function(tt){for(var et=0,rt=(this||w).sections;et<rt.length;et+=1){var it=rt[et];tt(it.content),it.scale&&tt(it.scale),it.font&&tt(it.font),it.textColor&&tt(it.textColor)}},ce.prototype.outputDefined=function(){return!1},ce.prototype.serialize=function(){for(var tt=["format"],et=0,rt=(this||w).sections;et<rt.length;et+=1){var it=rt[et];tt.push(it.content.serialize());var nt={};it.scale&&(nt["font-scale"]=it.scale.serialize()),it.font&&(nt["text-font"]=it.font.serialize()),it.textColor&&(nt["text-color"]=it.textColor.serialize()),tt.push(nt)}return tt};var he=function(tt){(this||w).type=po,(this||w).input=tt};he.parse=function(w,tt){if(2!==w.length)return tt.error("Expected two arguments.");var et=tt.parse(w[1],1,Fn);return et?new he(et):tt.error("No image name provided.")},he.prototype.evaluate=function(tt){var et=(this||w).input.evaluate(tt),rt=re.fromString(et);return rt&&tt.availableImages&&(rt.available=tt.availableImages.indexOf(et)>-1),rt},he.prototype.eachChild=function(tt){tt((this||w).input)},he.prototype.outputDefined=function(){return!1},he.prototype.serialize=function(){return["image",(this||w).input.serialize()]};var ea={"to-boolean":Vn,"to-color":Nn,"to-number":Bn,"to-string":Fn},ye=function(tt,et){(this||w).type=tt,(this||w).args=et};ye.parse=function(w,tt){if(w.length<2)return tt.error("Expected at least one argument.");var et=w[0];if(("to-boolean"===et||"to-string"===et)&&2!==w.length)return tt.error("Expected one argument.");for(var rt=ea[et],it=[],nt=1;nt<w.length;nt++){var ot=tt.parse(w[nt],nt,Yn);if(!ot)return null;it.push(ot)}return new ye(rt,it)},ye.prototype.evaluate=function(tt){if("boolean"===(this||w).type.kind)return Boolean((this||w).args[0].evaluate(tt));if("color"===(this||w).type.kind){for(var et,rt,it=0,nt=(this||w).args;it<nt.length;it+=1){if(rt=null,(et=nt[it].evaluate(tt))instanceof Wt)return et;if("string"==typeof et){var ot=tt.parseColor(et);if(ot)return ot}else if(Array.isArray(et)&&!(rt=et.length<3||et.length>4?"Invalid rbga value "+JSON.stringify(et)+": expected an array containing either three or four numeric values.":ne(et[0],et[1],et[2],et[3])))return new Wt(et[0]/255,et[1]/255,et[2]/255,et[3])}throw new ue(rt||"Could not parse color from value '"+("string"==typeof et?et:String(JSON.stringify(et)))+"'")}if("number"===(this||w).type.kind){for(var at=null,st=0,ct=(this||w).args;st<ct.length;st+=1){if(null===(at=ct[st].evaluate(tt)))return 0;var pt=Number(at);if(!isNaN(pt))return pt}throw new ue("Could not convert "+JSON.stringify(at)+" to number.")}return"formatted"===(this||w).type.kind?ee.fromString(oe((this||w).args[0].evaluate(tt))):"resolvedImage"===(this||w).type.kind?re.fromString(oe((this||w).args[0].evaluate(tt))):oe((this||w).args[0].evaluate(tt))},ye.prototype.eachChild=function(tt){(this||w).args.forEach(tt)},ye.prototype.outputDefined=function(){return(this||w).args.every((function(w){return w.outputDefined()}))},ye.prototype.serialize=function(){if("formatted"===(this||w).type.kind)return new ce([{content:(this||w).args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===(this||w).type.kind)return new he((this||w).args[0]).serialize();var tt=["to-"+(this||w).type.kind];return this.eachChild((function(w){tt.push(w.serialize())})),tt};var ra=["Unknown","Point","LineString","Polygon"],me=function(){(this||w).globals=null,(this||w).feature=null,(this||w).featureState=null,(this||w).formattedSection=null,(this||w)._parseColorCache={},(this||w).availableImages=null,(this||w).canonical=null};me.prototype.id=function(){return(this||w).feature&&"id"in(this||w).feature?(this||w).feature.id:null},me.prototype.geometryType=function(){return(this||w).feature?"number"==typeof(this||w).feature.type?ra[(this||w).feature.type]:(this||w).feature.type:null},me.prototype.geometry=function(){return(this||w).feature&&"geometry"in(this||w).feature?(this||w).feature.geometry:null},me.prototype.canonicalID=function(){return(this||w).canonical},me.prototype.properties=function(){return(this||w).feature&&(this||w).feature.properties||{}},me.prototype.parseColor=function(tt){var et=(this||w)._parseColorCache[tt];return et||(et=(this||w)._parseColorCache[tt]=Wt.parse(tt)),et};var ve=function(tt,et,rt,it){(this||w).name=tt,(this||w).type=et,(this||w)._evaluate=rt,(this||w).args=it};ve.prototype.evaluate=function(tt){return this._evaluate(tt,(this||w).args)},ve.prototype.eachChild=function(tt){(this||w).args.forEach(tt)},ve.prototype.outputDefined=function(){return!1},ve.prototype.serialize=function(){return[(this||w).name].concat((this||w).args.map((function(w){return w.serialize()})))},ve.parse=function(w,tt){var et,rt=w[0],it=ve.definitions[rt];if(!it)return tt.error('Unknown expression "'+rt+'". If you wanted a literal array, use ["literal", [...]].',0);for(var nt=Array.isArray(it)?it[0]:it.type,ot=Array.isArray(it)?[[it[1],it[2]]]:it.overloads,at=ot.filter((function(tt){var et=tt[0];return!Array.isArray(et)||et.length===w.length-1})),st=null,ct=0,pt=at;ct<pt.length;ct+=1){var ft=pt[ct],dt=ft[0],mt=ft[1];st=new Oe(tt.registry,tt.path,null,tt.scope);for(var yt=[],vt=!1,Dt=1;Dt<w.length;Dt++){var Rt=w[Dt],Bt=Array.isArray(dt)?dt[Dt-1]:dt.type,Ot=st.parse(Rt,1+yt.length,Bt);if(!Ot){vt=!0;break}yt.push(Ot)}if(!vt)if(Array.isArray(dt)&&dt.length!==yt.length)st.error("Expected "+dt.length+" arguments, but found "+yt.length+" instead.");else{for(var Ne=0;Ne<yt.length;Ne++){var Ze=Array.isArray(dt)?dt[Ne]:dt.type,Ge=yt[Ne];st.concat(Ne+1).checkSubtype(Ze,Ge.type)}if(0===st.errors.length)return new ve(rt,nt,mt,yt)}}if(1===at.length)(et=tt.errors).push.apply(et,st.errors);else{for(var Ke=(at.length?at:ot).map((function(w){var tt;return tt=w[0],Array.isArray(tt)?"("+tt.map(Zt).join(", ")+")":"("+Zt(tt.type)+"...)"})).join(" | "),er=[],rr=1;rr<w.length;rr++){var vr=tt.parse(w[rr],1+er.length);if(!vr)return null;er.push(Zt(vr.type))}tt.error("Expected arguments of type "+Ke+", but found ("+er.join(", ")+") instead.")}return null},ve.register=function(w,tt){for(var et in ve.definitions=tt,tt)w[et]=ve};var ge=function(tt,et,rt){(this||w).type=$n,(this||w).locale=rt,(this||w).caseSensitive=tt,(this||w).diacriticSensitive=et};function xe(w,tt){w[0]=Math.min(w[0],tt[0]),w[1]=Math.min(w[1],tt[1]),w[2]=Math.max(w[2],tt[0]),w[3]=Math.max(w[3],tt[1])}function be(w,tt){return!(w[0]<=tt[0]||w[2]>=tt[2]||w[1]<=tt[1]||w[3]>=tt[3])}function we(w,tt){var et=(180+w[0])/360,rt=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+w[1]*Math.PI/360)))/360,it=Math.pow(2,tt.z);return[Math.round(et*it*8192),Math.round(rt*it*8192)]}function _e(w,tt,et){return tt[1]>w[1]!=et[1]>w[1]&&w[0]<(et[0]-tt[0])*(w[1]-tt[1])/(et[1]-tt[1])+tt[0]}function Ae(w,tt){for(var et,rt,it,nt,ot,at,st,ct=!1,pt=0,ft=tt.length;pt<ft;pt++)for(var dt=tt[pt],mt=0,yt=dt.length;mt<yt-1;mt++){if((nt=(et=w)[0]-(rt=dt[mt])[0])*(st=et[1]-(it=dt[mt+1])[1])-(at=et[0]-it[0])*(ot=et[1]-rt[1])==0&&nt*at<=0&&ot*st<=0)return!1;_e(w,dt[mt],dt[mt+1])&&(ct=!ct)}return ct}function Se(w,tt){for(var et=0;et<tt.length;et++)if(Ae(w,tt[et]))return!0;return!1}function ke(w,tt,et,rt){var it=rt[0]-et[0],nt=rt[1]-et[1],ot=(w[0]-et[0])*nt-it*(w[1]-et[1]),at=(tt[0]-et[0])*nt-it*(tt[1]-et[1]);return ot>0&&at<0||ot<0&&at>0}function Ie(w,tt,et){for(var rt=0,it=et;rt<it.length;rt+=1)for(var nt=it[rt],ot=0;ot<nt.length-1;++ot)if(0!=(ft=[(pt=nt[ot+1])[0]-(ct=nt[ot])[0],pt[1]-ct[1]])[0]*(dt=[(st=tt)[0]-(at=w)[0],st[1]-at[1]])[1]-ft[1]*dt[0]&&ke(at,st,ct,pt)&&ke(ct,pt,at,st))return!0;var at,st,ct,pt,ft,dt;return!1}function ze(w,tt){for(var et=0;et<w.length;++et)if(!Ae(w[et],tt))return!1;for(var rt=0;rt<w.length-1;++rt)if(Ie(w[rt],w[rt+1],tt))return!1;return!0}function Ce(w,tt){for(var et=0;et<tt.length;et++)if(ze(w,tt[et]))return!0;return!1}function Me(w,tt,et){for(var rt=[],it=0;it<w.length;it++){for(var nt=[],ot=0;ot<w[it].length;ot++){var at=we(w[it][ot],et);xe(tt,at),nt.push(at)}rt.push(nt)}return rt}function Ee(w,tt,et){for(var rt=[],it=0;it<w.length;it++){var nt=Me(w[it],tt,et);rt.push(nt)}return rt}function Te(w,tt,et,rt){if(w[0]<et[0]||w[0]>et[2]){var it=.5*rt,nt=w[0]-et[0]>it?-rt:et[0]-w[0]>it?rt:0;0===nt&&(nt=w[0]-et[2]>it?-rt:et[2]-w[0]>it?rt:0),w[0]+=nt}xe(tt,w)}function Pe(w,tt,et,rt){for(var it=8192*Math.pow(2,rt.z),nt=[8192*rt.x,8192*rt.y],ot=[],at=0,st=w;at<st.length;at+=1)for(var ct=0,pt=st[at];ct<pt.length;ct+=1){var ft=pt[ct],dt=[ft.x+nt[0],ft.y+nt[1]];Te(dt,tt,et,it),ot.push(dt)}return ot}function Be(w,tt,et,rt){for(var it,nt=8192*Math.pow(2,rt.z),ot=[8192*rt.x,8192*rt.y],at=[],st=0,ct=w;st<ct.length;st+=1){for(var pt=[],ft=0,dt=ct[st];ft<dt.length;ft+=1){var mt=dt[ft],yt=[mt.x+ot[0],mt.y+ot[1]];xe(tt,yt),pt.push(yt)}at.push(pt)}if(tt[2]-tt[0]<=nt/2){(it=tt)[0]=it[1]=1/0,it[2]=it[3]=-1/0;for(var vt=0,Dt=at;vt<Dt.length;vt+=1)for(var Rt=0,Bt=Dt[vt];Rt<Bt.length;Rt+=1)Te(Bt[Rt],tt,et,nt)}return at}ge.parse=function(w,tt){if(2!==w.length)return tt.error("Expected one argument.");var et=w[1];if("object"!=typeof et||Array.isArray(et))return tt.error("Collator options argument must be an object.");var rt=tt.parse(void 0!==et["case-sensitive"]&&et["case-sensitive"],1,Vn);if(!rt)return null;var it=tt.parse(void 0!==et["diacritic-sensitive"]&&et["diacritic-sensitive"],1,Vn);if(!it)return null;var nt=null;return et.locale&&!(nt=tt.parse(et.locale,1,Fn))?null:new ge(rt,it,nt)},ge.prototype.evaluate=function(tt){return new Qt((this||w).caseSensitive.evaluate(tt),(this||w).diacriticSensitive.evaluate(tt),(this||w).locale?(this||w).locale.evaluate(tt):null)},ge.prototype.eachChild=function(tt){tt((this||w).caseSensitive),tt((this||w).diacriticSensitive),(this||w).locale&&tt((this||w).locale)},ge.prototype.outputDefined=function(){return!1},ge.prototype.serialize=function(){var tt={};return tt["case-sensitive"]=(this||w).caseSensitive.serialize(),tt["diacritic-sensitive"]=(this||w).diacriticSensitive.serialize(),(this||w).locale&&(tt.locale=(this||w).locale.serialize()),["collator",tt]};var Ve=function(tt,et){(this||w).type=Vn,(this||w).geojson=tt,(this||w).geometries=et};function Fe(w){if(w instanceof ve){if("get"===w.name&&1===w.args.length)return!1;if("feature-state"===w.name)return!1;if("has"===w.name&&1===w.args.length)return!1;if("properties"===w.name||"geometry-type"===w.name||"id"===w.name)return!1;if(/^filter-/.test(w.name))return!1}if(w instanceof Ve)return!1;var tt=!0;return w.eachChild((function(w){tt&&!Fe(w)&&(tt=!1)})),tt}function De(w){if(w instanceof ve&&"feature-state"===w.name)return!1;var tt=!0;return w.eachChild((function(w){tt&&!De(w)&&(tt=!1)})),tt}function Le(w,tt){if(w instanceof ve&&tt.indexOf(w.name)>=0)return!1;var et=!0;return w.eachChild((function(w){et&&!Le(w,tt)&&(et=!1)})),et}Ve.parse=function(w,tt){if(2!==w.length)return tt.error("'within' expression requires exactly one argument, but found "+(w.length-1)+" instead.");if(ie(w[1])){var et=w[1];if("FeatureCollection"===et.type)for(var rt=0;rt<et.features.length;++rt){var it=et.features[rt].geometry.type;if("Polygon"===it||"MultiPolygon"===it)return new Ve(et,et.features[rt].geometry)}else if("Feature"===et.type){var nt=et.geometry.type;if("Polygon"===nt||"MultiPolygon"===nt)return new Ve(et,et.geometry)}else if("Polygon"===et.type||"MultiPolygon"===et.type)return new Ve(et,et)}return tt.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Ve.prototype.evaluate=function(tt){if(null!=tt.geometry()&&null!=tt.canonicalID()){if("Point"===tt.geometryType())return function(w,tt){var et=[1/0,1/0,-1/0,-1/0],rt=[1/0,1/0,-1/0,-1/0],it=w.canonicalID();if("Polygon"===tt.type){var nt=Me(tt.coordinates,rt,it),ot=Pe(w.geometry(),et,rt,it);if(!be(et,rt))return!1;for(var at=0,st=ot;at<st.length;at+=1)if(!Ae(st[at],nt))return!1}if("MultiPolygon"===tt.type){var ct=Ee(tt.coordinates,rt,it),pt=Pe(w.geometry(),et,rt,it);if(!be(et,rt))return!1;for(var ft=0,dt=pt;ft<dt.length;ft+=1)if(!Se(dt[ft],ct))return!1}return!0}(tt,(this||w).geometries);if("LineString"===tt.geometryType())return function(w,tt){var et=[1/0,1/0,-1/0,-1/0],rt=[1/0,1/0,-1/0,-1/0],it=w.canonicalID();if("Polygon"===tt.type){var nt=Me(tt.coordinates,rt,it),ot=Be(w.geometry(),et,rt,it);if(!be(et,rt))return!1;for(var at=0,st=ot;at<st.length;at+=1)if(!ze(st[at],nt))return!1}if("MultiPolygon"===tt.type){var ct=Ee(tt.coordinates,rt,it),pt=Be(w.geometry(),et,rt,it);if(!be(et,rt))return!1;for(var ft=0,dt=pt;ft<dt.length;ft+=1)if(!Ce(dt[ft],ct))return!1}return!0}(tt,(this||w).geometries)}return!1},Ve.prototype.eachChild=function(){},Ve.prototype.outputDefined=function(){return!0},Ve.prototype.serialize=function(){return["within",(this||w).geojson]};var Re=function(tt,et){(this||w).type=et.type,(this||w).name=tt,(this||w).boundExpression=et};Re.parse=function(w,tt){if(2!==w.length||"string"!=typeof w[1])return tt.error("'var' expression requires exactly one string literal argument.");var et=w[1];return tt.scope.has(et)?new Re(et,tt.scope.get(et)):tt.error('Unknown variable "'+et+'". Make sure "'+et+'" has been bound in an enclosing "let" expression before using it.',1)},Re.prototype.evaluate=function(tt){return(this||w).boundExpression.evaluate(tt)},Re.prototype.eachChild=function(){},Re.prototype.outputDefined=function(){return!1},Re.prototype.serialize=function(){return["var",(this||w).name]};var Oe=function(tt,et,rt,it,nt){void 0===et&&(et=[]),void 0===it&&(it=new Vt),void 0===nt&&(nt=[]),(this||w).registry=tt,(this||w).path=et,(this||w).key=et.map((function(w){return"["+w+"]"})).join(""),(this||w).scope=it,(this||w).errors=nt,(this||w).expectedType=rt};function Ue(w,tt){for(var et,rt=w.length-1,it=0,nt=rt,ot=0;it<=nt;)if((et=w[ot=Math.floor((it+nt)/2)])<=tt){if(ot===rt||tt<w[ot+1])return ot;it=ot+1}else{if(!(et>tt))throw new ue("Input is not a number.");nt=ot-1}return 0}Oe.prototype.parse=function(w,tt,et,rt,it){return void 0===it&&(it={}),tt?this.concat(tt,et,rt)._parse(w,it):this._parse(w,it)},Oe.prototype._parse=function(tt,et){function r(w,tt,et){return"assert"===et?new pe(tt,[w]):"coerce"===et?new ye(tt,[w]):w}if(null!==tt&&"string"!=typeof tt&&"boolean"!=typeof tt&&"number"!=typeof tt||(tt=["literal",tt]),Array.isArray(tt)){if(0===tt.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var rt=tt[0];if("string"!=typeof rt)return this.error("Expression name must be a string, but found "+typeof rt+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var it=(this||w).registry[rt];if(it){var nt=it.parse(tt,this||w);if(!nt)return null;if((this||w).expectedType){var ot=(this||w).expectedType,at=nt.type;if("string"!==ot.kind&&"number"!==ot.kind&&"boolean"!==ot.kind&&"object"!==ot.kind&&"array"!==ot.kind||"value"!==at.kind)if("color"!==ot.kind&&"formatted"!==ot.kind&&"resolvedImage"!==ot.kind||"value"!==at.kind&&"string"!==at.kind){if(this.checkSubtype(ot,at))return null}else nt=r(nt,ot,et.typeAnnotation||"coerce");else nt=r(nt,ot,et.typeAnnotation||"assert")}if(!(nt instanceof se)&&"resolvedImage"!==nt.type.kind&&function t(w){if(w instanceof Re)return t(w.boundExpression);if(w instanceof ve&&"error"===w.name)return!1;if(w instanceof ge)return!1;if(w instanceof Ve)return!1;var tt=w instanceof ye||w instanceof pe,et=!0;return w.eachChild((function(w){et=tt?et&&t(w):et&&w instanceof se})),!!et&&Fe(w)&&Le(w,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(nt)){var st=new me;try{nt=new se(nt.type,nt.evaluate(st))}catch(tt){return this.error(tt.message),null}}return nt}return this.error('Unknown expression "'+rt+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===tt?"'undefined' value invalid. Use null instead.":"object"==typeof tt?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof tt+" instead.")},Oe.prototype.concat=function(tt,et,rt){var it="number"==typeof tt?(this||w).path.concat(tt):(this||w).path,nt=rt?(this||w).scope.concat(rt):(this||w).scope;return new Oe((this||w).registry,it,et||null,nt,(this||w).errors)},Oe.prototype.error=function(tt){for(var et=[],rt=arguments.length-1;rt-- >0;)et[rt]=arguments[rt+1];var it=""+(this||w).key+et.map((function(w){return"["+w+"]"})).join("");(this||w).errors.push(new Mn(it,tt))},Oe.prototype.checkSubtype=function(w,tt){var et=Jt(w,tt);return et&&this.error(et),et};var je=function(tt,et,rt){(this||w).type=tt,(this||w).input=et,(this||w).labels=[],(this||w).outputs=[];for(var it=0,nt=rt;it<nt.length;it+=1){var ot=nt[it],at=ot[1];(this||w).labels.push(ot[0]),(this||w).outputs.push(at)}};function qe(w,tt,et){return w*(1-et)+tt*et}je.parse=function(w,tt){if(w.length-1<4)return tt.error("Expected at least 4 arguments, but found only "+(w.length-1)+".");if((w.length-1)%2!=0)return tt.error("Expected an even number of arguments.");var et=tt.parse(w[1],1,Bn);if(!et)return null;var rt=[],it=null;tt.expectedType&&"value"!==tt.expectedType.kind&&(it=tt.expectedType);for(var nt=1;nt<w.length;nt+=2){var ot=1===nt?-1/0:w[nt],at=w[nt+1],st=nt,ct=nt+1;if("number"!=typeof ot)return tt.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',st);if(rt.length&&rt[rt.length-1][0]>=ot)return tt.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',st);var pt=tt.parse(at,ct,it);if(!pt)return null;it=it||pt.type,rt.push([ot,pt])}return new je(it,et,rt)},je.prototype.evaluate=function(tt){var et=(this||w).labels,rt=(this||w).outputs;if(1===et.length)return rt[0].evaluate(tt);var it=(this||w).input.evaluate(tt);if(it<=et[0])return rt[0].evaluate(tt);var nt=et.length;return it>=et[nt-1]?rt[nt-1].evaluate(tt):rt[Ue(et,it)].evaluate(tt)},je.prototype.eachChild=function(tt){tt((this||w).input);for(var et=0,rt=(this||w).outputs;et<rt.length;et+=1)tt(rt[et])},je.prototype.outputDefined=function(){return(this||w).outputs.every((function(w){return w.outputDefined()}))},je.prototype.serialize=function(){for(var tt=["step",(this||w).input.serialize()],et=0;et<(this||w).labels.length;et++)et>0&&tt.push((this||w).labels[et]),tt.push((this||w).outputs[et].serialize());return tt};var ia=Object.freeze({__proto__:null,number:qe,color:function(w,tt,et){return new Wt(qe(w.r,tt.r,et),qe(w.g,tt.g,et),qe(w.b,tt.b,et),qe(w.a,tt.a,et))},array:function(w,tt,et){return w.map((function(w,rt){return qe(w,tt[rt],et)}))}}),na=6/29*3*(6/29),sa=Math.PI/180,la=180/Math.PI;function Xe(w){return w>.008856451679035631?Math.pow(w,1/3):w/na+4/29}function Je(w){return w>6/29?w*w*w:na*(w-4/29)}function He(w){return 255*(w<=.0031308?12.92*w:1.055*Math.pow(w,1/2.4)-.055)}function Ye(w){return(w/=255)<=.04045?w/12.92:Math.pow((w+.055)/1.055,2.4)}function $e(w){var tt=Ye(w.r),et=Ye(w.g),rt=Ye(w.b),it=Xe((.4124564*tt+.3575761*et+.1804375*rt)/.95047),nt=Xe((.2126729*tt+.7151522*et+.072175*rt)/1);return{l:116*nt-16,a:500*(it-nt),b:200*(nt-Xe((.0193339*tt+.119192*et+.9503041*rt)/1.08883)),alpha:w.a}}function We(w){var tt=(w.l+16)/116,et=isNaN(w.a)?tt:tt+w.a/500,rt=isNaN(w.b)?tt:tt-w.b/200;return tt=1*Je(tt),et=.95047*Je(et),rt=1.08883*Je(rt),new Wt(He(3.2404542*et-1.5371385*tt-.4985314*rt),He(-.969266*et+1.8760108*tt+.041556*rt),He(.0556434*et-.2040259*tt+1.0572252*rt),w.alpha)}function Qe(w,tt,et){var rt=tt-w;return w+et*(rt>180||rt<-180?rt-360*Math.round(rt/360):rt)}var ua={forward:$e,reverse:We,interpolate:function(w,tt,et){return{l:qe(w.l,tt.l,et),a:qe(w.a,tt.a,et),b:qe(w.b,tt.b,et),alpha:qe(w.alpha,tt.alpha,et)}}},ca={forward:function(w){var tt=$e(w),et=tt.l,rt=tt.a,it=tt.b,nt=Math.atan2(it,rt)*la;return{h:nt<0?nt+360:nt,c:Math.sqrt(rt*rt+it*it),l:et,alpha:w.a}},reverse:function(w){var tt=w.h*sa,et=w.c;return We({l:w.l,a:Math.cos(tt)*et,b:Math.sin(tt)*et,alpha:w.alpha})},interpolate:function(w,tt,et){return{h:Qe(w.h,tt.h,et),c:qe(w.c,tt.c,et),l:qe(w.l,tt.l,et),alpha:qe(w.alpha,tt.alpha,et)}}},pa=Object.freeze({__proto__:null,lab:ua,hcl:ca}),nr=function(tt,et,rt,it,nt){(this||w).type=tt,(this||w).operator=et,(this||w).interpolation=rt,(this||w).input=it,(this||w).labels=[],(this||w).outputs=[];for(var ot=0,at=nt;ot<at.length;ot+=1){var st=at[ot],ct=st[1];(this||w).labels.push(st[0]),(this||w).outputs.push(ct)}};function ir(w,tt,et,rt){var it=rt-et,nt=w-et;return 0===it?0:1===tt?nt/it:(Math.pow(tt,nt)-1)/(Math.pow(tt,it)-1)}nr.interpolationFactor=function(w,tt,rt,it){var nt=0;if("exponential"===w.name)nt=ir(tt,w.base,rt,it);else if("linear"===w.name)nt=ir(tt,1,rt,it);else if("cubic-bezier"===w.name){var ot=w.controlPoints;nt=new et(ot[0],ot[1],ot[2],ot[3]).solve(ir(tt,1,rt,it))}return nt},nr.parse=function(w,tt){var et=w[0],rt=w[1],it=w[2],nt=w.slice(3);if(!Array.isArray(rt)||0===rt.length)return tt.error("Expected an interpolation type expression.",1);if("linear"===rt[0])rt={name:"linear"};else if("exponential"===rt[0]){var ot=rt[1];if("number"!=typeof ot)return tt.error("Exponential interpolation requires a numeric base.",1,1);rt={name:"exponential",base:ot}}else{if("cubic-bezier"!==rt[0])return tt.error("Unknown interpolation type "+String(rt[0]),1,0);var at=rt.slice(1);if(4!==at.length||at.some((function(w){return"number"!=typeof w||w<0||w>1})))return tt.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);rt={name:"cubic-bezier",controlPoints:at}}if(w.length-1<4)return tt.error("Expected at least 4 arguments, but found only "+(w.length-1)+".");if((w.length-1)%2!=0)return tt.error("Expected an even number of arguments.");if(!(it=tt.parse(it,2,Bn)))return null;var st=[],ct=null;"interpolate-hcl"===et||"interpolate-lab"===et?ct=Nn:tt.expectedType&&"value"!==tt.expectedType.kind&&(ct=tt.expectedType);for(var pt=0;pt<nt.length;pt+=2){var ft=nt[pt],dt=nt[pt+1],mt=pt+3,yt=pt+4;if("number"!=typeof ft)return tt.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',mt);if(st.length&&st[st.length-1][0]>=ft)return tt.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',mt);var vt=tt.parse(dt,yt,ct);if(!vt)return null;ct=ct||vt.type,st.push([ft,vt])}return"number"===ct.kind||"color"===ct.kind||"array"===ct.kind&&"number"===ct.itemType.kind&&"number"==typeof ct.N?new nr(ct,et,rt,it,st):tt.error("Type "+Zt(ct)+" is not interpolatable.")},nr.prototype.evaluate=function(tt){var et=(this||w).labels,rt=(this||w).outputs;if(1===et.length)return rt[0].evaluate(tt);var it=(this||w).input.evaluate(tt);if(it<=et[0])return rt[0].evaluate(tt);var nt=et.length;if(it>=et[nt-1])return rt[nt-1].evaluate(tt);var ot=Ue(et,it),at=nr.interpolationFactor((this||w).interpolation,it,et[ot],et[ot+1]),st=rt[ot].evaluate(tt),ct=rt[ot+1].evaluate(tt);return"interpolate"===(this||w).operator?ia[(this||w).type.kind.toLowerCase()](st,ct,at):"interpolate-hcl"===(this||w).operator?ca.reverse(ca.interpolate(ca.forward(st),ca.forward(ct),at)):ua.reverse(ua.interpolate(ua.forward(st),ua.forward(ct),at))},nr.prototype.eachChild=function(tt){tt((this||w).input);for(var et=0,rt=(this||w).outputs;et<rt.length;et+=1)tt(rt[et])},nr.prototype.outputDefined=function(){return(this||w).outputs.every((function(w){return w.outputDefined()}))},nr.prototype.serialize=function(){var tt;tt="linear"===(this||w).interpolation.name?["linear"]:"exponential"===(this||w).interpolation.name?1===(this||w).interpolation.base?["linear"]:["exponential",(this||w).interpolation.base]:["cubic-bezier"].concat((this||w).interpolation.controlPoints);for(var et=[(this||w).operator,tt,(this||w).input.serialize()],rt=0;rt<(this||w).labels.length;rt++)et.push((this||w).labels[rt],(this||w).outputs[rt].serialize());return et};var ar=function(tt,et){(this||w).type=tt,(this||w).args=et};ar.parse=function(w,tt){if(w.length<2)return tt.error("Expectected at least one argument.");var et=null,rt=tt.expectedType;rt&&"value"!==rt.kind&&(et=rt);for(var it=[],nt=0,ot=w.slice(1);nt<ot.length;nt+=1){var at=tt.parse(ot[nt],1+it.length,et,void 0,{typeAnnotation:"omit"});if(!at)return null;et=et||at.type,it.push(at)}var st=rt&&it.some((function(w){return Jt(rt,w.type)}));return new ar(st?Yn:et,it)},ar.prototype.evaluate=function(tt){for(var et,rt=null,it=0,nt=0,ot=(this||w).args;nt<ot.length&&(it++,(rt=ot[nt].evaluate(tt))&&rt instanceof re&&!rt.available&&(et||(et=rt.name),rt=null,it===(this||w).args.length&&(rt=et)),null===rt);nt+=1);return rt},ar.prototype.eachChild=function(tt){(this||w).args.forEach(tt)},ar.prototype.outputDefined=function(){return(this||w).args.every((function(w){return w.outputDefined()}))},ar.prototype.serialize=function(){var w=["coalesce"];return this.eachChild((function(tt){w.push(tt.serialize())})),w};var or=function(tt,et){(this||w).type=et.type,(this||w).bindings=[].concat(tt),(this||w).result=et};or.prototype.evaluate=function(tt){return(this||w).result.evaluate(tt)},or.prototype.eachChild=function(tt){for(var et=0,rt=(this||w).bindings;et<rt.length;et+=1)tt(rt[et][1]);tt((this||w).result)},or.parse=function(w,tt){if(w.length<4)return tt.error("Expected at least 3 arguments, but found "+(w.length-1)+" instead.");for(var et=[],rt=1;rt<w.length-1;rt+=2){var it=w[rt];if("string"!=typeof it)return tt.error("Expected string, but found "+typeof it+" instead.",rt);if(/[^a-zA-Z0-9_]/.test(it))return tt.error("Variable names must contain only alphanumeric characters or '_'.",rt);var nt=tt.parse(w[rt+1],rt+1);if(!nt)return null;et.push([it,nt])}var ot=tt.parse(w[w.length-1],w.length-1,tt.expectedType,et);return ot?new or(et,ot):null},or.prototype.outputDefined=function(){return(this||w).result.outputDefined()},or.prototype.serialize=function(){for(var tt=["let"],et=0,rt=(this||w).bindings;et<rt.length;et+=1){var it=rt[et];tt.push(it[0],it[1].serialize())}return tt.push((this||w).result.serialize()),tt};var sr=function(tt,et,rt){(this||w).type=tt,(this||w).index=et,(this||w).input=rt};sr.parse=function(w,tt){if(3!==w.length)return tt.error("Expected 2 arguments, but found "+(w.length-1)+" instead.");var et=tt.parse(w[1],1,Bn),rt=tt.parse(w[2],2,Gt(tt.expectedType||Yn));return et&&rt?new sr(rt.type.itemType,et,rt):null},sr.prototype.evaluate=function(tt){var et=(this||w).index.evaluate(tt),rt=(this||w).input.evaluate(tt);if(et<0)throw new ue("Array index out of bounds: "+et+" < 0.");if(et>=rt.length)throw new ue("Array index out of bounds: "+et+" > "+(rt.length-1)+".");if(et!==Math.floor(et))throw new ue("Array index must be an integer, but found "+et+" instead.");return rt[et]},sr.prototype.eachChild=function(tt){tt((this||w).index),tt((this||w).input)},sr.prototype.outputDefined=function(){return!1},sr.prototype.serialize=function(){return["at",(this||w).index.serialize(),(this||w).input.serialize()]};var ur=function(tt,et){(this||w).type=Vn,(this||w).needle=tt,(this||w).haystack=et};ur.parse=function(w,tt){if(3!==w.length)return tt.error("Expected 2 arguments, but found "+(w.length-1)+" instead.");var et=tt.parse(w[1],1,Yn),rt=tt.parse(w[2],2,Yn);return et&&rt?Ht(et.type,[Vn,Fn,Bn,Ln,Yn])?new ur(et,rt):tt.error("Expected first argument to be of type boolean, string, number or null, but found "+Zt(et.type)+" instead"):null},ur.prototype.evaluate=function(tt){var et=(this||w).needle.evaluate(tt),rt=(this||w).haystack.evaluate(tt);if(!rt)return!1;if(!Yt(et,["boolean","string","number","null"]))throw new ue("Expected first argument to be of type boolean, string, number or null, but found "+Zt(ae(et))+" instead.");if(!Yt(rt,["string","array"]))throw new ue("Expected second argument to be of type array or string, but found "+Zt(ae(rt))+" instead.");return rt.indexOf(et)>=0},ur.prototype.eachChild=function(tt){tt((this||w).needle),tt((this||w).haystack)},ur.prototype.outputDefined=function(){return!0},ur.prototype.serialize=function(){return["in",(this||w).needle.serialize(),(this||w).haystack.serialize()]};var lr=function(tt,et,rt){(this||w).type=Bn,(this||w).needle=tt,(this||w).haystack=et,(this||w).fromIndex=rt};lr.parse=function(w,tt){if(w.length<=2||w.length>=5)return tt.error("Expected 3 or 4 arguments, but found "+(w.length-1)+" instead.");var et=tt.parse(w[1],1,Yn),rt=tt.parse(w[2],2,Yn);if(!et||!rt)return null;if(!Ht(et.type,[Vn,Fn,Bn,Ln,Yn]))return tt.error("Expected first argument to be of type boolean, string, number or null, but found "+Zt(et.type)+" instead");if(4===w.length){var it=tt.parse(w[3],3,Bn);return it?new lr(et,rt,it):null}return new lr(et,rt)},lr.prototype.evaluate=function(tt){var et=(this||w).needle.evaluate(tt),rt=(this||w).haystack.evaluate(tt);if(!Yt(et,["boolean","string","number","null"]))throw new ue("Expected first argument to be of type boolean, string, number or null, but found "+Zt(ae(et))+" instead.");if(!Yt(rt,["string","array"]))throw new ue("Expected second argument to be of type array or string, but found "+Zt(ae(rt))+" instead.");if((this||w).fromIndex){var it=(this||w).fromIndex.evaluate(tt);return rt.indexOf(et,it)}return rt.indexOf(et)},lr.prototype.eachChild=function(tt){tt((this||w).needle),tt((this||w).haystack),(this||w).fromIndex&&tt((this||w).fromIndex)},lr.prototype.outputDefined=function(){return!1},lr.prototype.serialize=function(){if(null!=(this||w).fromIndex&&void 0!==(this||w).fromIndex){var tt=(this||w).fromIndex.serialize();return["index-of",(this||w).needle.serialize(),(this||w).haystack.serialize(),tt]}return["index-of",(this||w).needle.serialize(),(this||w).haystack.serialize()]};var pr=function(tt,et,rt,it,nt,ot){(this||w).inputType=tt,(this||w).type=et,(this||w).input=rt,(this||w).cases=it,(this||w).outputs=nt,(this||w).otherwise=ot};pr.parse=function(w,tt){if(w.length<5)return tt.error("Expected at least 4 arguments, but found only "+(w.length-1)+".");if(w.length%2!=1)return tt.error("Expected an even number of arguments.");var et,rt;tt.expectedType&&"value"!==tt.expectedType.kind&&(rt=tt.expectedType);for(var it={},nt=[],ot=2;ot<w.length-1;ot+=2){var at=w[ot],st=w[ot+1];Array.isArray(at)||(at=[at]);var ct=tt.concat(ot);if(0===at.length)return ct.error("Expected at least one branch label.");for(var pt=0,ft=at;pt<ft.length;pt+=1){var dt=ft[pt];if("number"!=typeof dt&&"string"!=typeof dt)return ct.error("Branch labels must be numbers or strings.");if("number"==typeof dt&&Math.abs(dt)>Number.MAX_SAFE_INTEGER)return ct.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof dt&&Math.floor(dt)!==dt)return ct.error("Numeric branch labels must be integer values.");if(et){if(ct.checkSubtype(et,ae(dt)))return null}else et=ae(dt);if(void 0!==it[String(dt)])return ct.error("Branch labels must be unique.");it[String(dt)]=nt.length}var mt=tt.parse(st,ot,rt);if(!mt)return null;rt=rt||mt.type,nt.push(mt)}var yt=tt.parse(w[1],1,Yn);if(!yt)return null;var vt=tt.parse(w[w.length-1],w.length-1,rt);return vt?"value"!==yt.type.kind&&tt.concat(1).checkSubtype(et,yt.type)?null:new pr(et,rt,yt,it,nt,vt):null},pr.prototype.evaluate=function(tt){var et=(this||w).input.evaluate(tt);return(ae(et)===(this||w).inputType&&(this||w).outputs[(this||w).cases[et]]||(this||w).otherwise).evaluate(tt)},pr.prototype.eachChild=function(tt){tt((this||w).input),(this||w).outputs.forEach(tt),tt((this||w).otherwise)},pr.prototype.outputDefined=function(){return(this||w).outputs.every((function(w){return w.outputDefined()}))&&(this||w).otherwise.outputDefined()},pr.prototype.serialize=function(){for(var tt=this||w,et=["match",(this||w).input.serialize()],rt=[],it={},nt=0,ot=Object.keys((this||w).cases).sort();nt<ot.length;nt+=1){var at=ot[nt];void 0===(ft=it[(this||w).cases[at]])?(it[(this||w).cases[at]]=rt.length,rt.push([(this||w).cases[at],[at]])):rt[ft][1].push(at)}for(var s=function(w){return"number"===tt.inputType.kind?Number(w):w},st=0,ct=rt;st<ct.length;st+=1){var pt=ct[st],ft=pt[0],dt=pt[1];et.push(1===dt.length?s(dt[0]):dt.map(s)),et.push((this||w).outputs[outputIndex$1].serialize())}return et.push((this||w).otherwise.serialize()),et};var cr=function(tt,et,rt){(this||w).type=tt,(this||w).branches=et,(this||w).otherwise=rt};cr.parse=function(w,tt){if(w.length<4)return tt.error("Expected at least 3 arguments, but found only "+(w.length-1)+".");if(w.length%2!=0)return tt.error("Expected an odd number of arguments.");var et;tt.expectedType&&"value"!==tt.expectedType.kind&&(et=tt.expectedType);for(var rt=[],it=1;it<w.length-1;it+=2){var nt=tt.parse(w[it],it,Vn);if(!nt)return null;var ot=tt.parse(w[it+1],it+1,et);if(!ot)return null;rt.push([nt,ot]),et=et||ot.type}var at=tt.parse(w[w.length-1],w.length-1,et);return at?new cr(et,rt,at):null},cr.prototype.evaluate=function(tt){for(var et=0,rt=(this||w).branches;et<rt.length;et+=1){var it=rt[et],nt=it[1];if(it[0].evaluate(tt))return nt.evaluate(tt)}return(this||w).otherwise.evaluate(tt)},cr.prototype.eachChild=function(tt){for(var et=0,rt=(this||w).branches;et<rt.length;et+=1){var it=rt[et],nt=it[1];tt(it[0]),tt(nt)}tt((this||w).otherwise)},cr.prototype.outputDefined=function(){return(this||w).branches.every((function(w){return w[1].outputDefined()}))&&(this||w).otherwise.outputDefined()},cr.prototype.serialize=function(){var w=["case"];return this.eachChild((function(tt){w.push(tt.serialize())})),w};var hr=function(tt,et,rt,it){(this||w).type=tt,(this||w).input=et,(this||w).beginIndex=rt,(this||w).endIndex=it};function fr(w,tt){return"=="===w||"!="===w?"boolean"===tt.kind||"string"===tt.kind||"number"===tt.kind||"null"===tt.kind||"value"===tt.kind:"string"===tt.kind||"number"===tt.kind||"value"===tt.kind}function yr(w,tt,et,rt){return 0===rt.compare(tt,et)}function dr(tt,et,rt){var it="=="!==tt&&"!="!==tt;return function(){function i(tt,et,rt){(this||w).type=Vn,(this||w).lhs=tt,(this||w).rhs=et,(this||w).collator=rt,(this||w).hasUntypedArgument="value"===tt.type.kind||"value"===et.type.kind}return i.parse=function(w,tt){if(3!==w.length&&4!==w.length)return tt.error("Expected two or three arguments.");var et=w[0],rt=tt.parse(w[1],1,Yn);if(!rt)return null;if(!fr(et,rt.type))return tt.concat(1).error('"'+et+"\" comparisons are not supported for type '"+Zt(rt.type)+"'.");var nt=tt.parse(w[2],2,Yn);if(!nt)return null;if(!fr(et,nt.type))return tt.concat(2).error('"'+et+"\" comparisons are not supported for type '"+Zt(nt.type)+"'.");if(rt.type.kind!==nt.type.kind&&"value"!==rt.type.kind&&"value"!==nt.type.kind)return tt.error("Cannot compare types '"+Zt(rt.type)+"' and '"+Zt(nt.type)+"'.");it&&("value"===rt.type.kind&&"value"!==nt.type.kind?rt=new pe(nt.type,[rt]):"value"!==rt.type.kind&&"value"===nt.type.kind&&(nt=new pe(rt.type,[nt])));var ot=null;if(4===w.length){if("string"!==rt.type.kind&&"string"!==nt.type.kind&&"value"!==rt.type.kind&&"value"!==nt.type.kind)return tt.error("Cannot use collator to compare non-string types.");if(!(ot=tt.parse(w[3],3,$n)))return null}return new i(rt,nt,ot)},i.prototype.evaluate=function(nt){var ot=(this||w).lhs.evaluate(nt),at=(this||w).rhs.evaluate(nt);if(it&&(this||w).hasUntypedArgument){var st=ae(ot),ct=ae(at);if(st.kind!==ct.kind||"string"!==st.kind&&"number"!==st.kind)throw new ue('Expected arguments for "'+tt+'" to be (string, string) or (number, number), but found ('+st.kind+", "+ct.kind+") instead.")}if((this||w).collator&&!it&&(this||w).hasUntypedArgument){var pt=ae(ot),ft=ae(at);if("string"!==pt.kind||"string"!==ft.kind)return et(nt,ot,at)}return(this||w).collator?rt(nt,ot,at,(this||w).collator.evaluate(nt)):et(nt,ot,at)},i.prototype.eachChild=function(tt){tt((this||w).lhs),tt((this||w).rhs),(this||w).collator&&tt((this||w).collator)},i.prototype.outputDefined=function(){return!0},i.prototype.serialize=function(){var w=[tt];return this.eachChild((function(tt){w.push(tt.serialize())})),w},i}()}hr.parse=function(w,tt){if(w.length<=2||w.length>=5)return tt.error("Expected 3 or 4 arguments, but found "+(w.length-1)+" instead.");var et=tt.parse(w[1],1,Yn),rt=tt.parse(w[2],2,Bn);if(!et||!rt)return null;if(!Ht(et.type,[Gt(Yn),Fn,Yn]))return tt.error("Expected first argument to be of type array or string, but found "+Zt(et.type)+" instead");if(4===w.length){var it=tt.parse(w[3],3,Bn);return it?new hr(et.type,et,rt,it):null}return new hr(et.type,et,rt)},hr.prototype.evaluate=function(tt){var et=(this||w).input.evaluate(tt),rt=(this||w).beginIndex.evaluate(tt);if(!Yt(et,["string","array"]))throw new ue("Expected first argument to be of type array or string, but found "+Zt(ae(et))+" instead.");if((this||w).endIndex){var it=(this||w).endIndex.evaluate(tt);return et.slice(rt,it)}return et.slice(rt)},hr.prototype.eachChild=function(tt){tt((this||w).input),tt((this||w).beginIndex),(this||w).endIndex&&tt((this||w).endIndex)},hr.prototype.outputDefined=function(){return!1},hr.prototype.serialize=function(){if(null!=(this||w).endIndex&&void 0!==(this||w).endIndex){var tt=(this||w).endIndex.serialize();return["slice",(this||w).input.serialize(),(this||w).beginIndex.serialize(),tt]}return["slice",(this||w).input.serialize(),(this||w).beginIndex.serialize()]};var fa=dr("==",(function(w,tt,et){return tt===et}),yr),ga=dr("!=",(function(w,tt,et){return tt!==et}),(function(w,tt,et,rt){return!yr(0,tt,et,rt)})),_a=dr("<",(function(w,tt,et){return tt<et}),(function(w,tt,et,rt){return rt.compare(tt,et)<0})),va=dr(">",(function(w,tt,et){return tt>et}),(function(w,tt,et,rt){return rt.compare(tt,et)>0})),xa=dr("<=",(function(w,tt,et){return tt<=et}),(function(w,tt,et,rt){return rt.compare(tt,et)<=0})),ba=dr(">=",(function(w,tt,et){return tt>=et}),(function(w,tt,et,rt){return rt.compare(tt,et)>=0})),_r=function(tt,et,rt,it,nt){(this||w).type=Fn,(this||w).number=tt,(this||w).locale=et,(this||w).currency=rt,(this||w).minFractionDigits=it,(this||w).maxFractionDigits=nt};_r.parse=function(w,tt){if(3!==w.length)return tt.error("Expected two arguments.");var et=tt.parse(w[1],1,Bn);if(!et)return null;var rt=w[2];if("object"!=typeof rt||Array.isArray(rt))return tt.error("NumberFormat options argument must be an object.");var it=null;if(rt.locale&&!(it=tt.parse(rt.locale,1,Fn)))return null;var nt=null;if(rt.currency&&!(nt=tt.parse(rt.currency,1,Fn)))return null;var ot=null;if(rt["min-fraction-digits"]&&!(ot=tt.parse(rt["min-fraction-digits"],1,Bn)))return null;var at=null;return rt["max-fraction-digits"]&&!(at=tt.parse(rt["max-fraction-digits"],1,Bn))?null:new _r(et,it,nt,ot,at)},_r.prototype.evaluate=function(tt){return new Intl.NumberFormat((this||w).locale?(this||w).locale.evaluate(tt):[],{style:(this||w).currency?"currency":"decimal",currency:(this||w).currency?(this||w).currency.evaluate(tt):void 0,minimumFractionDigits:(this||w).minFractionDigits?(this||w).minFractionDigits.evaluate(tt):void 0,maximumFractionDigits:(this||w).maxFractionDigits?(this||w).maxFractionDigits.evaluate(tt):void 0}).format((this||w).number.evaluate(tt))},_r.prototype.eachChild=function(tt){tt((this||w).number),(this||w).locale&&tt((this||w).locale),(this||w).currency&&tt((this||w).currency),(this||w).minFractionDigits&&tt((this||w).minFractionDigits),(this||w).maxFractionDigits&&tt((this||w).maxFractionDigits)},_r.prototype.outputDefined=function(){return!1},_r.prototype.serialize=function(){var tt={};return(this||w).locale&&(tt.locale=(this||w).locale.serialize()),(this||w).currency&&(tt.currency=(this||w).currency.serialize()),(this||w).minFractionDigits&&(tt["min-fraction-digits"]=(this||w).minFractionDigits.serialize()),(this||w).maxFractionDigits&&(tt["max-fraction-digits"]=(this||w).maxFractionDigits.serialize()),["number-format",(this||w).number.serialize(),tt]};var Ar=function(tt){(this||w).type=Bn,(this||w).input=tt};Ar.parse=function(w,tt){if(2!==w.length)return tt.error("Expected 1 argument, but found "+(w.length-1)+" instead.");var et=tt.parse(w[1],1);return et?"array"!==et.type.kind&&"string"!==et.type.kind&&"value"!==et.type.kind?tt.error("Expected argument of type string or array, but found "+Zt(et.type)+" instead."):new Ar(et):null},Ar.prototype.evaluate=function(tt){var et=(this||w).input.evaluate(tt);if("string"==typeof et)return et.length;if(Array.isArray(et))return et.length;throw new ue("Expected value to be of type string or array, but found "+Zt(ae(et))+" instead.")},Ar.prototype.eachChild=function(tt){tt((this||w).input)},Ar.prototype.outputDefined=function(){return!1},Ar.prototype.serialize=function(){var w=["length"];return this.eachChild((function(tt){w.push(tt.serialize())})),w};var wa={"==":fa,"!=":ga,">":va,"<":_a,">=":ba,"<=":xa,array:pe,at:sr,boolean:pe,case:cr,coalesce:ar,collator:ge,format:ce,image:he,in:ur,"index-of":lr,interpolate:nr,"interpolate-hcl":nr,"interpolate-lab":nr,length:Ar,let:or,literal:se,match:pr,number:pe,"number-format":_r,object:pe,slice:hr,step:je,string:pe,"to-boolean":ye,"to-color":ye,"to-number":ye,"to-string":ye,var:Re,within:Ve};function kr(w,tt){var et=tt[0],rt=tt[1],it=tt[2],nt=tt[3];et=et.evaluate(w),rt=rt.evaluate(w),it=it.evaluate(w);var ot=nt?nt.evaluate(w):1,at=ne(et,rt,it,ot);if(at)throw new ue(at);return new Wt(et/255*ot,rt/255*ot,it/255*ot,ot)}function Ir(w,tt){return w in tt}function zr(w,tt){var et=tt[w];return void 0===et?null:et}function Cr(w){return{type:w}}function Mr(w){return{result:"success",value:w}}function Er(w){return{result:"error",value:w}}function Tr(w){return"data-driven"===w["property-type"]||"cross-faded-data-driven"===w["property-type"]}function Pr(w){return!!w.expression&&w.expression.parameters.indexOf("zoom")>-1}function Br(w){return!!w.expression&&w.expression.interpolated}function Vr(w){return w instanceof Number?"number":w instanceof String?"string":w instanceof Boolean?"boolean":Array.isArray(w)?"array":null===w?"null":typeof w}function Fr(w){return"object"==typeof w&&null!==w&&!Array.isArray(w)}function Dr(w){return w}function Lr(w,tt,et){return void 0!==w?w:void 0!==tt?tt:void 0!==et?et:void 0}function Rr(w,tt,et,rt,it){return Lr(typeof et===it?rt[et]:void 0,w.default,tt.default)}function Or(w,tt,et){if("number"!==Vr(et))return Lr(w.default,tt.default);var rt=w.stops.length;if(1===rt)return w.stops[0][1];if(et<=w.stops[0][0])return w.stops[0][1];if(et>=w.stops[rt-1][0])return w.stops[rt-1][1];var it=Ue(w.stops.map((function(w){return w[0]})),et);return w.stops[it][1]}function Ur(w,tt,et){var rt=void 0!==w.base?w.base:1;if("number"!==Vr(et))return Lr(w.default,tt.default);var it=w.stops.length;if(1===it)return w.stops[0][1];if(et<=w.stops[0][0])return w.stops[0][1];if(et>=w.stops[it-1][0])return w.stops[it-1][1];var nt=Ue(w.stops.map((function(w){return w[0]})),et),ot=function(w,tt,et,rt){var it=rt-et,nt=w-et;return 0===it?0:1===tt?nt/it:(Math.pow(tt,nt)-1)/(Math.pow(tt,it)-1)}(et,rt,w.stops[nt][0],w.stops[nt+1][0]),at=w.stops[nt][1],st=w.stops[nt+1][1],ct=ia[tt.type]||Dr;if(w.colorSpace&&"rgb"!==w.colorSpace){var pt=pa[w.colorSpace];ct=function(w,tt){return pt.reverse(pt.interpolate(pt.forward(w),pt.forward(tt),ot))}}return"function"==typeof at.evaluate?{evaluate:function(){for(var w=[],tt=arguments.length;tt--;)w[tt]=arguments[tt];var et=at.evaluate.apply(void 0,w),rt=st.evaluate.apply(void 0,w);if(void 0!==et&&void 0!==rt)return ct(et,rt,ot)}}:ct(at,st,ot)}function jr(w,tt,et){return"color"===tt.type?et=Wt.parse(et):"formatted"===tt.type?et=ee.fromString(et.toString()):"resolvedImage"===tt.type?et=re.fromString(et.toString()):Vr(et)===tt.type||"enum"===tt.type&&tt.values[et]||(et=void 0),Lr(et,w.default,tt.default)}ve.register(wa,{error:[{kind:"error"},[Fn],function(w,tt){throw new ue(tt[0].evaluate(w))}],typeof:[Fn,[Yn],function(w,tt){return Zt(ae(tt[0].evaluate(w)))}],"to-rgba":[Gt(Bn,4),[Nn],function(w,tt){return tt[0].evaluate(w).toArray()}],rgb:[Nn,[Bn,Bn,Bn],kr],rgba:[Nn,[Bn,Bn,Bn,Bn],kr],has:{type:Vn,overloads:[[[Fn],function(w,tt){return Ir(tt[0].evaluate(w),w.properties())}],[[Fn,Wn],function(w,tt){var et=tt[1];return Ir(tt[0].evaluate(w),et.evaluate(w))}]]},get:{type:Yn,overloads:[[[Fn],function(w,tt){return zr(tt[0].evaluate(w),w.properties())}],[[Fn,Wn],function(w,tt){var et=tt[1];return zr(tt[0].evaluate(w),et.evaluate(w))}]]},"feature-state":[Yn,[Fn],function(w,tt){return zr(tt[0].evaluate(w),w.featureState||{})}],properties:[Wn,[],function(w){return w.properties()}],"geometry-type":[Fn,[],function(w){return w.geometryType()}],id:[Yn,[],function(w){return w.id()}],zoom:[Bn,[],function(w){return w.globals.zoom}],"heatmap-density":[Bn,[],function(w){return w.globals.heatmapDensity||0}],"line-progress":[Bn,[],function(w){return w.globals.lineProgress||0}],accumulated:[Yn,[],function(w){return void 0===w.globals.accumulated?null:w.globals.accumulated}],"+":[Bn,Cr(Bn),function(w,tt){for(var et=0,rt=0,it=tt;rt<it.length;rt+=1)et+=it[rt].evaluate(w);return et}],"*":[Bn,Cr(Bn),function(w,tt){for(var et=1,rt=0,it=tt;rt<it.length;rt+=1)et*=it[rt].evaluate(w);return et}],"-":{type:Bn,overloads:[[[Bn,Bn],function(w,tt){var et=tt[1];return tt[0].evaluate(w)-et.evaluate(w)}],[[Bn],function(w,tt){return-tt[0].evaluate(w)}]]},"/":[Bn,[Bn,Bn],function(w,tt){var et=tt[1];return tt[0].evaluate(w)/et.evaluate(w)}],"%":[Bn,[Bn,Bn],function(w,tt){var et=tt[1];return tt[0].evaluate(w)%et.evaluate(w)}],ln2:[Bn,[],function(){return Math.LN2}],pi:[Bn,[],function(){return Math.PI}],e:[Bn,[],function(){return Math.E}],"^":[Bn,[Bn,Bn],function(w,tt){var et=tt[1];return Math.pow(tt[0].evaluate(w),et.evaluate(w))}],sqrt:[Bn,[Bn],function(w,tt){return Math.sqrt(tt[0].evaluate(w))}],log10:[Bn,[Bn],function(w,tt){return Math.log(tt[0].evaluate(w))/Math.LN10}],ln:[Bn,[Bn],function(w,tt){return Math.log(tt[0].evaluate(w))}],log2:[Bn,[Bn],function(w,tt){return Math.log(tt[0].evaluate(w))/Math.LN2}],sin:[Bn,[Bn],function(w,tt){return Math.sin(tt[0].evaluate(w))}],cos:[Bn,[Bn],function(w,tt){return Math.cos(tt[0].evaluate(w))}],tan:[Bn,[Bn],function(w,tt){return Math.tan(tt[0].evaluate(w))}],asin:[Bn,[Bn],function(w,tt){return Math.asin(tt[0].evaluate(w))}],acos:[Bn,[Bn],function(w,tt){return Math.acos(tt[0].evaluate(w))}],atan:[Bn,[Bn],function(w,tt){return Math.atan(tt[0].evaluate(w))}],min:[Bn,Cr(Bn),function(w,tt){return Math.min.apply(Math,tt.map((function(tt){return tt.evaluate(w)})))}],max:[Bn,Cr(Bn),function(w,tt){return Math.max.apply(Math,tt.map((function(tt){return tt.evaluate(w)})))}],abs:[Bn,[Bn],function(w,tt){return Math.abs(tt[0].evaluate(w))}],round:[Bn,[Bn],function(w,tt){var et=tt[0].evaluate(w);return et<0?-Math.round(-et):Math.round(et)}],floor:[Bn,[Bn],function(w,tt){return Math.floor(tt[0].evaluate(w))}],ceil:[Bn,[Bn],function(w,tt){return Math.ceil(tt[0].evaluate(w))}],"filter-==":[Vn,[Fn,Yn],function(w,tt){var et=tt[0],rt=tt[1];return w.properties()[et.value]===rt.value}],"filter-id-==":[Vn,[Yn],function(w,tt){var et=tt[0];return w.id()===et.value}],"filter-type-==":[Vn,[Fn],function(w,tt){var et=tt[0];return w.geometryType()===et.value}],"filter-<":[Vn,[Fn,Yn],function(w,tt){var et=tt[0],rt=tt[1],it=w.properties()[et.value],nt=rt.value;return typeof it==typeof nt&&it<nt}],"filter-id-<":[Vn,[Yn],function(w,tt){var et=tt[0],rt=w.id(),it=et.value;return typeof rt==typeof it&&rt<it}],"filter->":[Vn,[Fn,Yn],function(w,tt){var et=tt[0],rt=tt[1],it=w.properties()[et.value],nt=rt.value;return typeof it==typeof nt&&it>nt}],"filter-id->":[Vn,[Yn],function(w,tt){var et=tt[0],rt=w.id(),it=et.value;return typeof rt==typeof it&&rt>it}],"filter-<=":[Vn,[Fn,Yn],function(w,tt){var et=tt[0],rt=tt[1],it=w.properties()[et.value],nt=rt.value;return typeof it==typeof nt&&it<=nt}],"filter-id-<=":[Vn,[Yn],function(w,tt){var et=tt[0],rt=w.id(),it=et.value;return typeof rt==typeof it&&rt<=it}],"filter->=":[Vn,[Fn,Yn],function(w,tt){var et=tt[0],rt=tt[1],it=w.properties()[et.value],nt=rt.value;return typeof it==typeof nt&&it>=nt}],"filter-id->=":[Vn,[Yn],function(w,tt){var et=tt[0],rt=w.id(),it=et.value;return typeof rt==typeof it&&rt>=it}],"filter-has":[Vn,[Yn],function(w,tt){return tt[0].value in w.properties()}],"filter-has-id":[Vn,[],function(w){return null!==w.id()&&void 0!==w.id()}],"filter-type-in":[Vn,[Gt(Fn)],function(w,tt){return tt[0].value.indexOf(w.geometryType())>=0}],"filter-id-in":[Vn,[Gt(Yn)],function(w,tt){return tt[0].value.indexOf(w.id())>=0}],"filter-in-small":[Vn,[Fn,Gt(Yn)],function(w,tt){var et=tt[0];return tt[1].value.indexOf(w.properties()[et.value])>=0}],"filter-in-large":[Vn,[Fn,Gt(Yn)],function(w,tt){var et=tt[0],rt=tt[1];return function(w,tt,et,rt){for(;et<=rt;){var it=et+rt>>1;if(tt[it]===w)return!0;tt[it]>w?rt=it-1:et=it+1}return!1}(w.properties()[et.value],rt.value,0,rt.value.length-1)}],all:{type:Vn,overloads:[[[Vn,Vn],function(w,tt){var et=tt[1];return tt[0].evaluate(w)&&et.evaluate(w)}],[Cr(Vn),function(w,tt){for(var et=0,rt=tt;et<rt.length;et+=1)if(!rt[et].evaluate(w))return!1;return!0}]]},any:{type:Vn,overloads:[[[Vn,Vn],function(w,tt){var et=tt[1];return tt[0].evaluate(w)||et.evaluate(w)}],[Cr(Vn),function(w,tt){for(var et=0,rt=tt;et<rt.length;et+=1)if(rt[et].evaluate(w))return!0;return!1}]]},"!":[Vn,[Vn],function(w,tt){return!tt[0].evaluate(w)}],"is-supported-script":[Vn,[Fn],function(w,tt){var et=w.globals&&w.globals.isSupportedScript;return!et||et(tt[0].evaluate(w))}],upcase:[Fn,[Fn],function(w,tt){return tt[0].evaluate(w).toUpperCase()}],downcase:[Fn,[Fn],function(w,tt){return tt[0].evaluate(w).toLowerCase()}],concat:[Fn,Cr(Yn),function(w,tt){return tt.map((function(tt){return oe(tt.evaluate(w))})).join("")}],"resolved-locale":[Fn,[$n],function(w,tt){return tt[0].evaluate(w).resolvedLocale()}]});var qr=function(tt,et){(this||w).expression=tt,(this||w)._warningHistory={},(this||w)._evaluator=new me,(this||w)._defaultValue=et?function(w){return"color"===w.type&&Fr(w.default)?new Wt(0,0,0,0):"color"===w.type?Wt.parse(w.default)||null:void 0===w.default?null:w.default}(et):null,(this||w)._enumValues=et&&"enum"===et.type?et.values:null};function Nr(w){return Array.isArray(w)&&w.length>0&&"string"==typeof w[0]&&w[0]in wa}function Kr(w,tt){var et=new Oe(wa,[],tt?function(w){var tt={color:Nn,string:Fn,number:Bn,enum:Fn,boolean:Vn,formatted:uo,resolvedImage:po};return"array"===w.type?Gt(tt[w.value]||Yn,w.length):tt[w.type]}(tt):void 0),rt=et.parse(w,void 0,void 0,void 0,tt&&"string"===tt.type?{typeAnnotation:"coerce"}:void 0);return rt?Mr(new qr(rt,tt)):Er(et.errors)}qr.prototype.evaluateWithoutErrorHandling=function(tt,et,rt,it,nt,ot){return(this||w)._evaluator.globals=tt,(this||w)._evaluator.feature=et,(this||w)._evaluator.featureState=rt,(this||w)._evaluator.canonical=it,(this||w)._evaluator.availableImages=nt||null,(this||w)._evaluator.formattedSection=ot,(this||w).expression.evaluate((this||w)._evaluator)},qr.prototype.evaluate=function(tt,et,rt,it,nt,ot){(this||w)._evaluator.globals=tt,(this||w)._evaluator.feature=et||null,(this||w)._evaluator.featureState=rt||null,(this||w)._evaluator.canonical=it,(this||w)._evaluator.availableImages=nt||null,(this||w)._evaluator.formattedSection=ot||null;try{var at=(this||w).expression.evaluate((this||w)._evaluator);if(null==at||"number"==typeof at&&at!=at)return(this||w)._defaultValue;if((this||w)._enumValues&&!(at in(this||w)._enumValues))throw new ue("Expected value to be one of "+Object.keys((this||w)._enumValues).map((function(w){return JSON.stringify(w)})).join(", ")+", but found "+JSON.stringify(at)+" instead.");return at}catch(tt){return(this||w)._warningHistory[tt.message]||((this||w)._warningHistory[tt.message]=!0,"undefined"!=typeof console&&console.warn(tt.message)),(this||w)._defaultValue}};var Gr=function(tt,et){(this||w).kind=tt,(this||w)._styleExpression=et,(this||w).isStateDependent="constant"!==tt&&!De(et.expression)};Gr.prototype.evaluateWithoutErrorHandling=function(tt,et,rt,it,nt,ot){return(this||w)._styleExpression.evaluateWithoutErrorHandling(tt,et,rt,it,nt,ot)},Gr.prototype.evaluate=function(tt,et,rt,it,nt,ot){return(this||w)._styleExpression.evaluate(tt,et,rt,it,nt,ot)};var Zr=function(tt,et,rt,it){(this||w).kind=tt,(this||w).zoomStops=rt,(this||w)._styleExpression=et,(this||w).isStateDependent="camera"!==tt&&!De(et.expression),(this||w).interpolationType=it};function Xr(w,tt){if("error"===(w=Kr(w,tt)).result)return w;var et=w.value.expression,rt=Fe(et);if(!rt&&!Tr(tt))return Er([new Mn("","data expressions not supported")]);var it=Le(et,["zoom"]);if(!it&&!Pr(tt))return Er([new Mn("","zoom expressions not supported")]);var nt=function t(w){var tt=null;if(w instanceof or)tt=t(w.result);else if(w instanceof ar)for(var et=0,rt=w.args;et<rt.length&&!(tt=t(rt[et]));et+=1);else(w instanceof je||w instanceof nr)&&w.input instanceof ve&&"zoom"===w.input.name&&(tt=w);return tt instanceof Mn||w.eachChild((function(w){var et=t(w);et instanceof Mn?tt=et:!tt&&et?tt=new Mn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):tt&&et&&tt!==et&&(tt=new Mn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),tt}(et);return nt||it?nt instanceof Mn?Er([nt]):nt instanceof nr&&!Br(tt)?Er([new Mn("",'"interpolate" expressions cannot be used with this property')]):Mr(nt?new Zr(rt?"camera":"composite",w.value,nt.labels,nt instanceof nr?nt.interpolation:void 0):new Gr(rt?"constant":"source",w.value)):Er([new Mn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Zr.prototype.evaluateWithoutErrorHandling=function(tt,et,rt,it,nt,ot){return(this||w)._styleExpression.evaluateWithoutErrorHandling(tt,et,rt,it,nt,ot)},Zr.prototype.evaluate=function(tt,et,rt,it,nt,ot){return(this||w)._styleExpression.evaluate(tt,et,rt,it,nt,ot)},Zr.prototype.interpolationFactor=function(tt,et,rt){return(this||w).interpolationType?nr.interpolationFactor((this||w).interpolationType,tt,et,rt):0};var Jr=function(tt,et){(this||w)._parameters=tt,(this||w)._specification=et,Et(this||w,function t(w,tt){var et,rt,it,nt="color"===tt.type,ot=w.stops&&"object"==typeof w.stops[0][0],at=ot||!(ot||void 0!==w.property),st=w.type||(Br(tt)?"exponential":"interval");if(nt&&((w=Et({},w)).stops&&(w.stops=w.stops.map((function(w){return[w[0],Wt.parse(w[1])]}))),w.default=Wt.parse(w.default?w.default:tt.default)),w.colorSpace&&"rgb"!==w.colorSpace&&!pa[w.colorSpace])throw new Error("Unknown color space: "+w.colorSpace);if("exponential"===st)et=Ur;else if("interval"===st)et=Or;else if("categorical"===st){et=Rr,rt=Object.create(null);for(var ct=0,pt=w.stops;ct<pt.length;ct+=1){var ft=pt[ct];rt[ft[0]]=ft[1]}it=typeof w.stops[0][0]}else{if("identity"!==st)throw new Error('Unknown function type "'+st+'"');et=jr}if(ot){for(var dt={},mt=[],yt=0;yt<w.stops.length;yt++){var vt=w.stops[yt],Dt=vt[0].zoom;void 0===dt[Dt]&&(dt[Dt]={zoom:Dt,type:w.type,property:w.property,default:w.default,stops:[]},mt.push(Dt)),dt[Dt].stops.push([vt[0].value,vt[1]])}for(var Rt=[],Bt=0,Ot=mt;Bt<Ot.length;Bt+=1){var Ne=Ot[Bt];Rt.push([dt[Ne].zoom,t(dt[Ne],tt)])}var Ze={name:"linear"};return{kind:"composite",interpolationType:Ze,interpolationFactor:nr.interpolationFactor.bind(void 0,Ze),zoomStops:Rt.map((function(w){return w[0]})),evaluate:function(et,rt){var it=et.zoom;return Ur({stops:Rt,base:w.base},tt,it).evaluate(it,rt)}}}if(at){var Ge="exponential"===st?{name:"exponential",base:void 0!==w.base?w.base:1}:null;return{kind:"camera",interpolationType:Ge,interpolationFactor:nr.interpolationFactor.bind(void 0,Ge),zoomStops:w.stops.map((function(w){return w[0]})),evaluate:function(nt){return et(w,tt,nt.zoom,rt,it)}}}return{kind:"source",evaluate:function(nt,ot){var at=ot&&ot.properties?ot.properties[w.property]:void 0;return void 0===at?Lr(w.default,tt.default):et(w,tt,at,rt,it)}}}((this||w)._parameters,(this||w)._specification))};function Hr(w){var tt=w.key,et=w.value,rt=w.valueSpec||{},it=w.objectElementValidators||{},nt=w.style,ot=w.styleSpec,at=[],st=Vr(et);if("object"!==st)return[new Ct(tt,et,"object expected, "+st+" found")];for(var ct in et){var pt=ct.split(".")[0],ft=rt[pt]||rt["*"],dt=void 0;if(it[pt])dt=it[pt];else if(rt[pt])dt=wn;else if(it["*"])dt=it["*"];else{if(!rt["*"]){at.push(new Ct(tt,et[ct],'unknown property "'+ct+'"'));continue}dt=wn}at=at.concat(dt({key:(tt?tt+".":tt)+ct,value:et[ct],valueSpec:ft,style:nt,styleSpec:ot,object:et,objectKey:ct},et))}for(var mt in rt)it[mt]||rt[mt].required&&void 0===rt[mt].default&&void 0===et[mt]&&at.push(new Ct(tt,et,'missing required property "'+mt+'"'));return at}function Yr(w){var tt=w.value,et=w.valueSpec,rt=w.style,it=w.styleSpec,nt=w.key,ot=w.arrayElementValidator||wn;if("array"!==Vr(tt))return[new Ct(nt,tt,"array expected, "+Vr(tt)+" found")];if(et.length&&tt.length!==et.length)return[new Ct(nt,tt,"array length "+et.length+" expected, length "+tt.length+" found")];if(et["min-length"]&&tt.length<et["min-length"])return[new Ct(nt,tt,"array length at least "+et["min-length"]+" expected, length "+tt.length+" found")];var at={type:et.value,values:et.values};it.$version<7&&(at.function=et.function),"object"===Vr(et.value)&&(at=et.value);for(var st=[],ct=0;ct<tt.length;ct++)st=st.concat(ot({array:tt,arrayIndex:ct,value:tt[ct],valueSpec:at,style:rt,styleSpec:it,key:nt+"["+ct+"]"}));return st}function $r(w){var tt=w.key,et=w.value,rt=w.valueSpec,it=Vr(et);return"number"===it&&et!=et&&(it="NaN"),"number"!==it?[new Ct(tt,et,"number expected, "+it+" found")]:"minimum"in rt&&et<rt.minimum?[new Ct(tt,et,et+" is less than the minimum value "+rt.minimum)]:"maximum"in rt&&et>rt.maximum?[new Ct(tt,et,et+" is greater than the maximum value "+rt.maximum)]:[]}function Wr(w){var tt,et,rt,it=w.valueSpec,nt=Tt(w.value.type),ot={},at="categorical"!==nt&&void 0===w.value.property,st=!at,ct="array"===Vr(w.value.stops)&&"array"===Vr(w.value.stops[0])&&"object"===Vr(w.value.stops[0][0]),pt=Hr({key:w.key,value:w.value,valueSpec:w.styleSpec.function,style:w.style,styleSpec:w.styleSpec,objectElementValidators:{stops:function(w){if("identity"===nt)return[new Ct(w.key,w.value,'identity function may not have a "stops" property')];var tt=[],et=w.value;return tt=tt.concat(Yr({key:w.key,value:et,valueSpec:w.valueSpec,style:w.style,styleSpec:w.styleSpec,arrayElementValidator:c})),"array"===Vr(et)&&0===et.length&&tt.push(new Ct(w.key,et,"array must have at least one stop")),tt},default:function(w){return wn({key:w.key,value:w.value,valueSpec:it,style:w.style,styleSpec:w.styleSpec})}}});return"identity"===nt&&at&&pt.push(new Ct(w.key,w.value,'missing required property "property"')),"identity"===nt||w.value.stops||pt.push(new Ct(w.key,w.value,'missing required property "stops"')),"exponential"===nt&&w.valueSpec.expression&&!Br(w.valueSpec)&&pt.push(new Ct(w.key,w.value,"exponential functions not supported")),w.styleSpec.$version>=8&&(st&&!Tr(w.valueSpec)?pt.push(new Ct(w.key,w.value,"property functions not supported")):at&&!Pr(w.valueSpec)&&pt.push(new Ct(w.key,w.value,"zoom functions not supported"))),"categorical"!==nt&&!ct||void 0!==w.value.property||pt.push(new Ct(w.key,w.value,'"property" property is required')),pt;function c(w){var tt=[],nt=w.value,at=w.key;if("array"!==Vr(nt))return[new Ct(at,nt,"array expected, "+Vr(nt)+" found")];if(2!==nt.length)return[new Ct(at,nt,"array length 2 expected, length "+nt.length+" found")];if(ct){if("object"!==Vr(nt[0]))return[new Ct(at,nt,"object expected, "+Vr(nt[0])+" found")];if(void 0===nt[0].zoom)return[new Ct(at,nt,"object stop key must have zoom")];if(void 0===nt[0].value)return[new Ct(at,nt,"object stop key must have value")];if(rt&&rt>Tt(nt[0].zoom))return[new Ct(at,nt[0].zoom,"stop zoom values must appear in ascending order")];Tt(nt[0].zoom)!==rt&&(rt=Tt(nt[0].zoom),et=void 0,ot={}),tt=tt.concat(Hr({key:at+"[0]",value:nt[0],valueSpec:{zoom:{}},style:w.style,styleSpec:w.styleSpec,objectElementValidators:{zoom:$r,value:h}}))}else tt=tt.concat(h({key:at+"[0]",value:nt[0],valueSpec:{},style:w.style,styleSpec:w.styleSpec},nt));return Nr(Pt(nt[1]))?tt.concat([new Ct(at+"[1]",nt[1],"expressions are not allowed in function stops.")]):tt.concat(wn({key:at+"[1]",value:nt[1],valueSpec:it,style:w.style,styleSpec:w.styleSpec}))}function h(w,rt){var at=Vr(w.value),st=Tt(w.value),ct=null!==w.value?w.value:rt;if(tt){if(at!==tt)return[new Ct(w.key,ct,at+" stop domain type must match previous stop domain type "+tt)]}else tt=at;if("number"!==at&&"string"!==at&&"boolean"!==at)return[new Ct(w.key,ct,"stop domain value must be a number, string, or boolean")];if("number"!==at&&"categorical"!==nt){var pt="number expected, "+at+" found";return Tr(it)&&void 0===nt&&(pt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ct(w.key,ct,pt)]}return"categorical"!==nt||"number"!==at||isFinite(st)&&Math.floor(st)===st?"categorical"!==nt&&"number"===at&&void 0!==et&&st<et?[new Ct(w.key,ct,"stop domain values must appear in ascending order")]:(et=st,"categorical"===nt&&st in ot?[new Ct(w.key,ct,"stop domain values must be unique")]:(ot[st]=!0,[])):[new Ct(w.key,ct,"integer expected, found "+st)]}}function Qr(w){var tt=("property"===w.expressionContext?Xr:Kr)(Pt(w.value),w.valueSpec);if("error"===tt.result)return tt.value.map((function(tt){return new Ct(""+w.key+tt.key,w.value,tt.message)}));var et=tt.value.expression||tt.value._styleExpression.expression;if("property"===w.expressionContext&&"text-font"===w.propertyKey&&!et.outputDefined())return[new Ct(w.key,w.value,'Invalid data expression for "'+w.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===w.expressionContext&&"layout"===w.propertyType&&!De(et))return[new Ct(w.key,w.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===w.expressionContext&&!De(et))return[new Ct(w.key,w.value,'"feature-state" data expressions are not supported with filters.')];if(w.expressionContext&&0===w.expressionContext.indexOf("cluster")){if(!Le(et,["zoom","feature-state"]))return[new Ct(w.key,w.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===w.expressionContext&&!Fe(et))return[new Ct(w.key,w.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function tn(w){var tt=w.key,et=w.value,rt=w.valueSpec,it=[];return Array.isArray(rt.values)?-1===rt.values.indexOf(Tt(et))&&it.push(new Ct(tt,et,"expected one of ["+rt.values.join(", ")+"], "+JSON.stringify(et)+" found")):-1===Object.keys(rt.values).indexOf(Tt(et))&&it.push(new Ct(tt,et,"expected one of ["+Object.keys(rt.values).join(", ")+"], "+JSON.stringify(et)+" found")),it}function en(w){if(!0===w||!1===w)return!0;if(!Array.isArray(w)||0===w.length)return!1;switch(w[0]){case"has":return w.length>=2&&"$id"!==w[1]&&"$type"!==w[1];case"in":return w.length>=3&&("string"!=typeof w[1]||Array.isArray(w[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==w.length||Array.isArray(w[1])||Array.isArray(w[2]);case"any":case"all":for(var tt=0,et=w.slice(1);tt<et.length;tt+=1){var rt=et[tt];if(!en(rt)&&"boolean"!=typeof rt)return!1}return!0;default:return!0}}Jr.deserialize=function(w){return new Jr(w._parameters,w._specification)},Jr.serialize=function(w){return{_parameters:w._parameters,_specification:w._specification}};var Sa={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function nn(w){if(null==w)return{filter:function(){return!0},needGeometry:!1};en(w)||(w=on(w));var tt=Kr(w,Sa);if("error"===tt.result)throw new Error(tt.value.map((function(w){return w.key+": "+w.message})).join(", "));return{filter:function(w,et,rt){return tt.value.evaluate(w,et,{},rt)},needGeometry:function t(w){if(!Array.isArray(w))return!1;if("within"===w[0])return!0;for(var tt=1;tt<w.length;tt++)if(t(w[tt]))return!0;return!1}(w)}}function an(w,tt){return w<tt?-1:w>tt?1:0}function on(w){if(!w)return!0;var tt,et=w[0];return w.length<=1?"any"!==et:"=="===et?sn(w[1],w[2],"=="):"!="===et?pn(sn(w[1],w[2],"==")):"<"===et||">"===et||"<="===et||">="===et?sn(w[1],w[2],et):"any"===et?(tt=w.slice(1),["any"].concat(tt.map(on))):"all"===et?["all"].concat(w.slice(1).map(on)):"none"===et?["all"].concat(w.slice(1).map(on).map(pn)):"in"===et?un(w[1],w.slice(2)):"!in"===et?pn(un(w[1],w.slice(2))):"has"===et?ln(w[1]):"!has"===et?pn(ln(w[1])):"within"!==et||w}function sn(w,tt,et){switch(w){case"$type":return["filter-type-"+et,tt];case"$id":return["filter-id-"+et,tt];default:return["filter-"+et,w,tt]}}function un(w,tt){if(0===tt.length)return!1;switch(w){case"$type":return["filter-type-in",["literal",tt]];case"$id":return["filter-id-in",["literal",tt]];default:return tt.length>200&&!tt.some((function(w){return typeof w!=typeof tt[0]}))?["filter-in-large",w,["literal",tt.sort(an)]]:["filter-in-small",w,["literal",tt]]}}function ln(w){switch(w){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",w]}}function pn(w){return["!",w]}function cn(w){return en(Pt(w.value))?Qr(Et({},w,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(w){var tt=w.value,et=w.key;if("array"!==Vr(tt))return[new Ct(et,tt,"array expected, "+Vr(tt)+" found")];var rt,it=w.styleSpec,nt=[];if(tt.length<1)return[new Ct(et,tt,"filter array must have at least 1 element")];switch(nt=nt.concat(tn({key:et+"[0]",value:tt[0],valueSpec:it.filter_operator,style:w.style,styleSpec:w.styleSpec})),Tt(tt[0])){case"<":case"<=":case">":case">=":tt.length>=2&&"$type"===Tt(tt[1])&&nt.push(new Ct(et,tt,'"$type" cannot be use with operator "'+tt[0]+'"'));case"==":case"!=":3!==tt.length&&nt.push(new Ct(et,tt,'filter array for operator "'+tt[0]+'" must have 3 elements'));case"in":case"!in":tt.length>=2&&"string"!==(rt=Vr(tt[1]))&&nt.push(new Ct(et+"[1]",tt[1],"string expected, "+rt+" found"));for(var ot=2;ot<tt.length;ot++)rt=Vr(tt[ot]),"$type"===Tt(tt[1])?nt=nt.concat(tn({key:et+"["+ot+"]",value:tt[ot],valueSpec:it.geometry_type,style:w.style,styleSpec:w.styleSpec})):"string"!==rt&&"number"!==rt&&"boolean"!==rt&&nt.push(new Ct(et+"["+ot+"]",tt[ot],"string, number, or boolean expected, "+rt+" found"));break;case"any":case"all":case"none":for(var at=1;at<tt.length;at++)nt=nt.concat(t({key:et+"["+at+"]",value:tt[at],style:w.style,styleSpec:w.styleSpec}));break;case"has":case"!has":rt=Vr(tt[1]),2!==tt.length?nt.push(new Ct(et,tt,'filter array for "'+tt[0]+'" operator must have 2 elements')):"string"!==rt&&nt.push(new Ct(et+"[1]",tt[1],"string expected, "+rt+" found"));break;case"within":rt=Vr(tt[1]),2!==tt.length?nt.push(new Ct(et,tt,'filter array for "'+tt[0]+'" operator must have 2 elements')):"object"!==rt&&nt.push(new Ct(et+"[1]",tt[1],"object expected, "+rt+" found"))}return nt}(w)}function hn(w,tt){var et=w.key,rt=w.style,it=w.styleSpec,nt=w.value,ot=w.objectKey,at=it[tt+"_"+w.layerType];if(!at)return[];var st=ot.match(/^(.*)-transition$/);if("paint"===tt&&st&&at[st[1]]&&at[st[1]].transition)return wn({key:et,value:nt,valueSpec:it.transition,style:rt,styleSpec:it});var ct,pt=w.valueSpec||at[ot];if(!pt)return[new Ct(et,nt,'unknown property "'+ot+'"')];if("string"===Vr(nt)&&Tr(pt)&&!pt.tokens&&(ct=/^{([^}]+)}$/.exec(nt)))return[new Ct(et,nt,'"'+ot+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(ct[1])+" }`.")];var ft=[];return"symbol"===w.layerType&&("text-field"===ot&&rt&&!rt.glyphs&&ft.push(new Ct(et,nt,'use of "text-field" requires a style "glyphs" property')),"text-font"===ot&&Fr(Pt(nt))&&"identity"===Tt(nt.type)&&ft.push(new Ct(et,nt,'"text-font" does not support identity functions'))),ft.concat(wn({key:w.key,value:nt,valueSpec:pt,style:rt,styleSpec:it,expressionContext:"property",propertyType:tt,propertyKey:ot}))}function fn(w){return hn(w,"paint")}function yn(w){return hn(w,"layout")}function dn(w){var tt=[],et=w.value,rt=w.key,it=w.style,nt=w.styleSpec;et.type||et.ref||tt.push(new Ct(rt,et,'either "type" or "ref" is required'));var ot,at=Tt(et.type),st=Tt(et.ref);if(et.id)for(var ct=Tt(et.id),pt=0;pt<w.arrayIndex;pt++){var ft=it.layers[pt];Tt(ft.id)===ct&&tt.push(new Ct(rt,et.id,'duplicate layer id "'+et.id+'", previously used at line '+ft.id.__line__))}if("ref"in et)["type","source","source-layer","filter","layout"].forEach((function(w){w in et&&tt.push(new Ct(rt,et[w],'"'+w+'" is prohibited for ref layers'))})),it.layers.forEach((function(w){Tt(w.id)===st&&(ot=w)})),ot?ot.ref?tt.push(new Ct(rt,et.ref,"ref cannot reference another ref layer")):at=Tt(ot.type):tt.push(new Ct(rt,et.ref,'ref layer "'+st+'" not found'));else if("background"!==at)if(et.source){var dt=it.sources&&it.sources[et.source],mt=dt&&Tt(dt.type);dt?"vector"===mt&&"raster"===at?tt.push(new Ct(rt,et.source,'layer "'+et.id+'" requires a raster source')):"raster"===mt&&"raster"!==at?tt.push(new Ct(rt,et.source,'layer "'+et.id+'" requires a vector source')):"vector"!==mt||et["source-layer"]?"raster-dem"===mt&&"hillshade"!==at?tt.push(new Ct(rt,et.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==at||!et.paint||!et.paint["line-gradient"]||"geojson"===mt&&dt.lineMetrics||tt.push(new Ct(rt,et,'layer "'+et.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):tt.push(new Ct(rt,et,'layer "'+et.id+'" must specify a "source-layer"')):tt.push(new Ct(rt,et.source,'source "'+et.source+'" not found'))}else tt.push(new Ct(rt,et,'missing required property "source"'));return tt=tt.concat(Hr({key:rt,value:et,valueSpec:nt.layer,style:w.style,styleSpec:w.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return wn({key:rt+".type",value:et.type,valueSpec:nt.layer.type,style:w.style,styleSpec:w.styleSpec,object:et,objectKey:"type"})},filter:cn,layout:function(w){return Hr({layer:et,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,objectElementValidators:{"*":function(w){return yn(Et({layerType:at},w))}}})},paint:function(w){return Hr({layer:et,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,objectElementValidators:{"*":function(w){return fn(Et({layerType:at},w))}}})}}}))}function mn(w){var tt=w.value,et=w.key,rt=Vr(tt);return"string"!==rt?[new Ct(et,tt,"string expected, "+rt+" found")]:[]}var Aa={promoteId:function(w){var tt=w.key,et=w.value;if("string"===Vr(et))return mn({key:tt,value:et});var rt=[];for(var it in et)rt.push.apply(rt,mn({key:tt+"."+it,value:et[it]}));return rt}};function gn(w){var tt=w.value,et=w.key,rt=w.styleSpec,it=w.style;if(!tt.type)return[new Ct(et,tt,'"type" is required')];var nt,ot=Tt(tt.type);switch(ot){case"vector":case"raster":case"raster-dem":return Hr({key:et,value:tt,valueSpec:rt["source_"+ot.replace("-","_")],style:w.style,styleSpec:rt,objectElementValidators:Aa});case"geojson":if(nt=Hr({key:et,value:tt,valueSpec:rt.source_geojson,style:it,styleSpec:rt,objectElementValidators:Aa}),tt.cluster)for(var at in tt.clusterProperties){var st=tt.clusterProperties[at],ct=st[0],pt="string"==typeof ct?[ct,["accumulated"],["get",at]]:ct;nt.push.apply(nt,Qr({key:et+"."+at+".map",value:st[1],expressionContext:"cluster-map"})),nt.push.apply(nt,Qr({key:et+"."+at+".reduce",value:pt,expressionContext:"cluster-reduce"}))}return nt;case"video":return Hr({key:et,value:tt,valueSpec:rt.source_video,style:it,styleSpec:rt});case"image":return Hr({key:et,value:tt,valueSpec:rt.source_image,style:it,styleSpec:rt});case"canvas":return[new Ct(et,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return tn({key:et+".type",value:tt.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:it,styleSpec:rt})}}function xn(w){var tt=w.value,et=w.styleSpec,rt=et.light,it=w.style,nt=[],ot=Vr(tt);if(void 0===tt)return nt;if("object"!==ot)return nt.concat([new Ct("light",tt,"object expected, "+ot+" found")]);for(var at in tt){var st=at.match(/^(.*)-transition$/);nt=nt.concat(st&&rt[st[1]]&&rt[st[1]].transition?wn({key:at,value:tt[at],valueSpec:et.transition,style:it,styleSpec:et}):rt[at]?wn({key:at,value:tt[at],valueSpec:rt[at],style:it,styleSpec:et}):[new Ct(at,tt[at],'unknown property "'+at+'"')])}return nt}var Da={"*":function(){return[]},array:Yr,boolean:function(w){var tt=w.value,et=w.key,rt=Vr(tt);return"boolean"!==rt?[new Ct(et,tt,"boolean expected, "+rt+" found")]:[]},number:$r,color:function(w){var tt=w.key,et=w.value,rt=Vr(et);return"string"!==rt?[new Ct(tt,et,"color expected, "+rt+" found")]:null===So(et)?[new Ct(tt,et,'color expected, "'+et+'" found')]:[]},constants:Mt,enum:tn,filter:cn,function:Wr,layer:dn,object:Hr,source:gn,light:xn,string:mn,formatted:function(w){return 0===mn(w).length?[]:Qr(w)},resolvedImage:function(w){return 0===mn(w).length?[]:Qr(w)}};function wn(w){var tt=w.value,et=w.valueSpec,rt=w.styleSpec;return et.expression&&Fr(Tt(tt))?Wr(w):et.expression&&Nr(Pt(tt))?Qr(w):et.type&&Da[et.type]?Da[et.type](w):Hr(Et({},w,{valueSpec:et.type?rt[et.type]:et}))}function _n(w){var tt=w.value,et=w.key,rt=mn(w);return rt.length||(-1===tt.indexOf("{fontstack}")&&rt.push(new Ct(et,tt,'"glyphs" url must include a "{fontstack}" token')),-1===tt.indexOf("{range}")&&rt.push(new Ct(et,tt,'"glyphs" url must include a "{range}" token'))),rt}function An(w,tt){void 0===tt&&(tt=Cn);var et=[];return et=et.concat(wn({key:"",value:w,valueSpec:tt.$root,styleSpec:tt,style:w,objectElementValidators:{glyphs:_n,"*":function(){return[]}}})),w.constants&&(et=et.concat(Mt({key:"constants",value:w.constants,style:w,styleSpec:tt}))),Sn(et)}function Sn(w){return[].concat(w).sort((function(w,tt){return w.line-tt.line}))}function kn(tt){return function(){for(var et=[],rt=arguments.length;rt--;)et[rt]=arguments[rt];return Sn(tt.apply(this||w,et))}}An.source=kn(gn),An.light=kn(xn),An.layer=kn(dn),An.filter=kn(cn),An.paintProperty=kn(fn),An.layoutProperty=kn(yn);var Fa=An,os=Fa.light,as=Fa.paintProperty,ss=Fa.layoutProperty;function En(w,tt){var et=!1;if(tt&&tt.length)for(var rt=0,it=tt;rt<it.length;rt+=1)w.fire(new zn(new Error(it[rt].message))),et=!0;return et}var ls=Pn;function Pn(tt,et,rt){var it=(this||w).cells=[];if(tt instanceof ArrayBuffer){(this||w).arrayBuffer=tt;var nt=new Int32Array((this||w).arrayBuffer);tt=nt[0],(this||w).d=(et=nt[1])+2*(rt=nt[2]);for(var ot=0;ot<(this||w).d*(this||w).d;ot++){var at=nt[3+ot],st=nt[3+ot+1];it.push(at===st?null:nt.subarray(at,st))}var ct=nt[3+it.length+1];(this||w).keys=nt.subarray(nt[3+it.length],ct),(this||w).bboxes=nt.subarray(ct),(this||w).insert=(this||w)._insertReadonly}else{(this||w).d=et+2*rt;for(var pt=0;pt<(this||w).d*(this||w).d;pt++)it.push([]);(this||w).keys=[],(this||w).bboxes=[]}(this||w).n=et,(this||w).extent=tt,(this||w).padding=rt,(this||w).scale=et/tt,(this||w).uid=0;var ft=rt/et*tt;(this||w).min=-ft,(this||w).max=tt+ft}Pn.prototype.insert=function(tt,et,rt,it,nt){this._forEachCell(et,rt,it,nt,(this||w)._insertCell,(this||w).uid++),(this||w).keys.push(tt),(this||w).bboxes.push(et),(this||w).bboxes.push(rt),(this||w).bboxes.push(it),(this||w).bboxes.push(nt)},Pn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Pn.prototype._insertCell=function(tt,et,rt,it,nt,ot){(this||w).cells[nt].push(ot)},Pn.prototype.query=function(tt,et,rt,it,nt){var ot=(this||w).min,at=(this||w).max;if(tt<=ot&&et<=ot&&at<=rt&&at<=it&&!nt)return Array.prototype.slice.call((this||w).keys);var st=[];return this._forEachCell(tt,et,rt,it,(this||w)._queryCell,st,{},nt),st},Pn.prototype._queryCell=function(tt,et,rt,it,nt,ot,at,st){var ct=(this||w).cells[nt];if(null!==ct)for(var pt=(this||w).keys,ft=(this||w).bboxes,dt=0;dt<ct.length;dt++){var mt=ct[dt];if(void 0===at[mt]){var yt=4*mt;(st?st(ft[yt+0],ft[yt+1],ft[yt+2],ft[yt+3]):tt<=ft[yt+2]&&et<=ft[yt+3]&&rt>=ft[yt+0]&&it>=ft[yt+1])?(at[mt]=!0,ot.push(pt[mt])):at[mt]=!1}}},Pn.prototype._forEachCell=function(tt,et,rt,it,nt,ot,at,st){for(var ct=this._convertToCellCoord(tt),pt=this._convertToCellCoord(et),ft=this._convertToCellCoord(rt),dt=this._convertToCellCoord(it),mt=ct;mt<=ft;mt++)for(var yt=pt;yt<=dt;yt++){var vt=(this||w).d*yt+mt;if((!st||st(this._convertFromCellCoord(mt),this._convertFromCellCoord(yt),this._convertFromCellCoord(mt+1),this._convertFromCellCoord(yt+1)))&&nt.call(this||w,tt,et,rt,it,vt,ot,at,st))return}},Pn.prototype._convertFromCellCoord=function(tt){return(tt-(this||w).padding)/(this||w).scale},Pn.prototype._convertToCellCoord=function(tt){return Math.max(0,Math.min((this||w).d-1,Math.floor(tt*(this||w).scale)+(this||w).padding))},Pn.prototype.toArrayBuffer=function(){if((this||w).arrayBuffer)return(this||w).arrayBuffer;for(var tt=(this||w).cells,et=3+(this||w).cells.length+1+1,rt=0,it=0;it<(this||w).cells.length;it++)rt+=(this||w).cells[it].length;var nt=new Int32Array(et+rt+(this||w).keys.length+(this||w).bboxes.length);nt[0]=(this||w).extent,nt[1]=(this||w).n,nt[2]=(this||w).padding;for(var ot=et,at=0;at<tt.length;at++){var st=tt[at];nt[3+at]=ot,nt.set(st,ot),ot+=st.length}return nt[3+tt.length]=ot,nt.set((this||w).keys,ot),nt[3+tt.length+1]=ot+=(this||w).keys.length,nt.set((this||w).bboxes,ot),ot+=(this||w).bboxes.length,nt.buffer};var us=it.ImageData,fs=it.ImageBitmap,gs={};function Dn(w,tt,et){void 0===et&&(et={}),Object.defineProperty(tt,"_classRegistryKey",{value:w,writeable:!1}),gs[w]={klass:tt,omit:et.omit||[],shallow:et.shallow||[]}}for(var vs in Dn("Object",Object),ls.serialize=function(w,tt){var et=w.toArrayBuffer();return tt&&tt.push(et),{buffer:et}},ls.deserialize=function(w){return new ls(w.buffer)},Dn("Grid",ls),Dn("Color",Wt),Dn("Error",Error),Dn("ResolvedImage",re),Dn("StylePropertyFunction",Jr),Dn("StyleExpression",qr,{omit:["_evaluator"]}),Dn("ZoomDependentExpression",Zr),Dn("ZoomConstantExpression",Gr),Dn("CompoundExpression",ve,{omit:["_evaluate"]}),wa)wa[vs]._classRegistryKey||Dn("Expression_"+vs,wa[vs]);function Rn(w){return w&&"undefined"!=typeof ArrayBuffer&&(w instanceof ArrayBuffer||w.constructor&&"ArrayBuffer"===w.constructor.name)}function On(w){return fs&&w instanceof fs}function Un(w,tt){if(null==w||"boolean"==typeof w||"number"==typeof w||"string"==typeof w||w instanceof Boolean||w instanceof Number||w instanceof String||w instanceof Date||w instanceof RegExp)return w;if(Rn(w)||On(w))return tt&&tt.push(w),w;if(ArrayBuffer.isView(w)){var et=w;return tt&&tt.push(et.buffer),et}if(w instanceof us)return tt&&tt.push(w.data.buffer),w;if(Array.isArray(w)){for(var rt=[],it=0,nt=w;it<nt.length;it+=1)rt.push(Un(nt[it],tt));return rt}if("object"==typeof w){var ot=w.constructor,at=ot._classRegistryKey;if(!at)throw new Error("can't serialize object of unregistered class");var st=ot.serialize?ot.serialize(w,tt):{};if(!ot.serialize){for(var ct in w)if(w.hasOwnProperty(ct)&&!(gs[at].omit.indexOf(ct)>=0)){var pt=w[ct];st[ct]=gs[at].shallow.indexOf(ct)>=0?pt:Un(pt,tt)}w instanceof Error&&(st.message=w.message)}if(st.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==at&&(st.$name=at),st}throw new Error("can't serialize object of type "+typeof w)}function jn(w){if(null==w||"boolean"==typeof w||"number"==typeof w||"string"==typeof w||w instanceof Boolean||w instanceof Number||w instanceof String||w instanceof Date||w instanceof RegExp||Rn(w)||On(w)||ArrayBuffer.isView(w)||w instanceof us)return w;if(Array.isArray(w))return w.map(jn);if("object"==typeof w){var tt=w.$name||"Object",et=gs[tt].klass;if(!et)throw new Error("can't deserialize unregistered class "+tt);if(et.deserialize)return et.deserialize(w);for(var rt=Object.create(et.prototype),it=0,nt=Object.keys(w);it<nt.length;it+=1){var ot=nt[it];if("$name"!==ot){var at=w[ot];rt[ot]=gs[tt].shallow.indexOf(ot)>=0?at:jn(at)}}return rt}throw new Error("can't deserialize object of type "+typeof w)}var qn=function(){(this||w).first=!0};qn.prototype.update=function(tt,et){var rt=Math.floor(tt);return(this||w).first?((this||w).first=!1,(this||w).lastIntegerZoom=rt,(this||w).lastIntegerZoomTime=0,(this||w).lastZoom=tt,(this||w).lastFloorZoom=rt,!0):((this||w).lastFloorZoom>rt?((this||w).lastIntegerZoom=rt+1,(this||w).lastIntegerZoomTime=et):(this||w).lastFloorZoom<rt&&((this||w).lastIntegerZoom=rt,(this||w).lastIntegerZoomTime=et),tt!==(this||w).lastZoom&&((this||w).lastZoom=tt,(this||w).lastFloorZoom=rt,!0))};var xs={"Latin-1 Supplement":function(w){return w>=128&&w<=255},Arabic:function(w){return w>=1536&&w<=1791},"Arabic Supplement":function(w){return w>=1872&&w<=1919},"Arabic Extended-A":function(w){return w>=2208&&w<=2303},"Hangul Jamo":function(w){return w>=4352&&w<=4607},"Unified Canadian Aboriginal Syllabics":function(w){return w>=5120&&w<=5759},Khmer:function(w){return w>=6016&&w<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(w){return w>=6320&&w<=6399},"General Punctuation":function(w){return w>=8192&&w<=8303},"Letterlike Symbols":function(w){return w>=8448&&w<=8527},"Number Forms":function(w){return w>=8528&&w<=8591},"Miscellaneous Technical":function(w){return w>=8960&&w<=9215},"Control Pictures":function(w){return w>=9216&&w<=9279},"Optical Character Recognition":function(w){return w>=9280&&w<=9311},"Enclosed Alphanumerics":function(w){return w>=9312&&w<=9471},"Geometric Shapes":function(w){return w>=9632&&w<=9727},"Miscellaneous Symbols":function(w){return w>=9728&&w<=9983},"Miscellaneous Symbols and Arrows":function(w){return w>=11008&&w<=11263},"CJK Radicals Supplement":function(w){return w>=11904&&w<=12031},"Kangxi Radicals":function(w){return w>=12032&&w<=12255},"Ideographic Description Characters":function(w){return w>=12272&&w<=12287},"CJK Symbols and Punctuation":function(w){return w>=12288&&w<=12351},Hiragana:function(w){return w>=12352&&w<=12447},Katakana:function(w){return w>=12448&&w<=12543},Bopomofo:function(w){return w>=12544&&w<=12591},"Hangul Compatibility Jamo":function(w){return w>=12592&&w<=12687},Kanbun:function(w){return w>=12688&&w<=12703},"Bopomofo Extended":function(w){return w>=12704&&w<=12735},"CJK Strokes":function(w){return w>=12736&&w<=12783},"Katakana Phonetic Extensions":function(w){return w>=12784&&w<=12799},"Enclosed CJK Letters and Months":function(w){return w>=12800&&w<=13055},"CJK Compatibility":function(w){return w>=13056&&w<=13311},"CJK Unified Ideographs Extension A":function(w){return w>=13312&&w<=19903},"Yijing Hexagram Symbols":function(w){return w>=19904&&w<=19967},"CJK Unified Ideographs":function(w){return w>=19968&&w<=40959},"Yi Syllables":function(w){return w>=40960&&w<=42127},"Yi Radicals":function(w){return w>=42128&&w<=42191},"Hangul Jamo Extended-A":function(w){return w>=43360&&w<=43391},"Hangul Syllables":function(w){return w>=44032&&w<=55215},"Hangul Jamo Extended-B":function(w){return w>=55216&&w<=55295},"Private Use Area":function(w){return w>=57344&&w<=63743},"CJK Compatibility Ideographs":function(w){return w>=63744&&w<=64255},"Arabic Presentation Forms-A":function(w){return w>=64336&&w<=65023},"Vertical Forms":function(w){return w>=65040&&w<=65055},"CJK Compatibility Forms":function(w){return w>=65072&&w<=65103},"Small Form Variants":function(w){return w>=65104&&w<=65135},"Arabic Presentation Forms-B":function(w){return w>=65136&&w<=65279},"Halfwidth and Fullwidth Forms":function(w){return w>=65280&&w<=65519}};function Kn(w){for(var tt=0,et=w;tt<et.length;tt+=1)if(Gn(et[tt].charCodeAt(0)))return!0;return!1}function Gn(w){return!(746!==w&&747!==w&&(w<4352||!(xs["Bopomofo Extended"](w)||xs.Bopomofo(w)||xs["CJK Compatibility Forms"](w)&&!(w>=65097&&w<=65103)||xs["CJK Compatibility Ideographs"](w)||xs["CJK Compatibility"](w)||xs["CJK Radicals Supplement"](w)||xs["CJK Strokes"](w)||!(!xs["CJK Symbols and Punctuation"](w)||w>=12296&&w<=12305||w>=12308&&w<=12319||12336===w)||xs["CJK Unified Ideographs Extension A"](w)||xs["CJK Unified Ideographs"](w)||xs["Enclosed CJK Letters and Months"](w)||xs["Hangul Compatibility Jamo"](w)||xs["Hangul Jamo Extended-A"](w)||xs["Hangul Jamo Extended-B"](w)||xs["Hangul Jamo"](w)||xs["Hangul Syllables"](w)||xs.Hiragana(w)||xs["Ideographic Description Characters"](w)||xs.Kanbun(w)||xs["Kangxi Radicals"](w)||xs["Katakana Phonetic Extensions"](w)||xs.Katakana(w)&&12540!==w||!(!xs["Halfwidth and Fullwidth Forms"](w)||65288===w||65289===w||65293===w||w>=65306&&w<=65310||65339===w||65341===w||65343===w||w>=65371&&w<=65503||65507===w||w>=65512&&w<=65519)||!(!xs["Small Form Variants"](w)||w>=65112&&w<=65118||w>=65123&&w<=65126)||xs["Unified Canadian Aboriginal Syllabics"](w)||xs["Unified Canadian Aboriginal Syllabics Extended"](w)||xs["Vertical Forms"](w)||xs["Yijing Hexagram Symbols"](w)||xs["Yi Syllables"](w)||xs["Yi Radicals"](w))))}function Zn(w){return!(Gn(w)||function(w){return!!(xs["Latin-1 Supplement"](w)&&(167===w||169===w||174===w||177===w||188===w||189===w||190===w||215===w||247===w)||xs["General Punctuation"](w)&&(8214===w||8224===w||8225===w||8240===w||8241===w||8251===w||8252===w||8258===w||8263===w||8264===w||8265===w||8273===w)||xs["Letterlike Symbols"](w)||xs["Number Forms"](w)||xs["Miscellaneous Technical"](w)&&(w>=8960&&w<=8967||w>=8972&&w<=8991||w>=8996&&w<=9e3||9003===w||w>=9085&&w<=9114||w>=9150&&w<=9165||9167===w||w>=9169&&w<=9179||w>=9186&&w<=9215)||xs["Control Pictures"](w)&&9251!==w||xs["Optical Character Recognition"](w)||xs["Enclosed Alphanumerics"](w)||xs["Geometric Shapes"](w)||xs["Miscellaneous Symbols"](w)&&!(w>=9754&&w<=9759)||xs["Miscellaneous Symbols and Arrows"](w)&&(w>=11026&&w<=11055||w>=11088&&w<=11097||w>=11192&&w<=11243)||xs["CJK Symbols and Punctuation"](w)||xs.Katakana(w)||xs["Private Use Area"](w)||xs["CJK Compatibility Forms"](w)||xs["Small Form Variants"](w)||xs["Halfwidth and Fullwidth Forms"](w)||8734===w||8756===w||8757===w||w>=9984&&w<=10087||w>=10102&&w<=10131||65532===w||65533===w)}(w))}function Xn(w){return w>=1424&&w<=2303||xs["Arabic Presentation Forms-A"](w)||xs["Arabic Presentation Forms-B"](w)}function Jn(w,tt){return!(!tt&&Xn(w)||w>=2304&&w<=3583||w>=3840&&w<=4255||xs.Khmer(w))}function Hn(w){for(var tt=0,et=w;tt<et.length;tt+=1)if(Xn(et[tt].charCodeAt(0)))return!0;return!1}var Ss=null,Es="unavailable",As=null,Qn=function(w){w&&"string"==typeof w&&w.indexOf("NetworkError")>-1&&(Es="error"),Ss&&Ss(w)};function ti(){zs.fire(new St("pluginStateChange",{pluginStatus:Es,pluginURL:As}))}var zs=new It,ri=function(){return Es},ni=function(){if("deferred"!==Es||!As)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Es="loading",ti(),As&&xt({url:As},(function(w){w?Qn(w):(Es="loaded",ti())}))},Ps={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===Es||null!=Ps.applyArabicShaping},isLoading:function(){return"loading"===Es},setState:function(w){Es=w.pluginStatus,As=w.pluginURL},isParsed:function(){return null!=Ps.applyArabicShaping&&null!=Ps.processBidirectionalText&&null!=Ps.processStyledBidirectionalText},getPluginURL:function(){return As}},ai=function(tt,et){(this||w).zoom=tt,et?((this||w).now=et.now,(this||w).fadeDuration=et.fadeDuration,(this||w).zoomHistory=et.zoomHistory,(this||w).transition=et.transition):((this||w).now=0,(this||w).fadeDuration=0,(this||w).zoomHistory=new qn,(this||w).transition={})};ai.prototype.isSupportedScript=function(w){return function(w,tt){for(var et=0,rt=w;et<rt.length;et+=1)if(!Jn(rt[et].charCodeAt(0),tt))return!1;return!0}(w,Ps.isLoaded())},ai.prototype.crossFadingFactor=function(){return 0===(this||w).fadeDuration?1:Math.min(((this||w).now-(this||w).zoomHistory.lastIntegerZoomTime)/(this||w).fadeDuration,1)},ai.prototype.getCrossfadeParameters=function(){var tt=(this||w).zoom,et=tt-Math.floor(tt),rt=this.crossFadingFactor();return tt>(this||w).zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:et+(1-et)*rt}:{fromScale:.5,toScale:1,t:1-(1-rt)*et}};var oi=function(tt,et){(this||w).property=tt,(this||w).value=et,(this||w).expression=function(w,tt){if(Fr(w))return new Jr(w,tt);if(Nr(w)){var et=Xr(w,tt);if("error"===et.result)throw new Error(et.value.map((function(w){return w.key+": "+w.message})).join(", "));return et.value}var rt=w;return"string"==typeof w&&"color"===tt.type&&(rt=Wt.parse(w)),{kind:"constant",evaluate:function(){return rt}}}(void 0===et?tt.specification.default:et,tt.specification)};oi.prototype.isDataDriven=function(){return"source"===(this||w).expression.kind||"composite"===(this||w).expression.kind},oi.prototype.possiblyEvaluate=function(tt,et,rt){return(this||w).property.possiblyEvaluate(this||w,tt,et,rt)};var si=function(tt){(this||w).property=tt,(this||w).value=new oi(tt,void 0)};si.prototype.transitioned=function(tt,et){return new li((this||w).property,(this||w).value,et,c({},tt.transition,(this||w).transition),tt.now)},si.prototype.untransitioned=function(){return new li((this||w).property,(this||w).value,null,{},0)};var ui=function(tt){(this||w)._properties=tt,(this||w)._values=Object.create(tt.defaultTransitionablePropertyValues)};ui.prototype.getValue=function(tt){return b((this||w)._values[tt].value.value)},ui.prototype.setValue=function(tt,et){(this||w)._values.hasOwnProperty(tt)||((this||w)._values[tt]=new si((this||w)._values[tt].property)),(this||w)._values[tt].value=new oi((this||w)._values[tt].property,null===et?void 0:b(et))},ui.prototype.getTransition=function(tt){return b((this||w)._values[tt].transition)},ui.prototype.setTransition=function(tt,et){(this||w)._values.hasOwnProperty(tt)||((this||w)._values[tt]=new si((this||w)._values[tt].property)),(this||w)._values[tt].transition=b(et)||void 0},ui.prototype.serialize=function(){for(var tt={},et=0,rt=Object.keys((this||w)._values);et<rt.length;et+=1){var it=rt[et],nt=this.getValue(it);void 0!==nt&&(tt[it]=nt);var ot=this.getTransition(it);void 0!==ot&&(tt[it+"-transition"]=ot)}return tt},ui.prototype.transitioned=function(tt,et){for(var rt=new pi((this||w)._properties),it=0,nt=Object.keys((this||w)._values);it<nt.length;it+=1){var ot=nt[it];rt._values[ot]=(this||w)._values[ot].transitioned(tt,et._values[ot])}return rt},ui.prototype.untransitioned=function(){for(var tt=new pi((this||w)._properties),et=0,rt=Object.keys((this||w)._values);et<rt.length;et+=1){var it=rt[et];tt._values[it]=(this||w)._values[it].untransitioned()}return tt};var li=function(tt,et,rt,it,nt){(this||w).property=tt,(this||w).value=et,(this||w).begin=nt+it.delay||0,(this||w).end=(this||w).begin+it.duration||0,tt.specification.transition&&(it.delay||it.duration)&&((this||w).prior=rt)};li.prototype.possiblyEvaluate=function(tt,et,rt){var it=tt.now||0,nt=(this||w).value.possiblyEvaluate(tt,et,rt),ot=(this||w).prior;if(ot){if(it>(this||w).end)return(this||w).prior=null,nt;if((this||w).value.isDataDriven())return(this||w).prior=null,nt;if(it<(this||w).begin)return ot.possiblyEvaluate(tt,et,rt);var at=(it-(this||w).begin)/((this||w).end-(this||w).begin);return(this||w).property.interpolate(ot.possiblyEvaluate(tt,et,rt),nt,function(w){if(w<=0)return 0;if(w>=1)return 1;var tt=w*w,et=tt*w;return 4*(w<.5?et:3*(w-tt)+et-.75)}(at))}return nt};var pi=function(tt){(this||w)._properties=tt,(this||w)._values=Object.create(tt.defaultTransitioningPropertyValues)};pi.prototype.possiblyEvaluate=function(tt,et,rt){for(var it=new fi((this||w)._properties),nt=0,ot=Object.keys((this||w)._values);nt<ot.length;nt+=1){var at=ot[nt];it._values[at]=(this||w)._values[at].possiblyEvaluate(tt,et,rt)}return it},pi.prototype.hasTransition=function(){for(var tt=0,et=Object.keys((this||w)._values);tt<et.length;tt+=1)if((this||w)._values[et[tt]].prior)return!0;return!1};var ci=function(tt){(this||w)._properties=tt,(this||w)._values=Object.create(tt.defaultPropertyValues)};ci.prototype.getValue=function(tt){return b((this||w)._values[tt].value)},ci.prototype.setValue=function(tt,et){(this||w)._values[tt]=new oi((this||w)._values[tt].property,null===et?void 0:b(et))},ci.prototype.serialize=function(){for(var tt={},et=0,rt=Object.keys((this||w)._values);et<rt.length;et+=1){var it=rt[et],nt=this.getValue(it);void 0!==nt&&(tt[it]=nt)}return tt},ci.prototype.possiblyEvaluate=function(tt,et,rt){for(var it=new fi((this||w)._properties),nt=0,ot=Object.keys((this||w)._values);nt<ot.length;nt+=1){var at=ot[nt];it._values[at]=(this||w)._values[at].possiblyEvaluate(tt,et,rt)}return it};var hi=function(tt,et,rt){(this||w).property=tt,(this||w).value=et,(this||w).parameters=rt};hi.prototype.isConstant=function(){return"constant"===(this||w).value.kind},hi.prototype.constantOr=function(tt){return"constant"===(this||w).value.kind?(this||w).value.value:tt},hi.prototype.evaluate=function(tt,et,rt,it){return(this||w).property.evaluate((this||w).value,(this||w).parameters,tt,et,rt,it)};var fi=function(tt){(this||w)._properties=tt,(this||w)._values=Object.create(tt.defaultPossiblyEvaluatedValues)};fi.prototype.get=function(tt){return(this||w)._values[tt]};var yi=function(tt){(this||w).specification=tt};yi.prototype.possiblyEvaluate=function(w,tt){return w.expression.evaluate(tt)},yi.prototype.interpolate=function(tt,et,rt){var it=ia[(this||w).specification.type];return it?it(tt,et,rt):tt};var di=function(tt,et){(this||w).specification=tt,(this||w).overrides=et};di.prototype.possiblyEvaluate=function(tt,et,rt,it){return new hi(this||w,"constant"===tt.expression.kind||"camera"===tt.expression.kind?{kind:"constant",value:tt.expression.evaluate(et,null,{},rt,it)}:tt.expression,et)},di.prototype.interpolate=function(tt,et,rt){if("constant"!==tt.value.kind||"constant"!==et.value.kind)return tt;if(void 0===tt.value.value||void 0===et.value.value)return new hi(this||w,{kind:"constant",value:void 0},tt.parameters);var it=ia[(this||w).specification.type];return it?new hi(this||w,{kind:"constant",value:it(tt.value.value,et.value.value,rt)},tt.parameters):tt},di.prototype.evaluate=function(w,tt,et,rt,it,nt){return"constant"===w.kind?w.value:w.evaluate(tt,et,rt,it,nt)};var Cs=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(tt,et,rt,it){if(void 0===tt.value)return new hi(this||w,{kind:"constant",value:void 0},et);if("constant"===tt.expression.kind){var nt=tt.expression.evaluate(et,null,{},rt,it),ot="resolvedImage"===tt.property.specification.type&&"string"!=typeof nt?nt.name:nt,at=this._calculate(ot,ot,ot,et);return new hi(this||w,{kind:"constant",value:at},et)}if("camera"===tt.expression.kind){var st=this._calculate(tt.expression.evaluate({zoom:et.zoom-1}),tt.expression.evaluate({zoom:et.zoom}),tt.expression.evaluate({zoom:et.zoom+1}),et);return new hi(this||w,{kind:"constant",value:st},et)}return new hi(this||w,tt.expression,et)},e.prototype.evaluate=function(w,tt,et,rt,it,nt){if("source"===w.kind){var ot=w.evaluate(tt,et,rt,it,nt);return this._calculate(ot,ot,ot,tt)}return"composite"===w.kind?this._calculate(w.evaluate({zoom:Math.floor(tt.zoom)-1},et,rt),w.evaluate({zoom:Math.floor(tt.zoom)},et,rt),w.evaluate({zoom:Math.floor(tt.zoom)+1},et,rt),tt):w.value},e.prototype._calculate=function(w,tt,et,rt){return rt.zoom>rt.zoomHistory.lastIntegerZoom?{from:w,to:tt}:{from:et,to:tt}},e.prototype.interpolate=function(w){return w},e}(di),vi=function(tt){(this||w).specification=tt};vi.prototype.possiblyEvaluate=function(w,tt,et,rt){if(void 0!==w.value){if("constant"===w.expression.kind){var it=w.expression.evaluate(tt,null,{},et,rt);return this._calculate(it,it,it,tt)}return this._calculate(w.expression.evaluate(new ai(Math.floor(tt.zoom-1),tt)),w.expression.evaluate(new ai(Math.floor(tt.zoom),tt)),w.expression.evaluate(new ai(Math.floor(tt.zoom+1),tt)),tt)}},vi.prototype._calculate=function(w,tt,et,rt){return rt.zoom>rt.zoomHistory.lastIntegerZoom?{from:w,to:tt}:{from:et,to:tt}},vi.prototype.interpolate=function(w){return w};var gi=function(tt){(this||w).specification=tt};gi.prototype.possiblyEvaluate=function(w,tt,et,rt){return!!w.expression.evaluate(tt,null,{},et,rt)},gi.prototype.interpolate=function(){return!1};var xi=function(tt){for(var et in(this||w).properties=tt,(this||w).defaultPropertyValues={},(this||w).defaultTransitionablePropertyValues={},(this||w).defaultTransitioningPropertyValues={},(this||w).defaultPossiblyEvaluatedValues={},(this||w).overridableProperties=[],tt){var rt=tt[et];rt.specification.overridable&&(this||w).overridableProperties.push(et);var it=(this||w).defaultPropertyValues[et]=new oi(rt,void 0),nt=(this||w).defaultTransitionablePropertyValues[et]=new si(rt);(this||w).defaultTransitioningPropertyValues[et]=nt.untransitioned(),(this||w).defaultPossiblyEvaluatedValues[et]=it.possiblyEvaluate({})}};Dn("DataDrivenProperty",di),Dn("DataConstantProperty",yi),Dn("CrossFadedDataDrivenProperty",Cs),Dn("CrossFadedProperty",vi),Dn("ColorRampProperty",gi);var Ms=function(tt){function e(et,rt){if(tt.call(this||w),(this||w).id=et.id,(this||w).type=et.type,(this||w)._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==et.type&&((this||w).metadata=(et=et).metadata,(this||w).minzoom=et.minzoom,(this||w).maxzoom=et.maxzoom,"background"!==et.type&&((this||w).source=et.source,(this||w).sourceLayer=et["source-layer"],(this||w).filter=et.filter),rt.layout&&((this||w)._unevaluatedLayout=new ci(rt.layout)),rt.paint)){for(var it in(this||w)._transitionablePaint=new ui(rt.paint),et.paint)this.setPaintProperty(it,et.paint[it],{validate:!1});for(var nt in et.layout)this.setLayoutProperty(nt,et.layout[nt],{validate:!1});(this||w)._transitioningPaint=(this||w)._transitionablePaint.untransitioned(),(this||w).paint=new fi(rt.paint)}}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getCrossfadeParameters=function(){return(this||w)._crossfadeParameters},e.prototype.getLayoutProperty=function(tt){return"visibility"===tt?(this||w).visibility:(this||w)._unevaluatedLayout.getValue(tt)},e.prototype.setLayoutProperty=function(tt,et,rt){void 0===rt&&(rt={}),null!=et&&this._validate(ss,"layers."+(this||w).id+".layout."+tt,tt,et,rt)||("visibility"!==tt?(this||w)._unevaluatedLayout.setValue(tt,et):(this||w).visibility=et)},e.prototype.getPaintProperty=function(tt){return v(tt,"-transition")?(this||w)._transitionablePaint.getTransition(tt.slice(0,-"-transition".length)):(this||w)._transitionablePaint.getValue(tt)},e.prototype.setPaintProperty=function(tt,et,rt){if(void 0===rt&&(rt={}),null!=et&&this._validate(as,"layers."+(this||w).id+".paint."+tt,tt,et,rt))return!1;if(v(tt,"-transition"))return(this||w)._transitionablePaint.setTransition(tt.slice(0,-"-transition".length),et||void 0),!1;var it=(this||w)._transitionablePaint._values[tt],nt="cross-faded-data-driven"===it.property.specification["property-type"],ot=it.value.isDataDriven(),at=it.value;(this||w)._transitionablePaint.setValue(tt,et),this._handleSpecialPaintPropertyUpdate(tt);var st=(this||w)._transitionablePaint._values[tt].value;return st.isDataDriven()||ot||nt||this._handleOverridablePaintPropertyUpdate(tt,at,st)},e.prototype._handleSpecialPaintPropertyUpdate=function(w){},e.prototype._handleOverridablePaintPropertyUpdate=function(w,tt,et){return!1},e.prototype.isHidden=function(tt){return!!((this||w).minzoom&&tt<(this||w).minzoom)||!!((this||w).maxzoom&&tt>=(this||w).maxzoom)||"none"===(this||w).visibility},e.prototype.updateTransitions=function(tt){(this||w)._transitioningPaint=(this||w)._transitionablePaint.transitioned(tt,(this||w)._transitioningPaint)},e.prototype.hasTransition=function(){return(this||w)._transitioningPaint.hasTransition()},e.prototype.recalculate=function(tt,et){tt.getCrossfadeParameters&&((this||w)._crossfadeParameters=tt.getCrossfadeParameters()),(this||w)._unevaluatedLayout&&((this||w).layout=(this||w)._unevaluatedLayout.possiblyEvaluate(tt,void 0,et)),(this||w).paint=(this||w)._transitioningPaint.possiblyEvaluate(tt,void 0,et)},e.prototype.serialize=function(){var tt={id:(this||w).id,type:(this||w).type,source:(this||w).source,"source-layer":(this||w).sourceLayer,metadata:(this||w).metadata,minzoom:(this||w).minzoom,maxzoom:(this||w).maxzoom,filter:(this||w).filter,layout:(this||w)._unevaluatedLayout&&(this||w)._unevaluatedLayout.serialize(),paint:(this||w)._transitionablePaint&&(this||w)._transitionablePaint.serialize()};return(this||w).visibility&&(tt.layout=tt.layout||{},tt.layout.visibility=(this||w).visibility),x(tt,(function(w,tt){return!(void 0===w||"layout"===tt&&!Object.keys(w).length||"paint"===tt&&!Object.keys(w).length)}))},e.prototype._validate=function(tt,et,rt,it,nt){return void 0===nt&&(nt={}),(!nt||!1!==nt.validate)&&En(this||w,tt.call(Fa,{key:et,layerType:(this||w).type,objectKey:rt,value:it,styleSpec:Cn,style:{glyphs:!0,sprite:!0}}))},e.prototype.is3D=function(){return!1},e.prototype.isTileClipped=function(){return!1},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e.prototype.isStateDependent=function(){for(var tt in(this||w).paint._values){var et=(this||w).paint.get(tt);if(et instanceof hi&&Tr(et.property.specification)&&("source"===et.value.kind||"composite"===et.value.kind)&&et.value.isStateDependent)return!0}return!1},e}(It),Ls={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},_i=function(tt,et){(this||w)._structArray=tt,(this||w)._pos1=et*(this||w).size,(this||w)._pos2=(this||w)._pos1/2,(this||w)._pos4=(this||w)._pos1/4,(this||w)._pos8=(this||w)._pos1/8},Ai=function(){(this||w).isTransferred=!1,(this||w).capacity=-1,this.resize(0)};function Si(w,tt){void 0===tt&&(tt=1);var et=0,rt=0;return{members:w.map((function(w){var it=Ls[w.type].BYTES_PER_ELEMENT,nt=et=ki(et,Math.max(tt,it)),ot=w.components||1;return rt=Math.max(rt,it),et+=it*ot,{name:w.name,type:w.type,components:ot,offset:nt}})),size:ki(et,Math.max(rt,tt)),alignment:tt}}function ki(w,tt){return Math.ceil(w/tt)*tt}Ai.serialize=function(w,tt){return w._trim(),tt&&(w.isTransferred=!0,tt.push(w.arrayBuffer)),{length:w.length,arrayBuffer:w.arrayBuffer}},Ai.deserialize=function(tt){var et=Object.create((this||w).prototype);return et.arrayBuffer=tt.arrayBuffer,et.length=tt.length,et.capacity=tt.arrayBuffer.byteLength/et.bytesPerElement,et._refreshViews(),et},Ai.prototype._trim=function(){(this||w).length!==(this||w).capacity&&((this||w).capacity=(this||w).length,(this||w).arrayBuffer=(this||w).arrayBuffer.slice(0,(this||w).length*(this||w).bytesPerElement),this._refreshViews())},Ai.prototype.clear=function(){(this||w).length=0},Ai.prototype.resize=function(tt){this.reserve(tt),(this||w).length=tt},Ai.prototype.reserve=function(tt){if(tt>(this||w).capacity){(this||w).capacity=Math.max(tt,Math.floor(5*(this||w).capacity),128),(this||w).arrayBuffer=new ArrayBuffer((this||w).capacity*(this||w).bytesPerElement);var et=(this||w).uint8;this._refreshViews(),et&&(this||w).uint8.set(et)}},Ai.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Rs=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).int16=new Int16Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt,et){var rt=(this||w).length;return this.resize(rt+1),this.emplace(rt,tt,et)},e.prototype.emplace=function(tt,et,rt){var it=2*tt;return(this||w).int16[it+0]=et,(this||w).int16[it+1]=rt,tt},e}(Ai);Rs.prototype.bytesPerElement=4,Dn("StructArrayLayout2i4",Rs);var Bs=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).int16=new Int16Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt,et,rt,it){var nt=(this||w).length;return this.resize(nt+1),this.emplace(nt,tt,et,rt,it)},e.prototype.emplace=function(tt,et,rt,it,nt){var ot=4*tt;return(this||w).int16[ot+0]=et,(this||w).int16[ot+1]=rt,(this||w).int16[ot+2]=it,(this||w).int16[ot+3]=nt,tt},e}(Ai);Bs.prototype.bytesPerElement=8,Dn("StructArrayLayout4i8",Bs);var Fs=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).int16=new Int16Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt,et,rt,it,nt,ot){var at=(this||w).length;return this.resize(at+1),this.emplace(at,tt,et,rt,it,nt,ot)},e.prototype.emplace=function(tt,et,rt,it,nt,ot,at){var st=6*tt;return(this||w).int16[st+0]=et,(this||w).int16[st+1]=rt,(this||w).int16[st+2]=it,(this||w).int16[st+3]=nt,(this||w).int16[st+4]=ot,(this||w).int16[st+5]=at,tt},e}(Ai);Fs.prototype.bytesPerElement=12,Dn("StructArrayLayout2i4i12",Fs);var Os=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).int16=new Int16Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt,et,rt,it,nt,ot){var at=(this||w).length;return this.resize(at+1),this.emplace(at,tt,et,rt,it,nt,ot)},e.prototype.emplace=function(tt,et,rt,it,nt,ot,at){var st=4*tt,ct=8*tt;return(this||w).int16[st+0]=et,(this||w).int16[st+1]=rt,(this||w).uint8[ct+4]=it,(this||w).uint8[ct+5]=nt,(this||w).uint8[ct+6]=ot,(this||w).uint8[ct+7]=at,tt},e}(Ai);Os.prototype.bytesPerElement=8,Dn("StructArrayLayout2i4ub8",Os);var Us=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).uint16=new Uint16Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt,et,rt,it,nt,ot,at,st,ct,pt){var ft=(this||w).length;return this.resize(ft+1),this.emplace(ft,tt,et,rt,it,nt,ot,at,st,ct,pt)},e.prototype.emplace=function(tt,et,rt,it,nt,ot,at,st,ct,pt,ft){var dt=10*tt;return(this||w).uint16[dt+0]=et,(this||w).uint16[dt+1]=rt,(this||w).uint16[dt+2]=it,(this||w).uint16[dt+3]=nt,(this||w).uint16[dt+4]=ot,(this||w).uint16[dt+5]=at,(this||w).uint16[dt+6]=st,(this||w).uint16[dt+7]=ct,(this||w).uint16[dt+8]=pt,(this||w).uint16[dt+9]=ft,tt},e}(Ai);Us.prototype.bytesPerElement=20,Dn("StructArrayLayout10ui20",Us);var Vs=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).int16=new Int16Array((this||w).arrayBuffer),(this||w).uint16=new Uint16Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt,et,rt,it,nt,ot,at,st,ct,pt,ft,dt){var mt=(this||w).length;return this.resize(mt+1),this.emplace(mt,tt,et,rt,it,nt,ot,at,st,ct,pt,ft,dt)},e.prototype.emplace=function(tt,et,rt,it,nt,ot,at,st,ct,pt,ft,dt,mt){var yt=12*tt;return(this||w).int16[yt+0]=et,(this||w).int16[yt+1]=rt,(this||w).int16[yt+2]=it,(this||w).int16[yt+3]=nt,(this||w).uint16[yt+4]=ot,(this||w).uint16[yt+5]=at,(this||w).uint16[yt+6]=st,(this||w).uint16[yt+7]=ct,(this||w).int16[yt+8]=pt,(this||w).int16[yt+9]=ft,(this||w).int16[yt+10]=dt,(this||w).int16[yt+11]=mt,tt},e}(Ai);Vs.prototype.bytesPerElement=24,Dn("StructArrayLayout4i4ui4i24",Vs);var Ns=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).float32=new Float32Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt,et,rt){var it=(this||w).length;return this.resize(it+1),this.emplace(it,tt,et,rt)},e.prototype.emplace=function(tt,et,rt,it){var nt=3*tt;return(this||w).float32[nt+0]=et,(this||w).float32[nt+1]=rt,(this||w).float32[nt+2]=it,tt},e}(Ai);Ns.prototype.bytesPerElement=12,Dn("StructArrayLayout3f12",Ns);var js=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).uint32=new Uint32Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt){var et=(this||w).length;return this.resize(et+1),this.emplace(et,tt)},e.prototype.emplace=function(tt,et){return(this||w).uint32[1*tt+0]=et,tt},e}(Ai);js.prototype.bytesPerElement=4,Dn("StructArrayLayout1ul4",js);var Zs=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).int16=new Int16Array((this||w).arrayBuffer),(this||w).uint32=new Uint32Array((this||w).arrayBuffer),(this||w).uint16=new Uint16Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt,et,rt,it,nt,ot,at,st,ct){var pt=(this||w).length;return this.resize(pt+1),this.emplace(pt,tt,et,rt,it,nt,ot,at,st,ct)},e.prototype.emplace=function(tt,et,rt,it,nt,ot,at,st,ct,pt){var ft=10*tt,dt=5*tt;return(this||w).int16[ft+0]=et,(this||w).int16[ft+1]=rt,(this||w).int16[ft+2]=it,(this||w).int16[ft+3]=nt,(this||w).int16[ft+4]=ot,(this||w).int16[ft+5]=at,(this||w).uint32[dt+3]=st,(this||w).uint16[ft+8]=ct,(this||w).uint16[ft+9]=pt,tt},e}(Ai);Zs.prototype.bytesPerElement=20,Dn("StructArrayLayout6i1ul2ui20",Zs);var Js=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).int16=new Int16Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt,et,rt,it,nt,ot){var at=(this||w).length;return this.resize(at+1),this.emplace(at,tt,et,rt,it,nt,ot)},e.prototype.emplace=function(tt,et,rt,it,nt,ot,at){var st=6*tt;return(this||w).int16[st+0]=et,(this||w).int16[st+1]=rt,(this||w).int16[st+2]=it,(this||w).int16[st+3]=nt,(this||w).int16[st+4]=ot,(this||w).int16[st+5]=at,tt},e}(Ai);Js.prototype.bytesPerElement=12,Dn("StructArrayLayout2i2i2i12",Js);var tl=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).float32=new Float32Array((this||w).arrayBuffer),(this||w).int16=new Int16Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt,et,rt,it,nt){var ot=(this||w).length;return this.resize(ot+1),this.emplace(ot,tt,et,rt,it,nt)},e.prototype.emplace=function(tt,et,rt,it,nt,ot){var at=4*tt,st=8*tt;return(this||w).float32[at+0]=et,(this||w).float32[at+1]=rt,(this||w).float32[at+2]=it,(this||w).int16[st+6]=nt,(this||w).int16[st+7]=ot,tt},e}(Ai);tl.prototype.bytesPerElement=16,Dn("StructArrayLayout2f1f2i16",tl);var ol=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).float32=new Float32Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt,et,rt,it){var nt=(this||w).length;return this.resize(nt+1),this.emplace(nt,tt,et,rt,it)},e.prototype.emplace=function(tt,et,rt,it,nt){var ot=12*tt,at=3*tt;return(this||w).uint8[ot+0]=et,(this||w).uint8[ot+1]=rt,(this||w).float32[at+1]=it,(this||w).float32[at+2]=nt,tt},e}(Ai);ol.prototype.bytesPerElement=12,Dn("StructArrayLayout2ub2f12",ol);var sl=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).uint16=new Uint16Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt,et,rt){var it=(this||w).length;return this.resize(it+1),this.emplace(it,tt,et,rt)},e.prototype.emplace=function(tt,et,rt,it){var nt=3*tt;return(this||w).uint16[nt+0]=et,(this||w).uint16[nt+1]=rt,(this||w).uint16[nt+2]=it,tt},e}(Ai);sl.prototype.bytesPerElement=6,Dn("StructArrayLayout3ui6",sl);var dl=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).int16=new Int16Array((this||w).arrayBuffer),(this||w).uint16=new Uint16Array((this||w).arrayBuffer),(this||w).uint32=new Uint32Array((this||w).arrayBuffer),(this||w).float32=new Float32Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt,et,rt,it,nt,ot,at,st,ct,pt,ft,dt,mt,yt,vt,Dt,Rt){var Bt=(this||w).length;return this.resize(Bt+1),this.emplace(Bt,tt,et,rt,it,nt,ot,at,st,ct,pt,ft,dt,mt,yt,vt,Dt,Rt)},e.prototype.emplace=function(tt,et,rt,it,nt,ot,at,st,ct,pt,ft,dt,mt,yt,vt,Dt,Rt,Bt){var Ot=24*tt,Ne=12*tt,Ze=48*tt;return(this||w).int16[Ot+0]=et,(this||w).int16[Ot+1]=rt,(this||w).uint16[Ot+2]=it,(this||w).uint16[Ot+3]=nt,(this||w).uint32[Ne+2]=ot,(this||w).uint32[Ne+3]=at,(this||w).uint32[Ne+4]=st,(this||w).uint16[Ot+10]=ct,(this||w).uint16[Ot+11]=pt,(this||w).uint16[Ot+12]=ft,(this||w).float32[Ne+7]=dt,(this||w).float32[Ne+8]=mt,(this||w).uint8[Ze+36]=yt,(this||w).uint8[Ze+37]=vt,(this||w).uint8[Ze+38]=Dt,(this||w).uint32[Ne+10]=Rt,(this||w).int16[Ot+22]=Bt,tt},e}(Ai);dl.prototype.bytesPerElement=48,Dn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",dl);var yl=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).int16=new Int16Array((this||w).arrayBuffer),(this||w).uint16=new Uint16Array((this||w).arrayBuffer),(this||w).uint32=new Uint32Array((this||w).arrayBuffer),(this||w).float32=new Float32Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt,et,rt,it,nt,ot,at,st,ct,pt,ft,dt,mt,yt,vt,Dt,Rt,Bt,Ot,Ne,Ze,Ge,Ke,er,rr,vr,wr,Sr){var ei=(this||w).length;return this.resize(ei+1),this.emplace(ei,tt,et,rt,it,nt,ot,at,st,ct,pt,ft,dt,mt,yt,vt,Dt,Rt,Bt,Ot,Ne,Ze,Ge,Ke,er,rr,vr,wr,Sr)},e.prototype.emplace=function(tt,et,rt,it,nt,ot,at,st,ct,pt,ft,dt,mt,yt,vt,Dt,Rt,Bt,Ot,Ne,Ze,Ge,Ke,er,rr,vr,wr,Sr,ei){var ii=34*tt,mi=17*tt;return(this||w).int16[ii+0]=et,(this||w).int16[ii+1]=rt,(this||w).int16[ii+2]=it,(this||w).int16[ii+3]=nt,(this||w).int16[ii+4]=ot,(this||w).int16[ii+5]=at,(this||w).int16[ii+6]=st,(this||w).int16[ii+7]=ct,(this||w).uint16[ii+8]=pt,(this||w).uint16[ii+9]=ft,(this||w).uint16[ii+10]=dt,(this||w).uint16[ii+11]=mt,(this||w).uint16[ii+12]=yt,(this||w).uint16[ii+13]=vt,(this||w).uint16[ii+14]=Dt,(this||w).uint16[ii+15]=Rt,(this||w).uint16[ii+16]=Bt,(this||w).uint16[ii+17]=Ot,(this||w).uint16[ii+18]=Ne,(this||w).uint16[ii+19]=Ze,(this||w).uint16[ii+20]=Ge,(this||w).uint16[ii+21]=Ke,(this||w).uint16[ii+22]=er,(this||w).uint32[mi+12]=rr,(this||w).float32[mi+13]=vr,(this||w).float32[mi+14]=wr,(this||w).float32[mi+15]=Sr,(this||w).float32[mi+16]=ei,tt},e}(Ai);yl.prototype.bytesPerElement=68,Dn("StructArrayLayout8i15ui1ul4f68",yl);var gl=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).float32=new Float32Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt){var et=(this||w).length;return this.resize(et+1),this.emplace(et,tt)},e.prototype.emplace=function(tt,et){return(this||w).float32[1*tt+0]=et,tt},e}(Ai);gl.prototype.bytesPerElement=4,Dn("StructArrayLayout1f4",gl);var _l=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).int16=new Int16Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt,et,rt){var it=(this||w).length;return this.resize(it+1),this.emplace(it,tt,et,rt)},e.prototype.emplace=function(tt,et,rt,it){var nt=3*tt;return(this||w).int16[nt+0]=et,(this||w).int16[nt+1]=rt,(this||w).int16[nt+2]=it,tt},e}(Ai);_l.prototype.bytesPerElement=6,Dn("StructArrayLayout3i6",_l);var vl=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).uint32=new Uint32Array((this||w).arrayBuffer),(this||w).uint16=new Uint16Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt,et,rt){var it=(this||w).length;return this.resize(it+1),this.emplace(it,tt,et,rt)},e.prototype.emplace=function(tt,et,rt,it){var nt=4*tt;return(this||w).uint32[2*tt+0]=et,(this||w).uint16[nt+2]=rt,(this||w).uint16[nt+3]=it,tt},e}(Ai);vl.prototype.bytesPerElement=8,Dn("StructArrayLayout1ul2ui8",vl);var xl=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).uint16=new Uint16Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt,et){var rt=(this||w).length;return this.resize(rt+1),this.emplace(rt,tt,et)},e.prototype.emplace=function(tt,et,rt){var it=2*tt;return(this||w).uint16[it+0]=et,(this||w).uint16[it+1]=rt,tt},e}(Ai);xl.prototype.bytesPerElement=4,Dn("StructArrayLayout2ui4",xl);var bl=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).uint16=new Uint16Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt){var et=(this||w).length;return this.resize(et+1),this.emplace(et,tt)},e.prototype.emplace=function(tt,et){return(this||w).uint16[1*tt+0]=et,tt},e}(Ai);bl.prototype.bytesPerElement=2,Dn("StructArrayLayout1ui2",bl);var wl=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).float32=new Float32Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt,et){var rt=(this||w).length;return this.resize(rt+1),this.emplace(rt,tt,et)},e.prototype.emplace=function(tt,et,rt){var it=2*tt;return(this||w).float32[it+0]=et,(this||w).float32[it+1]=rt,tt},e}(Ai);wl.prototype.bytesPerElement=8,Dn("StructArrayLayout2f8",wl);var Sl=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._refreshViews=function(){(this||w).uint8=new Uint8Array((this||w).arrayBuffer),(this||w).float32=new Float32Array((this||w).arrayBuffer)},e.prototype.emplaceBack=function(tt,et,rt,it){var nt=(this||w).length;return this.resize(nt+1),this.emplace(nt,tt,et,rt,it)},e.prototype.emplace=function(tt,et,rt,it,nt){var ot=4*tt;return(this||w).float32[ot+0]=et,(this||w).float32[ot+1]=rt,(this||w).float32[ot+2]=it,(this||w).float32[ot+3]=nt,tt},e}(Ai);Sl.prototype.bytesPerElement=16,Dn("StructArrayLayout4f16",Sl);var Il=function(tt){function e(){tt.apply(this||w,arguments)}tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e;var et={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return et.anchorPointX.get=function(){return(this||w)._structArray.int16[(this||w)._pos2+0]},et.anchorPointY.get=function(){return(this||w)._structArray.int16[(this||w)._pos2+1]},et.x1.get=function(){return(this||w)._structArray.int16[(this||w)._pos2+2]},et.y1.get=function(){return(this||w)._structArray.int16[(this||w)._pos2+3]},et.x2.get=function(){return(this||w)._structArray.int16[(this||w)._pos2+4]},et.y2.get=function(){return(this||w)._structArray.int16[(this||w)._pos2+5]},et.featureIndex.get=function(){return(this||w)._structArray.uint32[(this||w)._pos4+3]},et.sourceLayerIndex.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+8]},et.bucketIndex.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+9]},et.anchorPoint.get=function(){return new rt((this||w).anchorPointX,(this||w).anchorPointY)},Object.defineProperties(e.prototype,et),e}(_i);Il.prototype.size=20;var Al=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.get=function(tt){return new Il(this||w,tt)},e}(Zs);Dn("CollisionBoxArray",Al);var zl=function(tt){function e(){tt.apply(this||w,arguments)}tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e;var et={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return et.anchorX.get=function(){return(this||w)._structArray.int16[(this||w)._pos2+0]},et.anchorY.get=function(){return(this||w)._structArray.int16[(this||w)._pos2+1]},et.glyphStartIndex.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+2]},et.numGlyphs.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+3]},et.vertexStartIndex.get=function(){return(this||w)._structArray.uint32[(this||w)._pos4+2]},et.lineStartIndex.get=function(){return(this||w)._structArray.uint32[(this||w)._pos4+3]},et.lineLength.get=function(){return(this||w)._structArray.uint32[(this||w)._pos4+4]},et.segment.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+10]},et.lowerSize.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+11]},et.upperSize.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+12]},et.lineOffsetX.get=function(){return(this||w)._structArray.float32[(this||w)._pos4+7]},et.lineOffsetY.get=function(){return(this||w)._structArray.float32[(this||w)._pos4+8]},et.writingMode.get=function(){return(this||w)._structArray.uint8[(this||w)._pos1+36]},et.placedOrientation.get=function(){return(this||w)._structArray.uint8[(this||w)._pos1+37]},et.placedOrientation.set=function(tt){(this||w)._structArray.uint8[(this||w)._pos1+37]=tt},et.hidden.get=function(){return(this||w)._structArray.uint8[(this||w)._pos1+38]},et.hidden.set=function(tt){(this||w)._structArray.uint8[(this||w)._pos1+38]=tt},et.crossTileID.get=function(){return(this||w)._structArray.uint32[(this||w)._pos4+10]},et.crossTileID.set=function(tt){(this||w)._structArray.uint32[(this||w)._pos4+10]=tt},et.associatedIconIndex.get=function(){return(this||w)._structArray.int16[(this||w)._pos2+22]},Object.defineProperties(e.prototype,et),e}(_i);zl.prototype.size=48;var Cl=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.get=function(tt){return new zl(this||w,tt)},e}(dl);Dn("PlacedSymbolArray",Cl);var kl=function(tt){function e(){tt.apply(this||w,arguments)}tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e;var et={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return et.anchorX.get=function(){return(this||w)._structArray.int16[(this||w)._pos2+0]},et.anchorY.get=function(){return(this||w)._structArray.int16[(this||w)._pos2+1]},et.rightJustifiedTextSymbolIndex.get=function(){return(this||w)._structArray.int16[(this||w)._pos2+2]},et.centerJustifiedTextSymbolIndex.get=function(){return(this||w)._structArray.int16[(this||w)._pos2+3]},et.leftJustifiedTextSymbolIndex.get=function(){return(this||w)._structArray.int16[(this||w)._pos2+4]},et.verticalPlacedTextSymbolIndex.get=function(){return(this||w)._structArray.int16[(this||w)._pos2+5]},et.placedIconSymbolIndex.get=function(){return(this||w)._structArray.int16[(this||w)._pos2+6]},et.verticalPlacedIconSymbolIndex.get=function(){return(this||w)._structArray.int16[(this||w)._pos2+7]},et.key.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+8]},et.textBoxStartIndex.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+9]},et.textBoxEndIndex.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+10]},et.verticalTextBoxStartIndex.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+11]},et.verticalTextBoxEndIndex.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+12]},et.iconBoxStartIndex.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+13]},et.iconBoxEndIndex.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+14]},et.verticalIconBoxStartIndex.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+15]},et.verticalIconBoxEndIndex.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+16]},et.featureIndex.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+17]},et.numHorizontalGlyphVertices.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+18]},et.numVerticalGlyphVertices.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+19]},et.numIconVertices.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+20]},et.numVerticalIconVertices.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+21]},et.useRuntimeCollisionCircles.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+22]},et.crossTileID.get=function(){return(this||w)._structArray.uint32[(this||w)._pos4+12]},et.crossTileID.set=function(tt){(this||w)._structArray.uint32[(this||w)._pos4+12]=tt},et.textBoxScale.get=function(){return(this||w)._structArray.float32[(this||w)._pos4+13]},et.textOffset0.get=function(){return(this||w)._structArray.float32[(this||w)._pos4+14]},et.textOffset1.get=function(){return(this||w)._structArray.float32[(this||w)._pos4+15]},et.collisionCircleDiameter.get=function(){return(this||w)._structArray.float32[(this||w)._pos4+16]},Object.defineProperties(e.prototype,et),e}(_i);kl.prototype.size=68;var Fl=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.get=function(tt){return new kl(this||w,tt)},e}(yl);Dn("SymbolInstanceArray",Fl);var Hl=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getoffsetX=function(tt){return(this||w).float32[1*tt+0]},e}(gl);Dn("GlyphOffsetArray",Hl);var du=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getx=function(tt){return(this||w).int16[3*tt+0]},e.prototype.gety=function(tt){return(this||w).int16[3*tt+1]},e.prototype.gettileUnitDistanceFromAnchor=function(tt){return(this||w).int16[3*tt+2]},e}(_l);Dn("SymbolLineVertexArray",du);var _u=function(tt){function e(){tt.apply(this||w,arguments)}tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e;var et={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return et.featureIndex.get=function(){return(this||w)._structArray.uint32[(this||w)._pos4+0]},et.sourceLayerIndex.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+2]},et.bucketIndex.get=function(){return(this||w)._structArray.uint16[(this||w)._pos2+3]},Object.defineProperties(e.prototype,et),e}(_i);_u.prototype.size=8;var vu=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.get=function(tt){return new _u(this||w,tt)},e}(vl);Dn("FeatureIndexArray",vu);var wu=Si([{name:"a_pos",components:2,type:"Int16"}],4).members,aa=function(tt){void 0===tt&&(tt=[]),(this||w).segments=tt};function oa(w,tt){return 256*(w=l(Math.floor(w),0,255))+l(Math.floor(tt),0,255)}aa.prototype.prepareSegment=function(tt,et,rt,it){var nt=(this||w).segments[(this||w).segments.length-1];return tt>aa.MAX_VERTEX_ARRAY_LENGTH&&_("Max vertices per segment is "+aa.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+tt),(!nt||nt.vertexLength+tt>aa.MAX_VERTEX_ARRAY_LENGTH||nt.sortKey!==it)&&(nt={vertexOffset:et.length,primitiveOffset:rt.length,vertexLength:0,primitiveLength:0},void 0!==it&&(nt.sortKey=it),(this||w).segments.push(nt)),nt},aa.prototype.get=function(){return(this||w).segments},aa.prototype.destroy=function(){for(var tt=0,et=(this||w).segments;tt<et.length;tt+=1){var rt=et[tt];for(var it in rt.vaos)rt.vaos[it].destroy()}},aa.simpleSegment=function(w,tt,et,rt){return new aa([{vertexOffset:w,primitiveOffset:tt,vertexLength:et,primitiveLength:rt,vaos:{},sortKey:0}])},aa.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Dn("SegmentVector",aa);var Tu=Si([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Fu=e((function(w){w.exports=function(w,tt){var et,rt,it,nt,ot,at,st,ct;for(rt=w.length-(et=3&w.length),it=tt,ot=3432918353,at=461845907,ct=0;ct<rt;)st=255&w.charCodeAt(ct)|(255&w.charCodeAt(++ct))<<8|(255&w.charCodeAt(++ct))<<16|(255&w.charCodeAt(++ct))<<24,++ct,it=27492+(65535&(nt=5*(65535&(it=(it^=st=(65535&(st=(st=(65535&st)*ot+(((st>>>16)*ot&65535)<<16)&4294967295)<<15|st>>>17))*at+(((st>>>16)*at&65535)<<16)&4294967295)<<13|it>>>19))+((5*(it>>>16)&65535)<<16)&4294967295))+((58964+(nt>>>16)&65535)<<16);switch(st=0,et){case 3:st^=(255&w.charCodeAt(ct+2))<<16;case 2:st^=(255&w.charCodeAt(ct+1))<<8;case 1:it^=st=(65535&(st=(st=(65535&(st^=255&w.charCodeAt(ct)))*ot+(((st>>>16)*ot&65535)<<16)&4294967295)<<15|st>>>17))*at+(((st>>>16)*at&65535)<<16)&4294967295}return it^=w.length,it=2246822507*(65535&(it^=it>>>16))+((2246822507*(it>>>16)&65535)<<16)&4294967295,it=3266489909*(65535&(it^=it>>>13))+((3266489909*(it>>>16)&65535)<<16)&4294967295,(it^=it>>>16)>>>0}})),tc=e((function(w){w.exports=function(w,tt){for(var et,rt=w.length,it=tt^rt,nt=0;rt>=4;)et=1540483477*(65535&(et=255&w.charCodeAt(nt)|(255&w.charCodeAt(++nt))<<8|(255&w.charCodeAt(++nt))<<16|(255&w.charCodeAt(++nt))<<24))+((1540483477*(et>>>16)&65535)<<16),it=1540483477*(65535&it)+((1540483477*(it>>>16)&65535)<<16)^(et=1540483477*(65535&(et^=et>>>24))+((1540483477*(et>>>16)&65535)<<16)),rt-=4,++nt;switch(rt){case 3:it^=(255&w.charCodeAt(nt+2))<<16;case 2:it^=(255&w.charCodeAt(nt+1))<<8;case 1:it=1540483477*(65535&(it^=255&w.charCodeAt(nt)))+((1540483477*(it>>>16)&65535)<<16)}return it=1540483477*(65535&(it^=it>>>13))+((1540483477*(it>>>16)&65535)<<16),(it^=it>>>15)>>>0}})),ec=Fu,rc=tc;ec.murmur3=Fu,ec.murmur2=rc;var ha=function(){(this||w).ids=[],(this||w).positions=[],(this||w).indexed=!1};ha.prototype.add=function(tt,et,rt,it){(this||w).ids.push(ya(tt)),(this||w).positions.push(et,rt,it)},ha.prototype.getPositions=function(tt){for(var et=ya(tt),rt=0,it=(this||w).ids.length-1;rt<it;){var nt=rt+it>>1;(this||w).ids[nt]>=et?it=nt:rt=nt+1}for(var ot=[];(this||w).ids[rt]===et;)ot.push({index:(this||w).positions[3*rt],start:(this||w).positions[3*rt+1],end:(this||w).positions[3*rt+2]}),rt++;return ot},ha.serialize=function(w,tt){var et=new Float64Array(w.ids),rt=new Uint32Array(w.positions);return function t(w,tt,et,rt){for(;et<rt;){for(var it=w[et+rt>>1],nt=et-1,ot=rt+1;;){do{nt++}while(w[nt]<it);do{ot--}while(w[ot]>it);if(nt>=ot)break;da(w,nt,ot),da(tt,3*nt,3*ot),da(tt,3*nt+1,3*ot+1),da(tt,3*nt+2,3*ot+2)}ot-et<rt-ot?(t(w,tt,et,ot),et=ot+1):(t(w,tt,ot+1,rt),rt=ot)}}(et,rt,0,et.length-1),tt&&tt.push(et.buffer,rt.buffer),{ids:et,positions:rt}},ha.deserialize=function(w){var tt=new ha;return tt.ids=w.ids,tt.positions=w.positions,tt.indexed=!0,tt};var ic=Math.pow(2,53)-1;function ya(w){var tt=+w;return!isNaN(tt)&&tt<=ic?tt:ec(String(w))}function da(w,tt,et){var rt=w[tt];w[tt]=w[et],w[et]=rt}Dn("FeaturePositionMap",ha);var ma=function(tt,et){(this||w).gl=tt.gl,(this||w).location=et},nc=function(tt){function e(et,rt){tt.call(this||w,et,rt),(this||w).current=0}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.set=function(tt){(this||w).current!==tt&&((this||w).current=tt,(this||w).gl.uniform1i((this||w).location,tt))},e}(ma),oc=function(tt){function e(et,rt){tt.call(this||w,et,rt),(this||w).current=0}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.set=function(tt){(this||w).current!==tt&&((this||w).current=tt,(this||w).gl.uniform1f((this||w).location,tt))},e}(ma),ac=function(tt){function e(et,rt){tt.call(this||w,et,rt),(this||w).current=[0,0]}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.set=function(tt){tt[0]===(this||w).current[0]&&tt[1]===(this||w).current[1]||((this||w).current=tt,(this||w).gl.uniform2f((this||w).location,tt[0],tt[1]))},e}(ma),sc=function(tt){function e(et,rt){tt.call(this||w,et,rt),(this||w).current=[0,0,0]}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.set=function(tt){tt[0]===(this||w).current[0]&&tt[1]===(this||w).current[1]&&tt[2]===(this||w).current[2]||((this||w).current=tt,(this||w).gl.uniform3f((this||w).location,tt[0],tt[1],tt[2]))},e}(ma),lc=function(tt){function e(et,rt){tt.call(this||w,et,rt),(this||w).current=[0,0,0,0]}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.set=function(tt){tt[0]===(this||w).current[0]&&tt[1]===(this||w).current[1]&&tt[2]===(this||w).current[2]&&tt[3]===(this||w).current[3]||((this||w).current=tt,(this||w).gl.uniform4f((this||w).location,tt[0],tt[1],tt[2],tt[3]))},e}(ma),uc=function(tt){function e(et,rt){tt.call(this||w,et,rt),(this||w).current=Wt.transparent}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.set=function(tt){tt.r===(this||w).current.r&&tt.g===(this||w).current.g&&tt.b===(this||w).current.b&&tt.a===(this||w).current.a||((this||w).current=tt,(this||w).gl.uniform4f((this||w).location,tt.r,tt.g,tt.b,tt.a))},e}(ma),cc=new Float32Array(16),pc=function(tt){function e(et,rt){tt.call(this||w,et,rt),(this||w).current=cc}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.set=function(tt){if(tt[12]!==(this||w).current[12]||tt[0]!==(this||w).current[0])return(this||w).current=tt,void(this||w).gl.uniformMatrix4fv((this||w).location,!1,tt);for(var et=1;et<16;et++)if(tt[et]!==(this||w).current[et]){(this||w).current=tt,(this||w).gl.uniformMatrix4fv((this||w).location,!1,tt);break}},e}(ma);function ka(w){return[oa(255*w.r,255*w.g),oa(255*w.b,255*w.a)]}var Ia=function(tt,et,rt){(this||w).value=tt,(this||w).uniformNames=et.map((function(w){return"u_"+w})),(this||w).type=rt};Ia.prototype.setUniform=function(tt,et,rt){tt.set(rt.constantOr((this||w).value))},Ia.prototype.getBinding=function(tt,et,rt){return"color"===(this||w).type?new uc(tt,et):new oc(tt,et)};var za=function(tt,et){(this||w).uniformNames=et.map((function(w){return"u_"+w})),(this||w).patternFrom=null,(this||w).patternTo=null,(this||w).pixelRatioFrom=1,(this||w).pixelRatioTo=1};za.prototype.setConstantPatternPositions=function(tt,et){(this||w).pixelRatioFrom=et.pixelRatio,(this||w).pixelRatioTo=tt.pixelRatio,(this||w).patternFrom=et.tlbr,(this||w).patternTo=tt.tlbr},za.prototype.setUniform=function(tt,et,rt,it){var nt="u_pattern_to"===it?(this||w).patternTo:"u_pattern_from"===it?(this||w).patternFrom:"u_pixel_ratio_to"===it?(this||w).pixelRatioTo:"u_pixel_ratio_from"===it?(this||w).pixelRatioFrom:null;nt&&tt.set(nt)},za.prototype.getBinding=function(w,tt,et){return"u_pattern"===et.substr(0,9)?new lc(w,tt):new oc(w,tt)};var Ca=function(tt,et,rt,it){(this||w).expression=tt,(this||w).type=rt,(this||w).maxValue=0,(this||w).paintVertexAttributes=et.map((function(w){return{name:"a_"+w,type:"Float32",components:"color"===rt?2:1,offset:0}})),(this||w).paintVertexArray=new it};Ca.prototype.populatePaintArray=function(tt,et,rt,it,nt){var ot=(this||w).paintVertexArray.length,at=(this||w).expression.evaluate(new ai(0),et,{},it,[],nt);(this||w).paintVertexArray.resize(tt),this._setPaintValue(ot,tt,at)},Ca.prototype.updatePaintArray=function(tt,et,rt,it){var nt=(this||w).expression.evaluate({zoom:0},rt,it);this._setPaintValue(tt,et,nt)},Ca.prototype._setPaintValue=function(tt,et,rt){if("color"===(this||w).type)for(var it=ka(rt),nt=tt;nt<et;nt++)(this||w).paintVertexArray.emplace(nt,it[0],it[1]);else{for(var ot=tt;ot<et;ot++)(this||w).paintVertexArray.emplace(ot,rt);(this||w).maxValue=Math.max((this||w).maxValue,Math.abs(rt))}},Ca.prototype.upload=function(tt){(this||w).paintVertexArray&&(this||w).paintVertexArray.arrayBuffer&&((this||w).paintVertexBuffer&&(this||w).paintVertexBuffer.buffer?(this||w).paintVertexBuffer.updateData((this||w).paintVertexArray):(this||w).paintVertexBuffer=tt.createVertexBuffer((this||w).paintVertexArray,(this||w).paintVertexAttributes,(this||w).expression.isStateDependent))},Ca.prototype.destroy=function(){(this||w).paintVertexBuffer&&(this||w).paintVertexBuffer.destroy()};var Ma=function(tt,et,rt,it,nt,ot){(this||w).expression=tt,(this||w).uniformNames=et.map((function(w){return"u_"+w+"_t"})),(this||w).type=rt,(this||w).useIntegerZoom=it,(this||w).zoom=nt,(this||w).maxValue=0,(this||w).paintVertexAttributes=et.map((function(w){return{name:"a_"+w,type:"Float32",components:"color"===rt?4:2,offset:0}})),(this||w).paintVertexArray=new ot};Ma.prototype.populatePaintArray=function(tt,et,rt,it,nt){var ot=(this||w).expression.evaluate(new ai((this||w).zoom),et,{},it,[],nt),at=(this||w).expression.evaluate(new ai((this||w).zoom+1),et,{},it,[],nt),st=(this||w).paintVertexArray.length;(this||w).paintVertexArray.resize(tt),this._setPaintValue(st,tt,ot,at)},Ma.prototype.updatePaintArray=function(tt,et,rt,it){var nt=(this||w).expression.evaluate({zoom:(this||w).zoom},rt,it),ot=(this||w).expression.evaluate({zoom:(this||w).zoom+1},rt,it);this._setPaintValue(tt,et,nt,ot)},Ma.prototype._setPaintValue=function(tt,et,rt,it){if("color"===(this||w).type)for(var nt=ka(rt),ot=ka(it),at=tt;at<et;at++)(this||w).paintVertexArray.emplace(at,nt[0],nt[1],ot[0],ot[1]);else{for(var st=tt;st<et;st++)(this||w).paintVertexArray.emplace(st,rt,it);(this||w).maxValue=Math.max((this||w).maxValue,Math.abs(rt),Math.abs(it))}},Ma.prototype.upload=function(tt){(this||w).paintVertexArray&&(this||w).paintVertexArray.arrayBuffer&&((this||w).paintVertexBuffer&&(this||w).paintVertexBuffer.buffer?(this||w).paintVertexBuffer.updateData((this||w).paintVertexArray):(this||w).paintVertexBuffer=tt.createVertexBuffer((this||w).paintVertexArray,(this||w).paintVertexAttributes,(this||w).expression.isStateDependent))},Ma.prototype.destroy=function(){(this||w).paintVertexBuffer&&(this||w).paintVertexBuffer.destroy()},Ma.prototype.setUniform=function(tt,et){var rt=(this||w).useIntegerZoom?Math.floor(et.zoom):et.zoom,it=l((this||w).expression.interpolationFactor(rt,(this||w).zoom,(this||w).zoom+1),0,1);tt.set(it)},Ma.prototype.getBinding=function(w,tt,et){return new oc(w,tt)};var Ea=function(tt,et,rt,it,nt,ot){(this||w).expression=tt,(this||w).type=et,(this||w).useIntegerZoom=rt,(this||w).zoom=it,(this||w).layerId=ot,(this||w).zoomInPaintVertexArray=new nt,(this||w).zoomOutPaintVertexArray=new nt};Ea.prototype.populatePaintArray=function(tt,et,rt){var it=(this||w).zoomInPaintVertexArray.length;(this||w).zoomInPaintVertexArray.resize(tt),(this||w).zoomOutPaintVertexArray.resize(tt),this._setPaintValues(it,tt,et.patterns&&et.patterns[(this||w).layerId],rt)},Ea.prototype.updatePaintArray=function(tt,et,rt,it,nt){this._setPaintValues(tt,et,rt.patterns&&rt.patterns[(this||w).layerId],nt)},Ea.prototype._setPaintValues=function(tt,et,rt,it){if(it&&rt){var nt=it[rt.min],ot=it[rt.mid],at=it[rt.max];if(nt&&ot&&at)for(var st=tt;st<et;st++)(this||w).zoomInPaintVertexArray.emplace(st,ot.tl[0],ot.tl[1],ot.br[0],ot.br[1],nt.tl[0],nt.tl[1],nt.br[0],nt.br[1],ot.pixelRatio,nt.pixelRatio),(this||w).zoomOutPaintVertexArray.emplace(st,ot.tl[0],ot.tl[1],ot.br[0],ot.br[1],at.tl[0],at.tl[1],at.br[0],at.br[1],ot.pixelRatio,at.pixelRatio)}},Ea.prototype.upload=function(tt){(this||w).zoomInPaintVertexArray&&(this||w).zoomInPaintVertexArray.arrayBuffer&&(this||w).zoomOutPaintVertexArray&&(this||w).zoomOutPaintVertexArray.arrayBuffer&&((this||w).zoomInPaintVertexBuffer=tt.createVertexBuffer((this||w).zoomInPaintVertexArray,Tu.members,(this||w).expression.isStateDependent),(this||w).zoomOutPaintVertexBuffer=tt.createVertexBuffer((this||w).zoomOutPaintVertexArray,Tu.members,(this||w).expression.isStateDependent))},Ea.prototype.destroy=function(){(this||w).zoomOutPaintVertexBuffer&&(this||w).zoomOutPaintVertexBuffer.destroy(),(this||w).zoomInPaintVertexBuffer&&(this||w).zoomInPaintVertexBuffer.destroy()};var Ta=function(tt,et,rt){(this||w).binders={},(this||w)._buffers=[];var it=[];for(var nt in tt.paint._values)if(rt(nt)){var ot=tt.paint.get(nt);if(ot instanceof hi&&Tr(ot.property.specification)){var at=Ba(nt,tt.type),st=ot.value,ct=ot.property.specification.type,pt=ot.property.useIntegerZoom,ft=ot.property.specification["property-type"],dt="cross-faded"===ft||"cross-faded-data-driven"===ft;if("constant"===st.kind)(this||w).binders[nt]=dt?new za(st.value,at):new Ia(st.value,at,ct),it.push("/u_"+nt);else if("source"===st.kind||dt){var mt=Va(nt,ct,"source");(this||w).binders[nt]=dt?new Ea(st,ct,pt,et,mt,tt.id):new Ca(st,at,ct,mt),it.push("/a_"+nt)}else{var yt=Va(nt,ct,"composite");(this||w).binders[nt]=new Ma(st,at,ct,pt,et,yt),it.push("/z_"+nt)}}}(this||w).cacheKey=it.sort().join("")};Ta.prototype.getMaxValue=function(tt){var et=(this||w).binders[tt];return et instanceof Ca||et instanceof Ma?et.maxValue:0},Ta.prototype.populatePaintArrays=function(tt,et,rt,it,nt){for(var ot in(this||w).binders){var at=(this||w).binders[ot];(at instanceof Ca||at instanceof Ma||at instanceof Ea)&&at.populatePaintArray(tt,et,rt,it,nt)}},Ta.prototype.setConstantPatternPositions=function(tt,et){for(var rt in(this||w).binders){var it=(this||w).binders[rt];it instanceof za&&it.setConstantPatternPositions(tt,et)}},Ta.prototype.updatePaintArrays=function(tt,et,rt,it,nt){var ot=!1;for(var at in tt)for(var st=0,ct=et.getPositions(at);st<ct.length;st+=1){var pt=ct[st],ft=rt.feature(pt.index);for(var dt in(this||w).binders){var mt=(this||w).binders[dt];if((mt instanceof Ca||mt instanceof Ma||mt instanceof Ea)&&!0===mt.expression.isStateDependent){var yt=it.paint.get(dt);mt.expression=yt.value,mt.updatePaintArray(pt.start,pt.end,ft,tt[at],nt),ot=!0}}}return ot},Ta.prototype.defines=function(){var tt=[];for(var et in(this||w).binders){var rt=(this||w).binders[et];(rt instanceof Ia||rt instanceof za)&&tt.push.apply(tt,rt.uniformNames.map((function(w){return"#define HAS_UNIFORM_"+w})))}return tt},Ta.prototype.getBinderAttributes=function(){var tt=[];for(var et in(this||w).binders){var rt=(this||w).binders[et];if(rt instanceof Ca||rt instanceof Ma)for(var it=0;it<rt.paintVertexAttributes.length;it++)tt.push(rt.paintVertexAttributes[it].name);else if(rt instanceof Ea)for(var nt=0;nt<Tu.members.length;nt++)tt.push(Tu.members[nt].name)}return tt},Ta.prototype.getBinderUniforms=function(){var tt=[];for(var et in(this||w).binders){var rt=(this||w).binders[et];if(rt instanceof Ia||rt instanceof za||rt instanceof Ma)for(var it=0,nt=rt.uniformNames;it<nt.length;it+=1)tt.push(nt[it])}return tt},Ta.prototype.getPaintVertexBuffers=function(){return(this||w)._buffers},Ta.prototype.getUniforms=function(tt,et){var rt=[];for(var it in(this||w).binders){var nt=(this||w).binders[it];if(nt instanceof Ia||nt instanceof za||nt instanceof Ma)for(var ot=0,at=nt.uniformNames;ot<at.length;ot+=1){var st=at[ot];if(et[st]){var ct=nt.getBinding(tt,et[st],st);rt.push({name:st,property:it,binding:ct})}}}return rt},Ta.prototype.setUniforms=function(tt,et,rt,it){for(var nt=0,ot=et;nt<ot.length;nt+=1){var at=ot[nt],st=at.name,ct=at.property;(this||w).binders[ct].setUniform(at.binding,it,rt.get(ct),st)}},Ta.prototype.updatePaintBuffers=function(tt){for(var et in(this||w)._buffers=[],(this||w).binders){var rt=(this||w).binders[et];if(tt&&rt instanceof Ea){var it=2===tt.fromScale?rt.zoomInPaintVertexBuffer:rt.zoomOutPaintVertexBuffer;it&&(this||w)._buffers.push(it)}else(rt instanceof Ca||rt instanceof Ma)&&rt.paintVertexBuffer&&(this||w)._buffers.push(rt.paintVertexBuffer)}},Ta.prototype.upload=function(tt){for(var et in(this||w).binders){var rt=(this||w).binders[et];(rt instanceof Ca||rt instanceof Ma||rt instanceof Ea)&&rt.upload(tt)}this.updatePaintBuffers()},Ta.prototype.destroy=function(){for(var tt in(this||w).binders){var et=(this||w).binders[tt];(et instanceof Ca||et instanceof Ma||et instanceof Ea)&&et.destroy()}};var Pa=function(tt,et,rt){void 0===rt&&(rt=function(){return!0}),(this||w).programConfigurations={};for(var it=0,nt=tt;it<nt.length;it+=1){var ot=nt[it];(this||w).programConfigurations[ot.id]=new Ta(ot,et,rt)}(this||w).needsUpload=!1,(this||w)._featureMap=new ha,(this||w)._bufferOffset=0};function Ba(w,tt){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[w]||[w.replace(tt+"-","").replace(/-/g,"_")]}function Va(w,tt,et){var rt={color:{source:wl,composite:Sl},number:{source:gl,composite:wl}},it=function(w){return{"line-pattern":{source:Us,composite:Us},"fill-pattern":{source:Us,composite:Us},"fill-extrusion-pattern":{source:Us,composite:Us}}[w]}(w);return it&&it[et]||rt[tt][et]}Pa.prototype.populatePaintArrays=function(tt,et,rt,it,nt,ot){for(var at in(this||w).programConfigurations)(this||w).programConfigurations[at].populatePaintArrays(tt,et,it,nt,ot);void 0!==et.id&&(this||w)._featureMap.add(et.id,rt,(this||w)._bufferOffset,tt),(this||w)._bufferOffset=tt,(this||w).needsUpload=!0},Pa.prototype.updatePaintArrays=function(tt,et,rt,it){for(var nt=0,ot=rt;nt<ot.length;nt+=1){var at=ot[nt];(this||w).needsUpload=(this||w).programConfigurations[at.id].updatePaintArrays(tt,(this||w)._featureMap,et,at,it)||(this||w).needsUpload}},Pa.prototype.get=function(tt){return(this||w).programConfigurations[tt]},Pa.prototype.upload=function(tt){if((this||w).needsUpload){for(var et in(this||w).programConfigurations)(this||w).programConfigurations[et].upload(tt);(this||w).needsUpload=!1}},Pa.prototype.destroy=function(){for(var tt in(this||w).programConfigurations)(this||w).programConfigurations[tt].destroy()},Dn("ConstantBinder",Ia),Dn("CrossFadedConstantBinder",za),Dn("SourceExpressionBinder",Ca),Dn("CrossFadedCompositeBinder",Ea),Dn("CompositeExpressionBinder",Ma),Dn("ProgramConfiguration",Ta,{omit:["_buffers"]}),Dn("ProgramConfigurationSet",Pa);var hc=Math.pow(2,14)-1,fc=-hc-1;function La(w){for(var tt=8192/w.extent,et=w.loadGeometry(),rt=0;rt<et.length;rt++)for(var it=et[rt],nt=0;nt<it.length;nt++){var ot=it[nt],at=Math.round(ot.x*tt),st=Math.round(ot.y*tt);ot.x=l(at,fc,hc),ot.y=l(st,fc,hc),(at<ot.x||at>ot.x+1||st<ot.y||st>ot.y+1)&&_("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return et}function Ra(w,tt,et,rt,it){w.emplaceBack(2*tt+(rt+1)/2,2*et+(it+1)/2)}var Oa=function(tt){(this||w).zoom=tt.zoom,(this||w).overscaling=tt.overscaling,(this||w).layers=tt.layers,(this||w).layerIds=(this||w).layers.map((function(w){return w.id})),(this||w).index=tt.index,(this||w).hasPattern=!1,(this||w).layoutVertexArray=new Rs,(this||w).indexArray=new sl,(this||w).segments=new aa,(this||w).programConfigurations=new Pa(tt.layers,tt.zoom),(this||w).stateDependentLayerIds=(this||w).layers.filter((function(w){return w.isStateDependent()})).map((function(w){return w.id}))};function Ua(w,tt){for(var et=0;et<w.length;et++)if(Ha(tt,w[et]))return!0;for(var rt=0;rt<tt.length;rt++)if(Ha(w,tt[rt]))return!0;return!!Ka(w,tt)}function ja(w,tt,et){return!!Ha(w,tt)||!!Za(tt,w,et)}function qa(w,tt){if(1===w.length)return Ja(tt,w[0]);for(var et=0;et<tt.length;et++)for(var rt=tt[et],it=0;it<rt.length;it++)if(Ha(w,rt[it]))return!0;for(var nt=0;nt<w.length;nt++)if(Ja(tt,w[nt]))return!0;for(var ot=0;ot<tt.length;ot++)if(Ka(w,tt[ot]))return!0;return!1}function Na(w,tt,et){if(w.length>1){if(Ka(w,tt))return!0;for(var rt=0;rt<tt.length;rt++)if(Za(tt[rt],w,et))return!0}for(var it=0;it<w.length;it++)if(Za(w[it],tt,et))return!0;return!1}function Ka(w,tt){if(0===w.length||0===tt.length)return!1;for(var et=0;et<w.length-1;et++)for(var rt=w[et],it=w[et+1],nt=0;nt<tt.length-1;nt++)if(Ga(rt,it,tt[nt],tt[nt+1]))return!0;return!1}function Ga(w,tt,et,rt){return A(w,et,rt)!==A(tt,et,rt)&&A(w,tt,et)!==A(w,tt,rt)}function Za(w,tt,et){var rt=et*et;if(1===tt.length)return w.distSqr(tt[0])<rt;for(var it=1;it<tt.length;it++)if(Xa(w,tt[it-1],tt[it])<rt)return!0;return!1}function Xa(w,tt,et){var rt=tt.distSqr(et);if(0===rt)return w.distSqr(tt);var it=((w.x-tt.x)*(et.x-tt.x)+(w.y-tt.y)*(et.y-tt.y))/rt;return w.distSqr(it<0?tt:it>1?et:et.sub(tt)._mult(it)._add(tt))}function Ja(w,tt){for(var et,rt,it,nt=!1,ot=0;ot<w.length;ot++)for(var at=0,st=(et=w[ot]).length-1;at<et.length;st=at++)(rt=et[at]).y>tt.y!=(it=et[st]).y>tt.y&&tt.x<(it.x-rt.x)*(tt.y-rt.y)/(it.y-rt.y)+rt.x&&(nt=!nt);return nt}function Ha(w,tt){for(var et=!1,rt=0,it=w.length-1;rt<w.length;it=rt++){var nt=w[rt],ot=w[it];nt.y>tt.y!=ot.y>tt.y&&tt.x<(ot.x-nt.x)*(tt.y-nt.y)/(ot.y-nt.y)+nt.x&&(et=!et)}return et}function Ya(w,tt,et){var rt=et[0],it=et[2];if(w.x<rt.x&&tt.x<rt.x||w.x>it.x&&tt.x>it.x||w.y<rt.y&&tt.y<rt.y||w.y>it.y&&tt.y>it.y)return!1;var nt=A(w,tt,et[0]);return nt!==A(w,tt,et[1])||nt!==A(w,tt,et[2])||nt!==A(w,tt,et[3])}function $a(w,tt,et){var rt=tt.paint.get(w).value;return"constant"===rt.kind?rt.value:et.programConfigurations.get(tt.id).getMaxValue(w)}function Wa(w){return Math.sqrt(w[0]*w[0]+w[1]*w[1])}function Qa(w,tt,et,it,nt){if(!tt[0]&&!tt[1])return w;var ot=rt.convert(tt)._mult(nt);"viewport"===et&&ot._rotate(-it);for(var at=[],st=0;st<w.length;st++)at.push(w[st].sub(ot));return at}Oa.prototype.populate=function(tt,et,rt){var it=(this||w).layers[0],nt=[],ot=null;"circle"===it.type&&(ot=it.layout.get("circle-sort-key"));for(var at=0,st=tt;at<st.length;at+=1){var ct=st[at],pt=ct.feature,ft=ct.id,dt=ct.index,mt=ct.sourceLayerIndex,yt=(this||w).layers[0]._featureFilter.needGeometry,vt={type:pt.type,id:ft,properties:pt.properties,geometry:yt?La(pt):[]};if((this||w).layers[0]._featureFilter.filter(new ai((this||w).zoom),vt,rt)){yt||(vt.geometry=La(pt));var Dt=ot?ot.evaluate(vt,{},rt):void 0;nt.push({id:ft,properties:pt.properties,type:pt.type,sourceLayerIndex:mt,index:dt,geometry:vt.geometry,patterns:{},sortKey:Dt})}}ot&&nt.sort((function(w,tt){return w.sortKey-tt.sortKey}));for(var Rt=0,Bt=nt;Rt<Bt.length;Rt+=1){var Ot=Bt[Rt],Ne=Ot.geometry,Ze=Ot.index,Ge=Ot.sourceLayerIndex,Ke=tt[Ze].feature;this.addFeature(Ot,Ne,Ze,rt),et.featureIndex.insert(Ke,Ne,Ze,Ge,(this||w).index)}},Oa.prototype.update=function(tt,et,rt){(this||w).stateDependentLayers.length&&(this||w).programConfigurations.updatePaintArrays(tt,et,(this||w).stateDependentLayers,rt)},Oa.prototype.isEmpty=function(){return 0===(this||w).layoutVertexArray.length},Oa.prototype.uploadPending=function(){return!(this||w).uploaded||(this||w).programConfigurations.needsUpload},Oa.prototype.upload=function(tt){(this||w).uploaded||((this||w).layoutVertexBuffer=tt.createVertexBuffer((this||w).layoutVertexArray,wu),(this||w).indexBuffer=tt.createIndexBuffer((this||w).indexArray)),(this||w).programConfigurations.upload(tt),(this||w).uploaded=!0},Oa.prototype.destroy=function(){(this||w).layoutVertexBuffer&&((this||w).layoutVertexBuffer.destroy(),(this||w).indexBuffer.destroy(),(this||w).programConfigurations.destroy(),(this||w).segments.destroy())},Oa.prototype.addFeature=function(tt,et,rt,it){for(var nt=0,ot=et;nt<ot.length;nt+=1)for(var at=0,st=ot[nt];at<st.length;at+=1){var ct=st[at],pt=ct.x,ft=ct.y;if(!(pt<0||pt>=8192||ft<0||ft>=8192)){var dt=(this||w).segments.prepareSegment(4,(this||w).layoutVertexArray,(this||w).indexArray,tt.sortKey),mt=dt.vertexLength;Ra((this||w).layoutVertexArray,pt,ft,-1,-1),Ra((this||w).layoutVertexArray,pt,ft,1,-1),Ra((this||w).layoutVertexArray,pt,ft,1,1),Ra((this||w).layoutVertexArray,pt,ft,-1,1),(this||w).indexArray.emplaceBack(mt,mt+1,mt+2),(this||w).indexArray.emplaceBack(mt,mt+3,mt+2),dt.vertexLength+=4,dt.primitiveLength+=2}}(this||w).programConfigurations.populatePaintArrays((this||w).layoutVertexArray.length,tt,rt,{},it)},Dn("CircleBucket",Oa,{omit:["layers"]});var dc=new xi({"circle-sort-key":new di(Cn.layout_circle["circle-sort-key"])}),mc={paint:new xi({"circle-radius":new di(Cn.paint_circle["circle-radius"]),"circle-color":new di(Cn.paint_circle["circle-color"]),"circle-blur":new di(Cn.paint_circle["circle-blur"]),"circle-opacity":new di(Cn.paint_circle["circle-opacity"]),"circle-translate":new yi(Cn.paint_circle["circle-translate"]),"circle-translate-anchor":new yi(Cn.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new yi(Cn.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new yi(Cn.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new di(Cn.paint_circle["circle-stroke-width"]),"circle-stroke-color":new di(Cn.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new di(Cn.paint_circle["circle-stroke-opacity"])}),layout:dc},yc="undefined"!=typeof Float32Array?Float32Array:Array;function no(w){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function io(w,tt,et){var rt=tt[0],it=tt[1],nt=tt[2],ot=tt[3],at=tt[4],st=tt[5],ct=tt[6],pt=tt[7],ft=tt[8],dt=tt[9],mt=tt[10],yt=tt[11],vt=tt[12],Dt=tt[13],Rt=tt[14],Bt=tt[15],Ot=et[0],Ne=et[1],Ze=et[2],Ge=et[3];return w[0]=Ot*rt+Ne*at+Ze*ft+Ge*vt,w[1]=Ot*it+Ne*st+Ze*dt+Ge*Dt,w[2]=Ot*nt+Ne*ct+Ze*mt+Ge*Rt,w[3]=Ot*ot+Ne*pt+Ze*yt+Ge*Bt,w[4]=(Ot=et[4])*rt+(Ne=et[5])*at+(Ze=et[6])*ft+(Ge=et[7])*vt,w[5]=Ot*it+Ne*st+Ze*dt+Ge*Dt,w[6]=Ot*nt+Ne*ct+Ze*mt+Ge*Rt,w[7]=Ot*ot+Ne*pt+Ze*yt+Ge*Bt,w[8]=(Ot=et[8])*rt+(Ne=et[9])*at+(Ze=et[10])*ft+(Ge=et[11])*vt,w[9]=Ot*it+Ne*st+Ze*dt+Ge*Dt,w[10]=Ot*nt+Ne*ct+Ze*mt+Ge*Rt,w[11]=Ot*ot+Ne*pt+Ze*yt+Ge*Bt,w[12]=(Ot=et[12])*rt+(Ne=et[13])*at+(Ze=et[14])*ft+(Ge=et[15])*vt,w[13]=Ot*it+Ne*st+Ze*dt+Ge*Dt,w[14]=Ot*nt+Ne*ct+Ze*mt+Ge*Rt,w[15]=Ot*ot+Ne*pt+Ze*yt+Ge*Bt,w}Math.hypot||(Math.hypot=function(){for(var w=arguments,tt=0,et=arguments.length;et--;)tt+=w[et]*w[et];return Math.sqrt(tt)});var gc,_c=io;function so(w,tt,et){var rt=tt[0],it=tt[1],nt=tt[2],ot=tt[3];return w[0]=et[0]*rt+et[4]*it+et[8]*nt+et[12]*ot,w[1]=et[1]*rt+et[5]*it+et[9]*nt+et[13]*ot,w[2]=et[2]*rt+et[6]*it+et[10]*nt+et[14]*ot,w[3]=et[3]*rt+et[7]*it+et[11]*nt+et[15]*ot,w}gc=new yc(3),yc!=Float32Array&&(gc[0]=0,gc[1]=0,gc[2]=0),function(){var w=new yc(4);yc!=Float32Array&&(w[0]=0,w[1]=0,w[2]=0,w[3]=0)}();var vc=(function(){var w=new yc(2);yc!=Float32Array&&(w[0]=0,w[1]=0)}(),function(tt){function e(et){tt.call(this||w,et,mc)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.createBucket=function(w){return new Oa(w)},e.prototype.queryRadius=function(tt){var et=tt;return $a("circle-radius",this||w,et)+$a("circle-stroke-width",this||w,et)+Wa((this||w).paint.get("circle-translate"))},e.prototype.queryIntersectsFeature=function(tt,et,rt,it,nt,ot,at,st){for(var ct=Qa(tt,(this||w).paint.get("circle-translate"),(this||w).paint.get("circle-translate-anchor"),ot.angle,at),pt=(this||w).paint.get("circle-radius").evaluate(et,rt)+(this||w).paint.get("circle-stroke-width").evaluate(et,rt),ft="map"===(this||w).paint.get("circle-pitch-alignment"),dt=ft?ct:function(w,tt){return w.map((function(w){return lo(w,tt)}))}(ct,st),mt=ft?pt*at:pt,yt=0,vt=it;yt<vt.length;yt+=1)for(var Dt=0,Rt=vt[yt];Dt<Rt.length;Dt+=1){var Bt=Rt[Dt],Ot=ft?Bt:lo(Bt,st),Ne=mt,Ze=so([],[Bt.x,Bt.y,0,1],st);if("viewport"===(this||w).paint.get("circle-pitch-scale")&&"map"===(this||w).paint.get("circle-pitch-alignment")?Ne*=Ze[3]/ot.cameraToCenterDistance:"map"===(this||w).paint.get("circle-pitch-scale")&&"viewport"===(this||w).paint.get("circle-pitch-alignment")&&(Ne*=ot.cameraToCenterDistance/Ze[3]),ja(dt,Ot,Ne))return!0}return!1},e}(Ms));function lo(w,tt){var et=so([],[w.x,w.y,0,1],tt);return new rt(et[0]/et[3],et[1]/et[3])}var xc=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e}(Oa);function co(w,tt,et,rt){var it=tt.width,nt=tt.height;if(rt){if(rt instanceof Uint8ClampedArray)rt=new Uint8Array(rt.buffer);else if(rt.length!==it*nt*et)throw new RangeError("mismatched image size")}else rt=new Uint8Array(it*nt*et);return w.width=it,w.height=nt,w.data=rt,w}function ho(w,tt,et){var rt=tt.width,it=tt.height;if(rt!==w.width||it!==w.height){var nt=co({},{width:rt,height:it},et);fo(w,nt,{x:0,y:0},{x:0,y:0},{width:Math.min(w.width,rt),height:Math.min(w.height,it)},et),w.width=rt,w.height=it,w.data=nt.data}}function fo(w,tt,et,rt,it,nt){if(0===it.width||0===it.height)return tt;if(it.width>w.width||it.height>w.height||et.x>w.width-it.width||et.y>w.height-it.height)throw new RangeError("out of range source coordinates for image copy");if(it.width>tt.width||it.height>tt.height||rt.x>tt.width-it.width||rt.y>tt.height-it.height)throw new RangeError("out of range destination coordinates for image copy");for(var ot=w.data,at=tt.data,st=0;st<it.height;st++)for(var ct=((et.y+st)*w.width+et.x)*nt,pt=((rt.y+st)*tt.width+rt.x)*nt,ft=0;ft<it.width*nt;ft++)at[pt+ft]=ot[ct+ft];return tt}Dn("HeatmapBucket",xc,{omit:["layers"]});var yo=function(tt,et){co(this||w,tt,1,et)};yo.prototype.resize=function(tt){ho(this||w,tt,1)},yo.prototype.clone=function(){return new yo({width:(this||w).width,height:(this||w).height},new Uint8Array((this||w).data))},yo.copy=function(w,tt,et,rt,it){fo(w,tt,et,rt,it,1)};var mo=function(tt,et){co(this||w,tt,4,et)};mo.prototype.resize=function(tt){ho(this||w,tt,4)},mo.prototype.replace=function(tt,et){et?(this||w).data.set(tt):(this||w).data=tt instanceof Uint8ClampedArray?new Uint8Array(tt.buffer):tt},mo.prototype.clone=function(){return new mo({width:(this||w).width,height:(this||w).height},new Uint8Array((this||w).data))},mo.copy=function(w,tt,et,rt,it){fo(w,tt,et,rt,it,4)},Dn("AlphaImage",yo),Dn("RGBAImage",mo);var bc={paint:new xi({"heatmap-radius":new di(Cn.paint_heatmap["heatmap-radius"]),"heatmap-weight":new di(Cn.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new yi(Cn.paint_heatmap["heatmap-intensity"]),"heatmap-color":new gi(Cn.paint_heatmap["heatmap-color"]),"heatmap-opacity":new yi(Cn.paint_heatmap["heatmap-opacity"])})};function go(w,tt){for(var et=new Uint8Array(1024),rt={},it=0,nt=0;it<256;it++,nt+=4){rt[tt]=it/255;var ot=w.evaluate(rt);et[nt+0]=Math.floor(255*ot.r/ot.a),et[nt+1]=Math.floor(255*ot.g/ot.a),et[nt+2]=Math.floor(255*ot.b/ot.a),et[nt+3]=Math.floor(255*ot.a)}return new mo({width:256,height:1},et)}var wc=function(tt){function e(et){tt.call(this||w,et,bc),this._updateColorRamp()}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.createBucket=function(w){return new xc(w)},e.prototype._handleSpecialPaintPropertyUpdate=function(w){"heatmap-color"===w&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){(this||w).colorRamp=go((this||w)._transitionablePaint._values["heatmap-color"].value.expression,"heatmapDensity"),(this||w).colorRampTexture=null},e.prototype.resize=function(){(this||w).heatmapFbo&&((this||w).heatmapFbo.destroy(),(this||w).heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return 0!==(this||w).paint.get("heatmap-opacity")&&"none"!==(this||w).visibility},e}(Ms),Sc={paint:new xi({"hillshade-illumination-direction":new yi(Cn.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new yi(Cn.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new yi(Cn.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new yi(Cn.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new yi(Cn.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new yi(Cn.paint_hillshade["hillshade-accent-color"])})},Tc=function(tt){function e(et){tt.call(this||w,et,Sc)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.hasOffscreenPass=function(){return 0!==(this||w).paint.get("hillshade-exaggeration")&&"none"!==(this||w).visibility},e}(Ms),Ic=Si([{name:"a_pos",components:2,type:"Int16"}],4).members,Ec=ko,Ac=ko;function ko(w,tt,et){et=et||2;var rt,it,nt,ot,at,st,ct,pt=tt&&tt.length,ft=pt?tt[0]*et:w.length,dt=Io(w,0,ft,et,!0),mt=[];if(!dt||dt.next===dt.prev)return mt;if(pt&&(dt=function(w,tt,et,rt){var it,nt,ot,at=[];for(it=0,nt=tt.length;it<nt;it++)(ot=Io(w,tt[it]*rt,it<nt-1?tt[it+1]*rt:w.length,rt,!1))===ot.next&&(ot.steiner=!0),at.push(Lo(ot));for(at.sort(Bo),it=0;it<at.length;it++)Vo(at[it],et),et=zo(et,et.next);return et}(w,tt,dt,et)),w.length>80*et){rt=nt=w[0],it=ot=w[1];for(var yt=et;yt<ft;yt+=et)(at=w[yt])<rt&&(rt=at),(st=w[yt+1])<it&&(it=st),at>nt&&(nt=at),st>ot&&(ot=st);ct=0!==(ct=Math.max(nt-rt,ot-it))?1/ct:0}return Co(dt,mt,et,rt,it,ct),mt}function Io(w,tt,et,rt,it){var nt,ot;if(it===Yo(w,tt,et,rt)>0)for(nt=tt;nt<et;nt+=rt)ot=Xo(nt,w[nt],w[nt+1],ot);else for(nt=et-rt;nt>=tt;nt-=rt)ot=Xo(nt,w[nt],w[nt+1],ot);return ot&&jo(ot,ot.next)&&(Jo(ot),ot=ot.next),ot}function zo(w,tt){if(!w)return w;tt||(tt=w);var et,rt=w;do{if(et=!1,rt.steiner||!jo(rt,rt.next)&&0!==Uo(rt.prev,rt,rt.next))rt=rt.next;else{if(Jo(rt),(rt=tt=rt.prev)===rt.next)break;et=!0}}while(et||rt!==tt);return tt}function Co(w,tt,et,rt,it,nt,ot){if(w){!ot&&nt&&function(w,tt,et,rt){var it=w;do{null===it.z&&(it.z=Do(it.x,it.y,tt,et,rt)),it.prevZ=it.prev,it.nextZ=it.next,it=it.next}while(it!==w);it.prevZ.nextZ=null,it.prevZ=null,function(w){var tt,et,rt,it,nt,ot,at,st,ct=1;do{for(et=w,w=null,nt=null,ot=0;et;){for(ot++,rt=et,at=0,tt=0;tt<ct&&(at++,rt=rt.nextZ);tt++);for(st=ct;at>0||st>0&&rt;)0!==at&&(0===st||!rt||et.z<=rt.z)?(it=et,et=et.nextZ,at--):(it=rt,rt=rt.nextZ,st--),nt?nt.nextZ=it:w=it,it.prevZ=nt,nt=it;et=rt}nt.nextZ=null,ct*=2}while(ot>1)}(it)}(w,rt,it,nt);for(var at,st,ct=w;w.prev!==w.next;)if(at=w.prev,st=w.next,nt?Eo(w,rt,it,nt):Mo(w))tt.push(at.i/et),tt.push(w.i/et),tt.push(st.i/et),Jo(w),w=st.next,ct=st.next;else if((w=st)===ct){ot?1===ot?Co(w=To(zo(w),tt,et),tt,et,rt,it,nt,2):2===ot&&Po(w,tt,et,rt,it,nt):Co(zo(w),tt,et,rt,it,nt,1);break}}}function Mo(w){var tt=w.prev,et=w,rt=w.next;if(Uo(tt,et,rt)>=0)return!1;for(var it=w.next.next;it!==w.prev;){if(Ro(tt.x,tt.y,et.x,et.y,rt.x,rt.y,it.x,it.y)&&Uo(it.prev,it,it.next)>=0)return!1;it=it.next}return!0}function Eo(w,tt,et,rt){var it=w.prev,nt=w,ot=w.next;if(Uo(it,nt,ot)>=0)return!1;for(var at=it.x>nt.x?it.x>ot.x?it.x:ot.x:nt.x>ot.x?nt.x:ot.x,st=it.y>nt.y?it.y>ot.y?it.y:ot.y:nt.y>ot.y?nt.y:ot.y,ct=Do(it.x<nt.x?it.x<ot.x?it.x:ot.x:nt.x<ot.x?nt.x:ot.x,it.y<nt.y?it.y<ot.y?it.y:ot.y:nt.y<ot.y?nt.y:ot.y,tt,et,rt),pt=Do(at,st,tt,et,rt),ft=w.prevZ,dt=w.nextZ;ft&&ft.z>=ct&&dt&&dt.z<=pt;){if(ft!==w.prev&&ft!==w.next&&Ro(it.x,it.y,nt.x,nt.y,ot.x,ot.y,ft.x,ft.y)&&Uo(ft.prev,ft,ft.next)>=0)return!1;if(ft=ft.prevZ,dt!==w.prev&&dt!==w.next&&Ro(it.x,it.y,nt.x,nt.y,ot.x,ot.y,dt.x,dt.y)&&Uo(dt.prev,dt,dt.next)>=0)return!1;dt=dt.nextZ}for(;ft&&ft.z>=ct;){if(ft!==w.prev&&ft!==w.next&&Ro(it.x,it.y,nt.x,nt.y,ot.x,ot.y,ft.x,ft.y)&&Uo(ft.prev,ft,ft.next)>=0)return!1;ft=ft.prevZ}for(;dt&&dt.z<=pt;){if(dt!==w.prev&&dt!==w.next&&Ro(it.x,it.y,nt.x,nt.y,ot.x,ot.y,dt.x,dt.y)&&Uo(dt.prev,dt,dt.next)>=0)return!1;dt=dt.nextZ}return!0}function To(w,tt,et){var rt=w;do{var it=rt.prev,nt=rt.next.next;!jo(it,nt)&&qo(it,rt,rt.next,nt)&&Go(it,nt)&&Go(nt,it)&&(tt.push(it.i/et),tt.push(rt.i/et),tt.push(nt.i/et),Jo(rt),Jo(rt.next),rt=w=nt),rt=rt.next}while(rt!==w);return zo(rt)}function Po(w,tt,et,rt,it,nt){var ot=w;do{for(var at=ot.next.next;at!==ot.prev;){if(ot.i!==at.i&&Oo(ot,at)){var st=Zo(ot,at);return ot=zo(ot,ot.next),st=zo(st,st.next),Co(ot,tt,et,rt,it,nt),void Co(st,tt,et,rt,it,nt)}at=at.next}ot=ot.next}while(ot!==w)}function Bo(w,tt){return w.x-tt.x}function Vo(w,tt){if(tt=function(w,tt){var et,rt=tt,it=w.x,nt=w.y,ot=-1/0;do{if(nt<=rt.y&&nt>=rt.next.y&&rt.next.y!==rt.y){var at=rt.x+(nt-rt.y)*(rt.next.x-rt.x)/(rt.next.y-rt.y);if(at<=it&&at>ot){if(ot=at,at===it){if(nt===rt.y)return rt;if(nt===rt.next.y)return rt.next}et=rt.x<rt.next.x?rt:rt.next}}rt=rt.next}while(rt!==tt);if(!et)return null;if(it===ot)return et;var st,ct=et,pt=et.x,ft=et.y,dt=1/0;rt=et;do{it>=rt.x&&rt.x>=pt&&it!==rt.x&&Ro(nt<ft?it:ot,nt,pt,ft,nt<ft?ot:it,nt,rt.x,rt.y)&&(st=Math.abs(nt-rt.y)/(it-rt.x),Go(rt,w)&&(st<dt||st===dt&&(rt.x>et.x||rt.x===et.x&&Fo(et,rt)))&&(et=rt,dt=st)),rt=rt.next}while(rt!==ct);return et}(w,tt)){var et=Zo(tt,w);zo(tt,tt.next),zo(et,et.next)}}function Fo(w,tt){return Uo(w.prev,w,tt.prev)<0&&Uo(tt.next,w,w.next)<0}function Do(w,tt,et,rt,it){return(w=1431655765&((w=858993459&((w=252645135&((w=16711935&((w=32767*(w-et)*it)|w<<8))|w<<4))|w<<2))|w<<1))|(tt=1431655765&((tt=858993459&((tt=252645135&((tt=16711935&((tt=32767*(tt-rt)*it)|tt<<8))|tt<<4))|tt<<2))|tt<<1))<<1}function Lo(w){var tt=w,et=w;do{(tt.x<et.x||tt.x===et.x&&tt.y<et.y)&&(et=tt),tt=tt.next}while(tt!==w);return et}function Ro(w,tt,et,rt,it,nt,ot,at){return(it-ot)*(tt-at)-(w-ot)*(nt-at)>=0&&(w-ot)*(rt-at)-(et-ot)*(tt-at)>=0&&(et-ot)*(nt-at)-(it-ot)*(rt-at)>=0}function Oo(w,tt){return w.next.i!==tt.i&&w.prev.i!==tt.i&&!function(w,tt){var et=w;do{if(et.i!==w.i&&et.next.i!==w.i&&et.i!==tt.i&&et.next.i!==tt.i&&qo(et,et.next,w,tt))return!0;et=et.next}while(et!==w);return!1}(w,tt)&&(Go(w,tt)&&Go(tt,w)&&function(w,tt){var et=w,rt=!1,it=(w.x+tt.x)/2,nt=(w.y+tt.y)/2;do{et.y>nt!=et.next.y>nt&&et.next.y!==et.y&&it<(et.next.x-et.x)*(nt-et.y)/(et.next.y-et.y)+et.x&&(rt=!rt),et=et.next}while(et!==w);return rt}(w,tt)&&(Uo(w.prev,w,tt.prev)||Uo(w,tt.prev,tt))||jo(w,tt)&&Uo(w.prev,w,w.next)>0&&Uo(tt.prev,tt,tt.next)>0)}function Uo(w,tt,et){return(tt.y-w.y)*(et.x-tt.x)-(tt.x-w.x)*(et.y-tt.y)}function jo(w,tt){return w.x===tt.x&&w.y===tt.y}function qo(w,tt,et,rt){var it=Ko(Uo(w,tt,et)),nt=Ko(Uo(w,tt,rt)),ot=Ko(Uo(et,rt,w)),at=Ko(Uo(et,rt,tt));return it!==nt&&ot!==at||!(0!==it||!No(w,et,tt))||!(0!==nt||!No(w,rt,tt))||!(0!==ot||!No(et,w,rt))||!(0!==at||!No(et,tt,rt))}function No(w,tt,et){return tt.x<=Math.max(w.x,et.x)&&tt.x>=Math.min(w.x,et.x)&&tt.y<=Math.max(w.y,et.y)&&tt.y>=Math.min(w.y,et.y)}function Ko(w){return w>0?1:w<0?-1:0}function Go(w,tt){return Uo(w.prev,w,w.next)<0?Uo(w,tt,w.next)>=0&&Uo(w,w.prev,tt)>=0:Uo(w,tt,w.prev)<0||Uo(w,w.next,tt)<0}function Zo(w,tt){var et=new Ho(w.i,w.x,w.y),rt=new Ho(tt.i,tt.x,tt.y),it=w.next,nt=tt.prev;return w.next=tt,tt.prev=w,et.next=it,it.prev=et,rt.next=et,et.prev=rt,nt.next=rt,rt.prev=nt,rt}function Xo(w,tt,et,rt){var it=new Ho(w,tt,et);return rt?(it.next=rt.next,it.prev=rt,rt.next.prev=it,rt.next=it):(it.prev=it,it.next=it),it}function Jo(w){w.next.prev=w.prev,w.prev.next=w.next,w.prevZ&&(w.prevZ.nextZ=w.nextZ),w.nextZ&&(w.nextZ.prevZ=w.prevZ)}function Ho(tt,et,rt){(this||w).i=tt,(this||w).x=et,(this||w).y=rt,(this||w).prev=null,(this||w).next=null,(this||w).z=null,(this||w).prevZ=null,(this||w).nextZ=null,(this||w).steiner=!1}function Yo(w,tt,et,rt){for(var it=0,nt=tt,ot=et-rt;nt<et;nt+=rt)it+=(w[ot]-w[nt])*(w[nt+1]+w[ot+1]),ot=nt;return it}function $o(w,tt,et,rt,it){!function t(w,tt,et,rt,it){for(;rt>et;){if(rt-et>600){var nt=rt-et+1,ot=tt-et+1,at=Math.log(nt),st=.5*Math.exp(2*at/3),ct=.5*Math.sqrt(at*st*(nt-st)/nt)*(ot-nt/2<0?-1:1);t(w,tt,Math.max(et,Math.floor(tt-ot*st/nt+ct)),Math.min(rt,Math.floor(tt+(nt-ot)*st/nt+ct)),it)}var pt=w[tt],ft=et,dt=rt;for(Wo(w,et,tt),it(w[rt],pt)>0&&Wo(w,et,rt);ft<dt;){for(Wo(w,ft,dt),ft++,dt--;it(w[ft],pt)<0;)ft++;for(;it(w[dt],pt)>0;)dt--}0===it(w[et],pt)?Wo(w,et,dt):Wo(w,++dt,rt),dt<=tt&&(et=dt+1),tt<=dt&&(rt=dt-1)}}(w,tt,et||0,rt||w.length-1,it||Qo)}function Wo(w,tt,et){var rt=w[tt];w[tt]=w[et],w[et]=rt}function Qo(w,tt){return w<tt?-1:w>tt?1:0}function ts(w,tt){var et=w.length;if(et<=1)return[w];for(var rt,it,nt=[],ot=0;ot<et;ot++){var at=S(w[ot]);0!==at&&(w[ot].area=Math.abs(at),void 0===it&&(it=at<0),it===at<0?(rt&&nt.push(rt),rt=[w[ot]]):rt.push(w[ot]))}if(rt&&nt.push(rt),tt>1)for(var st=0;st<nt.length;st++)nt[st].length<=tt||($o(nt[st],tt,1,nt[st].length-1,es),nt[st]=nt[st].slice(0,tt));return nt}function es(w,tt){return tt.area-w.area}function rs(w,tt,et){for(var rt=et.patternDependencies,it=!1,nt=0,ot=tt;nt<ot.length;nt+=1){var at=ot[nt].paint.get(w+"-pattern");at.isConstant()||(it=!0);var st=at.constantOr(null);st&&(it=!0,rt[st.to]=!0,rt[st.from]=!0)}return it}function ns(w,tt,et,rt,it){for(var nt=it.patternDependencies,ot=0,at=tt;ot<at.length;ot+=1){var st=at[ot],ct=st.paint.get(w+"-pattern").value;if("constant"!==ct.kind){var pt=ct.evaluate({zoom:rt-1},et,{},it.availableImages),ft=ct.evaluate({zoom:rt},et,{},it.availableImages),dt=ct.evaluate({zoom:rt+1},et,{},it.availableImages);ft=ft&&ft.name?ft.name:ft,dt=dt&&dt.name?dt.name:dt,nt[pt=pt&&pt.name?pt.name:pt]=!0,nt[ft]=!0,nt[dt]=!0,et.patterns[st.id]={min:pt,mid:ft,max:dt}}}return et}ko.deviation=function(w,tt,et,rt){var it=tt&&tt.length,nt=Math.abs(Yo(w,0,it?tt[0]*et:w.length,et));if(it)for(var ot=0,at=tt.length;ot<at;ot++)nt-=Math.abs(Yo(w,tt[ot]*et,ot<at-1?tt[ot+1]*et:w.length,et));var st=0;for(ot=0;ot<rt.length;ot+=3){var ct=rt[ot]*et,pt=rt[ot+1]*et,ft=rt[ot+2]*et;st+=Math.abs((w[ct]-w[ft])*(w[pt+1]-w[ct+1])-(w[ct]-w[pt])*(w[ft+1]-w[ct+1]))}return 0===nt&&0===st?0:Math.abs((st-nt)/nt)},ko.flatten=function(w){for(var tt=w[0][0].length,et={vertices:[],holes:[],dimensions:tt},rt=0,it=0;it<w.length;it++){for(var nt=0;nt<w[it].length;nt++)for(var ot=0;ot<tt;ot++)et.vertices.push(w[it][nt][ot]);it>0&&et.holes.push(rt+=w[it-1].length)}return et},Ec.default=Ac;var is=function(tt){(this||w).zoom=tt.zoom,(this||w).overscaling=tt.overscaling,(this||w).layers=tt.layers,(this||w).layerIds=(this||w).layers.map((function(w){return w.id})),(this||w).index=tt.index,(this||w).hasPattern=!1,(this||w).patternFeatures=[],(this||w).layoutVertexArray=new Rs,(this||w).indexArray=new sl,(this||w).indexArray2=new xl,(this||w).programConfigurations=new Pa(tt.layers,tt.zoom),(this||w).segments=new aa,(this||w).segments2=new aa,(this||w).stateDependentLayerIds=(this||w).layers.filter((function(w){return w.isStateDependent()})).map((function(w){return w.id}))};is.prototype.populate=function(tt,et,rt){(this||w).hasPattern=rs("fill",(this||w).layers,et);for(var it=(this||w).layers[0].layout.get("fill-sort-key"),nt=[],ot=0,at=tt;ot<at.length;ot+=1){var st=at[ot],ct=st.feature,pt=st.id,ft=st.index,dt=st.sourceLayerIndex,mt=(this||w).layers[0]._featureFilter.needGeometry,yt={type:ct.type,id:pt,properties:ct.properties,geometry:mt?La(ct):[]};if((this||w).layers[0]._featureFilter.filter(new ai((this||w).zoom),yt,rt)){mt||(yt.geometry=La(ct));var vt=it?it.evaluate(yt,{},rt,et.availableImages):void 0;nt.push({id:pt,properties:ct.properties,type:ct.type,sourceLayerIndex:dt,index:ft,geometry:yt.geometry,patterns:{},sortKey:vt})}}it&&nt.sort((function(w,tt){return w.sortKey-tt.sortKey}));for(var Dt=0,Rt=nt;Dt<Rt.length;Dt+=1){var Bt=Rt[Dt],Ot=Bt.geometry,Ne=Bt.index,Ze=Bt.sourceLayerIndex;if((this||w).hasPattern){var Ge=ns("fill",(this||w).layers,Bt,(this||w).zoom,et);(this||w).patternFeatures.push(Ge)}else this.addFeature(Bt,Ot,Ne,rt,{});et.featureIndex.insert(tt[Ne].feature,Ot,Ne,Ze,(this||w).index)}},is.prototype.update=function(tt,et,rt){(this||w).stateDependentLayers.length&&(this||w).programConfigurations.updatePaintArrays(tt,et,(this||w).stateDependentLayers,rt)},is.prototype.addFeatures=function(tt,et,rt){for(var it=0,nt=(this||w).patternFeatures;it<nt.length;it+=1){var ot=nt[it];this.addFeature(ot,ot.geometry,ot.index,et,rt)}},is.prototype.isEmpty=function(){return 0===(this||w).layoutVertexArray.length},is.prototype.uploadPending=function(){return!(this||w).uploaded||(this||w).programConfigurations.needsUpload},is.prototype.upload=function(tt){(this||w).uploaded||((this||w).layoutVertexBuffer=tt.createVertexBuffer((this||w).layoutVertexArray,Ic),(this||w).indexBuffer=tt.createIndexBuffer((this||w).indexArray),(this||w).indexBuffer2=tt.createIndexBuffer((this||w).indexArray2)),(this||w).programConfigurations.upload(tt),(this||w).uploaded=!0},is.prototype.destroy=function(){(this||w).layoutVertexBuffer&&((this||w).layoutVertexBuffer.destroy(),(this||w).indexBuffer.destroy(),(this||w).indexBuffer2.destroy(),(this||w).programConfigurations.destroy(),(this||w).segments.destroy(),(this||w).segments2.destroy())},is.prototype.addFeature=function(tt,et,rt,it,nt){for(var ot=0,at=ts(et,500);ot<at.length;ot+=1){for(var st=at[ot],ct=0,pt=0,ft=st;pt<ft.length;pt+=1)ct+=ft[pt].length;for(var dt=(this||w).segments.prepareSegment(ct,(this||w).layoutVertexArray,(this||w).indexArray),mt=dt.vertexLength,yt=[],vt=[],Dt=0,Rt=st;Dt<Rt.length;Dt+=1){var Bt=Rt[Dt];if(0!==Bt.length){Bt!==st[0]&&vt.push(yt.length/2);var Ot=(this||w).segments2.prepareSegment(Bt.length,(this||w).layoutVertexArray,(this||w).indexArray2),Ne=Ot.vertexLength;(this||w).layoutVertexArray.emplaceBack(Bt[0].x,Bt[0].y),(this||w).indexArray2.emplaceBack(Ne+Bt.length-1,Ne),yt.push(Bt[0].x),yt.push(Bt[0].y);for(var Ze=1;Ze<Bt.length;Ze++)(this||w).layoutVertexArray.emplaceBack(Bt[Ze].x,Bt[Ze].y),(this||w).indexArray2.emplaceBack(Ne+Ze-1,Ne+Ze),yt.push(Bt[Ze].x),yt.push(Bt[Ze].y);Ot.vertexLength+=Bt.length,Ot.primitiveLength+=Bt.length}}for(var Ge=Ec(yt,vt),Ke=0;Ke<Ge.length;Ke+=3)(this||w).indexArray.emplaceBack(mt+Ge[Ke],mt+Ge[Ke+1],mt+Ge[Ke+2]);dt.vertexLength+=ct,dt.primitiveLength+=Ge.length/3}(this||w).programConfigurations.populatePaintArrays((this||w).layoutVertexArray.length,tt,rt,nt,it)},Dn("FillBucket",is,{omit:["layers","patternFeatures"]});var zc=new xi({"fill-sort-key":new di(Cn.layout_fill["fill-sort-key"])}),Pc={paint:new xi({"fill-antialias":new yi(Cn.paint_fill["fill-antialias"]),"fill-opacity":new di(Cn.paint_fill["fill-opacity"]),"fill-color":new di(Cn.paint_fill["fill-color"]),"fill-outline-color":new di(Cn.paint_fill["fill-outline-color"]),"fill-translate":new yi(Cn.paint_fill["fill-translate"]),"fill-translate-anchor":new yi(Cn.paint_fill["fill-translate-anchor"]),"fill-pattern":new Cs(Cn.paint_fill["fill-pattern"])}),layout:zc},Cc=function(tt){function e(et){tt.call(this||w,et,Pc)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.recalculate=function(et,rt){tt.prototype.recalculate.call(this||w,et,rt);var it=(this||w).paint._values["fill-outline-color"];"constant"===it.value.kind&&void 0===it.value.value&&((this||w).paint._values["fill-outline-color"]=(this||w).paint._values["fill-color"])},e.prototype.createBucket=function(w){return new is(w)},e.prototype.queryRadius=function(){return Wa((this||w).paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(tt,et,rt,it,nt,ot,at){return qa(Qa(tt,(this||w).paint.get("fill-translate"),(this||w).paint.get("fill-translate-anchor"),ot.angle,at),it)},e.prototype.isTileClipped=function(){return!0},e}(Ms),kc=Si([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Mc=ps;function ps(tt,et,rt,it,nt){(this||w).properties={},(this||w).extent=rt,(this||w).type=0,(this||w)._pbf=tt,(this||w)._geometry=-1,(this||w)._keys=it,(this||w)._values=nt,tt.readFields(cs,this||w,et)}function cs(w,tt,et){1==w?tt.id=et.readVarint():2==w?function(w,tt){for(var et=w.readVarint()+w.pos;w.pos<et;){var rt=tt._keys[w.readVarint()],it=tt._values[w.readVarint()];tt.properties[rt]=it}}(et,tt):3==w?tt.type=et.readVarint():4==w&&(tt._geometry=et.pos)}function hs(w){for(var tt,et,rt=0,it=0,nt=w.length,ot=nt-1;it<nt;ot=it++)rt+=((et=w[ot]).x-(tt=w[it]).x)*(tt.y+et.y);return rt}ps.types=["Unknown","Point","LineString","Polygon"],ps.prototype.loadGeometry=function(){var tt=(this||w)._pbf;tt.pos=(this||w)._geometry;for(var et,it=tt.readVarint()+tt.pos,nt=1,ot=0,at=0,st=0,ct=[];tt.pos<it;){if(ot<=0){var pt=tt.readVarint();nt=7&pt,ot=pt>>3}if(ot--,1===nt||2===nt)at+=tt.readSVarint(),st+=tt.readSVarint(),1===nt&&(et&&ct.push(et),et=[]),et.push(new rt(at,st));else{if(7!==nt)throw new Error("unknown command "+nt);et&&et.push(et[0].clone())}}return et&&ct.push(et),ct},ps.prototype.bbox=function(){var tt=(this||w)._pbf;tt.pos=(this||w)._geometry;for(var et=tt.readVarint()+tt.pos,rt=1,it=0,nt=0,ot=0,at=1/0,st=-1/0,ct=1/0,pt=-1/0;tt.pos<et;){if(it<=0){var ft=tt.readVarint();rt=7&ft,it=ft>>3}if(it--,1===rt||2===rt)(nt+=tt.readSVarint())<at&&(at=nt),nt>st&&(st=nt),(ot+=tt.readSVarint())<ct&&(ct=ot),ot>pt&&(pt=ot);else if(7!==rt)throw new Error("unknown command "+rt)}return[at,ct,st,pt]},ps.prototype.toGeoJSON=function(tt,et,rt){var it,nt,ot=(this||w).extent*Math.pow(2,rt),at=(this||w).extent*tt,st=(this||w).extent*et,ct=this.loadGeometry(),pt=ps.types[(this||w).type];function p(w){for(var tt=0;tt<w.length;tt++){var et=w[tt];w[tt]=[360*(et.x+at)/ot-180,360/Math.PI*Math.atan(Math.exp((180-360*(et.y+st)/ot)*Math.PI/180))-90]}}switch((this||w).type){case 1:var ft=[];for(it=0;it<ct.length;it++)ft[it]=ct[it][0];p(ct=ft);break;case 2:for(it=0;it<ct.length;it++)p(ct[it]);break;case 3:for(ct=function(w){var tt=w.length;if(tt<=1)return[w];for(var et,rt,it=[],nt=0;nt<tt;nt++){var ot=hs(w[nt]);0!==ot&&(void 0===rt&&(rt=ot<0),rt===ot<0?(et&&it.push(et),et=[w[nt]]):et.push(w[nt]))}return et&&it.push(et),it}(ct),it=0;it<ct.length;it++)for(nt=0;nt<ct[it].length;nt++)p(ct[it][nt])}1===ct.length?ct=ct[0]:pt="Multi"+pt;var dt={type:"Feature",geometry:{type:pt,coordinates:ct},properties:(this||w).properties};return"id"in(this||w)&&(dt.id=(this||w).id),dt};var Dc=ys;function ys(tt,et){(this||w).version=1,(this||w).name=null,(this||w).extent=4096,(this||w).length=0,(this||w)._pbf=tt,(this||w)._keys=[],(this||w)._values=[],(this||w)._features=[],tt.readFields(ds,this||w,et),(this||w).length=(this||w)._features.length}function ds(w,tt,et){15===w?tt.version=et.readVarint():1===w?tt.name=et.readString():5===w?tt.extent=et.readVarint():2===w?tt._features.push(et.pos):3===w?tt._keys.push(et.readString()):4===w&&tt._values.push(function(w){for(var tt=null,et=w.readVarint()+w.pos;w.pos<et;){var rt=w.readVarint()>>3;tt=1===rt?w.readString():2===rt?w.readFloat():3===rt?w.readDouble():4===rt?w.readVarint64():5===rt?w.readVarint():6===rt?w.readSVarint():7===rt?w.readBoolean():null}return tt}(et))}function ms(w,tt,et){if(3===w){var rt=new Dc(et,et.readVarint()+et.pos);rt.length&&(tt[rt.name]=rt)}}ys.prototype.feature=function(tt){if(tt<0||tt>=(this||w)._features.length)throw new Error("feature index out of bounds");(this||w)._pbf.pos=(this||w)._features[tt];var et=(this||w)._pbf.readVarint()+(this||w)._pbf.pos;return new Mc((this||w)._pbf,et,(this||w).extent,(this||w)._keys,(this||w)._values)};var Lc={VectorTile:function(tt,et){(this||w).layers=tt.readFields(ms,{},et)},VectorTileFeature:Mc,VectorTileLayer:Dc},Rc=Lc.VectorTileFeature.types,Bc=Math.pow(2,13);function bs(w,tt,et,rt,it,nt,ot,at){w.emplaceBack(tt,et,2*Math.floor(rt*Bc)+ot,it*Bc*2,nt*Bc*2,Math.round(at))}var ws=function(tt){(this||w).zoom=tt.zoom,(this||w).overscaling=tt.overscaling,(this||w).layers=tt.layers,(this||w).layerIds=(this||w).layers.map((function(w){return w.id})),(this||w).index=tt.index,(this||w).hasPattern=!1,(this||w).layoutVertexArray=new Fs,(this||w).indexArray=new sl,(this||w).programConfigurations=new Pa(tt.layers,tt.zoom),(this||w).segments=new aa,(this||w).stateDependentLayerIds=(this||w).layers.filter((function(w){return w.isStateDependent()})).map((function(w){return w.id}))};function _s(w,tt){return w.x===tt.x&&(w.x<0||w.x>8192)||w.y===tt.y&&(w.y<0||w.y>8192)}ws.prototype.populate=function(tt,et,rt){(this||w).features=[],(this||w).hasPattern=rs("fill-extrusion",(this||w).layers,et);for(var it=0,nt=tt;it<nt.length;it+=1){var ot=nt[it],at=ot.feature,st=ot.id,ct=ot.index,pt=ot.sourceLayerIndex,ft=(this||w).layers[0]._featureFilter.needGeometry,dt={type:at.type,id:st,properties:at.properties,geometry:ft?La(at):[]};if((this||w).layers[0]._featureFilter.filter(new ai((this||w).zoom),dt,rt)){var mt={id:st,sourceLayerIndex:pt,index:ct,geometry:ft?dt.geometry:La(at),properties:at.properties,type:at.type,patterns:{}};void 0!==at.id&&(mt.id=at.id),(this||w).hasPattern?(this||w).features.push(ns("fill-extrusion",(this||w).layers,mt,(this||w).zoom,et)):this.addFeature(mt,mt.geometry,ct,rt,{}),et.featureIndex.insert(at,mt.geometry,ct,pt,(this||w).index,!0)}}},ws.prototype.addFeatures=function(tt,et,rt){for(var it=0,nt=(this||w).features;it<nt.length;it+=1){var ot=nt[it];this.addFeature(ot,ot.geometry,ot.index,et,rt)}},ws.prototype.update=function(tt,et,rt){(this||w).stateDependentLayers.length&&(this||w).programConfigurations.updatePaintArrays(tt,et,(this||w).stateDependentLayers,rt)},ws.prototype.isEmpty=function(){return 0===(this||w).layoutVertexArray.length},ws.prototype.uploadPending=function(){return!(this||w).uploaded||(this||w).programConfigurations.needsUpload},ws.prototype.upload=function(tt){(this||w).uploaded||((this||w).layoutVertexBuffer=tt.createVertexBuffer((this||w).layoutVertexArray,kc),(this||w).indexBuffer=tt.createIndexBuffer((this||w).indexArray)),(this||w).programConfigurations.upload(tt),(this||w).uploaded=!0},ws.prototype.destroy=function(){(this||w).layoutVertexBuffer&&((this||w).layoutVertexBuffer.destroy(),(this||w).indexBuffer.destroy(),(this||w).programConfigurations.destroy(),(this||w).segments.destroy())},ws.prototype.addFeature=function(tt,et,rt,it,nt){for(var ot=0,at=ts(et,500);ot<at.length;ot+=1){for(var st=at[ot],ct=0,pt=0,ft=st;pt<ft.length;pt+=1)ct+=ft[pt].length;for(var dt=(this||w).segments.prepareSegment(4,(this||w).layoutVertexArray,(this||w).indexArray),mt=0,yt=st;mt<yt.length;mt+=1){var vt=yt[mt];if(0!==vt.length&&!((Ki=vt).every((function(w){return w.x<0}))||Ki.every((function(w){return w.x>8192}))||Ki.every((function(w){return w.y<0}))||Ki.every((function(w){return w.y>8192}))))for(var Dt=0,Rt=0;Rt<vt.length;Rt++){var Bt=vt[Rt];if(Rt>=1){var Ot=vt[Rt-1];if(!_s(Bt,Ot)){dt.vertexLength+4>aa.MAX_VERTEX_ARRAY_LENGTH&&(dt=(this||w).segments.prepareSegment(4,(this||w).layoutVertexArray,(this||w).indexArray));var Ne=Bt.sub(Ot)._perp()._unit(),Ze=Ot.dist(Bt);Dt+Ze>32768&&(Dt=0),bs((this||w).layoutVertexArray,Bt.x,Bt.y,Ne.x,Ne.y,0,0,Dt),bs((this||w).layoutVertexArray,Bt.x,Bt.y,Ne.x,Ne.y,0,1,Dt),bs((this||w).layoutVertexArray,Ot.x,Ot.y,Ne.x,Ne.y,0,0,Dt+=Ze),bs((this||w).layoutVertexArray,Ot.x,Ot.y,Ne.x,Ne.y,0,1,Dt);var Ge=dt.vertexLength;(this||w).indexArray.emplaceBack(Ge,Ge+2,Ge+1),(this||w).indexArray.emplaceBack(Ge+1,Ge+2,Ge+3),dt.vertexLength+=4,dt.primitiveLength+=2}}}}if(dt.vertexLength+ct>aa.MAX_VERTEX_ARRAY_LENGTH&&(dt=(this||w).segments.prepareSegment(ct,(this||w).layoutVertexArray,(this||w).indexArray)),"Polygon"===Rc[tt.type]){for(var Ke=[],er=[],rr=dt.vertexLength,vr=0,wr=st;vr<wr.length;vr+=1){var Sr=wr[vr];if(0!==Sr.length){Sr!==st[0]&&er.push(Ke.length/2);for(var ei=0;ei<Sr.length;ei++){var ii=Sr[ei];bs((this||w).layoutVertexArray,ii.x,ii.y,0,0,1,1,0),Ke.push(ii.x),Ke.push(ii.y)}}}for(var mi=Ec(Ke,er),qi=0;qi<mi.length;qi+=3)(this||w).indexArray.emplaceBack(rr+mi[qi],rr+mi[qi+2],rr+mi[qi+1]);dt.primitiveLength+=mi.length/3,dt.vertexLength+=ct}}var Ki;(this||w).programConfigurations.populatePaintArrays((this||w).layoutVertexArray.length,tt,rt,nt,it)},Dn("FillExtrusionBucket",ws,{omit:["layers","features"]});var Fc={paint:new xi({"fill-extrusion-opacity":new yi(Cn["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new di(Cn["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new yi(Cn["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new yi(Cn["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Cs(Cn["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new di(Cn["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new di(Cn["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new yi(Cn["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Oc=function(tt){function e(et){tt.call(this||w,et,Fc)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.createBucket=function(w){return new ws(w)},e.prototype.queryRadius=function(){return Wa((this||w).paint.get("fill-extrusion-translate"))},e.prototype.is3D=function(){return!0},e.prototype.queryIntersectsFeature=function(tt,et,it,nt,ot,at,st,ct){var pt=Qa(tt,(this||w).paint.get("fill-extrusion-translate"),(this||w).paint.get("fill-extrusion-translate-anchor"),at.angle,st),ft=(this||w).paint.get("fill-extrusion-height").evaluate(et,it),dt=(this||w).paint.get("fill-extrusion-base").evaluate(et,it),mt=function(w,tt,et,it){for(var nt=[],ot=0,at=w;ot<at.length;ot+=1){var st=at[ot],ct=[st.x,st.y,0,1];so(ct,ct,tt),nt.push(new rt(ct[0]/ct[3],ct[1]/ct[3]))}return nt}(pt,ct),yt=function(w,tt,et,it){for(var nt=[],ot=[],at=it[8]*tt,st=it[9]*tt,ct=it[10]*tt,pt=it[11]*tt,ft=it[8]*et,dt=it[9]*et,mt=it[10]*et,yt=it[11]*et,vt=0,Dt=w;vt<Dt.length;vt+=1){for(var Rt=[],Bt=[],Ot=0,Ne=Dt[vt];Ot<Ne.length;Ot+=1){var Ze=Ne[Ot],Ge=Ze.x,Ke=Ze.y,er=it[0]*Ge+it[4]*Ke+it[12],rr=it[1]*Ge+it[5]*Ke+it[13],vr=it[2]*Ge+it[6]*Ke+it[14],wr=it[3]*Ge+it[7]*Ke+it[15],Sr=vr+ct,ei=wr+pt,ii=er+ft,mi=rr+dt,qi=vr+mt,Ki=wr+yt,Ji=new rt((er+at)/ei,(rr+st)/ei);Ji.z=Sr/ei,Rt.push(Ji);var rn=new rt(ii/Ki,mi/Ki);rn.z=qi/Ki,Bt.push(rn)}nt.push(Rt),ot.push(Bt)}return[nt,ot]}(nt,dt,ft,ct);return function(w,tt,et){var rt=1/0;qa(et,tt)&&(rt=Is(et,tt[0]));for(var it=0;it<tt.length;it++)for(var nt=tt[it],ot=w[it],at=0;at<nt.length-1;at++){var st=nt[at],ct=[st,nt[at+1],ot[at+1],ot[at],st];Ua(et,ct)&&(rt=Math.min(rt,Is(et,ct)))}return rt!==1/0&&rt}(yt[0],yt[1],mt)},e}(Ms);function ks(w,tt){return w.x*tt.x+w.y*tt.y}function Is(w,tt){if(1===w.length){for(var et,rt=0,it=tt[rt++];!et||it.equals(et);)if(!(et=tt[rt++]))return 1/0;for(;rt<tt.length;rt++){var nt=tt[rt],ot=w[0],at=et.sub(it),st=nt.sub(it),ct=ot.sub(it),pt=ks(at,at),ft=ks(at,st),dt=ks(st,st),mt=ks(ct,at),yt=ks(ct,st),vt=pt*dt-ft*ft,Dt=(dt*mt-ft*yt)/vt,Rt=(pt*yt-ft*mt)/vt,Bt=it.z*(1-Dt-Rt)+et.z*Dt+nt.z*Rt;if(isFinite(Bt))return Bt}return 1/0}for(var Ot=1/0,Ne=0,Ze=tt;Ne<Ze.length;Ne+=1)Ot=Math.min(Ot,Ze[Ne].z);return Ot}var Uc=Si([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Vc=Lc.VectorTileFeature.types,Nc=Math.cos(Math.PI/180*37.5),jc=Math.pow(2,14)/.5,Ts=function(tt){(this||w).zoom=tt.zoom,(this||w).overscaling=tt.overscaling,(this||w).layers=tt.layers,(this||w).layerIds=(this||w).layers.map((function(w){return w.id})),(this||w).index=tt.index,(this||w).hasPattern=!1,(this||w).patternFeatures=[],(this||w).layoutVertexArray=new Os,(this||w).indexArray=new sl,(this||w).programConfigurations=new Pa(tt.layers,tt.zoom),(this||w).segments=new aa,(this||w).stateDependentLayerIds=(this||w).layers.filter((function(w){return w.isStateDependent()})).map((function(w){return w.id}))};Ts.prototype.populate=function(tt,et,rt){(this||w).hasPattern=rs("line",(this||w).layers,et);for(var it=(this||w).layers[0].layout.get("line-sort-key"),nt=[],ot=0,at=tt;ot<at.length;ot+=1){var st=at[ot],ct=st.feature,pt=st.id,ft=st.index,dt=st.sourceLayerIndex,mt=(this||w).layers[0]._featureFilter.needGeometry,yt={type:ct.type,id:pt,properties:ct.properties,geometry:mt?La(ct):[]};if((this||w).layers[0]._featureFilter.filter(new ai((this||w).zoom),yt,rt)){mt||(yt.geometry=La(ct));var vt=it?it.evaluate(yt,{},rt):void 0;nt.push({id:pt,properties:ct.properties,type:ct.type,sourceLayerIndex:dt,index:ft,geometry:yt.geometry,patterns:{},sortKey:vt})}}it&&nt.sort((function(w,tt){return w.sortKey-tt.sortKey}));for(var Dt=0,Rt=nt;Dt<Rt.length;Dt+=1){var Bt=Rt[Dt],Ot=Bt.geometry,Ne=Bt.index,Ze=Bt.sourceLayerIndex;if((this||w).hasPattern){var Ge=ns("line",(this||w).layers,Bt,(this||w).zoom,et);(this||w).patternFeatures.push(Ge)}else this.addFeature(Bt,Ot,Ne,rt,{});et.featureIndex.insert(tt[Ne].feature,Ot,Ne,Ze,(this||w).index)}},Ts.prototype.update=function(tt,et,rt){(this||w).stateDependentLayers.length&&(this||w).programConfigurations.updatePaintArrays(tt,et,(this||w).stateDependentLayers,rt)},Ts.prototype.addFeatures=function(tt,et,rt){for(var it=0,nt=(this||w).patternFeatures;it<nt.length;it+=1){var ot=nt[it];this.addFeature(ot,ot.geometry,ot.index,et,rt)}},Ts.prototype.isEmpty=function(){return 0===(this||w).layoutVertexArray.length},Ts.prototype.uploadPending=function(){return!(this||w).uploaded||(this||w).programConfigurations.needsUpload},Ts.prototype.upload=function(tt){(this||w).uploaded||((this||w).layoutVertexBuffer=tt.createVertexBuffer((this||w).layoutVertexArray,Uc),(this||w).indexBuffer=tt.createIndexBuffer((this||w).indexArray)),(this||w).programConfigurations.upload(tt),(this||w).uploaded=!0},Ts.prototype.destroy=function(){(this||w).layoutVertexBuffer&&((this||w).layoutVertexBuffer.destroy(),(this||w).indexBuffer.destroy(),(this||w).programConfigurations.destroy(),(this||w).segments.destroy())},Ts.prototype.addFeature=function(tt,et,rt,it,nt){for(var ot=(this||w).layers[0].layout,at=ot.get("line-join").evaluate(tt,{}),st=ot.get("line-cap"),ct=ot.get("line-miter-limit"),pt=ot.get("line-round-limit"),ft=0,dt=et;ft<dt.length;ft+=1)this.addLine(dt[ft],tt,at,st,ct,pt);(this||w).programConfigurations.populatePaintArrays((this||w).layoutVertexArray.length,tt,rt,nt,it)},Ts.prototype.addLine=function(tt,et,rt,it,nt,ot){if((this||w).distance=0,(this||w).scaledDistance=0,(this||w).totalDistance=0,et.properties&&et.properties.hasOwnProperty("mapbox_clip_start")&&et.properties.hasOwnProperty("mapbox_clip_end")){(this||w).clipStart=+et.properties.mapbox_clip_start,(this||w).clipEnd=+et.properties.mapbox_clip_end;for(var at=0;at<tt.length-1;at++)(this||w).totalDistance+=tt[at].dist(tt[at+1]);this.updateScaledDistance()}for(var st="Polygon"===Vc[et.type],ct=tt.length;ct>=2&&tt[ct-1].equals(tt[ct-2]);)ct--;for(var pt=0;pt<ct-1&&tt[pt].equals(tt[pt+1]);)pt++;if(!(ct<(st?3:2))){"bevel"===rt&&(nt=1.05);var ft,dt=(this||w).overscaling<=16?122880/(512*(this||w).overscaling):0,mt=(this||w).segments.prepareSegment(10*ct,(this||w).layoutVertexArray,(this||w).indexArray),yt=void 0,vt=void 0,Dt=void 0,Rt=void 0;(this||w).e1=(this||w).e2=-1,st&&(Rt=tt[pt].sub(ft=tt[ct-2])._unit()._perp());for(var Bt=pt;Bt<ct;Bt++)if(!(vt=Bt===ct-1?st?tt[pt+1]:void 0:tt[Bt+1])||!tt[Bt].equals(vt)){Rt&&(Dt=Rt),ft&&(yt=ft),ft=tt[Bt],Rt=vt?vt.sub(ft)._unit()._perp():Dt;var Ot=(Dt=Dt||Rt).add(Rt);0===Ot.x&&0===Ot.y||Ot._unit();var Ne=Dt.x*Rt.x+Dt.y*Rt.y,Ze=Ot.x*Rt.x+Ot.y*Rt.y,Ge=0!==Ze?1/Ze:1/0,Ke=2*Math.sqrt(2-2*Ze),er=Ze<Nc&&yt&&vt,rr=Dt.x*Rt.y-Dt.y*Rt.x>0;if(er&&Bt>pt){var vr=ft.dist(yt);if(vr>2*dt){var wr=ft.sub(ft.sub(yt)._mult(dt/vr)._round());this.updateDistance(yt,wr),this.addCurrentVertex(wr,Dt,0,0,mt),yt=wr}}var Sr=yt&&vt,ei=Sr?rt:st?"butt":it;if(Sr&&"round"===ei&&(Ge<ot?ei="miter":Ge<=2&&(ei="fakeround")),"miter"===ei&&Ge>nt&&(ei="bevel"),"bevel"===ei&&(Ge>2&&(ei="flipbevel"),Ge<nt&&(ei="miter")),yt&&this.updateDistance(yt,ft),"miter"===ei)Ot._mult(Ge),this.addCurrentVertex(ft,Ot,0,0,mt);else if("flipbevel"===ei){if(Ge>100)Ot=Rt.mult(-1);else{var ii=Ge*Dt.add(Rt).mag()/Dt.sub(Rt).mag();Ot._perp()._mult(ii*(rr?-1:1))}this.addCurrentVertex(ft,Ot,0,0,mt),this.addCurrentVertex(ft,Ot.mult(-1),0,0,mt)}else if("bevel"===ei||"fakeround"===ei){var mi=-Math.sqrt(Ge*Ge-1),qi=rr?mi:0,Ki=rr?0:mi;if(yt&&this.addCurrentVertex(ft,Dt,qi,Ki,mt),"fakeround"===ei)for(var Ji=Math.round(180*Ke/Math.PI/20),rn=1;rn<Ji;rn++){var vn=rn/Ji;if(.5!==vn){var bn=vn-.5;vn+=vn*bn*(vn-1)*((1.0904+Ne*(Ne*(3.55645-1.43519*Ne)-3.2452))*bn*bn+(.848013+Ne*(.215638*Ne-1.06021)))}var Tn=Rt.sub(Dt)._mult(vn)._add(Dt)._unit()._mult(rr?-1:1);this.addHalfVertex(ft,Tn.x,Tn.y,!1,rr,0,mt)}vt&&this.addCurrentVertex(ft,Rt,-qi,-Ki,mt)}else if("butt"===ei)this.addCurrentVertex(ft,Ot,0,0,mt);else if("square"===ei){var In=yt?1:-1;this.addCurrentVertex(ft,Ot,In,In,mt)}else"round"===ei&&(yt&&(this.addCurrentVertex(ft,Dt,0,0,mt),this.addCurrentVertex(ft,Dt,1,1,mt,!0)),vt&&(this.addCurrentVertex(ft,Rt,-1,-1,mt,!0),this.addCurrentVertex(ft,Rt,0,0,mt)));if(er&&Bt<ct-1){var zn=ft.dist(vt);if(zn>2*dt){var Cn=ft.add(vt.sub(ft)._mult(dt/zn)._round());this.updateDistance(ft,Cn),this.addCurrentVertex(Cn,Rt,0,0,mt),ft=Cn}}}}},Ts.prototype.addCurrentVertex=function(tt,et,rt,it,nt,ot){void 0===ot&&(ot=!1);var at=et.y*it-et.x,st=-et.y-et.x*it;this.addHalfVertex(tt,et.x+et.y*rt,et.y-et.x*rt,ot,!1,rt,nt),this.addHalfVertex(tt,at,st,ot,!0,-it,nt),(this||w).distance>jc/2&&0===(this||w).totalDistance&&((this||w).distance=0,this.addCurrentVertex(tt,et,rt,it,nt,ot))},Ts.prototype.addHalfVertex=function(tt,et,rt,it,nt,ot,at){var st=.5*(this||w).scaledDistance;(this||w).layoutVertexArray.emplaceBack((tt.x<<1)+(it?1:0),(tt.y<<1)+(nt?1:0),Math.round(63*et)+128,Math.round(63*rt)+128,1+(0===ot?0:ot<0?-1:1)|(63&st)<<2,st>>6);var ct=at.vertexLength++;(this||w).e1>=0&&(this||w).e2>=0&&((this||w).indexArray.emplaceBack((this||w).e1,(this||w).e2,ct),at.primitiveLength++),nt?(this||w).e2=ct:(this||w).e1=ct},Ts.prototype.updateScaledDistance=function(){(this||w).scaledDistance=(this||w).totalDistance>0?((this||w).clipStart+((this||w).clipEnd-(this||w).clipStart)*(this||w).distance/(this||w).totalDistance)*(jc-1):(this||w).distance},Ts.prototype.updateDistance=function(tt,et){(this||w).distance+=tt.dist(et),this.updateScaledDistance()},Dn("LineBucket",Ts,{omit:["layers","patternFeatures"]});var qc=new xi({"line-cap":new yi(Cn.layout_line["line-cap"]),"line-join":new di(Cn.layout_line["line-join"]),"line-miter-limit":new yi(Cn.layout_line["line-miter-limit"]),"line-round-limit":new yi(Cn.layout_line["line-round-limit"]),"line-sort-key":new di(Cn.layout_line["line-sort-key"])}),Zc={paint:new xi({"line-opacity":new di(Cn.paint_line["line-opacity"]),"line-color":new di(Cn.paint_line["line-color"]),"line-translate":new yi(Cn.paint_line["line-translate"]),"line-translate-anchor":new yi(Cn.paint_line["line-translate-anchor"]),"line-width":new di(Cn.paint_line["line-width"]),"line-gap-width":new di(Cn.paint_line["line-gap-width"]),"line-offset":new di(Cn.paint_line["line-offset"]),"line-blur":new di(Cn.paint_line["line-blur"]),"line-dasharray":new vi(Cn.paint_line["line-dasharray"]),"line-pattern":new Cs(Cn.paint_line["line-pattern"]),"line-gradient":new gi(Cn.paint_line["line-gradient"])}),layout:qc},Gc=new(function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(et,rt){return rt=new ai(Math.floor(rt.zoom),{now:rt.now,fadeDuration:rt.fadeDuration,zoomHistory:rt.zoomHistory,transition:rt.transition}),tt.prototype.possiblyEvaluate.call(this||w,et,rt)},e.prototype.evaluate=function(et,rt,it,nt){return rt=c({},rt,{zoom:Math.floor(rt.zoom)}),tt.prototype.evaluate.call(this||w,et,rt,it,nt)},e}(di))(Zc.paint.properties["line-width"].specification);Gc.useIntegerZoom=!0;var Xc=function(tt){function e(et){tt.call(this||w,et,Zc)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._handleSpecialPaintPropertyUpdate=function(w){"line-gradient"===w&&this._updateGradient()},e.prototype._updateGradient=function(){(this||w).gradient=go((this||w)._transitionablePaint._values["line-gradient"].value.expression,"lineProgress"),(this||w).gradientTexture=null},e.prototype.recalculate=function(et,rt){tt.prototype.recalculate.call(this||w,et,rt),(this||w).paint._values["line-floorwidth"]=Gc.possiblyEvaluate((this||w)._transitioningPaint._values["line-width"].value,et)},e.prototype.createBucket=function(w){return new Ts(w)},e.prototype.queryRadius=function(tt){var et=tt,rt=Ds($a("line-width",this||w,et),$a("line-gap-width",this||w,et)),it=$a("line-offset",this||w,et);return rt/2+Math.abs(it)+Wa((this||w).paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(tt,et,it,nt,ot,at,st){var ct=Qa(tt,(this||w).paint.get("line-translate"),(this||w).paint.get("line-translate-anchor"),at.angle,st),pt=st/2*Ds((this||w).paint.get("line-width").evaluate(et,it),(this||w).paint.get("line-gap-width").evaluate(et,it)),ft=(this||w).paint.get("line-offset").evaluate(et,it);return ft&&(nt=function(w,tt){for(var et=[],it=new rt(0,0),nt=0;nt<w.length;nt++){for(var ot=w[nt],at=[],st=0;st<ot.length;st++){var ct=ot[st],pt=ot[st+1],ft=0===st?it:ct.sub(ot[st-1])._unit()._perp(),dt=st===ot.length-1?it:pt.sub(ct)._unit()._perp(),mt=ft._add(dt)._unit();mt._mult(1/(mt.x*dt.x+mt.y*dt.y)),at.push(mt._mult(tt)._add(ct))}et.push(at)}return et}(nt,ft*st)),function(w,tt,et){for(var rt=0;rt<tt.length;rt++){var it=tt[rt];if(w.length>=3)for(var nt=0;nt<it.length;nt++)if(Ha(w,it[nt]))return!0;if(Na(w,it,et))return!0}return!1}(ct,nt,pt)},e.prototype.isTileClipped=function(){return!0},e}(Ms);function Ds(w,tt){return tt>0?tt+2*w:w}var Wc=Si([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Hc=Si([{name:"a_projected_pos",components:3,type:"Float32"}],4),Kc=(Si([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Si([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Yc=(Si([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Si([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Jc=Si([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function qs(w,tt,et){return w.sections.forEach((function(w){w.text=function(w,tt,et){var rt=tt.layout.get("text-transform").evaluate(et,{});return"uppercase"===rt?w=w.toLocaleUpperCase():"lowercase"===rt&&(w=w.toLocaleLowerCase()),Ps.applyArabicShaping&&(w=Ps.applyArabicShaping(w)),w}(w.text,tt,et)})),w}Si([{name:"triangle",components:3,type:"Uint16"}]),Si([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Si([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Si([{type:"Float32",name:"offsetX"}]),Si([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var $c={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},Ks=function(w,tt,et,rt,it){var nt,ot,at=8*it-rt-1,st=(1<<at)-1,ct=st>>1,pt=-7,ft=et?it-1:0,dt=et?-1:1,mt=w[tt+ft];for(ft+=dt,nt=mt&(1<<-pt)-1,mt>>=-pt,pt+=at;pt>0;nt=256*nt+w[tt+ft],ft+=dt,pt-=8);for(ot=nt&(1<<-pt)-1,nt>>=-pt,pt+=rt;pt>0;ot=256*ot+w[tt+ft],ft+=dt,pt-=8);if(0===nt)nt=1-ct;else{if(nt===st)return ot?NaN:1/0*(mt?-1:1);ot+=Math.pow(2,rt),nt-=ct}return(mt?-1:1)*ot*Math.pow(2,nt-rt)},Gs=function(w,tt,et,rt,it,nt){var ot,at,st,ct=8*nt-it-1,pt=(1<<ct)-1,ft=pt>>1,dt=23===it?Math.pow(2,-24)-Math.pow(2,-77):0,mt=rt?0:nt-1,yt=rt?1:-1,vt=tt<0||0===tt&&1/tt<0?1:0;for(tt=Math.abs(tt),isNaN(tt)||tt===1/0?(at=isNaN(tt)?1:0,ot=pt):(ot=Math.floor(Math.log(tt)/Math.LN2),tt*(st=Math.pow(2,-ot))<1&&(ot--,st*=2),(tt+=ot+ft>=1?dt/st:dt*Math.pow(2,1-ft))*st>=2&&(ot++,st/=2),ot+ft>=pt?(at=0,ot=pt):ot+ft>=1?(at=(tt*st-1)*Math.pow(2,it),ot+=ft):(at=tt*Math.pow(2,ft-1)*Math.pow(2,it),ot=0));it>=8;w[et+mt]=255&at,mt+=yt,at/=256,it-=8);for(ot=ot<<it|at,ct+=it;ct>0;w[et+mt]=255&ot,mt+=yt,ot/=256,ct-=8);w[et+mt-yt]|=128*vt},Qc=Xs;function Xs(tt){(this||w).buf=ArrayBuffer.isView&&ArrayBuffer.isView(tt)?tt:new Uint8Array(tt||0),(this||w).pos=0,(this||w).type=0,(this||w).length=(this||w).buf.length}Xs.Varint=0,Xs.Fixed64=1,Xs.Bytes=2,Xs.Fixed32=5;var rp="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Hs(w){return w.type===Xs.Bytes?w.readVarint()+w.pos:w.pos+1}function Ys(w,tt,et){return et?4294967296*tt+(w>>>0):4294967296*(tt>>>0)+(w>>>0)}function $s(w,tt,et){var rt=tt<=16383?1:tt<=2097151?2:tt<=268435455?3:Math.floor(Math.log(tt)/(7*Math.LN2));et.realloc(rt);for(var it=et.pos-1;it>=w;it--)et.buf[it+rt]=et.buf[it]}function Ws(w,tt){for(var et=0;et<w.length;et++)tt.writeVarint(w[et])}function Qs(w,tt){for(var et=0;et<w.length;et++)tt.writeSVarint(w[et])}function tu(w,tt){for(var et=0;et<w.length;et++)tt.writeFloat(w[et])}function eu(w,tt){for(var et=0;et<w.length;et++)tt.writeDouble(w[et])}function ru(w,tt){for(var et=0;et<w.length;et++)tt.writeBoolean(w[et])}function nu(w,tt){for(var et=0;et<w.length;et++)tt.writeFixed32(w[et])}function iu(w,tt){for(var et=0;et<w.length;et++)tt.writeSFixed32(w[et])}function au(w,tt){for(var et=0;et<w.length;et++)tt.writeFixed64(w[et])}function ou(w,tt){for(var et=0;et<w.length;et++)tt.writeSFixed64(w[et])}function su(w,tt){return(w[tt]|w[tt+1]<<8|w[tt+2]<<16)+16777216*w[tt+3]}function uu(w,tt,et){w[et]=tt,w[et+1]=tt>>>8,w[et+2]=tt>>>16,w[et+3]=tt>>>24}function lu(w,tt){return(w[tt]|w[tt+1]<<8|w[tt+2]<<16)+(w[tt+3]<<24)}function pu(w,tt,et){1===w&&et.readMessage(cu,tt)}function cu(w,tt,et){if(3===w){var rt=et.readMessage(hu,{}),it=rt.width,nt=rt.height,ot=rt.left,at=rt.top,st=rt.advance;tt.push({id:rt.id,bitmap:new yo({width:it+6,height:nt+6},rt.bitmap),metrics:{width:it,height:nt,left:ot,top:at,advance:st}})}}function hu(w,tt,et){1===w?tt.id=et.readVarint():2===w?tt.bitmap=et.readBytes():3===w?tt.width=et.readVarint():4===w?tt.height=et.readVarint():5===w?tt.left=et.readSVarint():6===w?tt.top=et.readSVarint():7===w&&(tt.advance=et.readVarint())}function fu(w){for(var tt=0,et=0,rt=0,it=w;rt<it.length;rt+=1){var nt=it[rt];tt+=nt.w*nt.h,et=Math.max(et,nt.w)}w.sort((function(w,tt){return tt.h-w.h}));for(var ot=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(tt/.95)),et),h:1/0}],at=0,st=0,ct=0,pt=w;ct<pt.length;ct+=1)for(var ft=pt[ct],dt=ot.length-1;dt>=0;dt--){var mt=ot[dt];if(!(ft.w>mt.w||ft.h>mt.h)){if(ft.x=mt.x,ft.y=mt.y,st=Math.max(st,ft.y+ft.h),at=Math.max(at,ft.x+ft.w),ft.w===mt.w&&ft.h===mt.h){var yt=ot.pop();dt<ot.length&&(ot[dt]=yt)}else ft.h===mt.h?(mt.x+=ft.w,mt.w-=ft.w):ft.w===mt.w?(mt.y+=ft.h,mt.h-=ft.h):(ot.push({x:mt.x+ft.w,y:mt.y,w:mt.w-ft.w,h:ft.h}),mt.y+=ft.h,mt.h-=ft.h);break}}return{w:at,h:st,fill:tt/(at*st)||0}}Xs.prototype={destroy:function(){(this||w).buf=null},readFields:function(tt,et,rt){for(rt=rt||(this||w).length;(this||w).pos<rt;){var it=this.readVarint(),nt=it>>3,ot=(this||w).pos;(this||w).type=7&it,tt(nt,et,this||w),(this||w).pos===ot&&this.skip(it)}return et},readMessage:function(tt,et){return this.readFields(tt,et,this.readVarint()+(this||w).pos)},readFixed32:function(){var tt=su((this||w).buf,(this||w).pos);return(this||w).pos+=4,tt},readSFixed32:function(){var tt=lu((this||w).buf,(this||w).pos);return(this||w).pos+=4,tt},readFixed64:function(){var tt=su((this||w).buf,(this||w).pos)+4294967296*su((this||w).buf,(this||w).pos+4);return(this||w).pos+=8,tt},readSFixed64:function(){var tt=su((this||w).buf,(this||w).pos)+4294967296*lu((this||w).buf,(this||w).pos+4);return(this||w).pos+=8,tt},readFloat:function(){var tt=Ks((this||w).buf,(this||w).pos,!0,23,4);return(this||w).pos+=4,tt},readDouble:function(){var tt=Ks((this||w).buf,(this||w).pos,!0,52,8);return(this||w).pos+=8,tt},readVarint:function(tt){var et,rt,it=(this||w).buf;return et=127&(rt=it[(this||w).pos++]),rt<128?et:(et|=(127&(rt=it[(this||w).pos++]))<<7,rt<128?et:(et|=(127&(rt=it[(this||w).pos++]))<<14,rt<128?et:(et|=(127&(rt=it[(this||w).pos++]))<<21,rt<128?et:function(w,tt,et){var rt,it,nt=et.buf;if(rt=(112&(it=nt[et.pos++]))>>4,it<128)return Ys(w,rt,tt);if(rt|=(127&(it=nt[et.pos++]))<<3,it<128)return Ys(w,rt,tt);if(rt|=(127&(it=nt[et.pos++]))<<10,it<128)return Ys(w,rt,tt);if(rt|=(127&(it=nt[et.pos++]))<<17,it<128)return Ys(w,rt,tt);if(rt|=(127&(it=nt[et.pos++]))<<24,it<128)return Ys(w,rt,tt);if(rt|=(1&(it=nt[et.pos++]))<<31,it<128)return Ys(w,rt,tt);throw new Error("Expected varint not more than 10 bytes")}(et|=(15&(rt=it[(this||w).pos]))<<28,tt,this||w))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var w=this.readVarint();return w%2==1?(w+1)/-2:w/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var tt=this.readVarint()+(this||w).pos,et=(this||w).pos;return(this||w).pos=tt,tt-et>=12&&rp?function(w,tt,et){return rp.decode(w.subarray(tt,et))}((this||w).buf,et,tt):function(w,tt,et){for(var rt="",it=tt;it<et;){var nt,ot,at,st=w[it],ct=null,pt=st>239?4:st>223?3:st>191?2:1;if(it+pt>et)break;1===pt?st<128&&(ct=st):2===pt?128==(192&(nt=w[it+1]))&&(ct=(31&st)<<6|63&nt)<=127&&(ct=null):3===pt?(ot=w[it+2],128==(192&(nt=w[it+1]))&&128==(192&ot)&&((ct=(15&st)<<12|(63&nt)<<6|63&ot)<=2047||ct>=55296&&ct<=57343)&&(ct=null)):4===pt&&(ot=w[it+2],at=w[it+3],128==(192&(nt=w[it+1]))&&128==(192&ot)&&128==(192&at)&&((ct=(15&st)<<18|(63&nt)<<12|(63&ot)<<6|63&at)<=65535||ct>=1114112)&&(ct=null)),null===ct?(ct=65533,pt=1):ct>65535&&(ct-=65536,rt+=String.fromCharCode(ct>>>10&1023|55296),ct=56320|1023&ct),rt+=String.fromCharCode(ct),it+=pt}return rt}((this||w).buf,et,tt)},readBytes:function(){var tt=this.readVarint()+(this||w).pos,et=(this||w).buf.subarray((this||w).pos,tt);return(this||w).pos=tt,et},readPackedVarint:function(tt,et){if((this||w).type!==Xs.Bytes)return tt.push(this.readVarint(et));var rt=Hs(this||w);for(tt=tt||[];(this||w).pos<rt;)tt.push(this.readVarint(et));return tt},readPackedSVarint:function(tt){if((this||w).type!==Xs.Bytes)return tt.push(this.readSVarint());var et=Hs(this||w);for(tt=tt||[];(this||w).pos<et;)tt.push(this.readSVarint());return tt},readPackedBoolean:function(tt){if((this||w).type!==Xs.Bytes)return tt.push(this.readBoolean());var et=Hs(this||w);for(tt=tt||[];(this||w).pos<et;)tt.push(this.readBoolean());return tt},readPackedFloat:function(tt){if((this||w).type!==Xs.Bytes)return tt.push(this.readFloat());var et=Hs(this||w);for(tt=tt||[];(this||w).pos<et;)tt.push(this.readFloat());return tt},readPackedDouble:function(tt){if((this||w).type!==Xs.Bytes)return tt.push(this.readDouble());var et=Hs(this||w);for(tt=tt||[];(this||w).pos<et;)tt.push(this.readDouble());return tt},readPackedFixed32:function(tt){if((this||w).type!==Xs.Bytes)return tt.push(this.readFixed32());var et=Hs(this||w);for(tt=tt||[];(this||w).pos<et;)tt.push(this.readFixed32());return tt},readPackedSFixed32:function(tt){if((this||w).type!==Xs.Bytes)return tt.push(this.readSFixed32());var et=Hs(this||w);for(tt=tt||[];(this||w).pos<et;)tt.push(this.readSFixed32());return tt},readPackedFixed64:function(tt){if((this||w).type!==Xs.Bytes)return tt.push(this.readFixed64());var et=Hs(this||w);for(tt=tt||[];(this||w).pos<et;)tt.push(this.readFixed64());return tt},readPackedSFixed64:function(tt){if((this||w).type!==Xs.Bytes)return tt.push(this.readSFixed64());var et=Hs(this||w);for(tt=tt||[];(this||w).pos<et;)tt.push(this.readSFixed64());return tt},skip:function(tt){var et=7&tt;if(et===Xs.Varint)for(;(this||w).buf[(this||w).pos++]>127;);else if(et===Xs.Bytes)(this||w).pos=this.readVarint()+(this||w).pos;else if(et===Xs.Fixed32)(this||w).pos+=4;else{if(et!==Xs.Fixed64)throw new Error("Unimplemented type: "+et);(this||w).pos+=8}},writeTag:function(w,tt){this.writeVarint(w<<3|tt)},realloc:function(tt){for(var et=(this||w).length||16;et<(this||w).pos+tt;)et*=2;if(et!==(this||w).length){var rt=new Uint8Array(et);rt.set((this||w).buf),(this||w).buf=rt,(this||w).length=et}},finish:function(){return(this||w).length=(this||w).pos,(this||w).pos=0,(this||w).buf.subarray(0,(this||w).length)},writeFixed32:function(tt){this.realloc(4),uu((this||w).buf,tt,(this||w).pos),(this||w).pos+=4},writeSFixed32:function(tt){this.realloc(4),uu((this||w).buf,tt,(this||w).pos),(this||w).pos+=4},writeFixed64:function(tt){this.realloc(8),uu((this||w).buf,-1&tt,(this||w).pos),uu((this||w).buf,Math.floor(tt*(1/4294967296)),(this||w).pos+4),(this||w).pos+=8},writeSFixed64:function(tt){this.realloc(8),uu((this||w).buf,-1&tt,(this||w).pos),uu((this||w).buf,Math.floor(tt*(1/4294967296)),(this||w).pos+4),(this||w).pos+=8},writeVarint:function(tt){(tt=+tt||0)>268435455||tt<0?function(w,tt){var et,rt;if(w>=0?(et=w%4294967296|0,rt=w/4294967296|0):(rt=~(-w/4294967296),4294967295^(et=~(-w%4294967296))?et=et+1|0:(et=0,rt=rt+1|0)),w>=0x10000000000000000||w<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");tt.realloc(10),function(w,tt,et){et.buf[et.pos++]=127&w|128,w>>>=7,et.buf[et.pos++]=127&w|128,w>>>=7,et.buf[et.pos++]=127&w|128,w>>>=7,et.buf[et.pos++]=127&w|128,et.buf[et.pos]=127&(w>>>=7)}(et,0,tt),function(w,tt){var et=(7&w)<<4;tt.buf[tt.pos++]|=et|((w>>>=3)?128:0),w&&(tt.buf[tt.pos++]=127&w|((w>>>=7)?128:0),w&&(tt.buf[tt.pos++]=127&w|((w>>>=7)?128:0),w&&(tt.buf[tt.pos++]=127&w|((w>>>=7)?128:0),w&&(tt.buf[tt.pos++]=127&w|((w>>>=7)?128:0),w&&(tt.buf[tt.pos++]=127&w)))))}(rt,tt)}(tt,this||w):(this.realloc(4),(this||w).buf[(this||w).pos++]=127&tt|(tt>127?128:0),tt<=127||((this||w).buf[(this||w).pos++]=127&(tt>>>=7)|(tt>127?128:0),tt<=127||((this||w).buf[(this||w).pos++]=127&(tt>>>=7)|(tt>127?128:0),tt<=127||((this||w).buf[(this||w).pos++]=tt>>>7&127))))},writeSVarint:function(w){this.writeVarint(w<0?2*-w-1:2*w)},writeBoolean:function(w){this.writeVarint(Boolean(w))},writeString:function(tt){tt=String(tt),this.realloc(4*tt.length),(this||w).pos++;var et=(this||w).pos;(this||w).pos=function(w,tt,et){for(var rt,it,nt=0;nt<tt.length;nt++){if((rt=tt.charCodeAt(nt))>55295&&rt<57344){if(!it){rt>56319||nt+1===tt.length?(w[et++]=239,w[et++]=191,w[et++]=189):it=rt;continue}if(rt<56320){w[et++]=239,w[et++]=191,w[et++]=189,it=rt;continue}rt=it-55296<<10|rt-56320|65536,it=null}else it&&(w[et++]=239,w[et++]=191,w[et++]=189,it=null);rt<128?w[et++]=rt:(rt<2048?w[et++]=rt>>6|192:(rt<65536?w[et++]=rt>>12|224:(w[et++]=rt>>18|240,w[et++]=rt>>12&63|128),w[et++]=rt>>6&63|128),w[et++]=63&rt|128)}return et}((this||w).buf,tt,(this||w).pos);var rt=(this||w).pos-et;rt>=128&&$s(et,rt,this||w),(this||w).pos=et-1,this.writeVarint(rt),(this||w).pos+=rt},writeFloat:function(tt){this.realloc(4),Gs((this||w).buf,tt,(this||w).pos,!0,23,4),(this||w).pos+=4},writeDouble:function(tt){this.realloc(8),Gs((this||w).buf,tt,(this||w).pos,!0,52,8),(this||w).pos+=8},writeBytes:function(tt){var et=tt.length;this.writeVarint(et),this.realloc(et);for(var rt=0;rt<et;rt++)(this||w).buf[(this||w).pos++]=tt[rt]},writeRawMessage:function(tt,et){(this||w).pos++;var rt=(this||w).pos;tt(et,this||w);var it=(this||w).pos-rt;it>=128&&$s(rt,it,this||w),(this||w).pos=rt-1,this.writeVarint(it),(this||w).pos+=it},writeMessage:function(w,tt,et){this.writeTag(w,Xs.Bytes),this.writeRawMessage(tt,et)},writePackedVarint:function(w,tt){tt.length&&this.writeMessage(w,Ws,tt)},writePackedSVarint:function(w,tt){tt.length&&this.writeMessage(w,Qs,tt)},writePackedBoolean:function(w,tt){tt.length&&this.writeMessage(w,ru,tt)},writePackedFloat:function(w,tt){tt.length&&this.writeMessage(w,tu,tt)},writePackedDouble:function(w,tt){tt.length&&this.writeMessage(w,eu,tt)},writePackedFixed32:function(w,tt){tt.length&&this.writeMessage(w,nu,tt)},writePackedSFixed32:function(w,tt){tt.length&&this.writeMessage(w,iu,tt)},writePackedFixed64:function(w,tt){tt.length&&this.writeMessage(w,au,tt)},writePackedSFixed64:function(w,tt){tt.length&&this.writeMessage(w,ou,tt)},writeBytesField:function(w,tt){this.writeTag(w,Xs.Bytes),this.writeBytes(tt)},writeFixed32Field:function(w,tt){this.writeTag(w,Xs.Fixed32),this.writeFixed32(tt)},writeSFixed32Field:function(w,tt){this.writeTag(w,Xs.Fixed32),this.writeSFixed32(tt)},writeFixed64Field:function(w,tt){this.writeTag(w,Xs.Fixed64),this.writeFixed64(tt)},writeSFixed64Field:function(w,tt){this.writeTag(w,Xs.Fixed64),this.writeSFixed64(tt)},writeVarintField:function(w,tt){this.writeTag(w,Xs.Varint),this.writeVarint(tt)},writeSVarintField:function(w,tt){this.writeTag(w,Xs.Varint),this.writeSVarint(tt)},writeStringField:function(w,tt){this.writeTag(w,Xs.Bytes),this.writeString(tt)},writeFloatField:function(w,tt){this.writeTag(w,Xs.Fixed32),this.writeFloat(tt)},writeDoubleField:function(w,tt){this.writeTag(w,Xs.Fixed64),this.writeDouble(tt)},writeBooleanField:function(w,tt){this.writeVarintField(w,Boolean(tt))}};var yu=function(tt,et){var rt=et.pixelRatio,it=et.version,nt=et.stretchX,ot=et.stretchY,at=et.content;(this||w).paddedRect=tt,(this||w).pixelRatio=rt,(this||w).stretchX=nt,(this||w).stretchY=ot,(this||w).content=at,(this||w).version=it},ip={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};ip.tl.get=function(){return[(this||w).paddedRect.x+1,(this||w).paddedRect.y+1]},ip.br.get=function(){return[(this||w).paddedRect.x+(this||w).paddedRect.w-1,(this||w).paddedRect.y+(this||w).paddedRect.h-1]},ip.tlbr.get=function(){return(this||w).tl.concat((this||w).br)},ip.displaySize.get=function(){return[((this||w).paddedRect.w-2)/(this||w).pixelRatio,((this||w).paddedRect.h-2)/(this||w).pixelRatio]},Object.defineProperties(yu.prototype,ip);var mu=function(tt,et){var rt={},it={};(this||w).haveRenderCallbacks=[];var nt=[];this.addImages(tt,rt,nt),this.addImages(et,it,nt);var ot=fu(nt),at=new mo({width:ot.w||1,height:ot.h||1});for(var st in tt){var ct=tt[st],pt=rt[st].paddedRect;mo.copy(ct.data,at,{x:0,y:0},{x:pt.x+1,y:pt.y+1},ct.data)}for(var ft in et){var dt=et[ft],mt=it[ft].paddedRect,yt=mt.x+1,vt=mt.y+1,Dt=dt.data.width,Rt=dt.data.height;mo.copy(dt.data,at,{x:0,y:0},{x:yt,y:vt},dt.data),mo.copy(dt.data,at,{x:0,y:Rt-1},{x:yt,y:vt-1},{width:Dt,height:1}),mo.copy(dt.data,at,{x:0,y:0},{x:yt,y:vt+Rt},{width:Dt,height:1}),mo.copy(dt.data,at,{x:Dt-1,y:0},{x:yt-1,y:vt},{width:1,height:Rt}),mo.copy(dt.data,at,{x:0,y:0},{x:yt+Dt,y:vt},{width:1,height:Rt})}(this||w).image=at,(this||w).iconPositions=rt,(this||w).patternPositions=it};mu.prototype.addImages=function(tt,et,rt){for(var it in tt){var nt=tt[it],ot={x:0,y:0,w:nt.data.width+2,h:nt.data.height+2};rt.push(ot),et[it]=new yu(ot,nt),nt.hasRenderCallback&&(this||w).haveRenderCallbacks.push(it)}},mu.prototype.patchUpdatedImages=function(tt,et){for(var rt in tt.dispatchRenderCallbacks((this||w).haveRenderCallbacks),tt.updatedImages)this.patchUpdatedImage((this||w).iconPositions[rt],tt.getImage(rt),et),this.patchUpdatedImage((this||w).patternPositions[rt],tt.getImage(rt),et)},mu.prototype.patchUpdatedImage=function(w,tt,et){if(w&&tt&&w.version!==tt.version){w.version=tt.version;var rt=w.tl;et.update(tt.data,void 0,{x:rt[0],y:rt[1]})}},Dn("ImagePosition",yu),Dn("ImageAtlas",mu);var op={horizontal:1,vertical:2,horizontalOnly:3},gu=function(){(this||w).scale=1,(this||w).fontStack="",(this||w).imageName=null};gu.forText=function(w,tt){var et=new gu;return et.scale=w||1,et.fontStack=tt,et},gu.forImage=function(w){var tt=new gu;return tt.imageName=w,tt};var xu=function(){(this||w).text="",(this||w).sectionIndex=[],(this||w).sections=[],(this||w).imageSectionID=null};function bu(w,tt,et,rt,it,nt,ot,at,st,ct,pt,ft,dt,mt,yt,vt){var Dt,Rt=xu.fromFeature(w,it);ft===op.vertical&&Rt.verticalizePunctuation();var Bt=Ps.processBidirectionalText,Ot=Ps.processStyledBidirectionalText;if(Bt&&1===Rt.sections.length){Dt=[];for(var Ne=0,Ze=Bt(Rt.toString(),zu(Rt,ct,nt,tt,rt,mt,yt));Ne<Ze.length;Ne+=1){var Ge=Ze[Ne],Ke=new xu;Ke.text=Ge,Ke.sections=Rt.sections;for(var er=0;er<Ge.length;er++)Ke.sectionIndex.push(0);Dt.push(Ke)}}else if(Ot){Dt=[];for(var rr=0,vr=Ot(Rt.text,Rt.sectionIndex,zu(Rt,ct,nt,tt,rt,mt,yt));rr<vr.length;rr+=1){var wr=vr[rr],Sr=new xu;Sr.text=wr[0],Sr.sectionIndex=wr[1],Sr.sections=Rt.sections,Dt.push(Sr)}}else Dt=function(w,tt){for(var et=[],rt=w.text,it=0,nt=0,ot=tt;nt<ot.length;nt+=1){var at=ot[nt];et.push(w.substring(it,at)),it=at}return it<rt.length&&et.push(w.substring(it,rt.length)),et}(Rt,zu(Rt,ct,nt,tt,rt,mt,yt));var ei=[],ii={positionedLines:ei,text:Rt.toString(),top:pt[1],bottom:pt[1],left:pt[0],right:pt[0],writingMode:ft,iconsInText:!1,verticalizable:!1};return function(w,tt,et,rt,it,nt,ot,at,st,ct,pt,ft){for(var dt=0,mt=-17,yt=0,vt=0,Dt="right"===at?1:"left"===at?0:.5,Rt=0,Bt=0,Ot=it;Bt<Ot.length;Bt+=1){var Ne=Ot[Bt];Ne.trim();var Ze=Ne.getMaxScale(),Ge=24*(Ze-1),Ke={positionedGlyphs:[],lineOffset:0};w.positionedLines[Rt]=Ke;var er=Ke.positionedGlyphs,rr=0;if(Ne.length()){for(var vr=0;vr<Ne.length();vr++){var wr=Ne.getSection(vr),Sr=Ne.getSectionIndex(vr),ei=Ne.getCharCode(vr),ii=0,mi=null,qi=null,Ki=null,Ji=24,rn=!(st===op.horizontal||!pt&&!Gn(ei)||pt&&(ap[ei]||(Bn=ei,xs.Arabic(Bn)||xs["Arabic Supplement"](Bn)||xs["Arabic Extended-A"](Bn)||xs["Arabic Presentation Forms-A"](Bn)||xs["Arabic Presentation Forms-B"](Bn))));if(wr.imageName){var vn=rt[wr.imageName];if(!vn)continue;Ki=wr.imageName,w.iconsInText=w.iconsInText||!0,qi=vn.paddedRect;var bn=vn.displaySize;wr.scale=24*wr.scale/ft,ii=Ge+(24-bn[1]*wr.scale),Ji=(mi={width:bn[0],height:bn[1],left:1,top:-3,advance:rn?bn[1]:bn[0]}).advance;var Tn=rn?bn[0]*wr.scale-24*Ze:bn[1]*wr.scale-24*Ze;Tn>0&&Tn>rr&&(rr=Tn)}else{var In=et[wr.fontStack],zn=In&&In[ei];if(zn&&zn.rect)qi=zn.rect,mi=zn.metrics;else{var Cn=tt[wr.fontStack],Mn=Cn&&Cn[ei];if(!Mn)continue;mi=Mn.metrics}ii=24*(Ze-wr.scale)}rn?(w.verticalizable=!0,er.push({glyph:ei,imageName:Ki,x:dt,y:mt+ii,vertical:rn,scale:wr.scale,fontStack:wr.fontStack,sectionIndex:Sr,metrics:mi,rect:qi}),dt+=Ji*wr.scale+ct):(er.push({glyph:ei,imageName:Ki,x:dt,y:mt+ii,vertical:rn,scale:wr.scale,fontStack:wr.fontStack,sectionIndex:Sr,metrics:mi,rect:qi}),dt+=mi.advance*wr.scale+ct)}0!==er.length&&(yt=Math.max(dt-ct,yt),Mu(er,0,er.length-1,Dt,rr)),dt=0;var Ln=nt*Ze+rr;Ke.lineOffset=Math.max(rr,Ge),mt+=Ln,vt=Math.max(Ln,vt),++Rt}else mt+=nt,++Rt}var Bn,Fn=mt- -17,Vn=Cu(ot),Nn=Vn.horizontalAlign,Wn=Vn.verticalAlign;(function(w,tt,et,rt,it,nt,ot,at,st){var ct,pt=(tt-et)*it;ct=nt!==ot?-at*rt- -17:(-rt*st+.5)*ot;for(var ft=0,dt=w;ft<dt.length;ft+=1)for(var mt=0,yt=dt[ft].positionedGlyphs;mt<yt.length;mt+=1){var vt=yt[mt];vt.x+=pt,vt.y+=ct}})(w.positionedLines,Dt,Nn,Wn,yt,vt,nt,Fn,it.length),w.top+=-Wn*Fn,w.bottom=w.top+Fn,w.left+=-Nn*yt,w.right=w.left+yt}(ii,tt,et,rt,Dt,ot,at,st,ft,ct,dt,vt),!function(w){for(var tt=0,et=w;tt<et.length;tt+=1)if(0!==et[tt].positionedGlyphs.length)return!1;return!0}(ei)&&ii}xu.fromFeature=function(w,tt){for(var et=new xu,rt=0;rt<w.sections.length;rt++){var it=w.sections[rt];it.image?et.addImageSection(it):et.addTextSection(it,tt)}return et},xu.prototype.length=function(){return(this||w).text.length},xu.prototype.getSection=function(tt){return(this||w).sections[(this||w).sectionIndex[tt]]},xu.prototype.getSectionIndex=function(tt){return(this||w).sectionIndex[tt]},xu.prototype.getCharCode=function(tt){return(this||w).text.charCodeAt(tt)},xu.prototype.verticalizePunctuation=function(){(this||w).text=function(w){for(var tt="",et=0;et<w.length;et++){var rt=w.charCodeAt(et+1)||null,it=w.charCodeAt(et-1)||null;tt+=rt&&Zn(rt)&&!$c[w[et+1]]||it&&Zn(it)&&!$c[w[et-1]]||!$c[w[et]]?w[et]:$c[w[et]]}return tt}((this||w).text)},xu.prototype.trim=function(){for(var tt=0,et=0;et<(this||w).text.length&&ap[(this||w).text.charCodeAt(et)];et++)tt++;for(var rt=(this||w).text.length,it=(this||w).text.length-1;it>=0&&it>=tt&&ap[(this||w).text.charCodeAt(it)];it--)rt--;(this||w).text=(this||w).text.substring(tt,rt),(this||w).sectionIndex=(this||w).sectionIndex.slice(tt,rt)},xu.prototype.substring=function(tt,et){var rt=new xu;return rt.text=(this||w).text.substring(tt,et),rt.sectionIndex=(this||w).sectionIndex.slice(tt,et),rt.sections=(this||w).sections,rt},xu.prototype.toString=function(){return(this||w).text},xu.prototype.getMaxScale=function(){var tt=this||w;return(this||w).sectionIndex.reduce((function(w,et){return Math.max(w,tt.sections[et].scale)}),0)},xu.prototype.addTextSection=function(tt,et){(this||w).text+=tt.text,(this||w).sections.push(gu.forText(tt.scale,tt.fontStack||et));for(var rt=(this||w).sections.length-1,it=0;it<tt.text.length;++it)(this||w).sectionIndex.push(rt)},xu.prototype.addImageSection=function(tt){var et=tt.image?tt.image.name:"";if(0!==et.length){var rt=this.getNextImageSectionCharCode();rt?((this||w).text+=String.fromCharCode(rt),(this||w).sections.push(gu.forImage(et)),(this||w).sectionIndex.push((this||w).sections.length-1)):_("Reached maximum number of images 6401")}else _("Can't add FormattedSection with an empty image.")},xu.prototype.getNextImageSectionCharCode=function(){return(this||w).imageSectionID?(this||w).imageSectionID>=63743?null:++(this||w).imageSectionID:((this||w).imageSectionID=57344,(this||w).imageSectionID)};var ap={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},sp={};function Au(w,tt,et,rt,it,nt){if(tt.imageName){var ot=rt[tt.imageName];return ot?ot.displaySize[0]*tt.scale*24/nt+it:0}var at=et[tt.fontStack],st=at&&at[w];return st?st.metrics.advance*tt.scale+it:0}function Su(w,tt,et,rt){var it=Math.pow(w-tt,2);return rt?w<tt?it/2:2*it:it+Math.abs(et)*et}function ku(w,tt,et){var rt=0;return 10===w&&(rt-=1e4),et&&(rt+=150),40!==w&&65288!==w||(rt+=50),41!==tt&&65289!==tt||(rt+=50),rt}function Iu(w,tt,et,rt,it,nt){for(var ot=null,at=Su(tt,et,it,nt),st=0,ct=rt;st<ct.length;st+=1){var pt=ct[st],ft=Su(tt-pt.x,et,it,nt)+pt.badness;ft<=at&&(ot=pt,at=ft)}return{index:w,x:tt,priorBreak:ot,badness:at}}function zu(w,tt,et,rt,it,nt,ot){if("point"!==nt)return[];if(!w)return[];for(var at,st=[],ct=function(w,tt,et,rt,it,nt){for(var ot=0,at=0;at<w.length();at++){var st=w.getSection(at);ot+=Au(w.getCharCode(at),st,rt,it,tt,nt)}return ot/Math.max(1,Math.ceil(ot/et))}(w,tt,et,rt,it,ot),pt=w.text.indexOf("​")>=0,ft=0,dt=0;dt<w.length();dt++){var mt=w.getSection(dt),yt=w.getCharCode(dt);if(ap[yt]||(ft+=Au(yt,mt,rt,it,tt,ot)),dt<w.length()-1){var vt=!((at=yt)<11904||!(xs["Bopomofo Extended"](at)||xs.Bopomofo(at)||xs["CJK Compatibility Forms"](at)||xs["CJK Compatibility Ideographs"](at)||xs["CJK Compatibility"](at)||xs["CJK Radicals Supplement"](at)||xs["CJK Strokes"](at)||xs["CJK Symbols and Punctuation"](at)||xs["CJK Unified Ideographs Extension A"](at)||xs["CJK Unified Ideographs"](at)||xs["Enclosed CJK Letters and Months"](at)||xs["Halfwidth and Fullwidth Forms"](at)||xs.Hiragana(at)||xs["Ideographic Description Characters"](at)||xs["Kangxi Radicals"](at)||xs["Katakana Phonetic Extensions"](at)||xs.Katakana(at)||xs["Vertical Forms"](at)||xs["Yi Radicals"](at)||xs["Yi Syllables"](at)));(sp[yt]||vt||mt.imageName)&&st.push(Iu(dt+1,ft,ct,st,ku(yt,w.getCharCode(dt+1),vt&&pt),!1))}}return function t(w){return w?t(w.priorBreak).concat(w.index):[]}(Iu(w.length(),ft,ct,st,0,!0))}function Cu(w){var tt=.5,et=.5;switch(w){case"right":case"top-right":case"bottom-right":tt=1;break;case"left":case"top-left":case"bottom-left":tt=0}switch(w){case"bottom":case"bottom-right":case"bottom-left":et=1;break;case"top":case"top-right":case"top-left":et=0}return{horizontalAlign:tt,verticalAlign:et}}function Mu(w,tt,et,rt,it){if(rt||it)for(var nt=w[et],ot=(w[et].x+nt.metrics.advance*nt.scale)*rt,at=tt;at<=et;at++)w[at].x-=ot,w[at].y+=it}function Eu(w,tt,et,rt,it,nt){var ot,at=w.image;if(at.content){var st=at.content,ct=at.pixelRatio||1;ot=[st[0]/ct,st[1]/ct,at.displaySize[0]-st[2]/ct,at.displaySize[1]-st[3]/ct]}var pt,ft,dt,mt,yt=tt.left*nt,vt=tt.right*nt;"width"===et||"both"===et?(mt=it[0]+yt-rt[3],ft=it[0]+vt+rt[1]):ft=(mt=it[0]+(yt+vt-at.displaySize[0])/2)+at.displaySize[0];var Dt=tt.top*nt,Rt=tt.bottom*nt;return"height"===et||"both"===et?(pt=it[1]+Dt-rt[0],dt=it[1]+Rt+rt[2]):dt=(pt=it[1]+(Dt+Rt-at.displaySize[1])/2)+at.displaySize[1],{image:at,top:pt,right:ft,bottom:dt,left:mt,collisionPadding:ot}}sp[10]=!0,sp[32]=!0,sp[38]=!0,sp[40]=!0,sp[41]=!0,sp[43]=!0,sp[45]=!0,sp[47]=!0,sp[173]=!0,sp[183]=!0,sp[8203]=!0,sp[8208]=!0,sp[8211]=!0,sp[8231]=!0;var lp=function(tt){function e(et,rt,it,nt){tt.call(this||w,et,rt),(this||w).angle=it,void 0!==nt&&((this||w).segment=nt)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.clone=function(){return new e((this||w).x,(this||w).y,(this||w).angle,(this||w).segment)},e}(rt);function Pu(w,tt){var et=tt.expression;if("constant"===et.kind)return{kind:"constant",layoutSize:et.evaluate(new ai(w+1))};if("source"===et.kind)return{kind:"source"};for(var rt=et.zoomStops,it=et.interpolationType,nt=0;nt<rt.length&&rt[nt]<=w;)nt++;for(var ot=nt=Math.max(0,nt-1);ot<rt.length&&rt[ot]<w+1;)ot++;ot=Math.min(rt.length-1,ot);var at=rt[nt],st=rt[ot];return"composite"===et.kind?{kind:"composite",minZoom:at,maxZoom:st,interpolationType:it}:{kind:"camera",minZoom:at,maxZoom:st,minSize:et.evaluate(new ai(at)),maxSize:et.evaluate(new ai(st)),interpolationType:it}}function Bu(w,tt,et){var rt=tt.uSize,it=et.lowerSize;return"source"===w.kind?it/128:"composite"===w.kind?qe(it/128,et.upperSize/128,tt.uSizeT):rt}function Vu(w,tt){var et=0,rt=0;if("constant"===w.kind)rt=w.layoutSize;else if("source"!==w.kind){var it=w.interpolationType,nt=it?l(nr.interpolationFactor(it,tt,w.minZoom,w.maxZoom),0,1):0;"camera"===w.kind?rt=qe(w.minSize,w.maxSize,nt):et=nt}return{uSizeT:et,uSize:rt}}Dn("Anchor",lp);var up=Object.freeze({__proto__:null,getSizeData:Pu,evaluateSizeForFeature:Bu,evaluateSizeForZoom:Vu,SIZE_PACK_FACTOR:128});function Du(w,tt,et,rt,it){if(void 0===tt.segment)return!0;for(var nt=tt,ot=tt.segment+1,at=0;at>-et/2;){if(--ot<0)return!1;at-=w[ot].dist(nt),nt=w[ot]}at+=w[ot].dist(w[ot+1]),ot++;for(var st=[],ct=0;at<et/2;){var pt=w[ot],ft=w[ot+1];if(!ft)return!1;var dt=w[ot-1].angleTo(pt)-pt.angleTo(ft);for(dt=Math.abs((dt+3*Math.PI)%(2*Math.PI)-Math.PI),st.push({distance:at,angleDelta:dt}),ct+=dt;at-st[0].distance>rt;)ct-=st.shift().angleDelta;if(ct>it)return!1;ot++,at+=pt.dist(ft)}return!0}function Lu(w){for(var tt=0,et=0;et<w.length-1;et++)tt+=w[et].dist(w[et+1]);return tt}function Ru(w,tt,et){return w?.6*tt*et:0}function Ou(w,tt){return Math.max(w?w.right-w.left:0,tt?tt.right-tt.left:0)}function Uu(w,tt,et,rt,it,nt){for(var ot=Ru(et,it,nt),at=Ou(et,rt)*nt,st=0,ct=Lu(w)/2,pt=0;pt<w.length-1;pt++){var ft=w[pt],dt=w[pt+1],mt=ft.dist(dt);if(st+mt>ct){var yt=(ct-st)/mt,vt=qe(ft.x,dt.x,yt),Dt=qe(ft.y,dt.y,yt),Rt=new lp(vt,Dt,dt.angleTo(ft),pt);return Rt._round(),!ot||Du(w,Rt,at,ot,tt)?Rt:void 0}st+=mt}}function ju(w,tt,et,rt,it,nt,ot,at,st){var ct=Ru(rt,nt,ot),pt=Ou(rt,it),ft=pt*ot,dt=0===w[0].x||w[0].x===st||0===w[0].y||w[0].y===st;return tt-ft<tt/4&&(tt=ft+tt/4),function t(w,tt,et,rt,it,nt,ot,at,st){for(var ct=nt/2,pt=Lu(w),ft=0,dt=tt-et,mt=[],yt=0;yt<w.length-1;yt++){for(var vt=w[yt],Dt=w[yt+1],Rt=vt.dist(Dt),Bt=Dt.angleTo(vt);dt+et<ft+Rt;){var Ot=((dt+=et)-ft)/Rt,Ne=qe(vt.x,Dt.x,Ot),Ze=qe(vt.y,Dt.y,Ot);if(Ne>=0&&Ne<st&&Ze>=0&&Ze<st&&dt-ct>=0&&dt+ct<=pt){var Ge=new lp(Ne,Ze,Bt,yt);Ge._round(),rt&&!Du(w,Ge,nt,rt,it)||mt.push(Ge)}}ft+=Rt}return at||mt.length||ot||(mt=t(w,ft/2,et,rt,it,nt,ot,!0,st)),mt}(w,dt?tt/2*at%tt:(pt/2+2*nt)*ot*at%tt,tt,ct,et,ft,dt,!1,st)}function qu(w,tt,et,it,nt){for(var ot=[],at=0;at<w.length;at++)for(var st=w[at],ct=void 0,pt=0;pt<st.length-1;pt++){var ft=st[pt],dt=st[pt+1];ft.x<tt&&dt.x<tt||(ft.x<tt?ft=new rt(tt,ft.y+(tt-ft.x)/(dt.x-ft.x)*(dt.y-ft.y))._round():dt.x<tt&&(dt=new rt(tt,ft.y+(tt-ft.x)/(dt.x-ft.x)*(dt.y-ft.y))._round()),ft.y<et&&dt.y<et||(ft.y<et?ft=new rt(ft.x+(et-ft.y)/(dt.y-ft.y)*(dt.x-ft.x),et)._round():dt.y<et&&(dt=new rt(ft.x+(et-ft.y)/(dt.y-ft.y)*(dt.x-ft.x),et)._round()),ft.x>=it&&dt.x>=it||(ft.x>=it?ft=new rt(it,ft.y+(it-ft.x)/(dt.x-ft.x)*(dt.y-ft.y))._round():dt.x>=it&&(dt=new rt(it,ft.y+(it-ft.x)/(dt.x-ft.x)*(dt.y-ft.y))._round()),ft.y>=nt&&dt.y>=nt||(ft.y>=nt?ft=new rt(ft.x+(nt-ft.y)/(dt.y-ft.y)*(dt.x-ft.x),nt)._round():dt.y>=nt&&(dt=new rt(ft.x+(nt-ft.y)/(dt.y-ft.y)*(dt.x-ft.x),nt)._round()),ct&&ft.equals(ct[ct.length-1])||ot.push(ct=[ft]),ct.push(dt)))))}return ot}function Nu(w,tt,et,it){var nt=[],ot=w.image,at=ot.pixelRatio,st=ot.paddedRect.w-2,ct=ot.paddedRect.h-2,pt=w.right-w.left,ft=w.bottom-w.top,dt=ot.stretchX||[[0,st]],mt=ot.stretchY||[[0,ct]],y=function(w,tt){return w+tt[1]-tt[0]},yt=dt.reduce(y,0),vt=mt.reduce(y,0),Dt=st-yt,Rt=ct-vt,Bt=0,Ot=yt,Ne=0,Ze=vt,Ge=0,Ke=Dt,er=0,rr=Rt;if(ot.content&&it){var vr=ot.content;Bt=Ku(dt,0,vr[0]),Ne=Ku(mt,0,vr[1]),Ot=Ku(dt,vr[0],vr[2]),Ze=Ku(mt,vr[1],vr[3]),Ge=vr[0]-Bt,er=vr[1]-Ne,Ke=vr[2]-vr[0]-Ot,rr=vr[3]-vr[1]-Ze}var C=function(it,nt,st,ct){var dt=Zu(it.stretch-Bt,Ot,pt,w.left),mt=Xu(it.fixed-Ge,Ke,it.stretch,yt),Dt=Zu(nt.stretch-Ne,Ze,ft,w.top),Rt=Xu(nt.fixed-er,rr,nt.stretch,vt),vr=Zu(st.stretch-Bt,Ot,pt,w.left),wr=Xu(st.fixed-Ge,Ke,st.stretch,yt),Sr=Zu(ct.stretch-Ne,Ze,ft,w.top),ei=Xu(ct.fixed-er,rr,ct.stretch,vt),ii=new rt(dt,Dt),mi=new rt(vr,Dt),qi=new rt(vr,Sr),Ki=new rt(dt,Sr),Ji=new rt(mt/at,Rt/at),rn=new rt(wr/at,ei/at),vn=tt*Math.PI/180;if(vn){var bn=Math.sin(vn),Tn=Math.cos(vn),In=[Tn,-bn,bn,Tn];ii._matMult(In),mi._matMult(In),Ki._matMult(In),qi._matMult(In)}var zn=it.stretch+it.fixed,Cn=nt.stretch+nt.fixed;return{tl:ii,tr:mi,bl:Ki,br:qi,tex:{x:ot.paddedRect.x+1+zn,y:ot.paddedRect.y+1+Cn,w:st.stretch+st.fixed-zn,h:ct.stretch+ct.fixed-Cn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ji,pixelOffsetBR:rn,minFontScaleX:Ke/at/pt,minFontScaleY:rr/at/ft,isSDF:et}};if(it&&(ot.stretchX||ot.stretchY))for(var wr=Gu(dt,Dt,yt),Sr=Gu(mt,Rt,vt),ei=0;ei<wr.length-1;ei++)for(var ii=wr[ei],mi=wr[ei+1],qi=0;qi<Sr.length-1;qi++)nt.push(C(ii,Sr[qi],mi,Sr[qi+1]));else nt.push(C({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:st+1},{fixed:0,stretch:ct+1}));return nt}function Ku(w,tt,et){for(var rt=0,it=0,nt=w;it<nt.length;it+=1){var ot=nt[it];rt+=Math.max(tt,Math.min(et,ot[1]))-Math.max(tt,Math.min(et,ot[0]))}return rt}function Gu(w,tt,et){for(var rt=[{fixed:-1,stretch:0}],it=0,nt=w;it<nt.length;it+=1){var ot=nt[it],at=ot[0],st=ot[1],ct=rt[rt.length-1];rt.push({fixed:at-ct.stretch,stretch:ct.stretch}),rt.push({fixed:at-ct.stretch,stretch:ct.stretch+(st-at)})}return rt.push({fixed:tt+1,stretch:et}),rt}function Zu(w,tt,et,rt){return w/tt*et+rt}function Xu(w,tt,et,rt){return w-tt*et/rt}var Ju=function(tt,et,it,nt,ot,at,st,ct,pt,ft){if((this||w).boxStartIndex=tt.length,pt){var dt=at.top,mt=at.bottom,yt=at.collisionPadding;yt&&(dt-=yt[1],mt+=yt[3]);var vt=mt-dt;vt>0&&(vt=Math.max(10,vt),(this||w).circleDiameter=vt)}else{var Dt=at.top*st-ct,Rt=at.bottom*st+ct,Bt=at.left*st-ct,Ot=at.right*st+ct,Ne=at.collisionPadding;if(Ne&&(Bt-=Ne[0]*st,Dt-=Ne[1]*st,Ot+=Ne[2]*st,Rt+=Ne[3]*st),ft){var Ze=new rt(Bt,Dt),Ge=new rt(Ot,Dt),Ke=new rt(Bt,Rt),er=new rt(Ot,Rt),rr=ft*Math.PI/180;Ze._rotate(rr),Ge._rotate(rr),Ke._rotate(rr),er._rotate(rr),Bt=Math.min(Ze.x,Ge.x,Ke.x,er.x),Ot=Math.max(Ze.x,Ge.x,Ke.x,er.x),Dt=Math.min(Ze.y,Ge.y,Ke.y,er.y),Rt=Math.max(Ze.y,Ge.y,Ke.y,er.y)}tt.emplaceBack(et.x,et.y,Bt,Dt,Ot,Rt,it,nt,ot)}(this||w).boxEndIndex=tt.length},Hu=function(tt,et){if(void 0===tt&&(tt=[]),void 0===et&&(et=Yu),(this||w).data=tt,(this||w).length=(this||w).data.length,(this||w).compare=et,(this||w).length>0)for(var rt=((this||w).length>>1)-1;rt>=0;rt--)this._down(rt)};function Yu(w,tt){return w<tt?-1:w>tt?1:0}function $u(w,tt,et){void 0===tt&&(tt=1),void 0===et&&(et=!1);for(var it=1/0,nt=1/0,ot=-1/0,at=-1/0,st=w[0],ct=0;ct<st.length;ct++){var pt=st[ct];(!ct||pt.x<it)&&(it=pt.x),(!ct||pt.y<nt)&&(nt=pt.y),(!ct||pt.x>ot)&&(ot=pt.x),(!ct||pt.y>at)&&(at=pt.y)}var ft=Math.min(ot-it,at-nt),dt=ft/2,mt=new Hu([],Wu);if(0===ft)return new rt(it,nt);for(var yt=it;yt<ot;yt+=ft)for(var vt=nt;vt<at;vt+=ft)mt.push(new Qu(yt+dt,vt+dt,dt,w));for(var Dt=function(w){for(var tt=0,et=0,rt=0,it=w[0],nt=0,ot=it.length,at=ot-1;nt<ot;at=nt++){var st=it[nt],ct=it[at],pt=st.x*ct.y-ct.x*st.y;et+=(st.x+ct.x)*pt,rt+=(st.y+ct.y)*pt,tt+=3*pt}return new Qu(et/tt,rt/tt,0,w)}(w),Rt=mt.length;mt.length;){var Bt=mt.pop();(Bt.d>Dt.d||!Dt.d)&&(Dt=Bt,et&&console.log("found best %d after %d probes",Math.round(1e4*Bt.d)/1e4,Rt)),Bt.max-Dt.d<=tt||(mt.push(new Qu(Bt.p.x-(dt=Bt.h/2),Bt.p.y-dt,dt,w)),mt.push(new Qu(Bt.p.x+dt,Bt.p.y-dt,dt,w)),mt.push(new Qu(Bt.p.x-dt,Bt.p.y+dt,dt,w)),mt.push(new Qu(Bt.p.x+dt,Bt.p.y+dt,dt,w)),Rt+=4)}return et&&(console.log("num probes: "+Rt),console.log("best distance: "+Dt.d)),Dt.p}function Wu(w,tt){return tt.max-w.max}function Qu(tt,et,it,nt){(this||w).p=new rt(tt,et),(this||w).h=it,(this||w).d=function(w,tt){for(var et=!1,rt=1/0,it=0;it<tt.length;it++)for(var nt=tt[it],ot=0,at=nt.length,st=at-1;ot<at;st=ot++){var ct=nt[ot],pt=nt[st];ct.y>w.y!=pt.y>w.y&&w.x<(pt.x-ct.x)*(w.y-ct.y)/(pt.y-ct.y)+ct.x&&(et=!et),rt=Math.min(rt,Xa(w,ct,pt))}return(et?1:-1)*Math.sqrt(rt)}((this||w).p,nt),(this||w).max=(this||w).d+(this||w).h*Math.SQRT2}Hu.prototype.push=function(tt){(this||w).data.push(tt),(this||w).length++,this._up((this||w).length-1)},Hu.prototype.pop=function(){if(0!==(this||w).length){var tt=(this||w).data[0],et=(this||w).data.pop();return(this||w).length--,(this||w).length>0&&((this||w).data[0]=et,this._down(0)),tt}},Hu.prototype.peek=function(){return(this||w).data[0]},Hu.prototype._up=function(tt){for(var et=(this||w).data,rt=(this||w).compare,it=et[tt];tt>0;){var nt=tt-1>>1,ot=et[nt];if(rt(it,ot)>=0)break;et[tt]=ot,tt=nt}et[tt]=it},Hu.prototype._down=function(tt){for(var et=(this||w).data,rt=(this||w).compare,it=(this||w).length>>1,nt=et[tt];tt<it;){var ot=1+(tt<<1),at=et[ot],st=ot+1;if(st<(this||w).length&&rt(et[st],at)<0&&(ot=st,at=et[st]),rt(at,nt)>=0)break;et[tt]=at,tt=ot}et[tt]=nt};var cp=Number.POSITIVE_INFINITY;function el(w,tt){return tt[1]!==cp?function(w,tt,et){var rt=0,it=0;switch(tt=Math.abs(tt),et=Math.abs(et),w){case"top-right":case"top-left":case"top":it=et-7;break;case"bottom-right":case"bottom-left":case"bottom":it=7-et}switch(w){case"top-right":case"bottom-right":case"right":rt=-tt;break;case"top-left":case"bottom-left":case"left":rt=tt}return[rt,it]}(w,tt[0],tt[1]):function(w,tt){var et=0,rt=0;tt<0&&(tt=0);var it=tt/Math.sqrt(2);switch(w){case"top-right":case"top-left":rt=it-7;break;case"bottom-right":case"bottom-left":rt=7-it;break;case"bottom":rt=7-tt;break;case"top":rt=tt-7}switch(w){case"top-right":case"bottom-right":et=-it;break;case"top-left":case"bottom-left":et=it;break;case"left":et=tt;break;case"right":et=-tt}return[et,rt]}(w,tt[0])}function rl(w){switch(w){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function nl(w,tt,et,it,nt,ot,at,st,ct,pt,ft,dt,mt,yt,vt){var Dt=function(w,tt,et,it,nt,ot,at,st){for(var ct=it.layout.get("text-rotate").evaluate(ot,{})*Math.PI/180,pt=[],ft=0,dt=tt.positionedLines;ft<dt.length;ft+=1)for(var mt=dt[ft],yt=0,vt=mt.positionedGlyphs;yt<vt.length;yt+=1){var Dt=vt[yt];if(Dt.rect){var Rt=Dt.rect||{},Bt=4,Ot=!0,Ne=1,Ze=0,Ge=(nt||st)&&Dt.vertical,Ke=Dt.metrics.advance*Dt.scale/2;if(st&&tt.verticalizable&&(Ze=mt.lineOffset/2-(Dt.imageName?-(24-Dt.metrics.width*Dt.scale)/2:24*(Dt.scale-1))),Dt.imageName){var er=at[Dt.imageName];Ot=er.sdf,Bt=1/(Ne=er.pixelRatio)}var rr=nt?[Dt.x+Ke,Dt.y]:[0,0],vr=nt?[0,0]:[Dt.x+Ke+et[0],Dt.y+et[1]-Ze],wr=[0,0];Ge&&(wr=vr,vr=[0,0]);var Sr=(Dt.metrics.left-Bt)*Dt.scale-Ke+vr[0],ei=(-Dt.metrics.top-Bt)*Dt.scale+vr[1],ii=Sr+Rt.w*Dt.scale/Ne,mi=ei+Rt.h*Dt.scale/Ne,qi=new rt(Sr,ei),Ki=new rt(ii,ei),Ji=new rt(Sr,mi),rn=new rt(ii,mi);if(Ge){var vn=new rt(-Ke,Ke- -17),bn=-Math.PI/2,Tn=12-Ke,In=new rt(22-Tn,-(Dt.imageName?Tn:0)),zn=new(Function.prototype.bind.apply(rt,[null].concat(wr)));qi._rotateAround(bn,vn)._add(In)._add(zn),Ki._rotateAround(bn,vn)._add(In)._add(zn),Ji._rotateAround(bn,vn)._add(In)._add(zn),rn._rotateAround(bn,vn)._add(In)._add(zn)}if(ct){var Cn=Math.sin(ct),Mn=Math.cos(ct),Ln=[Mn,-Cn,Cn,Mn];qi._matMult(Ln),Ki._matMult(Ln),Ji._matMult(Ln),rn._matMult(Ln)}var Bn=new rt(0,0),Fn=new rt(0,0);pt.push({tl:qi,tr:Ki,bl:Ji,br:rn,tex:Rt,writingMode:tt.writingMode,glyphOffset:rr,sectionIndex:Dt.sectionIndex,isSDF:Ot,pixelOffsetTL:Bn,pixelOffsetBR:Fn,minFontScaleX:0,minFontScaleY:0})}}return pt}(0,et,st,nt,ot,at,it,w.allowVerticalPlacement),Rt=w.textSizeData,Bt=null;"source"===Rt.kind?(Bt=[128*nt.layout.get("text-size").evaluate(at,{})])[0]>32640&&_(w.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===Rt.kind&&((Bt=[128*yt.compositeTextSizes[0].evaluate(at,{},vt),128*yt.compositeTextSizes[1].evaluate(at,{},vt)])[0]>32640||Bt[1]>32640)&&_(w.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),w.addSymbols(w.text,Dt,Bt,st,ot,at,pt,tt,ct.lineStartIndex,ct.lineLength,mt,vt);for(var Ot=0,Ne=ft;Ot<Ne.length;Ot+=1)dt[Ne[Ot]]=w.text.placedSymbolArray.length-1;return 4*Dt.length}function il(w){for(var tt in w)return w[tt];return null}function al(w,tt,et,rt){var it=w.compareText;if(tt in it){for(var nt=it[tt],ot=nt.length-1;ot>=0;ot--)if(rt.dist(nt[ot])<et)return!0}else it[tt]=[];return it[tt].push(rt),!1}var pp=Lc.VectorTileFeature.types,hp=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ul(w,tt,et,rt,it,nt,ot,at,st,ct,pt,ft,dt){var mt=at?Math.min(32640,Math.round(at[0])):0,yt=at?Math.min(32640,Math.round(at[1])):0;w.emplaceBack(tt,et,Math.round(32*rt),Math.round(32*it),nt,ot,(mt<<1)+(st?1:0),yt,16*ct,16*pt,256*ft,256*dt)}function ll(w,tt,et){w.emplaceBack(tt.x,tt.y,et),w.emplaceBack(tt.x,tt.y,et),w.emplaceBack(tt.x,tt.y,et),w.emplaceBack(tt.x,tt.y,et)}function pl(w){for(var tt=0,et=w.sections;tt<et.length;tt+=1)if(Hn(et[tt].text))return!0;return!1}var cl=function(tt){(this||w).layoutVertexArray=new Vs,(this||w).indexArray=new sl,(this||w).programConfigurations=tt,(this||w).segments=new aa,(this||w).dynamicLayoutVertexArray=new Ns,(this||w).opacityVertexArray=new js,(this||w).placedSymbolArray=new Cl};cl.prototype.isEmpty=function(){return 0===(this||w).layoutVertexArray.length&&0===(this||w).indexArray.length&&0===(this||w).dynamicLayoutVertexArray.length&&0===(this||w).opacityVertexArray.length},cl.prototype.upload=function(tt,et,rt,it){this.isEmpty()||(rt&&((this||w).layoutVertexBuffer=tt.createVertexBuffer((this||w).layoutVertexArray,Wc.members),(this||w).indexBuffer=tt.createIndexBuffer((this||w).indexArray,et),(this||w).dynamicLayoutVertexBuffer=tt.createVertexBuffer((this||w).dynamicLayoutVertexArray,Hc.members,!0),(this||w).opacityVertexBuffer=tt.createVertexBuffer((this||w).opacityVertexArray,hp,!0),(this||w).opacityVertexBuffer.itemSize=1),(rt||it)&&(this||w).programConfigurations.upload(tt))},cl.prototype.destroy=function(){(this||w).layoutVertexBuffer&&((this||w).layoutVertexBuffer.destroy(),(this||w).indexBuffer.destroy(),(this||w).programConfigurations.destroy(),(this||w).segments.destroy(),(this||w).dynamicLayoutVertexBuffer.destroy(),(this||w).opacityVertexBuffer.destroy())},Dn("SymbolBuffers",cl);var hl=function(tt,et,rt){(this||w).layoutVertexArray=new tt,(this||w).layoutAttributes=et,(this||w).indexArray=new rt,(this||w).segments=new aa,(this||w).collisionVertexArray=new ol};hl.prototype.upload=function(tt){(this||w).layoutVertexBuffer=tt.createVertexBuffer((this||w).layoutVertexArray,(this||w).layoutAttributes),(this||w).indexBuffer=tt.createIndexBuffer((this||w).indexArray),(this||w).collisionVertexBuffer=tt.createVertexBuffer((this||w).collisionVertexArray,Kc.members,!0)},hl.prototype.destroy=function(){(this||w).layoutVertexBuffer&&((this||w).layoutVertexBuffer.destroy(),(this||w).indexBuffer.destroy(),(this||w).segments.destroy(),(this||w).collisionVertexBuffer.destroy())},Dn("CollisionBuffers",hl);var fl=function(tt){(this||w).collisionBoxArray=tt.collisionBoxArray,(this||w).zoom=tt.zoom,(this||w).overscaling=tt.overscaling,(this||w).layers=tt.layers,(this||w).layerIds=(this||w).layers.map((function(w){return w.id})),(this||w).index=tt.index,(this||w).pixelRatio=tt.pixelRatio,(this||w).sourceLayerIndex=tt.sourceLayerIndex,(this||w).hasPattern=!1,(this||w).hasRTLText=!1,(this||w).sortKeyRanges=[],(this||w).collisionCircleArray=[],(this||w).placementInvProjMatrix=no([]),(this||w).placementViewportMatrix=no([]);var et=(this||w).layers[0]._unevaluatedLayout._values;(this||w).textSizeData=Pu((this||w).zoom,et["text-size"]),(this||w).iconSizeData=Pu((this||w).zoom,et["icon-size"]);var rt=(this||w).layers[0].layout,it=rt.get("symbol-sort-key"),nt=rt.get("symbol-z-order");(this||w).sortFeaturesByKey="viewport-y"!==nt&&void 0!==it.constantOr(1),(this||w).sortFeaturesByY=("viewport-y"===nt||"auto"===nt&&!(this||w).sortFeaturesByKey)&&(rt.get("text-allow-overlap")||rt.get("icon-allow-overlap")||rt.get("text-ignore-placement")||rt.get("icon-ignore-placement")),"point"===rt.get("symbol-placement")&&((this||w).writingModes=rt.get("text-writing-mode").map((function(w){return op[w]}))),(this||w).stateDependentLayerIds=(this||w).layers.filter((function(w){return w.isStateDependent()})).map((function(w){return w.id})),(this||w).sourceID=tt.sourceID};fl.prototype.createArrays=function(){(this||w).text=new cl(new Pa((this||w).layers,(this||w).zoom,(function(w){return/^text/.test(w)}))),(this||w).icon=new cl(new Pa((this||w).layers,(this||w).zoom,(function(w){return/^icon/.test(w)}))),(this||w).glyphOffsetArray=new Hl,(this||w).lineVertexArray=new du,(this||w).symbolInstances=new Fl},fl.prototype.calculateGlyphDependencies=function(w,tt,et,rt,it){for(var nt=0;nt<w.length;nt++)if(tt[w.charCodeAt(nt)]=!0,(et||rt)&&it){var ot=$c[w.charAt(nt)];ot&&(tt[ot.charCodeAt(0)]=!0)}},fl.prototype.populate=function(tt,et,rt){var it=(this||w).layers[0],nt=it.layout,ot=nt.get("text-font"),at=nt.get("text-field"),st=nt.get("icon-image"),ct=("constant"!==at.value.kind||at.value.value instanceof ee&&!at.value.value.isEmpty()||at.value.value.toString().length>0)&&("constant"!==ot.value.kind||ot.value.value.length>0),pt="constant"!==st.value.kind||!!st.value.value||Object.keys(st.parameters).length>0,ft=nt.get("symbol-sort-key");if((this||w).features=[],ct||pt){for(var dt=et.iconDependencies,mt=et.glyphDependencies,yt=et.availableImages,vt=new ai((this||w).zoom),Dt=0,Rt=tt;Dt<Rt.length;Dt+=1){var Bt=Rt[Dt],Ot=Bt.feature,Ne=Bt.id,Ze=Bt.index,Ge=Bt.sourceLayerIndex,Ke=it._featureFilter.needGeometry,er={type:Ot.type,id:Ne,properties:Ot.properties,geometry:Ke?La(Ot):[]};if(it._featureFilter.filter(vt,er,rt)){Ke||(er.geometry=La(Ot));var rr=void 0;if(ct){var vr=it.getValueAndResolveTokens("text-field",er,rt,yt),wr=ee.factory(vr);pl(wr)&&((this||w).hasRTLText=!0),(!(this||w).hasRTLText||"unavailable"===ri()||(this||w).hasRTLText&&Ps.isParsed())&&(rr=qs(wr,it,er))}var Sr=void 0;if(pt){var ei=it.getValueAndResolveTokens("icon-image",er,rt,yt);Sr=ei instanceof re?ei:re.fromString(ei)}if(rr||Sr){var ii=(this||w).sortFeaturesByKey?ft.evaluate(er,{},rt):void 0,mi={id:Ne,text:rr,icon:Sr,index:Ze,sourceLayerIndex:Ge,geometry:La(Ot),properties:Ot.properties,type:pp[Ot.type],sortKey:ii};if((this||w).features.push(mi),Sr&&(dt[Sr.name]=!0),rr){var qi=ot.evaluate(er,{},rt).join(","),Ki="map"===nt.get("text-rotation-alignment")&&"point"!==nt.get("symbol-placement");(this||w).allowVerticalPlacement=(this||w).writingModes&&(this||w).writingModes.indexOf(op.vertical)>=0;for(var Ji=0,rn=rr.sections;Ji<rn.length;Ji+=1){var vn=rn[Ji];if(vn.image)dt[vn.image.name]=!0;else{var bn=Kn(rr.toString()),Tn=vn.fontStack||qi,In=mt[Tn]=mt[Tn]||{};this.calculateGlyphDependencies(vn.text,In,Ki,(this||w).allowVerticalPlacement,bn)}}}}}}"line"===nt.get("symbol-placement")&&((this||w).features=function(w){var tt={},et={},rt=[],it=0;function a(tt){rt.push(w[tt]),it++}function o(w,tt,it){var nt=et[w];return delete et[w],et[tt]=nt,rt[nt].geometry[0].pop(),rt[nt].geometry[0]=rt[nt].geometry[0].concat(it[0]),nt}function s(w,et,it){var nt=tt[et];return delete tt[et],tt[w]=nt,rt[nt].geometry[0].shift(),rt[nt].geometry[0]=it[0].concat(rt[nt].geometry[0]),nt}function u(w,tt,et){var rt=et?tt[0][tt[0].length-1]:tt[0][0];return w+":"+rt.x+":"+rt.y}for(var nt=0;nt<w.length;nt++){var ot=w[nt],at=ot.geometry,st=ot.text?ot.text.toString():null;if(st){var ct=u(st,at),pt=u(st,at,!0);if(ct in et&&pt in tt&&et[ct]!==tt[pt]){var ft=s(ct,pt,at),dt=o(ct,pt,rt[ft].geometry);delete tt[ct],delete et[pt],et[u(st,rt[dt].geometry,!0)]=dt,rt[ft].geometry=null}else ct in et?o(ct,pt,at):pt in tt?s(ct,pt,at):(a(nt),tt[ct]=it-1,et[pt]=it-1)}else a(nt)}return rt.filter((function(w){return w.geometry}))}((this||w).features)),(this||w).sortFeaturesByKey&&(this||w).features.sort((function(w,tt){return w.sortKey-tt.sortKey}))}},fl.prototype.update=function(tt,et,rt){(this||w).stateDependentLayers.length&&((this||w).text.programConfigurations.updatePaintArrays(tt,et,(this||w).layers,rt),(this||w).icon.programConfigurations.updatePaintArrays(tt,et,(this||w).layers,rt))},fl.prototype.isEmpty=function(){return 0===(this||w).symbolInstances.length&&!(this||w).hasRTLText},fl.prototype.uploadPending=function(){return!(this||w).uploaded||(this||w).text.programConfigurations.needsUpload||(this||w).icon.programConfigurations.needsUpload},fl.prototype.upload=function(tt){!(this||w).uploaded&&this.hasDebugData()&&((this||w).textCollisionBox.upload(tt),(this||w).iconCollisionBox.upload(tt)),(this||w).text.upload(tt,(this||w).sortFeaturesByY,!(this||w).uploaded,(this||w).text.programConfigurations.needsUpload),(this||w).icon.upload(tt,(this||w).sortFeaturesByY,!(this||w).uploaded,(this||w).icon.programConfigurations.needsUpload),(this||w).uploaded=!0},fl.prototype.destroyDebugData=function(){(this||w).textCollisionBox.destroy(),(this||w).iconCollisionBox.destroy()},fl.prototype.destroy=function(){(this||w).text.destroy(),(this||w).icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},fl.prototype.addToLineVertexArray=function(tt,et){var rt=(this||w).lineVertexArray.length;if(void 0!==tt.segment){for(var it=tt.dist(et[tt.segment+1]),nt=tt.dist(et[tt.segment]),ot={},at=tt.segment+1;at<et.length;at++)ot[at]={x:et[at].x,y:et[at].y,tileUnitDistanceFromAnchor:it},at<et.length-1&&(it+=et[at+1].dist(et[at]));for(var st=tt.segment||0;st>=0;st--)ot[st]={x:et[st].x,y:et[st].y,tileUnitDistanceFromAnchor:nt},st>0&&(nt+=et[st-1].dist(et[st]));for(var ct=0;ct<et.length;ct++){var pt=ot[ct];(this||w).lineVertexArray.emplaceBack(pt.x,pt.y,pt.tileUnitDistanceFromAnchor)}}return{lineStartIndex:rt,lineLength:(this||w).lineVertexArray.length-rt}},fl.prototype.addSymbols=function(tt,et,rt,it,nt,ot,at,st,ct,pt,ft,dt){for(var mt=tt.indexArray,yt=tt.layoutVertexArray,vt=tt.segments.prepareSegment(4*et.length,yt,mt,ot.sortKey),Dt=(this||w).glyphOffsetArray.length,Rt=vt.vertexLength,Bt=(this||w).allowVerticalPlacement&&at===op.vertical?Math.PI/2:0,Ot=ot.text&&ot.text.sections,Ne=0;Ne<et.length;Ne++){var Ze=et[Ne],Ge=Ze.tl,Ke=Ze.tr,er=Ze.bl,rr=Ze.br,vr=Ze.tex,wr=Ze.pixelOffsetTL,Sr=Ze.pixelOffsetBR,ei=Ze.minFontScaleX,ii=Ze.minFontScaleY,mi=Ze.glyphOffset,qi=Ze.isSDF,Ki=Ze.sectionIndex,Ji=vt.vertexLength,rn=mi[1];ul(yt,st.x,st.y,Ge.x,rn+Ge.y,vr.x,vr.y,rt,qi,wr.x,wr.y,ei,ii),ul(yt,st.x,st.y,Ke.x,rn+Ke.y,vr.x+vr.w,vr.y,rt,qi,Sr.x,wr.y,ei,ii),ul(yt,st.x,st.y,er.x,rn+er.y,vr.x,vr.y+vr.h,rt,qi,wr.x,Sr.y,ei,ii),ul(yt,st.x,st.y,rr.x,rn+rr.y,vr.x+vr.w,vr.y+vr.h,rt,qi,Sr.x,Sr.y,ei,ii),ll(tt.dynamicLayoutVertexArray,st,Bt),mt.emplaceBack(Ji,Ji+1,Ji+2),mt.emplaceBack(Ji+1,Ji+2,Ji+3),vt.vertexLength+=4,vt.primitiveLength+=2,(this||w).glyphOffsetArray.emplaceBack(mi[0]),Ne!==et.length-1&&Ki===et[Ne+1].sectionIndex||tt.programConfigurations.populatePaintArrays(yt.length,ot,ot.index,{},dt,Ot&&Ot[Ki])}tt.placedSymbolArray.emplaceBack(st.x,st.y,Dt,(this||w).glyphOffsetArray.length-Dt,Rt,ct,pt,st.segment,rt?rt[0]:0,rt?rt[1]:0,it[0],it[1],at,0,!1,0,ft)},fl.prototype._addCollisionDebugVertex=function(w,tt,et,rt,it,nt){return tt.emplaceBack(0,0),w.emplaceBack(et.x,et.y,rt,it,Math.round(nt.x),Math.round(nt.y))},fl.prototype.addCollisionDebugVertices=function(w,tt,et,it,nt,ot,at){var st=nt.segments.prepareSegment(4,nt.layoutVertexArray,nt.indexArray),ct=st.vertexLength,pt=nt.layoutVertexArray,ft=nt.collisionVertexArray,dt=at.anchorX,mt=at.anchorY;this._addCollisionDebugVertex(pt,ft,ot,dt,mt,new rt(w,tt)),this._addCollisionDebugVertex(pt,ft,ot,dt,mt,new rt(et,tt)),this._addCollisionDebugVertex(pt,ft,ot,dt,mt,new rt(et,it)),this._addCollisionDebugVertex(pt,ft,ot,dt,mt,new rt(w,it)),st.vertexLength+=4;var yt=nt.indexArray;yt.emplaceBack(ct,ct+1),yt.emplaceBack(ct+1,ct+2),yt.emplaceBack(ct+2,ct+3),yt.emplaceBack(ct+3,ct),st.primitiveLength+=4},fl.prototype.addDebugCollisionBoxes=function(tt,et,rt,it){for(var nt=tt;nt<et;nt++){var ot=(this||w).collisionBoxArray.get(nt);this.addCollisionDebugVertices(ot.x1,ot.y1,ot.x2,ot.y2,it?(this||w).textCollisionBox:(this||w).iconCollisionBox,ot.anchorPoint,rt)}},fl.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),(this||w).textCollisionBox=new hl(Js,Yc.members,xl),(this||w).iconCollisionBox=new hl(Js,Yc.members,xl);for(var tt=0;tt<(this||w).symbolInstances.length;tt++){var et=(this||w).symbolInstances.get(tt);this.addDebugCollisionBoxes(et.textBoxStartIndex,et.textBoxEndIndex,et,!0),this.addDebugCollisionBoxes(et.verticalTextBoxStartIndex,et.verticalTextBoxEndIndex,et,!0),this.addDebugCollisionBoxes(et.iconBoxStartIndex,et.iconBoxEndIndex,et,!1),this.addDebugCollisionBoxes(et.verticalIconBoxStartIndex,et.verticalIconBoxEndIndex,et,!1)}},fl.prototype._deserializeCollisionBoxesForSymbol=function(w,tt,et,rt,it,nt,ot,at,st){for(var ct={},pt=tt;pt<et;pt++){var ft=w.get(pt);ct.textBox={x1:ft.x1,y1:ft.y1,x2:ft.x2,y2:ft.y2,anchorPointX:ft.anchorPointX,anchorPointY:ft.anchorPointY},ct.textFeatureIndex=ft.featureIndex;break}for(var dt=rt;dt<it;dt++){var mt=w.get(dt);ct.verticalTextBox={x1:mt.x1,y1:mt.y1,x2:mt.x2,y2:mt.y2,anchorPointX:mt.anchorPointX,anchorPointY:mt.anchorPointY},ct.verticalTextFeatureIndex=mt.featureIndex;break}for(var yt=nt;yt<ot;yt++){var vt=w.get(yt);ct.iconBox={x1:vt.x1,y1:vt.y1,x2:vt.x2,y2:vt.y2,anchorPointX:vt.anchorPointX,anchorPointY:vt.anchorPointY},ct.iconFeatureIndex=vt.featureIndex;break}for(var Dt=at;Dt<st;Dt++){var Rt=w.get(Dt);ct.verticalIconBox={x1:Rt.x1,y1:Rt.y1,x2:Rt.x2,y2:Rt.y2,anchorPointX:Rt.anchorPointX,anchorPointY:Rt.anchorPointY},ct.verticalIconFeatureIndex=Rt.featureIndex;break}return ct},fl.prototype.deserializeCollisionBoxes=function(tt){(this||w).collisionArrays=[];for(var et=0;et<(this||w).symbolInstances.length;et++){var rt=(this||w).symbolInstances.get(et);(this||w).collisionArrays.push(this._deserializeCollisionBoxesForSymbol(tt,rt.textBoxStartIndex,rt.textBoxEndIndex,rt.verticalTextBoxStartIndex,rt.verticalTextBoxEndIndex,rt.iconBoxStartIndex,rt.iconBoxEndIndex,rt.verticalIconBoxStartIndex,rt.verticalIconBoxEndIndex))}},fl.prototype.hasTextData=function(){return(this||w).text.segments.get().length>0},fl.prototype.hasIconData=function(){return(this||w).icon.segments.get().length>0},fl.prototype.hasDebugData=function(){return(this||w).textCollisionBox&&(this||w).iconCollisionBox},fl.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&(this||w).textCollisionBox.segments.get().length>0},fl.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&(this||w).iconCollisionBox.segments.get().length>0},fl.prototype.addIndicesForPlacedSymbol=function(w,tt){for(var et=w.placedSymbolArray.get(tt),rt=et.vertexStartIndex+4*et.numGlyphs,it=et.vertexStartIndex;it<rt;it+=4)w.indexArray.emplaceBack(it,it+1,it+2),w.indexArray.emplaceBack(it+1,it+2,it+3)},fl.prototype.getSortedSymbolIndexes=function(tt){if((this||w).sortedAngle===tt&&void 0!==(this||w).symbolInstanceIndexes)return(this||w).symbolInstanceIndexes;for(var et=Math.sin(tt),rt=Math.cos(tt),it=[],nt=[],ot=[],at=0;at<(this||w).symbolInstances.length;++at){ot.push(at);var st=(this||w).symbolInstances.get(at);it.push(0|Math.round(et*st.anchorX+rt*st.anchorY)),nt.push(st.featureIndex)}return ot.sort((function(w,tt){return it[w]-it[tt]||nt[tt]-nt[w]})),ot},fl.prototype.addToSortKeyRanges=function(tt,et){var rt=(this||w).sortKeyRanges[(this||w).sortKeyRanges.length-1];rt&&rt.sortKey===et?rt.symbolInstanceEnd=tt+1:(this||w).sortKeyRanges.push({sortKey:et,symbolInstanceStart:tt,symbolInstanceEnd:tt+1})},fl.prototype.sortFeatures=function(tt){var et=this||w;if((this||w).sortFeaturesByY&&(this||w).sortedAngle!==tt&&!((this||w).text.segments.get().length>1||(this||w).icon.segments.get().length>1)){(this||w).symbolInstanceIndexes=this.getSortedSymbolIndexes(tt),(this||w).sortedAngle=tt,(this||w).text.indexArray.clear(),(this||w).icon.indexArray.clear(),(this||w).featureSortOrder=[];for(var rt=0,it=(this||w).symbolInstanceIndexes;rt<it.length;rt+=1){var nt=(this||w).symbolInstances.get(it[rt]);(this||w).featureSortOrder.push(nt.featureIndex),[nt.rightJustifiedTextSymbolIndex,nt.centerJustifiedTextSymbolIndex,nt.leftJustifiedTextSymbolIndex].forEach((function(w,tt,rt){w>=0&&rt.indexOf(w)===tt&&et.addIndicesForPlacedSymbol(et.text,w)})),nt.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol((this||w).text,nt.verticalPlacedTextSymbolIndex),nt.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol((this||w).icon,nt.placedIconSymbolIndex),nt.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol((this||w).icon,nt.verticalPlacedIconSymbolIndex)}(this||w).text.indexBuffer&&(this||w).text.indexBuffer.updateData((this||w).text.indexArray),(this||w).icon.indexBuffer&&(this||w).icon.indexBuffer.updateData((this||w).icon.indexArray)}},Dn("SymbolBucket",fl,{omit:["layers","collisionBoxArray","features","compareText"]}),fl.MAX_GLYPHS=65535,fl.addDynamicAttributes=ll;var fp=new xi({"symbol-placement":new yi(Cn.layout_symbol["symbol-placement"]),"symbol-spacing":new yi(Cn.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new yi(Cn.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new di(Cn.layout_symbol["symbol-sort-key"]),"symbol-z-order":new yi(Cn.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new yi(Cn.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new yi(Cn.layout_symbol["icon-ignore-placement"]),"icon-optional":new yi(Cn.layout_symbol["icon-optional"]),"icon-rotation-alignment":new yi(Cn.layout_symbol["icon-rotation-alignment"]),"icon-size":new di(Cn.layout_symbol["icon-size"]),"icon-text-fit":new yi(Cn.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new yi(Cn.layout_symbol["icon-text-fit-padding"]),"icon-image":new di(Cn.layout_symbol["icon-image"]),"icon-rotate":new di(Cn.layout_symbol["icon-rotate"]),"icon-padding":new yi(Cn.layout_symbol["icon-padding"]),"icon-keep-upright":new yi(Cn.layout_symbol["icon-keep-upright"]),"icon-offset":new di(Cn.layout_symbol["icon-offset"]),"icon-anchor":new di(Cn.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new yi(Cn.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new yi(Cn.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new yi(Cn.layout_symbol["text-rotation-alignment"]),"text-field":new di(Cn.layout_symbol["text-field"]),"text-font":new di(Cn.layout_symbol["text-font"]),"text-size":new di(Cn.layout_symbol["text-size"]),"text-max-width":new di(Cn.layout_symbol["text-max-width"]),"text-line-height":new yi(Cn.layout_symbol["text-line-height"]),"text-letter-spacing":new di(Cn.layout_symbol["text-letter-spacing"]),"text-justify":new di(Cn.layout_symbol["text-justify"]),"text-radial-offset":new di(Cn.layout_symbol["text-radial-offset"]),"text-variable-anchor":new yi(Cn.layout_symbol["text-variable-anchor"]),"text-anchor":new di(Cn.layout_symbol["text-anchor"]),"text-max-angle":new yi(Cn.layout_symbol["text-max-angle"]),"text-writing-mode":new yi(Cn.layout_symbol["text-writing-mode"]),"text-rotate":new di(Cn.layout_symbol["text-rotate"]),"text-padding":new yi(Cn.layout_symbol["text-padding"]),"text-keep-upright":new yi(Cn.layout_symbol["text-keep-upright"]),"text-transform":new di(Cn.layout_symbol["text-transform"]),"text-offset":new di(Cn.layout_symbol["text-offset"]),"text-allow-overlap":new yi(Cn.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new yi(Cn.layout_symbol["text-ignore-placement"]),"text-optional":new yi(Cn.layout_symbol["text-optional"])}),dp={paint:new xi({"icon-opacity":new di(Cn.paint_symbol["icon-opacity"]),"icon-color":new di(Cn.paint_symbol["icon-color"]),"icon-halo-color":new di(Cn.paint_symbol["icon-halo-color"]),"icon-halo-width":new di(Cn.paint_symbol["icon-halo-width"]),"icon-halo-blur":new di(Cn.paint_symbol["icon-halo-blur"]),"icon-translate":new yi(Cn.paint_symbol["icon-translate"]),"icon-translate-anchor":new yi(Cn.paint_symbol["icon-translate-anchor"]),"text-opacity":new di(Cn.paint_symbol["text-opacity"]),"text-color":new di(Cn.paint_symbol["text-color"],{runtimeType:Nn,getOverride:function(w){return w.textColor},hasOverride:function(w){return!!w.textColor}}),"text-halo-color":new di(Cn.paint_symbol["text-halo-color"]),"text-halo-width":new di(Cn.paint_symbol["text-halo-width"]),"text-halo-blur":new di(Cn.paint_symbol["text-halo-blur"]),"text-translate":new yi(Cn.paint_symbol["text-translate"]),"text-translate-anchor":new yi(Cn.paint_symbol["text-translate-anchor"])}),layout:fp},ml=function(tt){(this||w).type=tt.property.overrides?tt.property.overrides.runtimeType:Ln,(this||w).defaultValue=tt};ml.prototype.evaluate=function(tt){if(tt.formattedSection){var et=(this||w).defaultValue.property.overrides;if(et&&et.hasOverride(tt.formattedSection))return et.getOverride(tt.formattedSection)}return tt.feature&&tt.featureState?(this||w).defaultValue.evaluate(tt.feature,tt.featureState):(this||w).defaultValue.property.specification.default},ml.prototype.eachChild=function(tt){(this||w).defaultValue.isConstant()||tt((this||w).defaultValue.value._styleExpression.expression)},ml.prototype.outputDefined=function(){return!1},ml.prototype.serialize=function(){return null},Dn("FormatSectionOverride",ml,{omit:["defaultValue"]});var mp=function(tt){function e(et){tt.call(this||w,et,dp)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.recalculate=function(et,rt){if(tt.prototype.recalculate.call(this||w,et,rt),"auto"===(this||w).layout.get("icon-rotation-alignment")&&((this||w).layout._values["icon-rotation-alignment"]="point"!==(this||w).layout.get("symbol-placement")?"map":"viewport"),"auto"===(this||w).layout.get("text-rotation-alignment")&&((this||w).layout._values["text-rotation-alignment"]="point"!==(this||w).layout.get("symbol-placement")?"map":"viewport"),"auto"===(this||w).layout.get("text-pitch-alignment")&&((this||w).layout._values["text-pitch-alignment"]=(this||w).layout.get("text-rotation-alignment")),"auto"===(this||w).layout.get("icon-pitch-alignment")&&((this||w).layout._values["icon-pitch-alignment"]=(this||w).layout.get("icon-rotation-alignment")),"point"===(this||w).layout.get("symbol-placement")){var it=(this||w).layout.get("text-writing-mode");if(it){for(var nt=[],ot=0,at=it;ot<at.length;ot+=1){var st=at[ot];nt.indexOf(st)<0&&nt.push(st)}(this||w).layout._values["text-writing-mode"]=nt}else(this||w).layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},e.prototype.getValueAndResolveTokens=function(tt,et,rt,it){var nt=(this||w).layout.get(tt).evaluate(et,{},rt,it),ot=(this||w)._unevaluatedLayout._values[tt];return ot.isDataDriven()||Nr(ot.value)||!nt?nt:function(w,tt){return tt.replace(/{([^{}]+)}/g,(function(tt,et){return et in w?String(w[et]):""}))}(et.properties,nt)},e.prototype.createBucket=function(w){return new fl(w)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype._setPaintOverrides=function(){for(var tt=0,et=dp.paint.overridableProperties;tt<et.length;tt+=1){var rt=et[tt];if(e.hasPaintOverride((this||w).layout,rt)){var it,nt=(this||w).paint.get(rt),ot=new ml(nt),at=new qr(ot,nt.property.specification);it="constant"===nt.value.kind||"source"===nt.value.kind?new Gr("source",at):new Zr("composite",at,nt.value.zoomStops,nt.value._interpolationType),(this||w).paint._values[rt]=new hi(nt.property,it,nt.parameters)}}},e.prototype._handleOverridablePaintPropertyUpdate=function(tt,et,rt){return!(!(this||w).layout||et.isDataDriven()||rt.isDataDriven())&&e.hasPaintOverride((this||w).layout,tt)},e.hasPaintOverride=function(w,tt){var et=w.get("text-field"),rt=dp.paint.properties[tt],it=!1,a=function(w){for(var tt=0,et=w;tt<et.length;tt+=1)if(rt.overrides&&rt.overrides.hasOverride(et[tt]))return void(it=!0)};if("constant"===et.value.kind&&et.value.value instanceof ee)a(et.value.value.sections);else if("source"===et.value.kind){var o=function(w){it||(w instanceof se&&ae(w.value)===uo?a(w.value.sections):w instanceof ce?a(w.sections):w.eachChild(o))},nt=et.value;nt._styleExpression&&o(nt._styleExpression.expression)}return it},e}(Ms),yp={paint:new xi({"background-color":new yi(Cn.paint_background["background-color"]),"background-pattern":new vi(Cn.paint_background["background-pattern"]),"background-opacity":new yi(Cn.paint_background["background-opacity"])})},gp=function(tt){function e(et){tt.call(this||w,et,yp)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e}(Ms),_p={paint:new xi({"raster-opacity":new yi(Cn.paint_raster["raster-opacity"]),"raster-hue-rotate":new yi(Cn.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new yi(Cn.paint_raster["raster-brightness-min"]),"raster-brightness-max":new yi(Cn.paint_raster["raster-brightness-max"]),"raster-saturation":new yi(Cn.paint_raster["raster-saturation"]),"raster-contrast":new yi(Cn.paint_raster["raster-contrast"]),"raster-resampling":new yi(Cn.paint_raster["raster-resampling"]),"raster-fade-duration":new yi(Cn.paint_raster["raster-fade-duration"])})},vp=function(tt){function e(et){tt.call(this||w,et,_p)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e}(Ms),xp=function(tt){function e(et){tt.call(this||w,et,{}),(this||w).implementation=et}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.is3D=function(){return"3d"===(this||w).implementation.renderingMode},e.prototype.hasOffscreenPass=function(){return void 0!==(this||w).implementation.prerender},e.prototype.recalculate=function(){},e.prototype.updateTransitions=function(){},e.prototype.hasTransition=function(){},e.prototype.serialize=function(){},e.prototype.onAdd=function(tt){(this||w).implementation.onAdd&&(this||w).implementation.onAdd(tt,tt.painter.context.gl)},e.prototype.onRemove=function(tt){(this||w).implementation.onRemove&&(this||w).implementation.onRemove(tt,tt.painter.context.gl)},e}(Ms),bp={circle:vc,heatmap:wc,hillshade:Tc,fill:Cc,"fill-extrusion":Oc,line:Xc,symbol:mp,background:gp,raster:vp},wp=it.HTMLImageElement,Sp=it.HTMLCanvasElement,Tp=it.HTMLVideoElement,Ip=it.ImageData,Ep=it.ImageBitmap,Ml=function(tt,et,rt,it){(this||w).context=tt,(this||w).format=rt,(this||w).texture=tt.gl.createTexture(),this.update(et,it)};Ml.prototype.update=function(tt,et,rt){var it=tt.width,nt=tt.height,ot=!((this||w).size&&(this||w).size[0]===it&&(this||w).size[1]===nt||rt),at=(this||w).context,st=at.gl;if((this||w).useMipmap=Boolean(et&&et.useMipmap),st.bindTexture(st.TEXTURE_2D,(this||w).texture),at.pixelStoreUnpackFlipY.set(!1),at.pixelStoreUnpack.set(1),at.pixelStoreUnpackPremultiplyAlpha.set((this||w).format===st.RGBA&&(!et||!1!==et.premultiply)),ot)(this||w).size=[it,nt],tt instanceof wp||tt instanceof Sp||tt instanceof Tp||tt instanceof Ip||Ep&&tt instanceof Ep?st.texImage2D(st.TEXTURE_2D,0,(this||w).format,(this||w).format,st.UNSIGNED_BYTE,tt):st.texImage2D(st.TEXTURE_2D,0,(this||w).format,it,nt,0,(this||w).format,st.UNSIGNED_BYTE,tt.data);else{var ct=rt||{x:0,y:0},pt=ct.x,ft=ct.y;tt instanceof wp||tt instanceof Sp||tt instanceof Tp||tt instanceof Ip||Ep&&tt instanceof Ep?st.texSubImage2D(st.TEXTURE_2D,0,pt,ft,st.RGBA,st.UNSIGNED_BYTE,tt):st.texSubImage2D(st.TEXTURE_2D,0,pt,ft,it,nt,st.RGBA,st.UNSIGNED_BYTE,tt.data)}(this||w).useMipmap&&this.isSizePowerOfTwo()&&st.generateMipmap(st.TEXTURE_2D)},Ml.prototype.bind=function(tt,et,rt){var it=(this||w).context.gl;it.bindTexture(it.TEXTURE_2D,(this||w).texture),rt!==it.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(rt=it.LINEAR),tt!==(this||w).filter&&(it.texParameteri(it.TEXTURE_2D,it.TEXTURE_MAG_FILTER,tt),it.texParameteri(it.TEXTURE_2D,it.TEXTURE_MIN_FILTER,rt||tt),(this||w).filter=tt),et!==(this||w).wrap&&(it.texParameteri(it.TEXTURE_2D,it.TEXTURE_WRAP_S,et),it.texParameteri(it.TEXTURE_2D,it.TEXTURE_WRAP_T,et),(this||w).wrap=et)},Ml.prototype.isSizePowerOfTwo=function(){return(this||w).size[0]===(this||w).size[1]&&Math.log((this||w).size[0])/Math.LN2%1==0},Ml.prototype.destroy=function(){(this||w).context.gl.deleteTexture((this||w).texture),(this||w).texture=null};var El=function(tt){var et=this||w;(this||w)._callback=tt,(this||w)._triggered=!1,"undefined"!=typeof MessageChannel&&((this||w)._channel=new MessageChannel,(this||w)._channel.port2.onmessage=function(){et._triggered=!1,et._callback()})};El.prototype.trigger=function(){var tt=this||w;(this||w)._triggered||((this||w)._triggered=!0,(this||w)._channel?(this||w)._channel.port1.postMessage(!0):setTimeout((function(){tt._triggered=!1,tt._callback()}),0))},El.prototype.remove=function(){delete(this||w)._channel,(this||w)._callback=function(){}};var Tl=function(tt,et,rt){(this||w).target=tt,(this||w).parent=et,(this||w).mapId=rt,(this||w).callbacks={},(this||w).tasks={},(this||w).taskQueue=[],(this||w).cancelCallbacks={},m(["receive","process"],this||w),(this||w).invoker=new El((this||w).process),(this||w).target.addEventListener("message",(this||w).receive,!1),(this||w).globalScope=k()?tt:it};function Pl(w,tt,et){var rt=2*Math.PI*6378137/256/Math.pow(2,et);return[w*rt-2*Math.PI*6378137/2,tt*rt-2*Math.PI*6378137/2]}Tl.prototype.send=function(tt,et,rt,it,nt){var ot=this||w;void 0===nt&&(nt=!1);var at=Math.round(1e18*Math.random()).toString(36).substring(0,10);rt&&((this||w).callbacks[at]=rt);var st=C((this||w).globalScope)?void 0:[];return(this||w).target.postMessage({id:at,type:tt,hasCallback:!!rt,targetMapId:it,mustQueue:nt,sourceMapId:(this||w).mapId,data:Un(et,st)},st),{cancel:function(){rt&&delete ot.callbacks[at],ot.target.postMessage({id:at,type:"<cancel>",targetMapId:it,sourceMapId:ot.mapId})}}},Tl.prototype.receive=function(tt){var et=tt.data,rt=et.id;if(rt&&(!et.targetMapId||(this||w).mapId===et.targetMapId))if("<cancel>"===et.type){delete(this||w).tasks[rt];var it=(this||w).cancelCallbacks[rt];delete(this||w).cancelCallbacks[rt],it&&it()}else k()||et.mustQueue?((this||w).tasks[rt]=et,(this||w).taskQueue.push(rt),(this||w).invoker.trigger()):this.processTask(rt,et)},Tl.prototype.process=function(){if((this||w).taskQueue.length){var tt=(this||w).taskQueue.shift(),et=(this||w).tasks[tt];delete(this||w).tasks[tt],(this||w).taskQueue.length&&(this||w).invoker.trigger(),et&&this.processTask(tt,et)}},Tl.prototype.processTask=function(tt,et){var rt=this||w;if("<response>"===et.type){var it=(this||w).callbacks[tt];delete(this||w).callbacks[tt],it&&(et.error?it(jn(et.error)):it(null,jn(et.data)))}else{var nt=!1,ot=C((this||w).globalScope)?void 0:[],at=et.hasCallback?function(w,et){nt=!0,delete rt.cancelCallbacks[tt],rt.target.postMessage({id:tt,type:"<response>",sourceMapId:rt.mapId,error:w?Un(w):null,data:Un(et,ot)},ot)}:function(w){nt=!0},st=null,ct=jn(et.data);if((this||w).parent[et.type])st=(this||w).parent[et.type](et.sourceMapId,ct,at);else if((this||w).parent.getWorkerSource){var pt=et.type.split(".");st=(this||w).parent.getWorkerSource(et.sourceMapId,pt[0],ct.source)[pt[1]](ct,at)}else at(new Error("Could not find function "+et.type));!nt&&st&&st.cancel&&((this||w).cancelCallbacks[tt]=st.cancel)}},Tl.prototype.remove=function(){(this||w).invoker.remove(),(this||w).target.removeEventListener("message",(this||w).receive,!1)};var Bl=function(w,tt){w&&(tt?this.setSouthWest(w).setNorthEast(tt):4===w.length?this.setSouthWest([w[0],w[1]]).setNorthEast([w[2],w[3]]):this.setSouthWest(w[0]).setNorthEast(w[1]))};Bl.prototype.setNorthEast=function(tt){return(this||w)._ne=tt instanceof Vl?new Vl(tt.lng,tt.lat):Vl.convert(tt),this||w},Bl.prototype.setSouthWest=function(tt){return(this||w)._sw=tt instanceof Vl?new Vl(tt.lng,tt.lat):Vl.convert(tt),this||w},Bl.prototype.extend=function(tt){var et,rt,it=(this||w)._sw,nt=(this||w)._ne;if(tt instanceof Vl)et=tt,rt=tt;else{if(!(tt instanceof Bl))return Array.isArray(tt)?4===tt.length||tt.every(Array.isArray)?this.extend(Bl.convert(tt)):this.extend(Vl.convert(tt)):this||w;if(rt=tt._ne,!(et=tt._sw)||!rt)return this||w}return it||nt?(it.lng=Math.min(et.lng,it.lng),it.lat=Math.min(et.lat,it.lat),nt.lng=Math.max(rt.lng,nt.lng),nt.lat=Math.max(rt.lat,nt.lat)):((this||w)._sw=new Vl(et.lng,et.lat),(this||w)._ne=new Vl(rt.lng,rt.lat)),this||w},Bl.prototype.getCenter=function(){return new Vl(((this||w)._sw.lng+(this||w)._ne.lng)/2,((this||w)._sw.lat+(this||w)._ne.lat)/2)},Bl.prototype.getSouthWest=function(){return(this||w)._sw},Bl.prototype.getNorthEast=function(){return(this||w)._ne},Bl.prototype.getNorthWest=function(){return new Vl(this.getWest(),this.getNorth())},Bl.prototype.getSouthEast=function(){return new Vl(this.getEast(),this.getSouth())},Bl.prototype.getWest=function(){return(this||w)._sw.lng},Bl.prototype.getSouth=function(){return(this||w)._sw.lat},Bl.prototype.getEast=function(){return(this||w)._ne.lng},Bl.prototype.getNorth=function(){return(this||w)._ne.lat},Bl.prototype.toArray=function(){return[(this||w)._sw.toArray(),(this||w)._ne.toArray()]},Bl.prototype.toString=function(){return"LngLatBounds("+(this||w)._sw.toString()+", "+(this||w)._ne.toString()+")"},Bl.prototype.isEmpty=function(){return!((this||w)._sw&&(this||w)._ne)},Bl.prototype.contains=function(tt){var et=Vl.convert(tt),rt=et.lng,it=et.lat,nt=(this||w)._sw.lng<=rt&&rt<=(this||w)._ne.lng;return(this||w)._sw.lng>(this||w)._ne.lng&&(nt=(this||w)._sw.lng>=rt&&rt>=(this||w)._ne.lng),(this||w)._sw.lat<=it&&it<=(this||w)._ne.lat&&nt},Bl.convert=function(w){return!w||w instanceof Bl?w:new Bl(w)};var Vl=function(tt,et){if(isNaN(tt)||isNaN(et))throw new Error("Invalid LngLat object: ("+tt+", "+et+")");if((this||w).lng=+tt,(this||w).lat=+et,(this||w).lat>90||(this||w).lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Vl.prototype.wrap=function(){return new Vl(p((this||w).lng,-180,180),(this||w).lat)},Vl.prototype.toArray=function(){return[(this||w).lng,(this||w).lat]},Vl.prototype.toString=function(){return"LngLat("+(this||w).lng+", "+(this||w).lat+")"},Vl.prototype.distanceTo=function(tt){var et=Math.PI/180,rt=(this||w).lat*et,it=tt.lat*et,nt=Math.sin(rt)*Math.sin(it)+Math.cos(rt)*Math.cos(it)*Math.cos((tt.lng-(this||w).lng)*et);return 6371008.8*Math.acos(Math.min(nt,1))},Vl.prototype.toBounds=function(tt){void 0===tt&&(tt=0);var et=360*tt/40075017,rt=et/Math.cos(Math.PI/180*(this||w).lat);return new Bl(new Vl((this||w).lng-rt,(this||w).lat-et),new Vl((this||w).lng+rt,(this||w).lat+et))},Vl.convert=function(w){if(w instanceof Vl)return w;if(Array.isArray(w)&&(2===w.length||3===w.length))return new Vl(Number(w[0]),Number(w[1]));if(!Array.isArray(w)&&"object"==typeof w&&null!==w)return new Vl(Number("lng"in w?w.lng:w.lon),Number(w.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Ap=2*Math.PI*6371008.8;function Dl(w){return Ap*Math.cos(w*Math.PI/180)}function Ll(w){return(180+w)/360}function Rl(w){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+w*Math.PI/360)))/360}function Ol(w,tt){return w/Dl(tt)}function Ul(w){return 360/Math.PI*Math.atan(Math.exp((180-360*w)*Math.PI/180))-90}var jl=function(tt,et,rt){void 0===rt&&(rt=0),(this||w).x=+tt,(this||w).y=+et,(this||w).z=+rt};jl.fromLngLat=function(w,tt){void 0===tt&&(tt=0);var et=Vl.convert(w);return new jl(Ll(et.lng),Rl(et.lat),Ol(tt,et.lat))},jl.prototype.toLngLat=function(){return new Vl(360*(this||w).x-180,Ul((this||w).y))},jl.prototype.toAltitude=function(){return(this||w).z*Dl(Ul((this||w).y))},jl.prototype.meterInMercatorCoordinateUnits=function(){return 1/Ap*(tt=Ul((this||w).y),1/Math.cos(tt*Math.PI/180));var tt};var ql=function(tt,et,rt){(this||w).z=tt,(this||w).x=et,(this||w).y=rt,(this||w).key=Gl(0,tt,tt,et,rt)};ql.prototype.equals=function(tt){return(this||w).z===tt.z&&(this||w).x===tt.x&&(this||w).y===tt.y},ql.prototype.url=function(tt,et){var rt,it,nt,ot,at,st=(it=(this||w).y,nt=(this||w).z,ot=Pl(256*(rt=(this||w).x),256*(it=Math.pow(2,nt)-it-1),nt),at=Pl(256*(rt+1),256*(it+1),nt),ot[0]+","+ot[1]+","+at[0]+","+at[1]),ct=function(w,tt,et){for(var rt,it="",nt=w;nt>0;nt--)it+=(tt&(rt=1<<nt-1)?1:0)+(et&rt?2:0);return it}((this||w).z,(this||w).x,(this||w).y);return tt[((this||w).x+(this||w).y)%tt.length].replace("{prefix}",((this||w).x%16).toString(16)+((this||w).y%16).toString(16)).replace("{z}",String((this||w).z)).replace("{x}",String((this||w).x)).replace("{y}",String("tms"===et?Math.pow(2,(this||w).z)-(this||w).y-1:(this||w).y)).replace("{quadkey}",ct).replace("{bbox-epsg-3857}",st)},ql.prototype.getTilePoint=function(tt){var et=Math.pow(2,(this||w).z);return new rt(8192*(tt.x*et-(this||w).x),8192*(tt.y*et-(this||w).y))},ql.prototype.toString=function(){return(this||w).z+"/"+(this||w).x+"/"+(this||w).y};var Nl=function(tt,et){(this||w).wrap=tt,(this||w).canonical=et,(this||w).key=Gl(tt,et.z,et.z,et.x,et.y)},Kl=function(tt,et,rt,it,nt){(this||w).overscaledZ=tt,(this||w).wrap=et,(this||w).canonical=new ql(rt,+it,+nt),(this||w).key=Gl(et,tt,rt,it,nt)};function Gl(w,tt,et,rt,it){(w*=2)<0&&(w=-1*w-1);var nt=1<<et;return(nt*nt*w+nt*it+rt).toString(36)+et.toString(36)+tt.toString(36)}Kl.prototype.equals=function(tt){return(this||w).overscaledZ===tt.overscaledZ&&(this||w).wrap===tt.wrap&&(this||w).canonical.equals(tt.canonical)},Kl.prototype.scaledTo=function(tt){var et=(this||w).canonical.z-tt;return tt>(this||w).canonical.z?new Kl(tt,(this||w).wrap,(this||w).canonical.z,(this||w).canonical.x,(this||w).canonical.y):new Kl(tt,(this||w).wrap,tt,(this||w).canonical.x>>et,(this||w).canonical.y>>et)},Kl.prototype.calculateScaledKey=function(tt,et){var rt=(this||w).canonical.z-tt;return tt>(this||w).canonical.z?Gl((this||w).wrap*+et,tt,(this||w).canonical.z,(this||w).canonical.x,(this||w).canonical.y):Gl((this||w).wrap*+et,tt,tt,(this||w).canonical.x>>rt,(this||w).canonical.y>>rt)},Kl.prototype.isChildOf=function(tt){if(tt.wrap!==(this||w).wrap)return!1;var et=(this||w).canonical.z-tt.canonical.z;return 0===tt.overscaledZ||tt.overscaledZ<(this||w).overscaledZ&&tt.canonical.x===(this||w).canonical.x>>et&&tt.canonical.y===(this||w).canonical.y>>et},Kl.prototype.children=function(tt){if((this||w).overscaledZ>=tt)return[new Kl((this||w).overscaledZ+1,(this||w).wrap,(this||w).canonical.z,(this||w).canonical.x,(this||w).canonical.y)];var et=(this||w).canonical.z+1,rt=2*(this||w).canonical.x,it=2*(this||w).canonical.y;return[new Kl(et,(this||w).wrap,et,rt,it),new Kl(et,(this||w).wrap,et,rt+1,it),new Kl(et,(this||w).wrap,et,rt,it+1),new Kl(et,(this||w).wrap,et,rt+1,it+1)]},Kl.prototype.isLessThan=function(tt){return(this||w).wrap<tt.wrap||!((this||w).wrap>tt.wrap)&&((this||w).overscaledZ<tt.overscaledZ||!((this||w).overscaledZ>tt.overscaledZ)&&((this||w).canonical.x<tt.canonical.x||!((this||w).canonical.x>tt.canonical.x)&&(this||w).canonical.y<tt.canonical.y))},Kl.prototype.wrapped=function(){return new Kl((this||w).overscaledZ,0,(this||w).canonical.z,(this||w).canonical.x,(this||w).canonical.y)},Kl.prototype.unwrapTo=function(tt){return new Kl((this||w).overscaledZ,tt,(this||w).canonical.z,(this||w).canonical.x,(this||w).canonical.y)},Kl.prototype.overscaleFactor=function(){return Math.pow(2,(this||w).overscaledZ-(this||w).canonical.z)},Kl.prototype.toUnwrapped=function(){return new Nl((this||w).wrap,(this||w).canonical)},Kl.prototype.toString=function(){return(this||w).overscaledZ+"/"+(this||w).canonical.x+"/"+(this||w).canonical.y},Kl.prototype.getTilePoint=function(tt){return(this||w).canonical.getTilePoint(new jl(tt.x-(this||w).wrap,tt.y))},Dn("CanonicalTileID",ql),Dn("OverscaledTileID",Kl,{omit:["posMatrix"]});var Zl=function(tt,et,rt){if((this||w).uid=tt,et.height!==et.width)throw new RangeError("DEM tiles must be square");if(rt&&"mapbox"!==rt&&"terrarium"!==rt)return _('"'+rt+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');(this||w).stride=et.height;var it=(this||w).dim=et.height-2;(this||w).data=new Uint32Array(et.data.buffer),(this||w).encoding=rt||"mapbox";for(var nt=0;nt<it;nt++)(this||w).data[this._idx(-1,nt)]=(this||w).data[this._idx(0,nt)],(this||w).data[this._idx(it,nt)]=(this||w).data[this._idx(it-1,nt)],(this||w).data[this._idx(nt,-1)]=(this||w).data[this._idx(nt,0)],(this||w).data[this._idx(nt,it)]=(this||w).data[this._idx(nt,it-1)];(this||w).data[this._idx(-1,-1)]=(this||w).data[this._idx(0,0)],(this||w).data[this._idx(it,-1)]=(this||w).data[this._idx(it-1,0)],(this||w).data[this._idx(-1,it)]=(this||w).data[this._idx(0,it-1)],(this||w).data[this._idx(it,it)]=(this||w).data[this._idx(it-1,it-1)]};Zl.prototype.get=function(tt,et){var rt=new Uint8Array((this||w).data.buffer),it=4*this._idx(tt,et);return("terrarium"===(this||w).encoding?(this||w)._unpackTerrarium:(this||w)._unpackMapbox)(rt[it],rt[it+1],rt[it+2])},Zl.prototype.getUnpackVector=function(){return"terrarium"===(this||w).encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Zl.prototype._idx=function(tt,et){if(tt<-1||tt>=(this||w).dim+1||et<-1||et>=(this||w).dim+1)throw new RangeError("out of range source coordinates for DEM data");return(et+1)*(this||w).stride+(tt+1)},Zl.prototype._unpackMapbox=function(w,tt,et){return(256*w*256+256*tt+et)/10-1e4},Zl.prototype._unpackTerrarium=function(w,tt,et){return 256*w+tt+et/256-32768},Zl.prototype.getPixels=function(){return new mo({width:(this||w).stride,height:(this||w).stride},new Uint8Array((this||w).data.buffer))},Zl.prototype.backfillBorder=function(tt,et,rt){if((this||w).dim!==tt.dim)throw new Error("dem dimension mismatch");var it=et*(this||w).dim,nt=et*(this||w).dim+(this||w).dim,ot=rt*(this||w).dim,at=rt*(this||w).dim+(this||w).dim;switch(et){case-1:it=nt-1;break;case 1:nt=it+1}switch(rt){case-1:ot=at-1;break;case 1:at=ot+1}for(var st=-et*(this||w).dim,ct=-rt*(this||w).dim,pt=ot;pt<at;pt++)for(var ft=it;ft<nt;ft++)(this||w).data[this._idx(ft,pt)]=tt.data[this._idx(ft+st,pt+ct)]},Dn("DEMData",Zl);var Xl=function(tt){(this||w)._stringToNumber={},(this||w)._numberToString=[];for(var et=0;et<tt.length;et++){var rt=tt[et];(this||w)._stringToNumber[rt]=et,(this||w)._numberToString[et]=rt}};Xl.prototype.encode=function(tt){return(this||w)._stringToNumber[tt]},Xl.prototype.decode=function(tt){return(this||w)._numberToString[tt]};var Jl=function(tt,et,rt,it,nt){(this||w).type="Feature",(this||w)._vectorTileFeature=tt,tt._z=et,tt._x=rt,tt._y=it,(this||w).properties=tt.properties,(this||w).id=nt},zp={geometry:{configurable:!0}};zp.geometry.get=function(){return void 0===(this||w)._geometry&&((this||w)._geometry=(this||w)._vectorTileFeature.toGeoJSON((this||w)._vectorTileFeature._x,(this||w)._vectorTileFeature._y,(this||w)._vectorTileFeature._z).geometry),(this||w)._geometry},zp.geometry.set=function(tt){(this||w)._geometry=tt},Jl.prototype.toJSON=function(){var tt={geometry:(this||w).geometry};for(var et in this||w)"_geometry"!==et&&"_vectorTileFeature"!==et&&(tt[et]=(this||w)[et]);return tt},Object.defineProperties(Jl.prototype,zp);var Yl=function(){(this||w).state={},(this||w).stateChanges={},(this||w).deletedStates={}};Yl.prototype.updateState=function(tt,et,rt){var it=String(et);if((this||w).stateChanges[tt]=(this||w).stateChanges[tt]||{},(this||w).stateChanges[tt][it]=(this||w).stateChanges[tt][it]||{},c((this||w).stateChanges[tt][it],rt),null===(this||w).deletedStates[tt])for(var nt in(this||w).deletedStates[tt]={},(this||w).state[tt])nt!==it&&((this||w).deletedStates[tt][nt]=null);else if((this||w).deletedStates[tt]&&null===(this||w).deletedStates[tt][it])for(var ot in(this||w).deletedStates[tt][it]={},(this||w).state[tt][it])rt[ot]||((this||w).deletedStates[tt][it][ot]=null);else for(var at in rt)(this||w).deletedStates[tt]&&(this||w).deletedStates[tt][it]&&null===(this||w).deletedStates[tt][it][at]&&delete(this||w).deletedStates[tt][it][at]},Yl.prototype.removeFeatureState=function(tt,et,rt){if(null!==(this||w).deletedStates[tt]){var it=String(et);if((this||w).deletedStates[tt]=(this||w).deletedStates[tt]||{},rt&&void 0!==et)null!==(this||w).deletedStates[tt][it]&&((this||w).deletedStates[tt][it]=(this||w).deletedStates[tt][it]||{},(this||w).deletedStates[tt][it][rt]=null);else if(void 0!==et)if((this||w).stateChanges[tt]&&(this||w).stateChanges[tt][it])for(rt in(this||w).deletedStates[tt][it]={},(this||w).stateChanges[tt][it])(this||w).deletedStates[tt][it][rt]=null;else(this||w).deletedStates[tt][it]=null;else(this||w).deletedStates[tt]=null}},Yl.prototype.getState=function(tt,et){var rt=String(et),it=c({},((this||w).state[tt]||{})[rt],((this||w).stateChanges[tt]||{})[rt]);if(null===(this||w).deletedStates[tt])return{};if((this||w).deletedStates[tt]){var nt=(this||w).deletedStates[tt][et];if(null===nt)return{};for(var ot in nt)delete it[ot]}return it},Yl.prototype.initializeTileState=function(tt,et){tt.setFeatureState((this||w).state,et)},Yl.prototype.coalesceChanges=function(tt,et){var rt={};for(var it in(this||w).stateChanges){(this||w).state[it]=(this||w).state[it]||{};var nt={};for(var ot in(this||w).stateChanges[it])(this||w).state[it][ot]||((this||w).state[it][ot]={}),c((this||w).state[it][ot],(this||w).stateChanges[it][ot]),nt[ot]=(this||w).state[it][ot];rt[it]=nt}for(var at in(this||w).deletedStates){(this||w).state[at]=(this||w).state[at]||{};var st={};if(null===(this||w).deletedStates[at])for(var ct in(this||w).state[at])st[ct]={},(this||w).state[at][ct]={};else for(var pt in(this||w).deletedStates[at]){if(null===(this||w).deletedStates[at][pt])(this||w).state[at][pt]={};else for(var ft=0,dt=Object.keys((this||w).deletedStates[at][pt]);ft<dt.length;ft+=1)delete(this||w).state[at][pt][dt[ft]];st[pt]=(this||w).state[at][pt]}rt[at]=rt[at]||{},c(rt[at],st)}if((this||w).stateChanges={},(this||w).deletedStates={},0!==Object.keys(rt).length)for(var mt in tt)tt[mt].setFeatureState(rt,et)};var $l=function(tt,et){(this||w).tileID=tt,(this||w).x=tt.canonical.x,(this||w).y=tt.canonical.y,(this||w).z=tt.canonical.z,(this||w).grid=new ls(8192,16,0),(this||w).grid3D=new ls(8192,16,0),(this||w).featureIndexArray=new vu,(this||w).promoteId=et};function Wl(w,tt,et,rt,it){return g(w,(function(w,nt){var ot=tt instanceof fi?tt.get(nt):null;return ot&&ot.evaluate?ot.evaluate(et,rt,it):ot}))}function Ql(w){for(var tt=1/0,et=1/0,rt=-1/0,it=-1/0,nt=0,ot=w;nt<ot.length;nt+=1){var at=ot[nt];tt=Math.min(tt,at.x),et=Math.min(et,at.y),rt=Math.max(rt,at.x),it=Math.max(it,at.y)}return{minX:tt,minY:et,maxX:rt,maxY:it}}function tp(w,tt){return tt-w}$l.prototype.insert=function(tt,et,rt,it,nt,ot){var at=(this||w).featureIndexArray.length;(this||w).featureIndexArray.emplaceBack(rt,it,nt);for(var st=ot?(this||w).grid3D:(this||w).grid,ct=0;ct<et.length;ct++){for(var pt=et[ct],ft=[1/0,1/0,-1/0,-1/0],dt=0;dt<pt.length;dt++){var mt=pt[dt];ft[0]=Math.min(ft[0],mt.x),ft[1]=Math.min(ft[1],mt.y),ft[2]=Math.max(ft[2],mt.x),ft[3]=Math.max(ft[3],mt.y)}ft[0]<8192&&ft[1]<8192&&ft[2]>=0&&ft[3]>=0&&st.insert(at,ft[0],ft[1],ft[2],ft[3])}},$l.prototype.loadVTLayers=function(){return(this||w).vtLayers||((this||w).vtLayers=new Lc.VectorTile(new Qc((this||w).rawTileData)).layers,(this||w).sourceLayerCoder=new Xl((this||w).vtLayers?Object.keys((this||w).vtLayers).sort():["_geojsonTileLayer"])),(this||w).vtLayers},$l.prototype.query=function(tt,et,it,nt){var ot=this||w;this.loadVTLayers();for(var at=tt.params||{},st=8192/tt.tileSize/tt.scale,ct=nn(at.filter),pt=tt.queryGeometry,ft=tt.queryPadding*st,dt=Ql(pt),mt=(this||w).grid.query(dt.minX-ft,dt.minY-ft,dt.maxX+ft,dt.maxY+ft),yt=Ql(tt.cameraQueryGeometry),vt=(this||w).grid3D.query(yt.minX-ft,yt.minY-ft,yt.maxX+ft,yt.maxY+ft,(function(w,et,it,nt){return function(w,tt,et,it,nt){for(var ot=0,at=w;ot<at.length;ot+=1){var st=at[ot];if(tt<=st.x&&et<=st.y&&it>=st.x&&nt>=st.y)return!0}var ct=[new rt(tt,et),new rt(tt,nt),new rt(it,nt),new rt(it,et)];if(w.length>2)for(var pt=0,ft=ct;pt<ft.length;pt+=1)if(Ha(w,ft[pt]))return!0;for(var dt=0;dt<w.length-1;dt++)if(Ya(w[dt],w[dt+1],ct))return!0;return!1}(tt.cameraQueryGeometry,w-ft,et-ft,it+ft,nt+ft)})),Dt=0,Rt=vt;Dt<Rt.length;Dt+=1)mt.push(Rt[Dt]);mt.sort(tp);for(var Bt,Ot={},x=function(w){var rt=mt[w];if(rt!==Bt){Bt=rt;var ft=ot.featureIndexArray.get(rt),dt=null;ot.loadMatchingFeature(Ot,ft.bucketIndex,ft.sourceLayerIndex,ft.featureIndex,ct,at.layers,at.availableImages,et,it,nt,(function(w,et,rt){return dt||(dt=La(w)),et.queryIntersectsFeature(pt,w,rt,dt,ot.z,tt.transform,st,tt.pixelPosMatrix)}))}},Ne=0;Ne<mt.length;Ne++)x(Ne);return Ot},$l.prototype.loadMatchingFeature=function(tt,et,rt,it,nt,ot,at,st,ct,pt,ft){var dt=(this||w).bucketLayerIDs[et];if(!ot||function(w,tt){for(var et=0;et<w.length;et++)if(tt.indexOf(w[et])>=0)return!0;return!1}(ot,dt)){var mt=(this||w).sourceLayerCoder.decode(rt),yt=(this||w).vtLayers[mt].feature(it);if(nt.filter(new ai((this||w).tileID.overscaledZ),yt))for(var vt=this.getId(yt,mt),Dt=0;Dt<dt.length;Dt++){var Rt=dt[Dt];if(!(ot&&ot.indexOf(Rt)<0)){var Bt=st[Rt];if(Bt){var Ot={};void 0!==vt&&pt&&(Ot=pt.getState(Bt.sourceLayer||"_geojsonTileLayer",vt));var Ne=ct[Rt];Ne.paint=Wl(Ne.paint,Bt.paint,yt,Ot,at),Ne.layout=Wl(Ne.layout,Bt.layout,yt,Ot,at);var Ze=!ft||ft(yt,Bt,Ot);if(Ze){var Ge=new Jl(yt,(this||w).z,(this||w).x,(this||w).y,vt);Ge.layer=Ne;var Ke=tt[Rt];void 0===Ke&&(Ke=tt[Rt]=[]),Ke.push({featureIndex:it,feature:Ge,intersectionZ:Ze})}}}}}},$l.prototype.lookupSymbolFeatures=function(w,tt,et,rt,it,nt,ot,at){var st={};this.loadVTLayers();for(var ct=nn(it),pt=0,ft=w;pt<ft.length;pt+=1)this.loadMatchingFeature(st,et,rt,ft[pt],ct,nt,ot,at,tt);return st},$l.prototype.hasLayer=function(tt){for(var et=0,rt=(this||w).bucketLayerIDs;et<rt.length;et+=1)for(var it=0,nt=rt[et];it<nt.length;it+=1)if(tt===nt[it])return!0;return!1},$l.prototype.getId=function(tt,et){var rt=tt.id;return(this||w).promoteId&&"boolean"==typeof(rt=tt.properties["string"==typeof(this||w).promoteId?(this||w).promoteId:(this||w).promoteId[et]])&&(rt=Number(rt)),rt},Dn("FeatureIndex",$l,{omit:["rawTileData","sourceLayerCoder"]});var ep=function(tt,et){(this||w).tileID=tt,(this||w).uid=f(),(this||w).uses=0,(this||w).tileSize=et,(this||w).buckets={},(this||w).expirationTime=null,(this||w).queryPadding=0,(this||w).hasSymbolBuckets=!1,(this||w).hasRTLText=!1,(this||w).dependencies={},(this||w).expiredRequestCount=0,(this||w).state="loading"};ep.prototype.registerFadeDuration=function(tt){var et=tt+(this||w).timeAdded;et<Dt.now()||(this||w).fadeEndTime&&et<(this||w).fadeEndTime||((this||w).fadeEndTime=et)},ep.prototype.wasRequested=function(){return"errored"===(this||w).state||"loaded"===(this||w).state||"reloading"===(this||w).state},ep.prototype.loadVectorData=function(tt,et,rt){if(this.hasData()&&this.unloadVectorData(),(this||w).state="loaded",tt){for(var it in tt.featureIndex&&((this||w).latestFeatureIndex=tt.featureIndex,tt.rawTileData?((this||w).latestRawTileData=tt.rawTileData,(this||w).latestFeatureIndex.rawTileData=tt.rawTileData):(this||w).latestRawTileData&&((this||w).latestFeatureIndex.rawTileData=(this||w).latestRawTileData)),(this||w).collisionBoxArray=tt.collisionBoxArray,(this||w).buckets=function(w,tt){var et={};if(!tt)return et;for(var n=function(){var w=it[rt],nt=w.layerIds.map((function(w){return tt.getLayer(w)})).filter(Boolean);if(0!==nt.length){w.layers=nt,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map((function(w){return nt.filter((function(tt){return tt.id===w}))[0]})));for(var ot=0,at=nt;ot<at.length;ot+=1)et[at[ot].id]=w}},rt=0,it=w;rt<it.length;rt+=1)n();return et}(tt.buckets,et.style),(this||w).hasSymbolBuckets=!1,(this||w).buckets){var nt=(this||w).buckets[it];if(nt instanceof fl){if((this||w).hasSymbolBuckets=!0,!rt)break;nt.justReloaded=!0}}if((this||w).hasRTLText=!1,(this||w).hasSymbolBuckets)for(var ot in(this||w).buckets){var at=(this||w).buckets[ot];if(at instanceof fl&&at.hasRTLText){(this||w).hasRTLText=!0,Ps.isLoading()||Ps.isLoaded()||"deferred"!==ri()||ni();break}}for(var st in(this||w).queryPadding=0,(this||w).buckets){var ct=(this||w).buckets[st];(this||w).queryPadding=Math.max((this||w).queryPadding,et.style.getLayer(st).queryRadius(ct))}tt.imageAtlas&&((this||w).imageAtlas=tt.imageAtlas),tt.glyphAtlasImage&&((this||w).glyphAtlasImage=tt.glyphAtlasImage)}else(this||w).collisionBoxArray=new Al},ep.prototype.unloadVectorData=function(){for(var tt in(this||w).buckets)(this||w).buckets[tt].destroy();(this||w).buckets={},(this||w).imageAtlasTexture&&(this||w).imageAtlasTexture.destroy(),(this||w).imageAtlas&&((this||w).imageAtlas=null),(this||w).glyphAtlasTexture&&(this||w).glyphAtlasTexture.destroy(),(this||w).latestFeatureIndex=null,(this||w).state="unloaded"},ep.prototype.getBucket=function(tt){return(this||w).buckets[tt.id]},ep.prototype.upload=function(tt){for(var et in(this||w).buckets){var rt=(this||w).buckets[et];rt.uploadPending()&&rt.upload(tt)}var it=tt.gl;(this||w).imageAtlas&&!(this||w).imageAtlas.uploaded&&((this||w).imageAtlasTexture=new Ml(tt,(this||w).imageAtlas.image,it.RGBA),(this||w).imageAtlas.uploaded=!0),(this||w).glyphAtlasImage&&((this||w).glyphAtlasTexture=new Ml(tt,(this||w).glyphAtlasImage,it.ALPHA),(this||w).glyphAtlasImage=null)},ep.prototype.prepare=function(tt){(this||w).imageAtlas&&(this||w).imageAtlas.patchUpdatedImages(tt,(this||w).imageAtlasTexture)},ep.prototype.queryRenderedFeatures=function(tt,et,rt,it,nt,ot,at,st,ct,pt){return(this||w).latestFeatureIndex&&(this||w).latestFeatureIndex.rawTileData?(this||w).latestFeatureIndex.query({queryGeometry:it,cameraQueryGeometry:nt,scale:ot,tileSize:(this||w).tileSize,pixelPosMatrix:pt,transform:st,params:at,queryPadding:(this||w).queryPadding*ct},tt,et,rt):{}},ep.prototype.querySourceFeatures=function(tt,et){var rt=(this||w).latestFeatureIndex;if(rt&&rt.rawTileData){var it=rt.loadVTLayers(),nt=et?et.sourceLayer:"",ot=it._geojsonTileLayer||it[nt];if(ot)for(var at=nn(et&&et.filter),st=(this||w).tileID.canonical,ct=st.z,pt=st.x,ft=st.y,dt={z:ct,x:pt,y:ft},mt=0;mt<ot.length;mt++){var yt=ot.feature(mt);if(at.filter(new ai((this||w).tileID.overscaledZ),yt)){var vt=rt.getId(yt,nt),Dt=new Jl(yt,ct,pt,ft,vt);Dt.tile=dt,tt.push(Dt)}}}},ep.prototype.hasData=function(){return"loaded"===(this||w).state||"reloading"===(this||w).state||"expired"===(this||w).state},ep.prototype.patternsLoaded=function(){return(this||w).imageAtlas&&!!Object.keys((this||w).imageAtlas.patternPositions).length},ep.prototype.setExpiryData=function(tt){var et=(this||w).expirationTime;if(tt.cacheControl){var rt=I(tt.cacheControl);rt["max-age"]&&((this||w).expirationTime=Date.now()+1e3*rt["max-age"])}else tt.expires&&((this||w).expirationTime=new Date(tt.expires).getTime());if((this||w).expirationTime){var it=Date.now(),nt=!1;if((this||w).expirationTime>it)nt=!1;else if(et)if((this||w).expirationTime<et)nt=!0;else{var ot=(this||w).expirationTime-et;ot?(this||w).expirationTime=it+Math.max(ot,3e4):nt=!0}else nt=!0;nt?((this||w).expiredRequestCount++,(this||w).state="expired"):(this||w).expiredRequestCount=0}},ep.prototype.getExpiryTimeout=function(){if((this||w).expirationTime)return(this||w).expiredRequestCount?1e3*(1<<Math.min((this||w).expiredRequestCount-1,31)):Math.min((this||w).expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},ep.prototype.setFeatureState=function(tt,et){if((this||w).latestFeatureIndex&&(this||w).latestFeatureIndex.rawTileData&&0!==Object.keys(tt).length){var rt=(this||w).latestFeatureIndex.loadVTLayers();for(var it in(this||w).buckets)if(et.style.hasLayer(it)){var nt=(this||w).buckets[it],ot=nt.layers[0].sourceLayer||"_geojsonTileLayer",at=rt[ot],st=tt[ot];if(at&&st&&0!==Object.keys(st).length){nt.update(st,at,(this||w).imageAtlas&&(this||w).imageAtlas.patternPositions||{});var ct=et&&et.style&&et.style.getLayer(it);ct&&((this||w).queryPadding=Math.max((this||w).queryPadding,ct.queryRadius(nt)))}}}},ep.prototype.holdingForFade=function(){return void 0!==(this||w).symbolFadeHoldUntil},ep.prototype.symbolFadeFinished=function(){return!(this||w).symbolFadeHoldUntil||(this||w).symbolFadeHoldUntil<Dt.now()},ep.prototype.clearFadeHold=function(){(this||w).symbolFadeHoldUntil=void 0},ep.prototype.setHoldDuration=function(tt){(this||w).symbolFadeHoldUntil=Dt.now()+tt},ep.prototype.setDependencies=function(tt,et){for(var rt={},it=0,nt=et;it<nt.length;it+=1)rt[nt[it]]=!0;(this||w).dependencies[tt]=rt},ep.prototype.hasDependency=function(tt,et){for(var rt=0,it=tt;rt<it.length;rt+=1){var nt=(this||w).dependencies[it[rt]];if(nt)for(var ot=0,at=et;ot<at.length;ot+=1)if(nt[at[ot]])return!0}return!1};var Pp=it.performance,np=function(tt){(this||w)._marks={start:[tt.url,"start"].join("#"),end:[tt.url,"end"].join("#"),measure:tt.url.toString()},Pp.mark((this||w)._marks.start)};np.prototype.finish=function(){Pp.mark((this||w)._marks.end);var tt=Pp.getEntriesByName((this||w)._marks.measure);return 0===tt.length&&(Pp.measure((this||w)._marks.measure,(this||w)._marks.start,(this||w)._marks.end),tt=Pp.getEntriesByName((this||w)._marks.measure),Pp.clearMarks((this||w)._marks.start),Pp.clearMarks((this||w)._marks.end),Pp.clearMeasures((this||w)._marks.measure)),tt},tt.Actor=Tl,tt.AlphaImage=yo,tt.CanonicalTileID=ql,tt.CollisionBoxArray=Al,tt.Color=Wt,tt.DEMData=Zl,tt.DataConstantProperty=yi,tt.DictionaryCoder=Xl,tt.EXTENT=8192,tt.ErrorEvent=zn,tt.EvaluationParameters=ai,tt.Event=St,tt.Evented=It,tt.FeatureIndex=$l,tt.FillBucket=is,tt.FillExtrusionBucket=ws,tt.ImageAtlas=mu,tt.ImagePosition=yu,tt.LineBucket=Ts,tt.LngLat=Vl,tt.LngLatBounds=Bl,tt.MercatorCoordinate=jl,tt.ONE_EM=24,tt.OverscaledTileID=Kl,tt.Point=rt,tt.Point$1=rt,tt.Properties=xi,tt.Protobuf=Qc,tt.RGBAImage=mo,tt.RequestManager=K,tt.RequestPerformance=np,tt.ResourceType=rn,tt.SegmentVector=aa,tt.SourceFeatureState=Yl,tt.StructArrayLayout1ui2=bl,tt.StructArrayLayout2f1f2i16=tl,tt.StructArrayLayout2i4=Rs,tt.StructArrayLayout3ui6=sl,tt.StructArrayLayout4i8=Bs,tt.SymbolBucket=fl,tt.Texture=Ml,tt.Tile=ep,tt.Transitionable=ui,tt.Uniform1f=oc,tt.Uniform1i=nc,tt.Uniform2f=ac,tt.Uniform3f=sc,tt.Uniform4f=lc,tt.UniformColor=uc,tt.UniformMatrix4f=pc,tt.UnwrappedTileID=Nl,tt.ValidationError=Ct,tt.WritingMode=op,tt.ZoomHistory=qn,tt.add=function(w,tt,et){return w[0]=tt[0]+et[0],w[1]=tt[1]+et[1],w[2]=tt[2]+et[2],w},tt.addDynamicAttributes=ll,tt.asyncAll=function(w,tt,et){if(!w.length)return et(null,[]);var rt=w.length,it=new Array(w.length),nt=null;w.forEach((function(w,ot){tt(w,(function(w,tt){w&&(nt=w),it[ot]=tt,0==--rt&&et(nt,it)}))}))},tt.bezier=s,tt.bindAll=m,tt.browser=Dt,tt.cacheEntryPossiblyAdded=function(w){++Ji>qi&&(w.getActor().send("enforceCacheSizeLimit",mi),Ji=0)},tt.clamp=l,tt.clearTileCache=function(w){var tt=it.caches.delete("mapbox-tiles");w&&tt.catch(w).then((function(){return w()}))},tt.clipLine=qu,tt.clone=function(w){var tt=new yc(16);return tt[0]=w[0],tt[1]=w[1],tt[2]=w[2],tt[3]=w[3],tt[4]=w[4],tt[5]=w[5],tt[6]=w[6],tt[7]=w[7],tt[8]=w[8],tt[9]=w[9],tt[10]=w[10],tt[11]=w[11],tt[12]=w[12],tt[13]=w[13],tt[14]=w[14],tt[15]=w[15],tt},tt.clone$1=b,tt.clone$2=function(w){var tt=new yc(3);return tt[0]=w[0],tt[1]=w[1],tt[2]=w[2],tt},tt.collisionCircleLayout=Jc,tt.config=Rt,tt.create=function(){var w=new yc(16);return yc!=Float32Array&&(w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=0,w[12]=0,w[13]=0,w[14]=0),w[0]=1,w[5]=1,w[10]=1,w[15]=1,w},tt.create$1=function(){var w=new yc(9);return yc!=Float32Array&&(w[1]=0,w[2]=0,w[3]=0,w[5]=0,w[6]=0,w[7]=0),w[0]=1,w[4]=1,w[8]=1,w},tt.create$2=function(){var w=new yc(4);return yc!=Float32Array&&(w[1]=0,w[2]=0),w[0]=1,w[3]=1,w},tt.createCommonjsModule=e,tt.createExpression=Kr,tt.createLayout=Si,tt.createStyleLayer=function(w){return"custom"===w.type?new xp(w):new bp[w.type](w)},tt.cross=function(w,tt,et){var rt=tt[0],it=tt[1],nt=tt[2],ot=et[0],at=et[1],st=et[2];return w[0]=it*st-nt*at,w[1]=nt*ot-rt*st,w[2]=rt*at-it*ot,w},tt.deepEqual=function t(w,tt){if(Array.isArray(w)){if(!Array.isArray(tt)||w.length!==tt.length)return!1;for(var et=0;et<w.length;et++)if(!t(w[et],tt[et]))return!1;return!0}if("object"==typeof w&&null!==w&&null!==tt){if("object"!=typeof tt)return!1;if(Object.keys(w).length!==Object.keys(tt).length)return!1;for(var rt in w)if(!t(w[rt],tt[rt]))return!1;return!0}return w===tt},tt.dot=function(w,tt){return w[0]*tt[0]+w[1]*tt[1]+w[2]*tt[2]},tt.dot$1=function(w,tt){return w[0]*tt[0]+w[1]*tt[1]+w[2]*tt[2]+w[3]*tt[3]},tt.ease=nt,tt.emitValidationErrors=En,tt.endsWith=v,tt.enforceCacheSizeLimit=function(w){ut(),er&&er.then((function(tt){tt.keys().then((function(et){for(var rt=0;rt<et.length-w;rt++)tt.delete(et[rt])}))}))},tt.evaluateSizeForFeature=Bu,tt.evaluateSizeForZoom=Vu,tt.evaluateVariableOffset=el,tt.evented=zs,tt.extend=c,tt.featureFilter=nn,tt.filterObject=x,tt.fromRotation=function(w,tt){var et=Math.sin(tt),rt=Math.cos(tt);return w[0]=rt,w[1]=et,w[2]=0,w[3]=-et,w[4]=rt,w[5]=0,w[6]=0,w[7]=0,w[8]=1,w},tt.getAnchorAlignment=Cu,tt.getAnchorJustification=rl,tt.getArrayBuffer=xt,tt.getImage=wt,tt.getJSON=function(w,tt){return gt(c(w,{type:"json"}),tt)},tt.getRTLTextPluginStatus=ri,tt.getReferrer=bn,tt.getVideo=function(w,tt){var et,rt,nt=it.document.createElement("video");nt.muted=!0,nt.onloadstart=function(){tt(null,nt)};for(var ot=0;ot<w.length;ot++){var at=it.document.createElement("source");et=w[ot],rt=void 0,(rt=it.document.createElement("a")).href=et,(rt.protocol!==it.document.location.protocol||rt.host!==it.document.location.host)&&(nt.crossOrigin="Anonymous"),at.src=w[ot],nt.appendChild(at)}return{cancel:function(){}}},tt.identity=no,tt.invert=function(w,tt){var et=tt[0],rt=tt[1],it=tt[2],nt=tt[3],ot=tt[4],at=tt[5],st=tt[6],ct=tt[7],pt=tt[8],ft=tt[9],dt=tt[10],mt=tt[11],yt=tt[12],vt=tt[13],Dt=tt[14],Rt=tt[15],Bt=et*at-rt*ot,Ot=et*st-it*ot,Ne=et*ct-nt*ot,Ze=rt*st-it*at,Ge=rt*ct-nt*at,Ke=it*ct-nt*st,er=pt*vt-ft*yt,rr=pt*Dt-dt*yt,vr=pt*Rt-mt*yt,wr=ft*Dt-dt*vt,Sr=ft*Rt-mt*vt,ei=dt*Rt-mt*Dt,ii=Bt*ei-Ot*Sr+Ne*wr+Ze*vr-Ge*rr+Ke*er;return ii?(w[0]=(at*ei-st*Sr+ct*wr)*(ii=1/ii),w[1]=(it*Sr-rt*ei-nt*wr)*ii,w[2]=(vt*Ke-Dt*Ge+Rt*Ze)*ii,w[3]=(dt*Ge-ft*Ke-mt*Ze)*ii,w[4]=(st*vr-ot*ei-ct*rr)*ii,w[5]=(et*ei-it*vr+nt*rr)*ii,w[6]=(Dt*Ne-yt*Ke-Rt*Ot)*ii,w[7]=(pt*Ke-dt*Ne+mt*Ot)*ii,w[8]=(ot*Sr-at*vr+ct*er)*ii,w[9]=(rt*vr-et*Sr-nt*er)*ii,w[10]=(yt*Ge-vt*Ne+Rt*Bt)*ii,w[11]=(ft*Ne-pt*Ge-mt*Bt)*ii,w[12]=(at*rr-ot*wr-st*er)*ii,w[13]=(et*wr-rt*rr+it*er)*ii,w[14]=(vt*Ot-yt*Ze-Dt*Bt)*ii,w[15]=(pt*Ze-ft*Ot+dt*Bt)*ii,w):null},tt.isChar=xs,tt.isMapboxURL=G,tt.keysDifference=function(w,tt){var et=[];for(var rt in w)rt in tt||et.push(rt);return et},tt.makeRequest=gt,tt.mapObject=g,tt.mercatorXfromLng=Ll,tt.mercatorYfromLat=Rl,tt.mercatorZfromAltitude=Ol,tt.mul=_c,tt.multiply=io,tt.mvt=Lc,tt.normalize=function(w,tt){var et=tt[0],rt=tt[1],it=tt[2],nt=et*et+rt*rt+it*it;return nt>0&&(nt=1/Math.sqrt(nt)),w[0]=tt[0]*nt,w[1]=tt[1]*nt,w[2]=tt[2]*nt,w},tt.number=qe,tt.offscreenCanvasSupported=ht,tt.ortho=function(w,tt,et,rt,it,nt,ot){var at=1/(tt-et),st=1/(rt-it),ct=1/(nt-ot);return w[0]=-2*at,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*st,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=2*ct,w[11]=0,w[12]=(tt+et)*at,w[13]=(it+rt)*st,w[14]=(ot+nt)*ct,w[15]=1,w},tt.parseGlyphPBF=function(w){return new Qc(w).readFields(pu,[])},tt.pbf=Qc,tt.performSymbolLayout=function(w,tt,et,rt,it,nt,ot){w.createArrays(),w.tilePixelRatio=8192/(512*w.overscaling),w.compareText={},w.iconsNeedLinear=!1;var at=w.layers[0].layout,st=w.layers[0]._unevaluatedLayout._values,ct={};if("composite"===w.textSizeData.kind){var pt=w.textSizeData,ft=pt.maxZoom;ct.compositeTextSizes=[st["text-size"].possiblyEvaluate(new ai(pt.minZoom),ot),st["text-size"].possiblyEvaluate(new ai(ft),ot)]}if("composite"===w.iconSizeData.kind){var dt=w.iconSizeData,mt=dt.maxZoom;ct.compositeIconSizes=[st["icon-size"].possiblyEvaluate(new ai(dt.minZoom),ot),st["icon-size"].possiblyEvaluate(new ai(mt),ot)]}ct.layoutTextSize=st["text-size"].possiblyEvaluate(new ai(w.zoom+1),ot),ct.layoutIconSize=st["icon-size"].possiblyEvaluate(new ai(w.zoom+1),ot),ct.textMaxSize=st["text-size"].possiblyEvaluate(new ai(18));for(var yt=24*at.get("text-line-height"),vt="map"===at.get("text-rotation-alignment")&&"point"!==at.get("symbol-placement"),Dt=at.get("text-keep-upright"),Rt=at.get("text-size"),g=function(){var nt=Ot[Bt],st=at.get("text-font").evaluate(nt,{},ot).join(","),pt=Rt.evaluate(nt,{},ot),ft=ct.layoutTextSize.evaluate(nt,{},ot),dt=ct.layoutIconSize.evaluate(nt,{},ot),mt={horizontal:{},vertical:void 0},Ne=nt.text,Ze=[0,0];if(Ne){var Ge=Ne.toString(),Ke=24*at.get("text-letter-spacing").evaluate(nt,{},ot),er=function(w){for(var tt=0,et=w;tt<et.length;tt+=1)if(rt=et[tt].charCodeAt(0),xs.Arabic(rt)||xs["Arabic Supplement"](rt)||xs["Arabic Extended-A"](rt)||xs["Arabic Presentation Forms-A"](rt)||xs["Arabic Presentation Forms-B"](rt))return!1;var rt;return!0}(Ge)?Ke:0,rr=at.get("text-anchor").evaluate(nt,{},ot),vr=at.get("text-variable-anchor");if(!vr){var wr=at.get("text-radial-offset").evaluate(nt,{},ot);Ze=wr?el(rr,[24*wr,cp]):at.get("text-offset").evaluate(nt,{},ot).map((function(w){return 24*w}))}var Sr=vt?"center":at.get("text-justify").evaluate(nt,{},ot),ei=at.get("symbol-placement"),ii="point"===ei?24*at.get("text-max-width").evaluate(nt,{},ot):0,P=function(){w.allowVerticalPlacement&&Kn(Ge)&&(mt.vertical=bu(Ne,tt,et,it,st,ii,yt,rr,"left",er,Ze,op.vertical,!0,ei,ft,pt))};if(!vt&&vr){for(var mi="auto"===Sr?vr.map((function(w){return rl(w)})):[Sr],qi=!1,Ki=0;Ki<mi.length;Ki++){var Ji=mi[Ki];if(!mt.horizontal[Ji])if(qi)mt.horizontal[Ji]=mt.horizontal[0];else{var rn=bu(Ne,tt,et,it,st,ii,yt,"center",Ji,er,Ze,op.horizontal,!1,ei,ft,pt);rn&&(mt.horizontal[Ji]=rn,qi=1===rn.positionedLines.length)}}P()}else{"auto"===Sr&&(Sr=rl(rr));var vn=bu(Ne,tt,et,it,st,ii,yt,rr,Sr,er,Ze,op.horizontal,!1,ei,ft,pt);vn&&(mt.horizontal[Sr]=vn),P(),Kn(Ge)&&vt&&Dt&&(mt.vertical=bu(Ne,tt,et,it,st,ii,yt,rr,Sr,er,Ze,op.vertical,!1,ei,ft,pt))}}var bn=void 0,Tn=!1;if(nt.icon&&nt.icon.name){var In=rt[nt.icon.name];In&&(bn=function(w,tt,et){var rt=Cu(et),it=tt[0]-w.displaySize[0]*rt.horizontalAlign,nt=tt[1]-w.displaySize[1]*rt.verticalAlign;return{image:w,top:nt,bottom:nt+w.displaySize[1],left:it,right:it+w.displaySize[0]}}(it[nt.icon.name],at.get("icon-offset").evaluate(nt,{},ot),at.get("icon-anchor").evaluate(nt,{},ot)),Tn=In.sdf,void 0===w.sdfIcons?w.sdfIcons=In.sdf:w.sdfIcons!==In.sdf&&_("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(In.pixelRatio!==w.pixelRatio||0!==at.get("icon-rotate").constantOr(1))&&(w.iconsNeedLinear=!0))}var zn=il(mt.horizontal)||mt.vertical;w.iconsInText=!!zn&&zn.iconsInText,(zn||bn)&&function(w,tt,et,rt,it,nt,ot,at,st,ct,pt){var ft=nt.textMaxSize.evaluate(tt,{});void 0===ft&&(ft=ot);var dt,mt=w.layers[0].layout,yt=mt.get("icon-offset").evaluate(tt,{},pt),vt=il(et.horizontal),Dt=ot/24,Rt=w.tilePixelRatio*Dt,Bt=w.tilePixelRatio*ft/24,Ot=w.tilePixelRatio*at,Ne=w.tilePixelRatio*mt.get("symbol-spacing"),Ze=mt.get("text-padding")*w.tilePixelRatio,Ge=mt.get("icon-padding")*w.tilePixelRatio,Ke=mt.get("text-max-angle")/180*Math.PI,er="map"===mt.get("text-rotation-alignment")&&"point"!==mt.get("symbol-placement"),rr="map"===mt.get("icon-rotation-alignment")&&"point"!==mt.get("symbol-placement"),vr=mt.get("symbol-placement"),wr=Ne/2,Sr=mt.get("icon-text-fit");rt&&"none"!==Sr&&(w.allowVerticalPlacement&&et.vertical&&(dt=Eu(rt,et.vertical,Sr,mt.get("icon-text-fit-padding"),yt,Dt)),vt&&(rt=Eu(rt,vt,Sr,mt.get("icon-text-fit-padding"),yt,Dt)));var E=function(at,ft){ft.x<0||ft.x>=8192||ft.y<0||ft.y>=8192||function(w,tt,et,rt,it,nt,ot,at,st,ct,pt,ft,dt,mt,yt,vt,Dt,Rt,Bt,Ot,Ne,Ze,Ge,Ke,er){var rr,vr,wr,Sr,ei,ii=w.addToLineVertexArray(tt,et),mi=0,qi=0,Ki=0,Ji=0,rn=-1,vn=-1,bn={},Tn=ec(""),In=0,zn=0;if(void 0===at._unevaluatedLayout.getValue("text-radial-offset")?(In=(rr=at.layout.get("text-offset").evaluate(Ne,{},Ke).map((function(w){return 24*w})))[0],zn=rr[1]):(In=24*at.layout.get("text-radial-offset").evaluate(Ne,{},Ke),zn=cp),w.allowVerticalPlacement&&rt.vertical){var Cn=at.layout.get("text-rotate").evaluate(Ne,{},Ke)+90;Sr=new Ju(st,tt,ct,pt,ft,rt.vertical,dt,mt,yt,Cn),ot&&(ei=new Ju(st,tt,ct,pt,ft,ot,Dt,Rt,yt,Cn))}if(it){var Mn=at.layout.get("icon-rotate").evaluate(Ne,{}),Ln="none"!==at.layout.get("icon-text-fit"),Bn=Nu(it,Mn,Ge,Ln),Fn=ot?Nu(ot,Mn,Ge,Ln):void 0;wr=new Ju(st,tt,ct,pt,ft,it,Dt,Rt,!1,Mn),mi=4*Bn.length;var Vn=w.iconSizeData,Nn=null;"source"===Vn.kind?(Nn=[128*at.layout.get("icon-size").evaluate(Ne,{})])[0]>32640&&_(w.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===Vn.kind&&((Nn=[128*Ze.compositeIconSizes[0].evaluate(Ne,{},Ke),128*Ze.compositeIconSizes[1].evaluate(Ne,{},Ke)])[0]>32640||Nn[1]>32640)&&_(w.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),w.addSymbols(w.icon,Bn,Nn,Ot,Bt,Ne,!1,tt,ii.lineStartIndex,ii.lineLength,-1,Ke),rn=w.icon.placedSymbolArray.length-1,Fn&&(qi=4*Fn.length,w.addSymbols(w.icon,Fn,Nn,Ot,Bt,Ne,op.vertical,tt,ii.lineStartIndex,ii.lineLength,-1,Ke),vn=w.icon.placedSymbolArray.length-1)}for(var Wn in rt.horizontal){var Yn=rt.horizontal[Wn];if(!vr){Tn=ec(Yn.text);var $n=at.layout.get("text-rotate").evaluate(Ne,{},Ke);vr=new Ju(st,tt,ct,pt,ft,Yn,dt,mt,yt,$n)}var uo=1===Yn.positionedLines.length;if(Ki+=nl(w,tt,Yn,nt,at,yt,Ne,vt,ii,rt.vertical?op.horizontal:op.horizontalOnly,uo?Object.keys(rt.horizontal):[Wn],bn,rn,Ze,Ke),uo)break}rt.vertical&&(Ji+=nl(w,tt,rt.vertical,nt,at,yt,Ne,vt,ii,op.vertical,["vertical"],bn,vn,Ze,Ke));var po=vr?vr.boxStartIndex:w.collisionBoxArray.length,vo=vr?vr.boxEndIndex:w.collisionBoxArray.length,So=Sr?Sr.boxStartIndex:w.collisionBoxArray.length,ta=Sr?Sr.boxEndIndex:w.collisionBoxArray.length,ea=wr?wr.boxStartIndex:w.collisionBoxArray.length,ra=wr?wr.boxEndIndex:w.collisionBoxArray.length,ia=ei?ei.boxStartIndex:w.collisionBoxArray.length,na=ei?ei.boxEndIndex:w.collisionBoxArray.length,sa=-1,ut=function(w,tt){return w&&w.circleDiameter?Math.max(w.circleDiameter,tt):tt};sa=ut(vr,sa),sa=ut(Sr,sa),sa=ut(wr,sa);var la=(sa=ut(ei,sa))>-1?1:0;la&&(sa*=er/24),w.glyphOffsetArray.length>=fl.MAX_GLYPHS&&_("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Ne.sortKey&&w.addToSortKeyRanges(w.symbolInstances.length,Ne.sortKey),w.symbolInstances.emplaceBack(tt.x,tt.y,bn.right>=0?bn.right:-1,bn.center>=0?bn.center:-1,bn.left>=0?bn.left:-1,bn.vertical||-1,rn,vn,Tn,po,vo,So,ta,ea,ra,ia,na,ct,Ki,Ji,mi,qi,la,0,dt,In,zn,sa)}(w,ft,at,et,rt,it,dt,w.layers[0],w.collisionBoxArray,tt.index,tt.sourceLayerIndex,w.index,Rt,Ze,er,st,Ot,Ge,rr,yt,tt,nt,ct,pt,ot)};if("line"===vr)for(var ei=0,ii=qu(tt.geometry,0,0,8192,8192);ei<ii.length;ei+=1)for(var mi=ii[ei],qi=0,Ki=ju(mi,Ne,Ke,et.vertical||vt,rt,24,Bt,w.overscaling,8192);qi<Ki.length;qi+=1){var Ji=Ki[qi];vt&&al(w,vt.text,wr,Ji)||E(mi,Ji)}else if("line-center"===vr)for(var rn=0,vn=tt.geometry;rn<vn.length;rn+=1){var bn=vn[rn];if(bn.length>1){var Tn=Uu(bn,Ke,et.vertical||vt,rt,24,Bt);Tn&&E(bn,Tn)}}else if("Polygon"===tt.type)for(var In=0,zn=ts(tt.geometry,0);In<zn.length;In+=1){var Cn=zn[In],Mn=$u(Cn,16);E(Cn[0],new lp(Mn.x,Mn.y,0))}else if("LineString"===tt.type)for(var Ln=0,Bn=tt.geometry;Ln<Bn.length;Ln+=1){var Fn=Bn[Ln];E(Fn,new lp(Fn[0].x,Fn[0].y,0))}else if("Point"===tt.type)for(var Vn=0,Nn=tt.geometry;Vn<Nn.length;Vn+=1)for(var Wn=0,Yn=Nn[Vn];Wn<Yn.length;Wn+=1){var $n=Yn[Wn];E([$n],new lp($n.x,$n.y,0))}}(w,nt,mt,bn,rt,ct,ft,dt,Ze,Tn,ot)},Bt=0,Ot=w.features;Bt<Ot.length;Bt+=1)g();nt&&w.generateCollisionDebugBuffers()},tt.perspective=function(w,tt,et,rt,it){var nt,ot=1/Math.tan(tt/2);return w[0]=ot/et,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=ot,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,null!=it&&it!==1/0?(w[10]=(it+rt)*(nt=1/(rt-it)),w[14]=2*it*rt*nt):(w[10]=-1,w[14]=-2*rt),w},tt.pick=function(w,tt){for(var et={},rt=0;rt<tt.length;rt++){var it=tt[rt];it in w&&(et[it]=w[it])}return et},tt.plugin=Ps,tt.polygonIntersectsPolygon=Ua,tt.postMapLoadEvent=ii,tt.postTurnstileEvent=Sr,tt.potpack=fu,tt.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],tt.register=Dn,tt.registerForPluginStateChange=function(w){return w({pluginStatus:Es,pluginURL:As}),zs.on("pluginStateChange",w),w},tt.rotate=function(w,tt,et){var rt=tt[0],it=tt[1],nt=tt[2],ot=tt[3],at=Math.sin(et),st=Math.cos(et);return w[0]=rt*st+nt*at,w[1]=it*st+ot*at,w[2]=rt*-at+nt*st,w[3]=it*-at+ot*st,w},tt.rotateX=function(w,tt,et){var rt=Math.sin(et),it=Math.cos(et),nt=tt[4],ot=tt[5],at=tt[6],st=tt[7],ct=tt[8],pt=tt[9],ft=tt[10],dt=tt[11];return tt!==w&&(w[0]=tt[0],w[1]=tt[1],w[2]=tt[2],w[3]=tt[3],w[12]=tt[12],w[13]=tt[13],w[14]=tt[14],w[15]=tt[15]),w[4]=nt*it+ct*rt,w[5]=ot*it+pt*rt,w[6]=at*it+ft*rt,w[7]=st*it+dt*rt,w[8]=ct*it-nt*rt,w[9]=pt*it-ot*rt,w[10]=ft*it-at*rt,w[11]=dt*it-st*rt,w},tt.rotateZ=function(w,tt,et){var rt=Math.sin(et),it=Math.cos(et),nt=tt[0],ot=tt[1],at=tt[2],st=tt[3],ct=tt[4],pt=tt[5],ft=tt[6],dt=tt[7];return tt!==w&&(w[8]=tt[8],w[9]=tt[9],w[10]=tt[10],w[11]=tt[11],w[12]=tt[12],w[13]=tt[13],w[14]=tt[14],w[15]=tt[15]),w[0]=nt*it+ct*rt,w[1]=ot*it+pt*rt,w[2]=at*it+ft*rt,w[3]=st*it+dt*rt,w[4]=ct*it-nt*rt,w[5]=pt*it-ot*rt,w[6]=ft*it-at*rt,w[7]=dt*it-st*rt,w},tt.scale=function(w,tt,et){var rt=et[0],it=et[1],nt=et[2];return w[0]=tt[0]*rt,w[1]=tt[1]*rt,w[2]=tt[2]*rt,w[3]=tt[3]*rt,w[4]=tt[4]*it,w[5]=tt[5]*it,w[6]=tt[6]*it,w[7]=tt[7]*it,w[8]=tt[8]*nt,w[9]=tt[9]*nt,w[10]=tt[10]*nt,w[11]=tt[11]*nt,w[12]=tt[12],w[13]=tt[13],w[14]=tt[14],w[15]=tt[15],w},tt.scale$1=function(w,tt,et){return w[0]=tt[0]*et,w[1]=tt[1]*et,w[2]=tt[2]*et,w[3]=tt[3]*et,w},tt.scale$2=function(w,tt,et){return w[0]=tt[0]*et,w[1]=tt[1]*et,w[2]=tt[2]*et,w},tt.setCacheLimits=function(w,tt){mi=w,qi=tt},tt.setRTLTextPlugin=function(w,tt,et){if(void 0===et&&(et=!1),"deferred"===Es||"loading"===Es||"loaded"===Es)throw new Error("setRTLTextPlugin cannot be called multiple times.");As=Dt.resolveURL(w),Es="deferred",Ss=tt,ti(),et||ni()},tt.sphericalToCartesian=function(w){var tt=w[0],et=w[1],rt=w[2];return et+=90,et*=Math.PI/180,rt*=Math.PI/180,{x:tt*Math.cos(et)*Math.sin(rt),y:tt*Math.sin(et)*Math.sin(rt),z:tt*Math.cos(rt)}},tt.sqrLen=function(w){var tt=w[0],et=w[1];return tt*tt+et*et},tt.styleSpec=Cn,tt.sub=function(w,tt,et){return w[0]=tt[0]-et[0],w[1]=tt[1]-et[1],w[2]=tt[2]-et[2],w},tt.symbolSize=up,tt.transformMat3=function(w,tt,et){var rt=tt[0],it=tt[1],nt=tt[2];return w[0]=rt*et[0]+it*et[3]+nt*et[6],w[1]=rt*et[1]+it*et[4]+nt*et[7],w[2]=rt*et[2]+it*et[5]+nt*et[8],w},tt.transformMat4=so,tt.translate=function(w,tt,et){var rt,it,nt,ot,at,st,ct,pt,ft,dt,mt,yt,vt=et[0],Dt=et[1],Rt=et[2];return tt===w?(w[12]=tt[0]*vt+tt[4]*Dt+tt[8]*Rt+tt[12],w[13]=tt[1]*vt+tt[5]*Dt+tt[9]*Rt+tt[13],w[14]=tt[2]*vt+tt[6]*Dt+tt[10]*Rt+tt[14],w[15]=tt[3]*vt+tt[7]*Dt+tt[11]*Rt+tt[15]):(it=tt[1],nt=tt[2],ot=tt[3],at=tt[4],st=tt[5],ct=tt[6],pt=tt[7],ft=tt[8],dt=tt[9],mt=tt[10],yt=tt[11],w[0]=rt=tt[0],w[1]=it,w[2]=nt,w[3]=ot,w[4]=at,w[5]=st,w[6]=ct,w[7]=pt,w[8]=ft,w[9]=dt,w[10]=mt,w[11]=yt,w[12]=rt*vt+at*Dt+ft*Rt+tt[12],w[13]=it*vt+st*Dt+dt*Rt+tt[13],w[14]=nt*vt+ct*Dt+mt*Rt+tt[14],w[15]=ot*vt+pt*Dt+yt*Rt+tt[15]),w},tt.triggerPluginCompletionEvent=Qn,tt.uniqueId=f,tt.validateCustomStyleLayer=function(w){var tt=[],et=w.id;return void 0===et&&tt.push({message:"layers."+et+': missing required property "id"'}),void 0===w.render&&tt.push({message:"layers."+et+': missing required method "render"'}),w.renderingMode&&"2d"!==w.renderingMode&&"3d"!==w.renderingMode&&tt.push({message:"layers."+et+': property "renderingMode" must be either "2d" or "3d"'}),tt},tt.validateLight=os,tt.validateStyle=Fa,tt.values=function(w){var tt=[];for(var et in w)tt.push(w[et]);return tt},tt.vectorTile=Lc,tt.version="1.11.0",tt.warnOnce=_,tt.webpSupported=Bt,tt.window=it,tt.wrap=p}));define(["./shared"],(function(tt){function t(w){var tt=typeof w;if("number"===tt||"boolean"===tt||"string"===tt||null==w)return JSON.stringify(w);if(Array.isArray(w)){for(var et="[",rt=0,it=w;rt<it.length;rt+=1)et+=t(it[rt])+",";return et+"]"}for(var nt=Object.keys(w).sort(),ot="{",at=0;at<nt.length;at++)ot+=JSON.stringify(nt[at])+":"+t(w[nt[at]])+",";return ot+"}"}function r(w){for(var et="",rt=0,it=tt.refProperties;rt<it.length;rt+=1)et+="/"+t(w[it[rt]]);return et}var i=function(tt){(this||w).keyCache={},tt&&this.replace(tt)};i.prototype.replace=function(tt){(this||w)._layerConfigs={},(this||w)._layers={},this.update(tt,[])},i.prototype.update=function(et,rt){for(var it=this||w,nt=0,ot=et;nt<ot.length;nt+=1){var at=ot[nt];(this||w)._layerConfigs[at.id]=at;var st=(this||w)._layers[at.id]=tt.createStyleLayer(at);st._featureFilter=tt.featureFilter(st.filter),(this||w).keyCache[at.id]&&delete(this||w).keyCache[at.id]}for(var ct=0,pt=rt;ct<pt.length;ct+=1){var ft=pt[ct];delete(this||w).keyCache[ft],delete(this||w)._layerConfigs[ft],delete(this||w)._layers[ft]}(this||w).familiesBySource={};for(var dt=0,mt=function(w,tt){for(var et={},rt=0;rt<w.length;rt++){var it=tt&&tt[w[rt].id]||r(w[rt]);tt&&(tt[w[rt].id]=it);var nt=et[it];nt||(nt=et[it]=[]),nt.push(w[rt])}var ot=[];for(var at in et)ot.push(et[at]);return ot}(tt.values((this||w)._layerConfigs),(this||w).keyCache);dt<mt.length;dt+=1){var yt=mt[dt].map((function(w){return it._layers[w.id]})),vt=yt[0];if("none"!==vt.visibility){var Dt=vt.source||"",Rt=(this||w).familiesBySource[Dt];Rt||(Rt=(this||w).familiesBySource[Dt]={});var Bt=vt.sourceLayer||"_geojsonTileLayer",Ot=Rt[Bt];Ot||(Ot=Rt[Bt]=[]),Ot.push(yt)}}};var o=function(et){var rt={},it=[];for(var nt in et){var ot=et[nt],at=rt[nt]={};for(var st in ot){var ct=ot[+st];if(ct&&0!==ct.bitmap.width&&0!==ct.bitmap.height){var pt={x:0,y:0,w:ct.bitmap.width+2,h:ct.bitmap.height+2};it.push(pt),at[st]={rect:pt,metrics:ct.metrics}}}}var ft=tt.potpack(it),dt=new tt.AlphaImage({width:ft.w||1,height:ft.h||1});for(var mt in et){var yt=et[mt];for(var vt in yt){var Dt=yt[+vt];if(Dt&&0!==Dt.bitmap.width&&0!==Dt.bitmap.height){var Rt=rt[mt][vt].rect;tt.AlphaImage.copy(Dt.bitmap,dt,{x:0,y:0},{x:Rt.x+1,y:Rt.y+1},Dt.bitmap)}}}(this||w).image=dt,(this||w).positions=rt};tt.register("GlyphAtlas",o);var n=function(et){(this||w).tileID=new tt.OverscaledTileID(et.tileID.overscaledZ,et.tileID.wrap,et.tileID.canonical.z,et.tileID.canonical.x,et.tileID.canonical.y),(this||w).uid=et.uid,(this||w).zoom=et.zoom,(this||w).pixelRatio=et.pixelRatio,(this||w).tileSize=et.tileSize,(this||w).source=et.source,(this||w).overscaling=(this||w).tileID.overscaleFactor(),(this||w).showCollisionBoxes=et.showCollisionBoxes,(this||w).collectResourceTiming=!!et.collectResourceTiming,(this||w).returnDependencies=!!et.returnDependencies,(this||w).promoteId=et.promoteId};function s(w,et,rt){for(var it=new tt.EvaluationParameters(et),nt=0,ot=w;nt<ot.length;nt+=1)ot[nt].recalculate(it,rt)}function a(w,et){var rt=tt.getArrayBuffer(w.request,(function(w,rt,it,nt){w?et(w):rt&&et(null,{vectorTile:new tt.vectorTile.VectorTile(new tt.pbf(rt)),rawData:rt,cacheControl:it,expires:nt})}));return function(){rt.cancel(),et()}}n.prototype.parse=function(et,rt,it,nt,ot){var at=this||w;(this||w).status="parsing",(this||w).data=et,(this||w).collisionBoxArray=new tt.CollisionBoxArray;var st=new tt.DictionaryCoder(Object.keys(et.layers).sort()),ct=new tt.FeatureIndex((this||w).tileID,(this||w).promoteId);ct.bucketLayerIDs=[];var pt,ft,dt,mt,yt={},vt={featureIndex:ct,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:it},Dt=rt.familiesBySource[(this||w).source];for(var Rt in Dt){var Bt=et.layers[Rt];if(Bt){1===Bt.version&&tt.warnOnce('Vector tile source "'+(this||w).source+'" layer "'+Rt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Ot=st.encode(Rt),Ne=[],Ze=0;Ze<Bt.length;Ze++){var Ge=Bt.feature(Ze),Ke=ct.getId(Ge,Rt);Ne.push({feature:Ge,id:Ke,index:Ze,sourceLayerIndex:Ot})}for(var er=0,rr=Dt[Rt];er<rr.length;er+=1){var vr=rr[er],wr=vr[0];wr.minzoom&&(this||w).zoom<Math.floor(wr.minzoom)||wr.maxzoom&&(this||w).zoom>=wr.maxzoom||"none"!==wr.visibility&&(s(vr,(this||w).zoom,it),(yt[wr.id]=wr.createBucket({index:ct.bucketLayerIDs.length,layers:vr,zoom:(this||w).zoom,pixelRatio:(this||w).pixelRatio,overscaling:(this||w).overscaling,collisionBoxArray:(this||w).collisionBoxArray,sourceLayerIndex:Ot,sourceID:(this||w).source})).populate(Ne,vt,(this||w).tileID.canonical),ct.bucketLayerIDs.push(vr.map((function(w){return w.id}))))}}}var Sr=tt.mapObject(vt.glyphDependencies,(function(w){return Object.keys(w).map(Number)}));Object.keys(Sr).length?nt.send("getGlyphs",{uid:(this||w).uid,stacks:Sr},(function(w,tt){pt||(pt=w,ft=tt,z.call(at))})):ft={};var ei=Object.keys(vt.iconDependencies);ei.length?nt.send("getImages",{icons:ei,source:(this||w).source,tileID:(this||w).tileID,type:"icons"},(function(w,tt){pt||(pt=w,dt=tt,z.call(at))})):dt={};var ii=Object.keys(vt.patternDependencies);function z(){if(pt)return ot(pt);if(ft&&dt&&mt){var et=new o(ft),rt=new tt.ImageAtlas(dt,mt);for(var nt in yt){var at=yt[nt];at instanceof tt.SymbolBucket?(s(at.layers,(this||w).zoom,it),tt.performSymbolLayout(at,ft,et.positions,dt,rt.iconPositions,(this||w).showCollisionBoxes,(this||w).tileID.canonical)):at.hasPattern&&(at instanceof tt.LineBucket||at instanceof tt.FillBucket||at instanceof tt.FillExtrusionBucket)&&(s(at.layers,(this||w).zoom,it),at.addFeatures(vt,(this||w).tileID.canonical,rt.patternPositions))}(this||w).status="done",ot(null,{buckets:tt.values(yt).filter((function(w){return!w.isEmpty()})),featureIndex:ct,collisionBoxArray:(this||w).collisionBoxArray,glyphAtlasImage:et.image,imageAtlas:rt,glyphMap:(this||w).returnDependencies?ft:null,iconMap:(this||w).returnDependencies?dt:null,glyphPositions:(this||w).returnDependencies?et.positions:null})}}ii.length?nt.send("getImages",{icons:ii,source:(this||w).source,tileID:(this||w).tileID,type:"patterns"},(function(w,tt){pt||(pt=w,mt=tt,z.call(at))})):mt={},z.call(this||w)};var l=function(tt,et,rt,it){(this||w).actor=tt,(this||w).layerIndex=et,(this||w).availableImages=rt,(this||w).loadVectorData=it||a,(this||w).loading={},(this||w).loaded={}};l.prototype.loadTile=function(et,rt){var it=this||w,nt=et.uid;(this||w).loading||((this||w).loading={});var ot=!!(et&&et.request&&et.request.collectResourceTiming)&&new tt.RequestPerformance(et.request),at=(this||w).loading[nt]=new n(et);at.abort=this.loadVectorData(et,(function(w,et){if(delete it.loading[nt],w||!et)return at.status="done",it.loaded[nt]=at,rt(w);var st=et.rawData,ct={};et.expires&&(ct.expires=et.expires),et.cacheControl&&(ct.cacheControl=et.cacheControl);var pt={};if(ot){var ft=ot.finish();ft&&(pt.resourceTiming=JSON.parse(JSON.stringify(ft)))}at.vectorTile=et.vectorTile,at.parse(et.vectorTile,it.layerIndex,it.availableImages,it.actor,(function(w,et){if(w||!et)return rt(w);rt(null,tt.extend({rawTileData:st.slice(0)},et,ct,pt))})),it.loaded=it.loaded||{},it.loaded[nt]=at}))},l.prototype.reloadTile=function(tt,et){var rt=this||w,it=(this||w).loaded,nt=tt.uid,ot=this||w;if(it&&it[nt]){var at=it[nt];at.showCollisionBoxes=tt.showCollisionBoxes;var a=function(w,tt){var it=at.reloadCallback;it&&(delete at.reloadCallback,at.parse(at.vectorTile,ot.layerIndex,rt.availableImages,ot.actor,it)),et(w,tt)};"parsing"===at.status?at.reloadCallback=a:"done"===at.status&&(at.vectorTile?at.parse(at.vectorTile,(this||w).layerIndex,(this||w).availableImages,(this||w).actor,a):a())}},l.prototype.abortTile=function(tt,et){var rt=(this||w).loading,it=tt.uid;rt&&rt[it]&&rt[it].abort&&(rt[it].abort(),delete rt[it]),et()},l.prototype.removeTile=function(tt,et){var rt=(this||w).loaded,it=tt.uid;rt&&rt[it]&&delete rt[it],et()};var et=tt.window.ImageBitmap,h=function(){(this||w).loaded={}};function c(w,tt){if(0!==w.length){p(w[0],tt);for(var et=1;et<w.length;et++)p(w[et],!tt)}}function p(w,tt){for(var et=0,rt=0,it=w.length,nt=it-1;rt<it;nt=rt++)et+=(w[rt][0]-w[nt][0])*(w[nt][1]+w[rt][1]);et>=0!=!!tt&&w.reverse()}h.prototype.loadTile=function(rt,it){var nt=rt.uid,ot=rt.encoding,at=rt.rawImageData,st=et&&at instanceof et?this.getImageData(at):at,ct=new tt.DEMData(nt,st,ot);(this||w).loaded=(this||w).loaded||{},(this||w).loaded[nt]=ct,it(null,ct)},h.prototype.getImageData=function(et){(this||w).offscreenCanvas&&(this||w).offscreenCanvasContext||((this||w).offscreenCanvas=new OffscreenCanvas(et.width,et.height),(this||w).offscreenCanvasContext=(this||w).offscreenCanvas.getContext("2d")),(this||w).offscreenCanvas.width=et.width,(this||w).offscreenCanvas.height=et.height,(this||w).offscreenCanvasContext.drawImage(et,0,0,et.width,et.height);var rt=(this||w).offscreenCanvasContext.getImageData(-1,-1,et.width+2,et.height+2);return(this||w).offscreenCanvasContext.clearRect(0,0,(this||w).offscreenCanvas.width,(this||w).offscreenCanvas.height),new tt.RGBAImage({width:rt.width,height:rt.height},rt.data)},h.prototype.removeTile=function(tt){var et=(this||w).loaded,rt=tt.uid;et&&et[rt]&&delete et[rt]};var rt=tt.vectorTile.VectorTileFeature.prototype.toGeoJSON,d=function(et){(this||w)._feature=et,(this||w).extent=tt.EXTENT,(this||w).type=et.type,(this||w).properties=et.tags,"id"in et&&!isNaN(et.id)&&((this||w).id=parseInt(et.id,10))};d.prototype.loadGeometry=function(){if(1===(this||w)._feature.type){for(var et=[],rt=0,it=(this||w)._feature.geometry;rt<it.length;rt+=1){var nt=it[rt];et.push([new tt.Point$1(nt[0],nt[1])])}return et}for(var ot=[],at=0,st=(this||w)._feature.geometry;at<st.length;at+=1){for(var ct=[],pt=0,ft=st[at];pt<ft.length;pt+=1){var dt=ft[pt];ct.push(new tt.Point$1(dt[0],dt[1]))}ot.push(ct)}return ot},d.prototype.toGeoJSON=function(tt,et,it){return rt.call(this||w,tt,et,it)};var g=function(et){(this||w).layers={_geojsonTileLayer:this||w},(this||w).name="_geojsonTileLayer",(this||w).extent=tt.EXTENT,(this||w).length=et.length,(this||w)._features=et};g.prototype.feature=function(tt){return new d((this||w)._features[tt])};var it=tt.vectorTile.VectorTileFeature,nt=y;function y(tt,et){(this||w).options=et||{},(this||w).features=tt,(this||w).length=tt.length}function x(tt,et){(this||w).id="number"==typeof tt.id?tt.id:void 0,(this||w).type=tt.type,(this||w).rawGeometry=1===tt.type?[tt.geometry]:tt.geometry,(this||w).properties=tt.tags,(this||w).extent=et||4096}y.prototype.feature=function(tt){return new x((this||w).features[tt],(this||w).options.extent)},x.prototype.loadGeometry=function(){var et=(this||w).rawGeometry;(this||w).geometry=[];for(var rt=0;rt<et.length;rt++){for(var it=et[rt],nt=[],ot=0;ot<it.length;ot++)nt.push(new tt.Point$1(it[ot][0],it[ot][1]));(this||w).geometry.push(nt)}return(this||w).geometry},x.prototype.bbox=function(){(this||w).geometry||this.loadGeometry();for(var tt=(this||w).geometry,et=1/0,rt=-1/0,it=1/0,nt=-1/0,ot=0;ot<tt.length;ot++)for(var at=tt[ot],st=0;st<at.length;st++){var ct=at[st];et=Math.min(et,ct.x),rt=Math.max(rt,ct.x),it=Math.min(it,ct.y),nt=Math.max(nt,ct.y)}return[et,it,rt,nt]},x.prototype.toGeoJSON=it.prototype.toGeoJSON;var ot=I,at=nt;function I(w){var et=new tt.pbf;return function(w,tt){for(var et in w.layers)tt.writeMessage(3,M,w.layers[et])}(w,et),et.finish()}function M(w,tt){var et;tt.writeVarintField(15,w.version||1),tt.writeStringField(1,w.name||""),tt.writeVarintField(5,w.extent||4096);var rt={keys:[],values:[],keycache:{},valuecache:{}};for(et=0;et<w.length;et++)rt.feature=w.feature(et),tt.writeMessage(2,b,rt);var it=rt.keys;for(et=0;et<it.length;et++)tt.writeStringField(3,it[et]);var nt=rt.values;for(et=0;et<nt.length;et++)tt.writeMessage(4,C,nt[et])}function b(w,tt){var et=w.feature;void 0!==et.id&&tt.writeVarintField(1,et.id),tt.writeMessage(2,_,w),tt.writeVarintField(3,et.type),tt.writeMessage(4,T,et)}function _(w,tt){var et=w.feature,rt=w.keys,it=w.values,nt=w.keycache,ot=w.valuecache;for(var at in et.properties){var st=nt[at];void 0===st&&(rt.push(at),nt[at]=st=rt.length-1),tt.writeVarint(st);var ct=et.properties[at],pt=typeof ct;"string"!==pt&&"boolean"!==pt&&"number"!==pt&&(ct=JSON.stringify(ct));var ft=pt+":"+ct,dt=ot[ft];void 0===dt&&(it.push(ct),ot[ft]=dt=it.length-1),tt.writeVarint(dt)}}function k(w,tt){return(tt<<3)+(7&w)}function P(w){return w<<1^w>>31}function T(w,tt){for(var et=w.loadGeometry(),rt=w.type,it=0,nt=0,ot=et.length,at=0;at<ot;at++){var st=et[at],ct=1;1===rt&&(ct=st.length),tt.writeVarint(k(1,ct));for(var pt=3===rt?st.length-1:st.length,ft=0;ft<pt;ft++){1===ft&&1!==rt&&tt.writeVarint(k(2,pt-1));var dt=st[ft].x-it,mt=st[ft].y-nt;tt.writeVarint(P(dt)),tt.writeVarint(P(mt)),it+=dt,nt+=mt}3===rt&&tt.writeVarint(k(7,1))}}function C(w,tt){var et=typeof w;"string"===et?tt.writeStringField(1,w):"boolean"===et?tt.writeBooleanField(7,w):"number"===et&&(w%1!=0?tt.writeDoubleField(3,w):w<0?tt.writeSVarintField(6,w):tt.writeVarintField(5,w))}function D(w,tt,et,rt){L(w,et,rt),L(tt,2*et,2*rt),L(tt,2*et+1,2*rt+1)}function L(w,tt,et){var rt=w[tt];w[tt]=w[et],w[et]=rt}function z(w,tt,et,rt){var it=w-et,nt=tt-rt;return it*it+nt*nt}ot.fromVectorTileJs=I,ot.fromGeojsonVt=function(w,tt){tt=tt||{};var et={};for(var rt in w)et[rt]=new nt(w[rt].features,tt),et[rt].name=rt,et[rt].version=tt.version,et[rt].extent=tt.extent;return I({layers:et})},ot.GeoJSONWrapper=at;var O=function(w){return w[0]},E=function(w){return w[1]},F=function(tt,et,rt,it,nt){void 0===et&&(et=O),void 0===rt&&(rt=E),void 0===it&&(it=64),void 0===nt&&(nt=Float64Array),(this||w).nodeSize=it,(this||w).points=tt;for(var ot=tt.length<65536?Uint16Array:Uint32Array,at=(this||w).ids=new ot(tt.length),st=(this||w).coords=new nt(2*tt.length),ct=0;ct<tt.length;ct++)at[ct]=ct,st[2*ct]=et(tt[ct]),st[2*ct+1]=rt(tt[ct]);!function e(w,tt,et,rt,it,nt){if(!(it-rt<=et)){var ot=rt+it>>1;!function e(w,tt,et,rt,it,nt){for(;it>rt;){if(it-rt>600){var ot=it-rt+1,at=et-rt+1,st=Math.log(ot),ct=.5*Math.exp(2*st/3),pt=.5*Math.sqrt(st*ct*(ot-ct)/ot)*(at-ot/2<0?-1:1);e(w,tt,et,Math.max(rt,Math.floor(et-at*ct/ot+pt)),Math.min(it,Math.floor(et+(ot-at)*ct/ot+pt)),nt)}var ft=tt[2*et+nt],dt=rt,mt=it;for(D(w,tt,rt,et),tt[2*it+nt]>ft&&D(w,tt,rt,it);dt<mt;){for(D(w,tt,dt,mt),dt++,mt--;tt[2*dt+nt]<ft;)dt++;for(;tt[2*mt+nt]>ft;)mt--}tt[2*rt+nt]===ft?D(w,tt,rt,mt):D(w,tt,++mt,it),mt<=et&&(rt=mt+1),et<=mt&&(it=mt-1)}}(w,tt,ot,rt,it,nt%2),e(w,tt,et,rt,ot-1,nt+1),e(w,tt,et,ot+1,it,nt+1)}}(at,st,it,0,at.length-1,0)};F.prototype.range=function(tt,et,rt,it){return function(w,tt,et,rt,it,nt,ot){for(var at,st,ct=[0,w.length-1,0],pt=[];ct.length;){var ft=ct.pop(),dt=ct.pop(),mt=ct.pop();if(dt-mt<=ot)for(var yt=mt;yt<=dt;yt++)st=tt[2*yt+1],(at=tt[2*yt])>=et&&at<=it&&st>=rt&&st<=nt&&pt.push(w[yt]);else{var vt=Math.floor((mt+dt)/2);st=tt[2*vt+1],(at=tt[2*vt])>=et&&at<=it&&st>=rt&&st<=nt&&pt.push(w[vt]);var Dt=(ft+1)%2;(0===ft?et<=at:rt<=st)&&(ct.push(mt),ct.push(vt-1),ct.push(Dt)),(0===ft?it>=at:nt>=st)&&(ct.push(vt+1),ct.push(dt),ct.push(Dt))}}return pt}((this||w).ids,(this||w).coords,tt,et,rt,it,(this||w).nodeSize)},F.prototype.within=function(tt,et,rt){return function(w,tt,et,rt,it,nt){for(var ot=[0,w.length-1,0],at=[],st=it*it;ot.length;){var ct=ot.pop(),pt=ot.pop(),ft=ot.pop();if(pt-ft<=nt)for(var dt=ft;dt<=pt;dt++)z(tt[2*dt],tt[2*dt+1],et,rt)<=st&&at.push(w[dt]);else{var mt=Math.floor((ft+pt)/2),yt=tt[2*mt],vt=tt[2*mt+1];z(yt,vt,et,rt)<=st&&at.push(w[mt]);var Dt=(ct+1)%2;(0===ct?et-it<=yt:rt-it<=vt)&&(ot.push(ft),ot.push(mt-1),ot.push(Dt)),(0===ct?et+it>=yt:rt+it>=vt)&&(ot.push(mt+1),ot.push(pt),ot.push(Dt))}}return at}((this||w).ids,(this||w).coords,tt,et,rt,(this||w).nodeSize)};var st={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(w){return w}},J=function(tt){(this||w).options=V(Object.create(st),tt),(this||w).trees=new Array((this||w).options.maxZoom+1)};function Z(w,tt,et,rt,it){return{x:w,y:tt,zoom:1/0,id:et,parentId:-1,numPoints:rt,properties:it}}function A(w,tt){var et=w.geometry.coordinates,rt=et[1];return{x:Y(et[0]),y:j(rt),zoom:1/0,index:tt,parentId:-1}}function B(w){return{type:"Feature",id:w.id,properties:G(w),geometry:{type:"Point",coordinates:[(rt=w.x,360*(rt-.5)),(tt=w.y,et=(180-360*tt)*Math.PI/180,360*Math.atan(Math.exp(et))/Math.PI-90)]}};var tt,et,rt}function G(w){var tt=w.numPoints,et=tt>=1e4?Math.round(tt/1e3)+"k":tt>=1e3?Math.round(tt/100)/10+"k":tt;return V(V({},w.properties),{cluster:!0,cluster_id:w.id,point_count:tt,point_count_abbreviated:et})}function Y(w){return w/360+.5}function j(w){var tt=Math.sin(w*Math.PI/180),et=.5-.25*Math.log((1+tt)/(1-tt))/Math.PI;return et<0?0:et>1?1:et}function V(w,tt){for(var et in tt)w[et]=tt[et];return w}function X(w){return w.x}function W(w){return w.y}function R(w,tt,et,rt,it,nt){var ot=it-et,at=nt-rt;if(0!==ot||0!==at){var st=((w-et)*ot+(tt-rt)*at)/(ot*ot+at*at);st>1?(et=it,rt=nt):st>0&&(et+=ot*st,rt+=at*st)}return(ot=w-et)*ot+(at=tt-rt)*at}function q(w,tt,et,rt){var it={id:void 0===w?null:w,type:tt,geometry:et,tags:rt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(w){var tt=w.geometry,et=w.type;if("Point"===et||"MultiPoint"===et||"LineString"===et)U(w,tt);else if("Polygon"===et||"MultiLineString"===et)for(var rt=0;rt<tt.length;rt++)U(w,tt[rt]);else if("MultiPolygon"===et)for(rt=0;rt<tt.length;rt++)for(var it=0;it<tt[rt].length;it++)U(w,tt[rt][it])}(it),it}function U(w,tt){for(var et=0;et<tt.length;et+=3)w.minX=Math.min(w.minX,tt[et]),w.minY=Math.min(w.minY,tt[et+1]),w.maxX=Math.max(w.maxX,tt[et]),w.maxY=Math.max(w.maxY,tt[et+1])}function $(w,tt,et,rt){if(tt.geometry){var it=tt.geometry.coordinates,nt=tt.geometry.type,ot=Math.pow(et.tolerance/((1<<et.maxZoom)*et.extent),2),at=[],st=tt.id;if(et.promoteId?st=tt.properties[et.promoteId]:et.generateId&&(st=rt||0),"Point"===nt)H(it,at);else if("MultiPoint"===nt)for(var ct=0;ct<it.length;ct++)H(it[ct],at);else if("LineString"===nt)K(it,at,ot,!1);else if("MultiLineString"===nt){if(et.lineMetrics){for(ct=0;ct<it.length;ct++)K(it[ct],at=[],ot,!1),w.push(q(st,"LineString",at,tt.properties));return}Q(it,at,ot,!1)}else if("Polygon"===nt)Q(it,at,ot,!0);else{if("MultiPolygon"!==nt){if("GeometryCollection"===nt){for(ct=0;ct<tt.geometry.geometries.length;ct++)$(w,{id:st,geometry:tt.geometry.geometries[ct],properties:tt.properties},et,rt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ct=0;ct<it.length;ct++){var pt=[];Q(it[ct],pt,ot,!0),at.push(pt)}}w.push(q(st,nt,at,tt.properties))}}function H(w,tt){tt.push(ee(w[0])),tt.push(te(w[1])),tt.push(0)}function K(w,tt,et,rt){for(var it,nt,ot=0,at=0;at<w.length;at++){var st=ee(w[at][0]),ct=te(w[at][1]);tt.push(st),tt.push(ct),tt.push(0),at>0&&(ot+=rt?(it*ct-st*nt)/2:Math.sqrt(Math.pow(st-it,2)+Math.pow(ct-nt,2))),it=st,nt=ct}var pt=tt.length-3;tt[2]=1,function e(w,tt,et,rt){for(var it,nt=rt,ot=et-tt>>1,at=et-tt,st=w[tt],ct=w[tt+1],pt=w[et],ft=w[et+1],dt=tt+3;dt<et;dt+=3){var mt=R(w[dt],w[dt+1],st,ct,pt,ft);if(mt>nt)it=dt,nt=mt;else if(mt===nt){var yt=Math.abs(dt-ot);yt<at&&(it=dt,at=yt)}}nt>rt&&(it-tt>3&&e(w,tt,it,rt),w[it+2]=nt,et-it>3&&e(w,it,et,rt))}(tt,0,pt,et),tt[pt+2]=1,tt.size=Math.abs(ot),tt.start=0,tt.end=tt.size}function Q(w,tt,et,rt){for(var it=0;it<w.length;it++){var nt=[];K(w[it],nt,et,rt),tt.push(nt)}}function ee(w){return w/360+.5}function te(w){var tt=Math.sin(w*Math.PI/180),et=.5-.25*Math.log((1+tt)/(1-tt))/Math.PI;return et<0?0:et>1?1:et}function re(w,tt,et,rt,it,nt,ot,at){if(rt/=tt,nt>=(et/=tt)&&ot<rt)return w;if(ot<et||nt>=rt)return null;for(var st=[],ct=0;ct<w.length;ct++){var pt=w[ct],ft=pt.geometry,dt=pt.type,mt=0===it?pt.minX:pt.minY,yt=0===it?pt.maxX:pt.maxY;if(mt>=et&&yt<rt)st.push(pt);else if(!(yt<et||mt>=rt)){var vt=[];if("Point"===dt||"MultiPoint"===dt)ie(ft,vt,et,rt,it);else if("LineString"===dt)oe(ft,vt,et,rt,it,!1,at.lineMetrics);else if("MultiLineString"===dt)se(ft,vt,et,rt,it,!1);else if("Polygon"===dt)se(ft,vt,et,rt,it,!0);else if("MultiPolygon"===dt)for(var Dt=0;Dt<ft.length;Dt++){var Rt=[];se(ft[Dt],Rt,et,rt,it,!0),Rt.length&&vt.push(Rt)}if(vt.length){if(at.lineMetrics&&"LineString"===dt){for(Dt=0;Dt<vt.length;Dt++)st.push(q(pt.id,dt,vt[Dt],pt.tags));continue}"LineString"!==dt&&"MultiLineString"!==dt||(1===vt.length?(dt="LineString",vt=vt[0]):dt="MultiLineString"),"Point"!==dt&&"MultiPoint"!==dt||(dt=3===vt.length?"Point":"MultiPoint"),st.push(q(pt.id,dt,vt,pt.tags))}}}return st.length?st:null}function ie(w,tt,et,rt,it){for(var nt=0;nt<w.length;nt+=3){var ot=w[nt+it];ot>=et&&ot<=rt&&(tt.push(w[nt]),tt.push(w[nt+1]),tt.push(w[nt+2]))}}function oe(w,tt,et,rt,it,nt,ot){for(var at,st,ct=ne(w),pt=0===it?le:ue,ft=w.start,dt=0;dt<w.length-3;dt+=3){var mt=w[dt],yt=w[dt+1],vt=w[dt+2],Dt=w[dt+3],Rt=w[dt+4],Bt=0===it?mt:yt,Ot=0===it?Dt:Rt,Ne=!1;ot&&(at=Math.sqrt(Math.pow(mt-Dt,2)+Math.pow(yt-Rt,2))),Bt<et?Ot>et&&(st=pt(ct,mt,yt,Dt,Rt,et),ot&&(ct.start=ft+at*st)):Bt>rt?Ot<rt&&(st=pt(ct,mt,yt,Dt,Rt,rt),ot&&(ct.start=ft+at*st)):ae(ct,mt,yt,vt),Ot<et&&Bt>=et&&(st=pt(ct,mt,yt,Dt,Rt,et),Ne=!0),Ot>rt&&Bt<=rt&&(st=pt(ct,mt,yt,Dt,Rt,rt),Ne=!0),!nt&&Ne&&(ot&&(ct.end=ft+at*st),tt.push(ct),ct=ne(w)),ot&&(ft+=at)}var Ze=w.length-3;mt=w[Ze],yt=w[Ze+1],vt=w[Ze+2],(Bt=0===it?mt:yt)>=et&&Bt<=rt&&ae(ct,mt,yt,vt),Ze=ct.length-3,nt&&Ze>=3&&(ct[Ze]!==ct[0]||ct[Ze+1]!==ct[1])&&ae(ct,ct[0],ct[1],ct[2]),ct.length&&tt.push(ct)}function ne(w){var tt=[];return tt.size=w.size,tt.start=w.start,tt.end=w.end,tt}function se(w,tt,et,rt,it,nt){for(var ot=0;ot<w.length;ot++)oe(w[ot],tt,et,rt,it,nt,!1)}function ae(w,tt,et,rt){w.push(tt),w.push(et),w.push(rt)}function le(w,tt,et,rt,it,nt){var ot=(nt-tt)/(rt-tt);return w.push(nt),w.push(et+(it-et)*ot),w.push(1),ot}function ue(w,tt,et,rt,it,nt){var ot=(nt-et)/(it-et);return w.push(tt+(rt-tt)*ot),w.push(nt),w.push(1),ot}function he(w,tt){for(var et=[],rt=0;rt<w.length;rt++){var it,nt=w[rt],ot=nt.type;if("Point"===ot||"MultiPoint"===ot||"LineString"===ot)it=ce(nt.geometry,tt);else if("MultiLineString"===ot||"Polygon"===ot){it=[];for(var at=0;at<nt.geometry.length;at++)it.push(ce(nt.geometry[at],tt))}else if("MultiPolygon"===ot)for(it=[],at=0;at<nt.geometry.length;at++){for(var st=[],ct=0;ct<nt.geometry[at].length;ct++)st.push(ce(nt.geometry[at][ct],tt));it.push(st)}et.push(q(nt.id,ot,it,nt.tags))}return et}function ce(w,tt){var et=[];et.size=w.size,void 0!==w.start&&(et.start=w.start,et.end=w.end);for(var rt=0;rt<w.length;rt+=3)et.push(w[rt]+tt,w[rt+1],w[rt+2]);return et}function pe(w,tt){if(w.transformed)return w;var et,rt,it,nt=1<<w.z,ot=w.x,at=w.y;for(et=0;et<w.features.length;et++){var st=w.features[et],ct=st.geometry,pt=st.type;if(st.geometry=[],1===pt)for(rt=0;rt<ct.length;rt+=2)st.geometry.push(fe(ct[rt],ct[rt+1],tt,nt,ot,at));else for(rt=0;rt<ct.length;rt++){var ft=[];for(it=0;it<ct[rt].length;it+=2)ft.push(fe(ct[rt][it],ct[rt][it+1],tt,nt,ot,at));st.geometry.push(ft)}}return w.transformed=!0,w}function fe(w,tt,et,rt,it,nt){return[Math.round(et*(w*rt-it)),Math.round(et*(tt*rt-nt))]}function de(w,tt,et,rt,it){for(var nt=tt===it.maxZoom?0:it.tolerance/((1<<tt)*it.extent),ot={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:et,y:rt,z:tt,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},at=0;at<w.length;at++){ot.numFeatures++,ge(ot,w[at],nt,it);var st=w[at].minX,ct=w[at].minY,pt=w[at].maxX,ft=w[at].maxY;st<ot.minX&&(ot.minX=st),ct<ot.minY&&(ot.minY=ct),pt>ot.maxX&&(ot.maxX=pt),ft>ot.maxY&&(ot.maxY=ft)}return ot}function ge(w,tt,et,rt){var it=tt.geometry,nt=tt.type,ot=[];if("Point"===nt||"MultiPoint"===nt)for(var at=0;at<it.length;at+=3)ot.push(it[at]),ot.push(it[at+1]),w.numPoints++,w.numSimplified++;else if("LineString"===nt)me(ot,it,w,et,!1,!1);else if("MultiLineString"===nt||"Polygon"===nt)for(at=0;at<it.length;at++)me(ot,it[at],w,et,"Polygon"===nt,0===at);else if("MultiPolygon"===nt)for(var st=0;st<it.length;st++){var ct=it[st];for(at=0;at<ct.length;at++)me(ot,ct[at],w,et,!0,0===at)}if(ot.length){var pt=tt.tags||null;if("LineString"===nt&&rt.lineMetrics){for(var ft in pt={},tt.tags)pt[ft]=tt.tags[ft];pt.mapbox_clip_start=it.start/it.size,pt.mapbox_clip_end=it.end/it.size}var dt={geometry:ot,type:"Polygon"===nt||"MultiPolygon"===nt?3:"LineString"===nt||"MultiLineString"===nt?2:1,tags:pt};null!==tt.id&&(dt.id=tt.id),w.features.push(dt)}}function me(w,tt,et,rt,it,nt){var ot=rt*rt;if(rt>0&&tt.size<(it?ot:rt))et.numPoints+=tt.length/3;else{for(var at=[],st=0;st<tt.length;st+=3)(0===rt||tt[st+2]>ot)&&(et.numSimplified++,at.push(tt[st]),at.push(tt[st+1])),et.numPoints++;it&&function(w,tt){for(var et=0,rt=0,it=w.length,nt=it-2;rt<it;nt=rt,rt+=2)et+=(w[rt]-w[nt])*(w[rt+1]+w[nt+1]);if(et>0===tt)for(rt=0,it=w.length;rt<it/2;rt+=2){var ot=w[rt],at=w[rt+1];w[rt]=w[it-2-rt],w[rt+1]=w[it-1-rt],w[it-2-rt]=ot,w[it-1-rt]=at}}(at,nt),w.push(at)}}function ve(tt,et){var rt=(et=(this||w).options=function(w,tt){for(var et in tt)w[et]=tt[et];return w}(Object.create((this||w).options),et)).debug;if(rt&&console.time("preprocess data"),et.maxZoom<0||et.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(et.promoteId&&et.generateId)throw new Error("promoteId and generateId cannot be used together.");var it=function(w,tt){var et=[];if("FeatureCollection"===w.type)for(var rt=0;rt<w.features.length;rt++)$(et,w.features[rt],tt,rt);else $(et,"Feature"===w.type?w:{geometry:w},tt);return et}(tt,et);(this||w).tiles={},(this||w).tileCoords=[],rt&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",et.indexMaxZoom,et.indexMaxPoints),console.time("generate tiles"),(this||w).stats={},(this||w).total=0),(it=function(w,tt){var et=tt.buffer/tt.extent,rt=w,it=re(w,1,-1-et,et,0,-1,2,tt),nt=re(w,1,1-et,2+et,0,-1,2,tt);return(it||nt)&&(rt=re(w,1,-et,1+et,0,-1,2,tt)||[],it&&(rt=he(it,1).concat(rt)),nt&&(rt=rt.concat(he(nt,-1)))),rt}(it,et)).length&&this.splitTile(it,0,0,0),rt&&(it.length&&console.log("features: %d, points: %d",(this||w).tiles[0].numFeatures,(this||w).tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",(this||w).total,JSON.stringify((this||w).stats)))}function ye(w,tt,et){return 32*((1<<w)*et+tt)+w}function xe(tt,et){var rt=tt.tileID.canonical;if(!(this||w)._geoJSONIndex)return et(null,null);var it=(this||w)._geoJSONIndex.getTile(rt.z,rt.x,rt.y);if(!it)return et(null,null);var nt=new g(it.features),at=ot(nt);0===at.byteOffset&&at.byteLength===at.buffer.byteLength||(at=new Uint8Array(at)),et(null,{vectorTile:nt,rawData:at.buffer})}J.prototype.load=function(tt){var et=(this||w).options,rt=et.log,it=et.minZoom,nt=et.maxZoom,ot=et.nodeSize;rt&&console.time("total time");var at="prepare "+tt.length+" points";rt&&console.time(at),(this||w).points=tt;for(var st=[],ct=0;ct<tt.length;ct++)tt[ct].geometry&&st.push(A(tt[ct],ct));(this||w).trees[nt+1]=new F(st,X,W,ot,Float32Array),rt&&console.timeEnd(at);for(var pt=nt;pt>=it;pt--){var ft=+Date.now();st=this._cluster(st,pt),(this||w).trees[pt]=new F(st,X,W,ot,Float32Array),rt&&console.log("z%d: %d clusters in %dms",pt,st.length,+Date.now()-ft)}return rt&&console.timeEnd("total time"),this||w},J.prototype.getClusters=function(tt,et){var rt=((tt[0]+180)%360+360)%360-180,it=Math.max(-90,Math.min(90,tt[1])),nt=180===tt[2]?180:((tt[2]+180)%360+360)%360-180,ot=Math.max(-90,Math.min(90,tt[3]));if(tt[2]-tt[0]>=360)rt=-180,nt=180;else if(rt>nt){var at=this.getClusters([rt,it,180,ot],et),st=this.getClusters([-180,it,nt,ot],et);return at.concat(st)}for(var ct=(this||w).trees[this._limitZoom(et)],pt=[],ft=0,dt=ct.range(Y(rt),j(ot),Y(nt),j(it));ft<dt.length;ft+=1){var mt=ct.points[dt[ft]];pt.push(mt.numPoints?B(mt):(this||w).points[mt.index])}return pt},J.prototype.getChildren=function(tt){var et=this._getOriginId(tt),rt=this._getOriginZoom(tt),it="No cluster with the specified id.",nt=(this||w).trees[rt];if(!nt)throw new Error(it);var ot=nt.points[et];if(!ot)throw new Error(it);for(var at=(this||w).options.radius/((this||w).options.extent*Math.pow(2,rt-1)),st=[],ct=0,pt=nt.within(ot.x,ot.y,at);ct<pt.length;ct+=1){var ft=nt.points[pt[ct]];ft.parentId===tt&&st.push(ft.numPoints?B(ft):(this||w).points[ft.index])}if(0===st.length)throw new Error(it);return st},J.prototype.getLeaves=function(w,tt,et){var rt=[];return this._appendLeaves(rt,w,tt=tt||10,et=et||0,0),rt},J.prototype.getTile=function(tt,et,rt){var it=(this||w).trees[this._limitZoom(tt)],nt=Math.pow(2,tt),ot=(this||w).options,at=ot.radius/ot.extent,st=(rt-at)/nt,ct=(rt+1+at)/nt,pt={features:[]};return this._addTileFeatures(it.range((et-at)/nt,st,(et+1+at)/nt,ct),it.points,et,rt,nt,pt),0===et&&this._addTileFeatures(it.range(1-at/nt,st,1,ct),it.points,nt,rt,nt,pt),et===nt-1&&this._addTileFeatures(it.range(0,st,at/nt,ct),it.points,-1,rt,nt,pt),pt.features.length?pt:null},J.prototype.getClusterExpansionZoom=function(tt){for(var et=this._getOriginZoom(tt)-1;et<=(this||w).options.maxZoom;){var rt=this.getChildren(tt);if(et++,1!==rt.length)break;tt=rt[0].properties.cluster_id}return et},J.prototype._appendLeaves=function(w,tt,et,rt,it){for(var nt=0,ot=this.getChildren(tt);nt<ot.length;nt+=1){var at=ot[nt],st=at.properties;if(st&&st.cluster?it+st.point_count<=rt?it+=st.point_count:it=this._appendLeaves(w,st.cluster_id,et,rt,it):it<rt?it++:w.push(at),w.length===et)break}return it},J.prototype._addTileFeatures=function(tt,et,rt,it,nt,ot){for(var at=0,st=tt;at<st.length;at+=1){var ct=et[st[at]],pt=ct.numPoints,ft={type:1,geometry:[[Math.round((this||w).options.extent*(ct.x*nt-rt)),Math.round((this||w).options.extent*(ct.y*nt-it))]],tags:pt?G(ct):(this||w).points[ct.index].properties},dt=void 0;pt?dt=ct.id:(this||w).options.generateId?dt=ct.index:(this||w).points[ct.index].id&&(dt=(this||w).points[ct.index].id),void 0!==dt&&(ft.id=dt),ot.features.push(ft)}},J.prototype._limitZoom=function(tt){return Math.max((this||w).options.minZoom,Math.min(+tt,(this||w).options.maxZoom+1))},J.prototype._cluster=function(tt,et){for(var rt=[],it=(this||w).options,nt=it.reduce,ot=it.minPoints,at=it.radius/(it.extent*Math.pow(2,et)),st=0;st<tt.length;st++){var ct=tt[st];if(!(ct.zoom<=et)){ct.zoom=et;for(var pt=(this||w).trees[et+1],ft=pt.within(ct.x,ct.y,at),dt=ct.numPoints||1,mt=dt,yt=0,vt=ft;yt<vt.length;yt+=1){var Dt=pt.points[vt[yt]];Dt.zoom>et&&(mt+=Dt.numPoints||1)}if(mt>=ot){for(var Rt=ct.x*dt,Bt=ct.y*dt,Ot=nt&&dt>1?this._map(ct,!0):null,Ne=(st<<5)+(et+1)+(this||w).points.length,Ze=0,Ge=ft;Ze<Ge.length;Ze+=1){var Ke=pt.points[Ge[Ze]];if(!(Ke.zoom<=et)){Ke.zoom=et;var er=Ke.numPoints||1;Rt+=Ke.x*er,Bt+=Ke.y*er,Ke.parentId=Ne,nt&&(Ot||(Ot=this._map(ct,!0)),nt(Ot,this._map(Ke)))}}ct.parentId=Ne,rt.push(Z(Rt/mt,Bt/mt,Ne,mt,Ot))}else if(rt.push(ct),mt>1)for(var rr=0,vr=ft;rr<vr.length;rr+=1){var wr=pt.points[vr[rr]];wr.zoom<=et||(wr.zoom=et,rt.push(wr))}}}return rt},J.prototype._getOriginId=function(tt){return tt-(this||w).points.length>>5},J.prototype._getOriginZoom=function(tt){return(tt-(this||w).points.length)%32},J.prototype._map=function(tt,et){if(tt.numPoints)return et?V({},tt.properties):tt.properties;var rt=(this||w).points[tt.index].properties,it=(this||w).options.map(rt);return et&&it===rt?V({},it):it},ve.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ve.prototype.splitTile=function(tt,et,rt,it,nt,ot,at){for(var st=[tt,et,rt,it],ct=(this||w).options,pt=ct.debug;st.length;){it=st.pop(),rt=st.pop(),et=st.pop(),tt=st.pop();var ft=1<<et,dt=ye(et,rt,it),mt=(this||w).tiles[dt];if(!mt&&(pt>1&&console.time("creation"),mt=(this||w).tiles[dt]=de(tt,et,rt,it,ct),(this||w).tileCoords.push({z:et,x:rt,y:it}),pt)){pt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",et,rt,it,mt.numFeatures,mt.numPoints,mt.numSimplified),console.timeEnd("creation"));var yt="z"+et;(this||w).stats[yt]=((this||w).stats[yt]||0)+1,(this||w).total++}if(mt.source=tt,nt){if(et===ct.maxZoom||et===nt)continue;var vt=1<<nt-et;if(rt!==Math.floor(ot/vt)||it!==Math.floor(at/vt))continue}else if(et===ct.indexMaxZoom||mt.numPoints<=ct.indexMaxPoints)continue;if(mt.source=null,0!==tt.length){pt>1&&console.time("clipping");var Dt,Rt,Bt,Ot,Ne,Ze,Ge=.5*ct.buffer/ct.extent,Ke=.5-Ge,er=.5+Ge,rr=1+Ge;Dt=Rt=Bt=Ot=null,Ne=re(tt,ft,rt-Ge,rt+er,0,mt.minX,mt.maxX,ct),Ze=re(tt,ft,rt+Ke,rt+rr,0,mt.minX,mt.maxX,ct),tt=null,Ne&&(Dt=re(Ne,ft,it-Ge,it+er,1,mt.minY,mt.maxY,ct),Rt=re(Ne,ft,it+Ke,it+rr,1,mt.minY,mt.maxY,ct),Ne=null),Ze&&(Bt=re(Ze,ft,it-Ge,it+er,1,mt.minY,mt.maxY,ct),Ot=re(Ze,ft,it+Ke,it+rr,1,mt.minY,mt.maxY,ct),Ze=null),pt>1&&console.timeEnd("clipping"),st.push(Dt||[],et+1,2*rt,2*it),st.push(Rt||[],et+1,2*rt,2*it+1),st.push(Bt||[],et+1,2*rt+1,2*it),st.push(Ot||[],et+1,2*rt+1,2*it+1)}}},ve.prototype.getTile=function(tt,et,rt){var it=(this||w).options,nt=it.extent,ot=it.debug;if(tt<0||tt>24)return null;var at=1<<tt,st=ye(tt,et=(et%at+at)%at,rt);if((this||w).tiles[st])return pe((this||w).tiles[st],nt);ot>1&&console.log("drilling down to z%d-%d-%d",tt,et,rt);for(var ct,pt=tt,ft=et,dt=rt;!ct&&pt>0;)pt--,ft=Math.floor(ft/2),dt=Math.floor(dt/2),ct=(this||w).tiles[ye(pt,ft,dt)];return ct&&ct.source?(ot>1&&console.log("found parent tile z%d-%d-%d",pt,ft,dt),ot>1&&console.time("drilling down"),this.splitTile(ct.source,pt,ft,dt,tt,et,rt),ot>1&&console.timeEnd("drilling down"),(this||w).tiles[st]?pe((this||w).tiles[st],nt):null):null};var ct=function(et){function r(tt,rt,it,nt){et.call(this||w,tt,rt,it,xe),nt&&((this||w).loadGeoJSON=nt)}return et&&(r.__proto__=et),(r.prototype=Object.create(et&&et.prototype)).constructor=r,r.prototype.loadData=function(tt,et){(this||w)._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),(this||w)._pendingCallback=et,(this||w)._pendingLoadDataParams=tt,(this||w)._state&&"Idle"!==(this||w)._state?(this||w)._state="NeedsLoadData":((this||w)._state="Coalescing",this._loadData())},r.prototype._loadData=function(){var et=this||w;if((this||w)._pendingCallback&&(this||w)._pendingLoadDataParams){var rt=(this||w)._pendingCallback,it=(this||w)._pendingLoadDataParams;delete(this||w)._pendingCallback,delete(this||w)._pendingLoadDataParams;var nt=!!(it&&it.request&&it.request.collectResourceTiming)&&new tt.RequestPerformance(it.request);this.loadGeoJSON(it,(function(w,ot){if(w||!ot)return rt(w);if("object"!=typeof ot)return rt(new Error("Input data given to '"+it.source+"' is not a valid GeoJSON object."));!function e(w,tt){var et,rt=w&&w.type;if("FeatureCollection"===rt)for(et=0;et<w.features.length;et++)e(w.features[et],tt);else if("GeometryCollection"===rt)for(et=0;et<w.geometries.length;et++)e(w.geometries[et],tt);else if("Feature"===rt)e(w.geometry,tt);else if("Polygon"===rt)c(w.coordinates,tt);else if("MultiPolygon"===rt)for(et=0;et<w.coordinates.length;et++)c(w.coordinates[et],tt);return w}(ot,!0);try{et._geoJSONIndex=it.cluster?new J(function(w){var et=w.superclusterOptions,rt=w.clusterProperties;if(!rt||!et)return et;for(var it={},nt={},ot={accumulated:null,zoom:0},at={properties:null},st=Object.keys(rt),ct=0,pt=st;ct<pt.length;ct+=1){var ft=pt[ct],dt=rt[ft],mt=dt[0],yt=tt.createExpression(dt[1]),vt=tt.createExpression("string"==typeof mt?[mt,["accumulated"],["get",ft]]:mt);it[ft]=yt.value,nt[ft]=vt.value}return et.map=function(w){at.properties=w;for(var tt={},et=0,rt=st;et<rt.length;et+=1){var nt=rt[et];tt[nt]=it[nt].evaluate(ot,at)}return tt},et.reduce=function(w,tt){at.properties=tt;for(var et=0,rt=st;et<rt.length;et+=1){var it=rt[et];ot.accumulated=w[it],w[it]=nt[it].evaluate(ot,at)}},et}(it)).load(ot.features):function(w,tt){return new ve(w,tt)}(ot,it.geojsonVtOptions)}catch(w){return rt(w)}et.loaded={};var at={};if(nt){var st=nt.finish();st&&(at.resourceTiming={},at.resourceTiming[it.source]=JSON.parse(JSON.stringify(st)))}rt(null,at)}))}},r.prototype.coalesce=function(){"Coalescing"===(this||w)._state?(this||w)._state="Idle":"NeedsLoadData"===(this||w)._state&&((this||w)._state="Coalescing",this._loadData())},r.prototype.reloadTile=function(tt,rt){var it=(this||w).loaded;return it&&it[tt.uid]?et.prototype.reloadTile.call(this||w,tt,rt):this.loadTile(tt,rt)},r.prototype.loadGeoJSON=function(w,et){if(w.request)tt.getJSON(w.request,et);else{if("string"!=typeof w.data)return et(new Error("Input data given to '"+w.source+"' is not a valid GeoJSON object."));try{return et(null,JSON.parse(w.data))}catch(tt){return et(new Error("Input data given to '"+w.source+"' is not a valid GeoJSON object."))}}},r.prototype.removeSource=function(tt,et){(this||w)._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),et()},r.prototype.getClusterExpansionZoom=function(tt,et){try{et(null,(this||w)._geoJSONIndex.getClusterExpansionZoom(tt.clusterId))}catch(tt){et(tt)}},r.prototype.getClusterChildren=function(tt,et){try{et(null,(this||w)._geoJSONIndex.getChildren(tt.clusterId))}catch(tt){et(tt)}},r.prototype.getClusterLeaves=function(tt,et){try{et(null,(this||w)._geoJSONIndex.getLeaves(tt.clusterId,tt.limit,tt.offset))}catch(tt){et(tt)}},r}(l),Se=function(et){var rt=this||w;(this||w).self=et,(this||w).actor=new tt.Actor(et,this||w),(this||w).layerIndexes={},(this||w).availableImages={},(this||w).workerSourceTypes={vector:l,geojson:ct},(this||w).workerSources={},(this||w).demWorkerSources={},(this||w).self.registerWorkerSource=function(w,tt){if(rt.workerSourceTypes[w])throw new Error('Worker source with name "'+w+'" already registered.');rt.workerSourceTypes[w]=tt},(this||w).self.registerRTLTextPlugin=function(w){if(tt.plugin.isParsed())throw new Error("RTL text plugin already registered.");tt.plugin.applyArabicShaping=w.applyArabicShaping,tt.plugin.processBidirectionalText=w.processBidirectionalText,tt.plugin.processStyledBidirectionalText=w.processStyledBidirectionalText}};return Se.prototype.setReferrer=function(tt,et){(this||w).referrer=et},Se.prototype.setImages=function(tt,et,rt){for(var it in(this||w).availableImages[tt]=et,(this||w).workerSources[tt]){var nt=(this||w).workerSources[tt][it];for(var ot in nt)nt[ot].availableImages=et}rt()},Se.prototype.setLayers=function(w,tt,et){this.getLayerIndex(w).replace(tt),et()},Se.prototype.updateLayers=function(w,tt,et){this.getLayerIndex(w).update(tt.layers,tt.removedIds),et()},Se.prototype.loadTile=function(w,tt,et){this.getWorkerSource(w,tt.type,tt.source).loadTile(tt,et)},Se.prototype.loadDEMTile=function(w,tt,et){this.getDEMWorkerSource(w,tt.source).loadTile(tt,et)},Se.prototype.reloadTile=function(w,tt,et){this.getWorkerSource(w,tt.type,tt.source).reloadTile(tt,et)},Se.prototype.abortTile=function(w,tt,et){this.getWorkerSource(w,tt.type,tt.source).abortTile(tt,et)},Se.prototype.removeTile=function(w,tt,et){this.getWorkerSource(w,tt.type,tt.source).removeTile(tt,et)},Se.prototype.removeDEMTile=function(w,tt){this.getDEMWorkerSource(w,tt.source).removeTile(tt)},Se.prototype.removeSource=function(tt,et,rt){if((this||w).workerSources[tt]&&(this||w).workerSources[tt][et.type]&&(this||w).workerSources[tt][et.type][et.source]){var it=(this||w).workerSources[tt][et.type][et.source];delete(this||w).workerSources[tt][et.type][et.source],void 0!==it.removeSource?it.removeSource(et,rt):rt()}},Se.prototype.loadWorkerSource=function(tt,et,rt){try{(this||w).self.importScripts(et.url),rt()}catch(tt){rt(tt.toString())}},Se.prototype.syncRTLPluginState=function(et,rt,it){try{tt.plugin.setState(rt);var nt=tt.plugin.getPluginURL();if(tt.plugin.isLoaded()&&!tt.plugin.isParsed()&&null!=nt){(this||w).self.importScripts(nt);var ot=tt.plugin.isParsed();it(ot?void 0:new Error("RTL Text Plugin failed to import scripts from "+nt),ot)}}catch(w){it(w.toString())}},Se.prototype.getAvailableImages=function(tt){var et=(this||w).availableImages[tt];return et||(et=[]),et},Se.prototype.getLayerIndex=function(tt){var et=(this||w).layerIndexes[tt];return et||(et=(this||w).layerIndexes[tt]=new i),et},Se.prototype.getWorkerSource=function(tt,et,rt){var it=this||w;return(this||w).workerSources[tt]||((this||w).workerSources[tt]={}),(this||w).workerSources[tt][et]||((this||w).workerSources[tt][et]={}),(this||w).workerSources[tt][et][rt]||((this||w).workerSources[tt][et][rt]=new(this||w).workerSourceTypes[et]({send:function(w,et,rt){it.actor.send(w,et,rt,tt)}},this.getLayerIndex(tt),this.getAvailableImages(tt))),(this||w).workerSources[tt][et][rt]},Se.prototype.getDEMWorkerSource=function(tt,et){return(this||w).demWorkerSources[tt]||((this||w).demWorkerSources[tt]={}),(this||w).demWorkerSources[tt][et]||((this||w).demWorkerSources[tt][et]=new h),(this||w).demWorkerSources[tt][et]},Se.prototype.enforceCacheSizeLimit=function(w,et){tt.enforceCacheSizeLimit(et)},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new Se(self)),Se}));define(["./shared"],(function(tt){var et=tt.createCommonjsModule((function(w){function e(w){return!i(w)}function i(w){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var w,tt,et=new Blob([""],{type:"text/javascript"}),rt=URL.createObjectURL(et);try{tt=new Worker(rt),w=!0}catch(tt){w=!1}return tt&&tt.terminate(),URL.revokeObjectURL(rt),w}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var w=document.createElement("canvas");w.width=w.height=1;var tt=w.getContext("2d");if(!tt)return!1;var et=tt.getImageData(0,0,1,1);return et&&et.width===w.width}()?(void 0===tt[et=w&&w.failIfMajorPerformanceCaveat]&&(tt[et]=function(w){var tt=function(w){var tt=document.createElement("canvas"),et=Object.create(e.webGLContextAttributes);return et.failIfMajorPerformanceCaveat=w,tt.probablySupportsContext?tt.probablySupportsContext("webgl",et)||tt.probablySupportsContext("experimental-webgl",et):tt.supportsContext?tt.supportsContext("webgl",et)||tt.supportsContext("experimental-webgl",et):tt.getContext("webgl",et)||tt.getContext("experimental-webgl",et)}(w);if(!tt)return!1;var et=tt.createShader(tt.VERTEX_SHADER);return!(!et||tt.isContextLost())&&(tt.shaderSource(et,"void main() {}"),tt.compileShader(et),!0===tt.getShaderParameter(et,tt.COMPILE_STATUS))}(et)),tt[et]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var et}w.exports?w.exports=e:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=e,window.mapboxgl.notSupportedReason=i);var tt={};e.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}})),rt={create:function(w,et,rt){var it=tt.window.document.createElement(w);return void 0!==et&&(it.className=et),rt&&rt.appendChild(it),it},createNS:function(w,et){return tt.window.document.createElementNS(w,et)}},it=tt.window.document&&tt.window.document.documentElement.style;function r(w){if(!it)return w[0];for(var tt=0;tt<w.length;tt++)if(w[tt]in it)return w[tt];return w[0]}var nt,ot=r(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);rt.disableDrag=function(){it&&ot&&(nt=it[ot],it[ot]="none")},rt.enableDrag=function(){it&&ot&&(it[ot]=nt)};var at=r(["transform","WebkitTransform"]);rt.setTransform=function(w,tt){w.style[at]=tt};var st=!1;try{var ct=Object.defineProperty({},"passive",{get:function(){st=!0}});tt.window.addEventListener("test",ct,ct),tt.window.removeEventListener("test",ct,ct)}catch(tt){st=!1}rt.addEventListener=function(w,tt,et,rt){void 0===rt&&(rt={}),w.addEventListener(tt,et,"passive"in rt&&st?rt:rt.capture)},rt.removeEventListener=function(w,tt,et,rt){void 0===rt&&(rt={}),w.removeEventListener(tt,et,"passive"in rt&&st?rt:rt.capture)};var u=function(w){w.preventDefault(),w.stopPropagation(),tt.window.removeEventListener("click",u,!0)};function h(w){var tt=w.userImage;return!!(tt&&tt.render&&tt.render())&&(w.data.replace(new Uint8Array(tt.data.buffer)),!0)}rt.suppressClick=function(){tt.window.addEventListener("click",u,!0),tt.window.setTimeout((function(){tt.window.removeEventListener("click",u,!0)}),0)},rt.mousePos=function(w,et){var rt=w.getBoundingClientRect();return new tt.Point(et.clientX-rt.left-w.clientLeft,et.clientY-rt.top-w.clientTop)},rt.touchPos=function(w,et){for(var rt=w.getBoundingClientRect(),it=[],nt=0;nt<et.length;nt++)it.push(new tt.Point(et[nt].clientX-rt.left-w.clientLeft,et[nt].clientY-rt.top-w.clientTop));return it},rt.mouseButton=function(w){return void 0!==tt.window.InstallTrigger&&2===w.button&&w.ctrlKey&&tt.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:w.button},rt.remove=function(w){w.parentNode&&w.parentNode.removeChild(w)};var pt=function(et){function i(){et.call(this||w),(this||w).images={},(this||w).updatedImages={},(this||w).callbackDispatchedThisFrame={},(this||w).loaded=!1,(this||w).requestors=[],(this||w).patterns={},(this||w).atlasImage=new tt.RGBAImage({width:1,height:1}),(this||w).dirty=!0}return et&&(i.__proto__=et),(i.prototype=Object.create(et&&et.prototype)).constructor=i,i.prototype.isLoaded=function(){return(this||w).loaded},i.prototype.setLoaded=function(tt){if((this||w).loaded!==tt&&((this||w).loaded=tt,tt)){for(var et=0,rt=(this||w).requestors;et<rt.length;et+=1){var it=rt[et];this._notify(it.ids,it.callback)}(this||w).requestors=[]}},i.prototype.getImage=function(tt){return(this||w).images[tt]},i.prototype.addImage=function(tt,et){this._validate(tt,et)&&((this||w).images[tt]=et)},i.prototype._validate=function(w,et){var rt=!0;return this._validateStretch(et.stretchX,et.data&&et.data.width)||(this.fire(new tt.ErrorEvent(new Error('Image "'+w+'" has invalid "stretchX" value'))),rt=!1),this._validateStretch(et.stretchY,et.data&&et.data.height)||(this.fire(new tt.ErrorEvent(new Error('Image "'+w+'" has invalid "stretchY" value'))),rt=!1),this._validateContent(et.content,et)||(this.fire(new tt.ErrorEvent(new Error('Image "'+w+'" has invalid "content" value'))),rt=!1),rt},i.prototype._validateStretch=function(w,tt){if(!w)return!0;for(var et=0,rt=0,it=w;rt<it.length;rt+=1){var nt=it[rt];if(nt[0]<et||nt[1]<nt[0]||tt<nt[1])return!1;et=nt[1]}return!0},i.prototype._validateContent=function(w,tt){return!(w&&(4!==w.length||w[0]<0||tt.data.width<w[0]||w[1]<0||tt.data.height<w[1]||w[2]<0||tt.data.width<w[2]||w[3]<0||tt.data.height<w[3]||w[2]<w[0]||w[3]<w[1]))},i.prototype.updateImage=function(tt,et){et.version=(this||w).images[tt].version+1,(this||w).images[tt]=et,(this||w).updatedImages[tt]=!0},i.prototype.removeImage=function(tt){var et=(this||w).images[tt];delete(this||w).images[tt],delete(this||w).patterns[tt],et.userImage&&et.userImage.onRemove&&et.userImage.onRemove()},i.prototype.listImages=function(){return Object.keys((this||w).images)},i.prototype.getImages=function(tt,et){var rt=!0;if(!this.isLoaded())for(var it=0,nt=tt;it<nt.length;it+=1)(this||w).images[nt[it]]||(rt=!1);this.isLoaded()||rt?this._notify(tt,et):(this||w).requestors.push({ids:tt,callback:et})},i.prototype._notify=function(et,rt){for(var it={},nt=0,ot=et;nt<ot.length;nt+=1){var at=ot[nt];(this||w).images[at]||this.fire(new tt.Event("styleimagemissing",{id:at}));var st=(this||w).images[at];st?it[at]={data:st.data.clone(),pixelRatio:st.pixelRatio,sdf:st.sdf,version:st.version,stretchX:st.stretchX,stretchY:st.stretchY,content:st.content,hasRenderCallback:Boolean(st.userImage&&st.userImage.render)}:tt.warnOnce('Image "'+at+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}rt(null,it)},i.prototype.getPixelSize=function(){var tt=(this||w).atlasImage;return{width:tt.width,height:tt.height}},i.prototype.getPattern=function(et){var rt=(this||w).patterns[et],it=this.getImage(et);if(!it)return null;if(rt&&rt.position.version===it.version)return rt.position;if(rt)rt.position.version=it.version;else{var nt={w:it.data.width+2,h:it.data.height+2,x:0,y:0},ot=new tt.ImagePosition(nt,it);(this||w).patterns[et]={bin:nt,position:ot}}return this._updatePatternAtlas(),(this||w).patterns[et].position},i.prototype.bind=function(et){var rt=et.gl;(this||w).atlasTexture?(this||w).dirty&&((this||w).atlasTexture.update((this||w).atlasImage),(this||w).dirty=!1):(this||w).atlasTexture=new tt.Texture(et,(this||w).atlasImage,rt.RGBA),(this||w).atlasTexture.bind(rt.LINEAR,rt.CLAMP_TO_EDGE)},i.prototype._updatePatternAtlas=function(){var et=[];for(var rt in(this||w).patterns)et.push((this||w).patterns[rt].bin);var it=tt.potpack(et),nt=it.w,ot=it.h,at=(this||w).atlasImage;for(var st in at.resize({width:nt||1,height:ot||1}),(this||w).patterns){var ct=(this||w).patterns[st].bin,pt=ct.x+1,ft=ct.y+1,dt=(this||w).images[st].data,mt=dt.width,yt=dt.height;tt.RGBAImage.copy(dt,at,{x:0,y:0},{x:pt,y:ft},{width:mt,height:yt}),tt.RGBAImage.copy(dt,at,{x:0,y:yt-1},{x:pt,y:ft-1},{width:mt,height:1}),tt.RGBAImage.copy(dt,at,{x:0,y:0},{x:pt,y:ft+yt},{width:mt,height:1}),tt.RGBAImage.copy(dt,at,{x:mt-1,y:0},{x:pt-1,y:ft},{width:1,height:yt}),tt.RGBAImage.copy(dt,at,{x:0,y:0},{x:pt+mt,y:ft},{width:1,height:yt})}(this||w).dirty=!0},i.prototype.beginFrame=function(){(this||w).callbackDispatchedThisFrame={}},i.prototype.dispatchRenderCallbacks=function(tt){for(var et=0,rt=tt;et<rt.length;et+=1){var it=rt[et];if(!(this||w).callbackDispatchedThisFrame[it]){(this||w).callbackDispatchedThisFrame[it]=!0;var nt=(this||w).images[it];h(nt)&&this.updateImage(it,nt)}}},i}(tt.Evented),ft=m,dt=m,mt=1e20;function m(tt,et,rt,it,nt,ot){(this||w).fontSize=tt||24,(this||w).buffer=void 0===et?3:et,(this||w).cutoff=it||.25,(this||w).fontFamily=nt||"sans-serif",(this||w).fontWeight=ot||"normal",(this||w).radius=rt||8;var at=(this||w).size=(this||w).fontSize+2*(this||w).buffer;(this||w).canvas=document.createElement("canvas"),(this||w).canvas.width=(this||w).canvas.height=at,(this||w).ctx=(this||w).canvas.getContext("2d"),(this||w).ctx.font=(this||w).fontWeight+" "+(this||w).fontSize+"px "+(this||w).fontFamily,(this||w).ctx.textBaseline="middle",(this||w).ctx.fillStyle="black",(this||w).gridOuter=new Float64Array(at*at),(this||w).gridInner=new Float64Array(at*at),(this||w).f=new Float64Array(at),(this||w).d=new Float64Array(at),(this||w).z=new Float64Array(at+1),(this||w).v=new Int16Array(at),(this||w).middle=Math.round(at/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function g(w,tt,et,rt,it,nt,ot){for(var at=0;at<tt;at++){for(var st=0;st<et;st++)rt[st]=w[st*tt+at];for(v(rt,it,nt,ot,et),st=0;st<et;st++)w[st*tt+at]=it[st]}for(st=0;st<et;st++){for(at=0;at<tt;at++)rt[at]=w[st*tt+at];for(v(rt,it,nt,ot,tt),at=0;at<tt;at++)w[st*tt+at]=Math.sqrt(it[at])}}function v(w,tt,et,rt,it){et[0]=0,rt[0]=-mt,rt[1]=+mt;for(var nt=1,ot=0;nt<it;nt++){for(var at=(w[nt]+nt*nt-(w[et[ot]]+et[ot]*et[ot]))/(2*nt-2*et[ot]);at<=rt[ot];)ot--,at=(w[nt]+nt*nt-(w[et[ot]]+et[ot]*et[ot]))/(2*nt-2*et[ot]);et[++ot]=nt,rt[ot]=at,rt[ot+1]=+mt}for(nt=0,ot=0;nt<it;nt++){for(;rt[ot+1]<nt;)ot++;tt[nt]=(nt-et[ot])*(nt-et[ot])+w[et[ot]]}}m.prototype.draw=function(tt){(this||w).ctx.clearRect(0,0,(this||w).size,(this||w).size),(this||w).ctx.fillText(tt,(this||w).buffer,(this||w).middle);for(var et=(this||w).ctx.getImageData(0,0,(this||w).size,(this||w).size),rt=new Uint8ClampedArray((this||w).size*(this||w).size),it=0;it<(this||w).size*(this||w).size;it++){var nt=et.data[4*it+3]/255;(this||w).gridOuter[it]=1===nt?0:0===nt?mt:Math.pow(Math.max(0,.5-nt),2),(this||w).gridInner[it]=1===nt?mt:0===nt?0:Math.pow(Math.max(0,nt-.5),2)}for(g((this||w).gridOuter,(this||w).size,(this||w).size,(this||w).f,(this||w).d,(this||w).v,(this||w).z),g((this||w).gridInner,(this||w).size,(this||w).size,(this||w).f,(this||w).d,(this||w).v,(this||w).z),it=0;it<(this||w).size*(this||w).size;it++)rt[it]=Math.max(0,Math.min(255,Math.round(255-255*(((this||w).gridOuter[it]-(this||w).gridInner[it])/(this||w).radius+(this||w).cutoff))));return rt},ft.default=dt;var y=function(tt,et){(this||w).requestManager=tt,(this||w).localIdeographFontFamily=et,(this||w).entries={}};y.prototype.setURL=function(tt){(this||w).url=tt},y.prototype.getGlyphs=function(et,rt){var it=this||w,nt=[];for(var ot in et)for(var at=0,st=et[ot];at<st.length;at+=1)nt.push({stack:ot,id:st[at]});tt.asyncAll(nt,(function(w,tt){var et=w.stack,rt=w.id,nt=it.entries[et];nt||(nt=it.entries[et]={glyphs:{},requests:{},ranges:{}});var ot=nt.glyphs[rt];if(void 0===ot){if(ot=it._tinySDF(nt,et,rt))return nt.glyphs[rt]=ot,void tt(null,{stack:et,id:rt,glyph:ot});var at=Math.floor(rt/256);if(256*at>65535)tt(new Error("glyphs > 65535 not supported"));else if(nt.ranges[at])tt(null,{stack:et,id:rt,glyph:ot});else{var st=nt.requests[at];st||(st=nt.requests[at]=[],y.loadGlyphRange(et,at,it.url,it.requestManager,(function(w,tt){if(tt){for(var et in tt)it._doesCharSupportLocalGlyph(+et)||(nt.glyphs[+et]=tt[+et]);nt.ranges[at]=!0}for(var rt=0,ot=st;rt<ot.length;rt+=1)(0,ot[rt])(w,tt);delete nt.requests[at]}))),st.push((function(w,it){w?tt(w):it&&tt(null,{stack:et,id:rt,glyph:it[rt]||null})}))}}else tt(null,{stack:et,id:rt,glyph:ot})}),(function(w,tt){if(w)rt(w);else if(tt){for(var et={},it=0,nt=tt;it<nt.length;it+=1){var ot=nt[it],at=ot.stack,st=ot.id,ct=ot.glyph;(et[at]||(et[at]={}))[st]=ct&&{id:ct.id,bitmap:ct.bitmap.clone(),metrics:ct.metrics}}rt(null,et)}}))},y.prototype._doesCharSupportLocalGlyph=function(et){return!!(this||w).localIdeographFontFamily&&(tt.isChar["CJK Unified Ideographs"](et)||tt.isChar["Hangul Syllables"](et)||tt.isChar.Hiragana(et)||tt.isChar.Katakana(et))},y.prototype._tinySDF=function(et,rt,it){var nt=(this||w).localIdeographFontFamily;if(nt&&this._doesCharSupportLocalGlyph(it)){var ot=et.tinySDF;if(!ot){var at="400";/bold/i.test(rt)?at="900":/medium/i.test(rt)?at="500":/light/i.test(rt)&&(at="200"),ot=et.tinySDF=new y.TinySDF(24,3,8,.25,nt,at)}return{id:it,bitmap:new tt.AlphaImage({width:30,height:30},ot.draw(String.fromCharCode(it))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},y.loadGlyphRange=function(w,et,rt,it,nt){var ot=256*et,at=ot+255,st=it.transformRequest(it.normalizeGlyphsURL(rt).replace("{fontstack}",w).replace("{range}",ot+"-"+at),tt.ResourceType.Glyphs);tt.getArrayBuffer(st,(function(w,et){if(w)nt(w);else if(et){for(var rt={},it=0,ot=tt.parseGlyphPBF(et);it<ot.length;it+=1){var at=ot[it];rt[at.id]=at}nt(null,rt)}}))},y.TinySDF=ft;var x=function(){(this||w).specification=tt.styleSpec.light.position};x.prototype.possiblyEvaluate=function(w,et){return tt.sphericalToCartesian(w.expression.evaluate(et))},x.prototype.interpolate=function(w,et,rt){return{x:tt.number(w.x,et.x,rt),y:tt.number(w.y,et.y,rt),z:tt.number(w.z,et.z,rt)}};var yt=new tt.Properties({anchor:new tt.DataConstantProperty(tt.styleSpec.light.anchor),position:new x,color:new tt.DataConstantProperty(tt.styleSpec.light.color),intensity:new tt.DataConstantProperty(tt.styleSpec.light.intensity)}),vt=function(et){function i(rt){et.call(this||w),(this||w)._transitionable=new tt.Transitionable(yt),this.setLight(rt),(this||w)._transitioning=(this||w)._transitionable.untransitioned()}return et&&(i.__proto__=et),(i.prototype=Object.create(et&&et.prototype)).constructor=i,i.prototype.getLight=function(){return(this||w)._transitionable.serialize()},i.prototype.setLight=function(et,rt){if(void 0===rt&&(rt={}),!this._validate(tt.validateLight,et,rt))for(var it in et){var nt=et[it];tt.endsWith(it,"-transition")?(this||w)._transitionable.setTransition(it.slice(0,-"-transition".length),nt):(this||w)._transitionable.setValue(it,nt)}},i.prototype.updateTransitions=function(tt){(this||w)._transitioning=(this||w)._transitionable.transitioned(tt,(this||w)._transitioning)},i.prototype.hasTransition=function(){return(this||w)._transitioning.hasTransition()},i.prototype.recalculate=function(tt){(this||w).properties=(this||w)._transitioning.possiblyEvaluate(tt)},i.prototype._validate=function(et,rt,it){return(!it||!1!==it.validate)&&tt.emitValidationErrors(this||w,et.call(tt.validateStyle,tt.extend({value:rt,style:{glyphs:!0,sprite:!0},styleSpec:tt.styleSpec})))},i}(tt.Evented),T=function(tt,et){(this||w).width=tt,(this||w).height=et,(this||w).nextRow=0,(this||w).data=new Uint8Array((this||w).width*(this||w).height),(this||w).dashEntry={}};T.prototype.getDash=function(tt,et){var rt=tt.join(",")+String(et);return(this||w).dashEntry[rt]||((this||w).dashEntry[rt]=this.addDash(tt,et)),(this||w).dashEntry[rt]},T.prototype.getDashRanges=function(w,tt,et){var rt=[],it=w.length%2==1?-w[w.length-1]*et:0,nt=w[0]*et,ot=!0;rt.push({left:it,right:nt,isDash:ot,zeroLength:0===w[0]});for(var at=w[0],st=1;st<w.length;st++){var ct=w[st];rt.push({left:it=at*et,right:nt=(at+=ct)*et,isDash:ot=!ot,zeroLength:0===ct})}return rt},T.prototype.addRoundDash=function(tt,et,rt){for(var it=et/2,nt=-rt;nt<=rt;nt++)for(var ot=(this||w).width*((this||w).nextRow+rt+nt),at=0,st=tt[at],ct=0;ct<(this||w).width;ct++){ct/st.right>1&&(st=tt[++at]);var pt=Math.abs(ct-st.left),ft=Math.abs(ct-st.right),dt=Math.min(pt,ft),mt=void 0,yt=nt/rt*(it+1);if(st.isDash){var vt=it-Math.abs(yt);mt=Math.sqrt(dt*dt+vt*vt)}else mt=it-Math.sqrt(dt*dt+yt*yt);(this||w).data[ot+ct]=Math.max(0,Math.min(255,mt+128))}},T.prototype.addRegularDash=function(tt){for(var et=tt.length-1;et>=0;--et){var rt=tt[et],it=tt[et+1];rt.zeroLength?tt.splice(et,1):it&&it.isDash===rt.isDash&&(it.left=rt.left,tt.splice(et,1))}var nt=tt[0],ot=tt[tt.length-1];nt.isDash===ot.isDash&&(nt.left=ot.left-(this||w).width,ot.right=nt.right+(this||w).width);for(var at=(this||w).width*(this||w).nextRow,st=0,ct=tt[st],pt=0;pt<(this||w).width;pt++){pt/ct.right>1&&(ct=tt[++st]);var ft=Math.abs(pt-ct.left),dt=Math.abs(pt-ct.right),mt=Math.min(ft,dt);(this||w).data[at+pt]=Math.max(0,Math.min(255,(ct.isDash?mt:-mt)+128))}},T.prototype.addDash=function(et,rt){var it=rt?7:0,nt=2*it+1;if((this||w).nextRow+nt>(this||w).height)return tt.warnOnce("LineAtlas out of space"),null;for(var ot=0,at=0;at<et.length;at++)ot+=et[at];if(0!==ot){var st=(this||w).width/ot,ct=this.getDashRanges(et,(this||w).width,st);rt?this.addRoundDash(ct,st,it):this.addRegularDash(ct)}var pt={y:((this||w).nextRow+it+.5)/(this||w).height,height:2*it/(this||w).height,width:ot};return(this||w).nextRow+=nt,(this||w).dirty=!0,pt},T.prototype.bind=function(tt){var et=tt.gl;(this||w).texture?(et.bindTexture(et.TEXTURE_2D,(this||w).texture),(this||w).dirty&&((this||w).dirty=!1,et.texSubImage2D(et.TEXTURE_2D,0,0,0,(this||w).width,(this||w).height,et.ALPHA,et.UNSIGNED_BYTE,(this||w).data))):((this||w).texture=et.createTexture(),et.bindTexture(et.TEXTURE_2D,(this||w).texture),et.texParameteri(et.TEXTURE_2D,et.TEXTURE_WRAP_S,et.REPEAT),et.texParameteri(et.TEXTURE_2D,et.TEXTURE_WRAP_T,et.REPEAT),et.texParameteri(et.TEXTURE_2D,et.TEXTURE_MIN_FILTER,et.LINEAR),et.texParameteri(et.TEXTURE_2D,et.TEXTURE_MAG_FILTER,et.LINEAR),et.texImage2D(et.TEXTURE_2D,0,et.ALPHA,(this||w).width,(this||w).height,0,et.ALPHA,et.UNSIGNED_BYTE,(this||w).data))};var Dt=function e(et,rt){(this||w).workerPool=et,(this||w).actors=[],(this||w).currentActor=0,(this||w).id=tt.uniqueId();for(var it=(this||w).workerPool.acquire((this||w).id),nt=0;nt<it.length;nt++){var ot=new e.Actor(it[nt],rt,(this||w).id);ot.name="Worker "+nt,(this||w).actors.push(ot)}};function I(w,et,rt){var r=function(it,nt){if(it)return rt(it);if(nt){var ot=tt.pick(tt.extend(nt,w),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);nt.vector_layers&&(ot.vectorLayers=nt.vector_layers,ot.vectorLayerIds=ot.vectorLayers.map((function(w){return w.id}))),ot.tiles=et.canonicalizeTileset(ot,w.url),rt(null,ot)}};return w.url?tt.getJSON(et.transformRequest(et.normalizeSourceURL(w.url),tt.ResourceType.Source),r):tt.browser.frame((function(){return r(null,w)}))}Dt.prototype.broadcast=function(et,rt,it){tt.asyncAll((this||w).actors,(function(w,tt){w.send(et,rt,tt)}),it=it||function(){})},Dt.prototype.getActor=function(){return(this||w).currentActor=((this||w).currentActor+1)%(this||w).actors.length,(this||w).actors[(this||w).currentActor]},Dt.prototype.remove=function(){(this||w).actors.forEach((function(w){w.remove()})),(this||w).actors=[],(this||w).workerPool.release((this||w).id)},Dt.Actor=tt.Actor;var P=function(et,rt,it){(this||w).bounds=tt.LngLatBounds.convert(this.validateBounds(et)),(this||w).minzoom=rt||0,(this||w).maxzoom=it||24};P.prototype.validateBounds=function(w){return Array.isArray(w)&&4===w.length?[Math.max(-180,w[0]),Math.max(-90,w[1]),Math.min(180,w[2]),Math.min(90,w[3])]:[-180,-90,180,90]},P.prototype.contains=function(et){var rt=Math.pow(2,et.z),it=Math.floor(tt.mercatorXfromLng((this||w).bounds.getWest())*rt),nt=Math.floor(tt.mercatorYfromLat((this||w).bounds.getNorth())*rt),ot=Math.ceil(tt.mercatorXfromLng((this||w).bounds.getEast())*rt),at=Math.ceil(tt.mercatorYfromLat((this||w).bounds.getSouth())*rt);return et.x>=it&&et.x<ot&&et.y>=nt&&et.y<at};var Rt=function(et){function i(rt,it,nt,ot){if(et.call(this||w),(this||w).id=rt,(this||w).dispatcher=nt,(this||w).type="vector",(this||w).minzoom=0,(this||w).maxzoom=22,(this||w).scheme="xyz",(this||w).tileSize=512,(this||w).reparseOverscaled=!0,(this||w).isTileClipped=!0,(this||w)._loaded=!1,tt.extend(this||w,tt.pick(it,["url","scheme","tileSize","promoteId"])),(this||w)._options=tt.extend({type:"vector"},it),(this||w)._collectResourceTiming=it.collectResourceTiming,512!==(this||w).tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(ot)}return et&&(i.__proto__=et),(i.prototype=Object.create(et&&et.prototype)).constructor=i,i.prototype.load=function(){var et=this||w;(this||w)._loaded=!1,this.fire(new tt.Event("dataloading",{dataType:"source"})),(this||w)._tileJSONRequest=I((this||w)._options,(this||w).map._requestManager,(function(w,rt){et._tileJSONRequest=null,et._loaded=!0,w?et.fire(new tt.ErrorEvent(w)):rt&&(tt.extend(et,rt),rt.bounds&&(et.tileBounds=new P(rt.bounds,et.minzoom,et.maxzoom)),tt.postTurnstileEvent(rt.tiles,et.map._requestManager._customAccessToken),tt.postMapLoadEvent(rt.tiles,et.map._getMapId(),et.map._requestManager._skuToken,et.map._requestManager._customAccessToken),et.fire(new tt.Event("data",{dataType:"source",sourceDataType:"metadata"})),et.fire(new tt.Event("data",{dataType:"source",sourceDataType:"content"})))}))},i.prototype.loaded=function(){return(this||w)._loaded},i.prototype.hasTile=function(tt){return!(this||w).tileBounds||(this||w).tileBounds.contains(tt.canonical)},i.prototype.onAdd=function(tt){(this||w).map=tt,this.load()},i.prototype.onRemove=function(){(this||w)._tileJSONRequest&&((this||w)._tileJSONRequest.cancel(),(this||w)._tileJSONRequest=null)},i.prototype.serialize=function(){return tt.extend({},(this||w)._options)},i.prototype.loadTile=function(et,rt){var it=(this||w).map._requestManager.normalizeTileURL(et.tileID.canonical.url((this||w).tiles,(this||w).scheme)),nt={request:(this||w).map._requestManager.transformRequest(it,tt.ResourceType.Tile),uid:et.uid,tileID:et.tileID,zoom:et.tileID.overscaledZ,tileSize:(this||w).tileSize*et.tileID.overscaleFactor(),type:(this||w).type,source:(this||w).id,pixelRatio:tt.browser.devicePixelRatio,showCollisionBoxes:(this||w).map.showCollisionBoxes,promoteId:(this||w).promoteId};function a(it,nt){return delete et.request,et.aborted?rt(null):it&&404!==it.status?rt(it):(nt&&nt.resourceTiming&&(et.resourceTiming=nt.resourceTiming),(this||w).map._refreshExpiredTiles&&nt&&et.setExpiryData(nt),et.loadVectorData(nt,(this||w).map.painter),tt.cacheEntryPossiblyAdded((this||w).dispatcher),rt(null),void(et.reloadCallback&&(this.loadTile(et,et.reloadCallback),et.reloadCallback=null)))}nt.request.collectResourceTiming=(this||w)._collectResourceTiming,et.actor&&"expired"!==et.state?"loading"===et.state?et.reloadCallback=rt:et.request=et.actor.send("reloadTile",nt,a.bind(this||w)):(et.actor=(this||w).dispatcher.getActor(),et.request=et.actor.send("loadTile",nt,a.bind(this||w)))},i.prototype.abortTile=function(tt){tt.request&&(tt.request.cancel(),delete tt.request),tt.actor&&tt.actor.send("abortTile",{uid:tt.uid,type:(this||w).type,source:(this||w).id},void 0)},i.prototype.unloadTile=function(tt){tt.unloadVectorData(),tt.actor&&tt.actor.send("removeTile",{uid:tt.uid,type:(this||w).type,source:(this||w).id},void 0)},i.prototype.hasTransition=function(){return!1},i}(tt.Evented),Bt=function(et){function i(rt,it,nt,ot){et.call(this||w),(this||w).id=rt,(this||w).dispatcher=nt,this.setEventedParent(ot),(this||w).type="raster",(this||w).minzoom=0,(this||w).maxzoom=22,(this||w).roundZoom=!0,(this||w).scheme="xyz",(this||w).tileSize=512,(this||w)._loaded=!1,(this||w)._options=tt.extend({type:"raster"},it),tt.extend(this||w,tt.pick(it,["url","scheme","tileSize"]))}return et&&(i.__proto__=et),(i.prototype=Object.create(et&&et.prototype)).constructor=i,i.prototype.load=function(){var et=this||w;(this||w)._loaded=!1,this.fire(new tt.Event("dataloading",{dataType:"source"})),(this||w)._tileJSONRequest=I((this||w)._options,(this||w).map._requestManager,(function(w,rt){et._tileJSONRequest=null,et._loaded=!0,w?et.fire(new tt.ErrorEvent(w)):rt&&(tt.extend(et,rt),rt.bounds&&(et.tileBounds=new P(rt.bounds,et.minzoom,et.maxzoom)),tt.postTurnstileEvent(rt.tiles),tt.postMapLoadEvent(rt.tiles,et.map._getMapId(),et.map._requestManager._skuToken),et.fire(new tt.Event("data",{dataType:"source",sourceDataType:"metadata"})),et.fire(new tt.Event("data",{dataType:"source",sourceDataType:"content"})))}))},i.prototype.loaded=function(){return(this||w)._loaded},i.prototype.onAdd=function(tt){(this||w).map=tt,this.load()},i.prototype.onRemove=function(){(this||w)._tileJSONRequest&&((this||w)._tileJSONRequest.cancel(),(this||w)._tileJSONRequest=null)},i.prototype.serialize=function(){return tt.extend({},(this||w)._options)},i.prototype.hasTile=function(tt){return!(this||w).tileBounds||(this||w).tileBounds.contains(tt.canonical)},i.prototype.loadTile=function(et,rt){var it=this||w,nt=(this||w).map._requestManager.normalizeTileURL(et.tileID.canonical.url((this||w).tiles,(this||w).scheme),(this||w).tileSize);et.request=tt.getImage((this||w).map._requestManager.transformRequest(nt,tt.ResourceType.Tile),(function(w,nt){if(delete et.request,et.aborted)et.state="unloaded",rt(null);else if(w)et.state="errored",rt(w);else if(nt){it.map._refreshExpiredTiles&&et.setExpiryData(nt),delete nt.cacheControl,delete nt.expires;var ot=it.map.painter.context,at=ot.gl;et.texture=it.map.painter.getTileTexture(nt.width),et.texture?et.texture.update(nt,{useMipmap:!0}):(et.texture=new tt.Texture(ot,nt,at.RGBA,{useMipmap:!0}),et.texture.bind(at.LINEAR,at.CLAMP_TO_EDGE,at.LINEAR_MIPMAP_NEAREST),ot.extTextureFilterAnisotropic&&at.texParameterf(at.TEXTURE_2D,ot.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ot.extTextureFilterAnisotropicMax)),et.state="loaded",tt.cacheEntryPossiblyAdded(it.dispatcher),rt(null)}}))},i.prototype.abortTile=function(w,tt){w.request&&(w.request.cancel(),delete w.request),tt()},i.prototype.unloadTile=function(tt,et){tt.texture&&(this||w).map.painter.saveTileTexture(tt.texture),et()},i.prototype.hasTransition=function(){return!1},i}(tt.Evented),Ot=function(et){function i(rt,it,nt,ot){et.call(this||w,rt,it,nt,ot),(this||w).type="raster-dem",(this||w).maxzoom=22,(this||w)._options=tt.extend({type:"raster-dem"},it),(this||w).encoding=it.encoding||"mapbox"}return et&&(i.__proto__=et),(i.prototype=Object.create(et&&et.prototype)).constructor=i,i.prototype.serialize=function(){return{type:"raster-dem",url:(this||w).url,tileSize:(this||w).tileSize,tiles:(this||w).tiles,bounds:(this||w).bounds,encoding:(this||w).encoding}},i.prototype.loadTile=function(et,rt){var it=(this||w).map._requestManager.normalizeTileURL(et.tileID.canonical.url((this||w).tiles,(this||w).scheme),(this||w).tileSize);function r(w,tt){w&&(et.state="errored",rt(w)),tt&&(et.dem=tt,et.needsHillshadePrepare=!0,et.state="loaded",rt(null))}et.request=tt.getImage((this||w).map._requestManager.transformRequest(it,tt.ResourceType.Tile),function(it,nt){if(delete et.request,et.aborted)et.state="unloaded",rt(null);else if(it)et.state="errored",rt(it);else if(nt){(this||w).map._refreshExpiredTiles&&et.setExpiryData(nt),delete nt.cacheControl,delete nt.expires;var ot=tt.window.ImageBitmap&&nt instanceof tt.window.ImageBitmap&&tt.offscreenCanvasSupported()?nt:tt.browser.getImageData(nt,1),at={uid:et.uid,coord:et.tileID,source:(this||w).id,rawImageData:ot,encoding:(this||w).encoding};et.actor&&"expired"!==et.state||(et.actor=(this||w).dispatcher.getActor(),et.actor.send("loadDEMTile",at,r.bind(this||w)))}}.bind(this||w)),et.neighboringTiles=this._getNeighboringTiles(et.tileID)},i.prototype._getNeighboringTiles=function(w){var et=w.canonical,rt=Math.pow(2,et.z),it=(et.x-1+rt)%rt,nt=0===et.x?w.wrap-1:w.wrap,ot=(et.x+1+rt)%rt,at=et.x+1===rt?w.wrap+1:w.wrap,st={};return st[new tt.OverscaledTileID(w.overscaledZ,nt,et.z,it,et.y).key]={backfilled:!1},st[new tt.OverscaledTileID(w.overscaledZ,at,et.z,ot,et.y).key]={backfilled:!1},et.y>0&&(st[new tt.OverscaledTileID(w.overscaledZ,nt,et.z,it,et.y-1).key]={backfilled:!1},st[new tt.OverscaledTileID(w.overscaledZ,w.wrap,et.z,et.x,et.y-1).key]={backfilled:!1},st[new tt.OverscaledTileID(w.overscaledZ,at,et.z,ot,et.y-1).key]={backfilled:!1}),et.y+1<rt&&(st[new tt.OverscaledTileID(w.overscaledZ,nt,et.z,it,et.y+1).key]={backfilled:!1},st[new tt.OverscaledTileID(w.overscaledZ,w.wrap,et.z,et.x,et.y+1).key]={backfilled:!1},st[new tt.OverscaledTileID(w.overscaledZ,at,et.z,ot,et.y+1).key]={backfilled:!1}),st},i.prototype.unloadTile=function(tt){tt.demTexture&&(this||w).map.painter.saveTileTexture(tt.demTexture),tt.fbo&&(tt.fbo.destroy(),delete tt.fbo),tt.dem&&delete tt.dem,delete tt.neighboringTiles,tt.state="unloaded",tt.actor&&tt.actor.send("removeDEMTile",{uid:tt.uid,source:(this||w).id})},i}(Bt),Ne=function(et){function i(rt,it,nt,ot){et.call(this||w),(this||w).id=rt,(this||w).type="geojson",(this||w).minzoom=0,(this||w).maxzoom=18,(this||w).tileSize=512,(this||w).isTileClipped=!0,(this||w).reparseOverscaled=!0,(this||w)._removed=!1,(this||w)._loaded=!1,(this||w).actor=nt.getActor(),this.setEventedParent(ot),(this||w)._data=it.data,(this||w)._options=tt.extend({},it),(this||w)._collectResourceTiming=it.collectResourceTiming,(this||w)._resourceTiming=[],void 0!==it.maxzoom&&((this||w).maxzoom=it.maxzoom),it.type&&((this||w).type=it.type),it.attribution&&((this||w).attribution=it.attribution),(this||w).promoteId=it.promoteId;var at=tt.EXTENT/(this||w).tileSize;(this||w).workerOptions=tt.extend({source:(this||w).id,cluster:it.cluster||!1,geojsonVtOptions:{buffer:(void 0!==it.buffer?it.buffer:128)*at,tolerance:(void 0!==it.tolerance?it.tolerance:.375)*at,extent:tt.EXTENT,maxZoom:(this||w).maxzoom,lineMetrics:it.lineMetrics||!1,generateId:it.generateId||!1},superclusterOptions:{maxZoom:void 0!==it.clusterMaxZoom?Math.min(it.clusterMaxZoom,(this||w).maxzoom-1):(this||w).maxzoom-1,minPoints:Math.max(2,it.clusterMinPoints||2),extent:tt.EXTENT,radius:(it.clusterRadius||50)*at,log:!1,generateId:it.generateId||!1},clusterProperties:it.clusterProperties},it.workerOptions)}return et&&(i.__proto__=et),(i.prototype=Object.create(et&&et.prototype)).constructor=i,i.prototype.load=function(){var et=this||w;this.fire(new tt.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(w){if(w)et.fire(new tt.ErrorEvent(w));else{var rt={dataType:"source",sourceDataType:"metadata"};et._collectResourceTiming&&et._resourceTiming&&et._resourceTiming.length>0&&(rt.resourceTiming=et._resourceTiming,et._resourceTiming=[]),et.fire(new tt.Event("data",rt))}}))},i.prototype.onAdd=function(tt){(this||w).map=tt,this.load()},i.prototype.setData=function(et){var rt=this||w;return(this||w)._data=et,this.fire(new tt.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(w){if(w)rt.fire(new tt.ErrorEvent(w));else{var et={dataType:"source",sourceDataType:"content"};rt._collectResourceTiming&&rt._resourceTiming&&rt._resourceTiming.length>0&&(et.resourceTiming=rt._resourceTiming,rt._resourceTiming=[]),rt.fire(new tt.Event("data",et))}})),this||w},i.prototype.getClusterExpansionZoom=function(tt,et){return(this||w).actor.send("geojson.getClusterExpansionZoom",{clusterId:tt,source:(this||w).id},et),this||w},i.prototype.getClusterChildren=function(tt,et){return(this||w).actor.send("geojson.getClusterChildren",{clusterId:tt,source:(this||w).id},et),this||w},i.prototype.getClusterLeaves=function(tt,et,rt,it){return(this||w).actor.send("geojson.getClusterLeaves",{source:(this||w).id,clusterId:tt,limit:et,offset:rt},it),this||w},i.prototype._updateWorkerData=function(et){var rt=this||w;(this||w)._loaded=!1;var it=tt.extend({},(this||w).workerOptions),nt=(this||w)._data;"string"==typeof nt?(it.request=(this||w).map._requestManager.transformRequest(tt.browser.resolveURL(nt),tt.ResourceType.Source),it.request.collectResourceTiming=(this||w)._collectResourceTiming):it.data=JSON.stringify(nt),(this||w).actor.send((this||w).type+".loadData",it,(function(w,tt){rt._removed||tt&&tt.abandoned||(rt._loaded=!0,tt&&tt.resourceTiming&&tt.resourceTiming[rt.id]&&(rt._resourceTiming=tt.resourceTiming[rt.id].slice(0)),rt.actor.send(rt.type+".coalesce",{source:it.source},null),et(w))}))},i.prototype.loaded=function(){return(this||w)._loaded},i.prototype.loadTile=function(et,rt){var it=this||w,nt=et.actor?"reloadTile":"loadTile";et.actor=(this||w).actor,et.request=(this||w).actor.send(nt,{type:(this||w).type,uid:et.uid,tileID:et.tileID,zoom:et.tileID.overscaledZ,maxZoom:(this||w).maxzoom,tileSize:(this||w).tileSize,source:(this||w).id,pixelRatio:tt.browser.devicePixelRatio,showCollisionBoxes:(this||w).map.showCollisionBoxes,promoteId:(this||w).promoteId},(function(w,tt){return delete et.request,et.unloadVectorData(),et.aborted?rt(null):w?rt(w):(et.loadVectorData(tt,it.map.painter,"reloadTile"===nt),rt(null))}))},i.prototype.abortTile=function(w){w.request&&(w.request.cancel(),delete w.request),w.aborted=!0},i.prototype.unloadTile=function(tt){tt.unloadVectorData(),(this||w).actor.send("removeTile",{uid:tt.uid,type:(this||w).type,source:(this||w).id})},i.prototype.onRemove=function(){(this||w)._removed=!0,(this||w).actor.send("removeSource",{type:(this||w).type,source:(this||w).id})},i.prototype.serialize=function(){return tt.extend({},(this||w)._options,{type:(this||w).type,data:(this||w)._data})},i.prototype.hasTransition=function(){return!1},i}(tt.Evented),Ze=tt.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Ge=function(et){function i(tt,rt,it,nt){et.call(this||w),(this||w).id=tt,(this||w).dispatcher=it,(this||w).coordinates=rt.coordinates,(this||w).type="image",(this||w).minzoom=0,(this||w).maxzoom=22,(this||w).tileSize=512,(this||w).tiles={},(this||w)._loaded=!1,this.setEventedParent(nt),(this||w).options=rt}return et&&(i.__proto__=et),(i.prototype=Object.create(et&&et.prototype)).constructor=i,i.prototype.load=function(et,rt){var it=this||w;(this||w)._loaded=!1,this.fire(new tt.Event("dataloading",{dataType:"source"})),(this||w).url=(this||w).options.url,tt.getImage((this||w).map._requestManager.transformRequest((this||w).url,tt.ResourceType.Image),(function(w,nt){it._loaded=!0,w?it.fire(new tt.ErrorEvent(w)):nt&&(it.image=nt,et&&(it.coordinates=et),rt&&rt(),it._finishLoading())}))},i.prototype.loaded=function(){return(this||w)._loaded},i.prototype.updateImage=function(tt){var et=this||w;return(this||w).image&&tt.url?((this||w).options.url=tt.url,this.load(tt.coordinates,(function(){et.texture=null})),this||w):this||w},i.prototype._finishLoading=function(){(this||w).map&&(this.setCoordinates((this||w).coordinates),this.fire(new tt.Event("data",{dataType:"source",sourceDataType:"metadata"})))},i.prototype.onAdd=function(tt){(this||w).map=tt,this.load()},i.prototype.setCoordinates=function(et){var rt=this||w;(this||w).coordinates=et;var it=et.map(tt.MercatorCoordinate.fromLngLat);(this||w).tileID=function(w){for(var et=1/0,rt=1/0,it=-1/0,nt=-1/0,ot=0,at=w;ot<at.length;ot+=1){var st=at[ot];et=Math.min(et,st.x),rt=Math.min(rt,st.y),it=Math.max(it,st.x),nt=Math.max(nt,st.y)}var ct=Math.max(it-et,nt-rt),pt=Math.max(0,Math.floor(-Math.log(ct)/Math.LN2)),ft=Math.pow(2,pt);return new tt.CanonicalTileID(pt,Math.floor((et+it)/2*ft),Math.floor((rt+nt)/2*ft))}(it),(this||w).minzoom=(this||w).maxzoom=(this||w).tileID.z;var nt=it.map((function(w){return rt.tileID.getTilePoint(w)._round()}));return(this||w)._boundsArray=new tt.StructArrayLayout4i8,(this||w)._boundsArray.emplaceBack(nt[0].x,nt[0].y,0,0),(this||w)._boundsArray.emplaceBack(nt[1].x,nt[1].y,tt.EXTENT,0),(this||w)._boundsArray.emplaceBack(nt[3].x,nt[3].y,0,tt.EXTENT),(this||w)._boundsArray.emplaceBack(nt[2].x,nt[2].y,tt.EXTENT,tt.EXTENT),(this||w).boundsBuffer&&((this||w).boundsBuffer.destroy(),delete(this||w).boundsBuffer),this.fire(new tt.Event("data",{dataType:"source",sourceDataType:"content"})),this||w},i.prototype.prepare=function(){if(0!==Object.keys((this||w).tiles).length&&(this||w).image){var et=(this||w).map.painter.context,rt=et.gl;for(var it in(this||w).boundsBuffer||((this||w).boundsBuffer=et.createVertexBuffer((this||w)._boundsArray,Ze.members)),(this||w).boundsSegments||((this||w).boundsSegments=tt.SegmentVector.simpleSegment(0,0,4,2)),(this||w).texture||((this||w).texture=new tt.Texture(et,(this||w).image,rt.RGBA),(this||w).texture.bind(rt.LINEAR,rt.CLAMP_TO_EDGE)),(this||w).tiles){var nt=(this||w).tiles[it];"loaded"!==nt.state&&(nt.state="loaded",nt.texture=(this||w).texture)}}},i.prototype.loadTile=function(tt,et){(this||w).tileID&&(this||w).tileID.equals(tt.tileID.canonical)?((this||w).tiles[String(tt.tileID.wrap)]=tt,tt.buckets={},et(null)):(tt.state="errored",et(null))},i.prototype.serialize=function(){return{type:"image",url:(this||w).options.url,coordinates:(this||w).coordinates}},i.prototype.hasTransition=function(){return!1},i}(tt.Evented),Ke=function(et){function i(tt,rt,it,nt){et.call(this||w,tt,rt,it,nt),(this||w).roundZoom=!0,(this||w).type="video",(this||w).options=rt}return et&&(i.__proto__=et),(i.prototype=Object.create(et&&et.prototype)).constructor=i,i.prototype.load=function(){var et=this||w;(this||w)._loaded=!1;var rt=(this||w).options;(this||w).urls=[];for(var it=0,nt=rt.urls;it<nt.length;it+=1)(this||w).urls.push((this||w).map._requestManager.transformRequest(nt[it],tt.ResourceType.Source).url);tt.getVideo((this||w).urls,(function(w,rt){et._loaded=!0,w?et.fire(new tt.ErrorEvent(w)):rt&&(et.video=rt,et.video.loop=!0,et.video.addEventListener("playing",(function(){et.map.triggerRepaint()})),et.map&&et.video.play(),et._finishLoading())}))},i.prototype.pause=function(){(this||w).video&&(this||w).video.pause()},i.prototype.play=function(){(this||w).video&&(this||w).video.play()},i.prototype.seek=function(et){if((this||w).video){var rt=(this||w).video.seekable;et<rt.start(0)||et>rt.end(0)?this.fire(new tt.ErrorEvent(new tt.ValidationError("sources."+(this||w).id,null,"Playback for this video can be set only between the "+rt.start(0)+" and "+rt.end(0)+"-second mark."))):(this||w).video.currentTime=et}},i.prototype.getVideo=function(){return(this||w).video},i.prototype.onAdd=function(tt){(this||w).map||((this||w).map=tt,this.load(),(this||w).video&&((this||w).video.play(),this.setCoordinates((this||w).coordinates)))},i.prototype.prepare=function(){if(!(0===Object.keys((this||w).tiles).length||(this||w).video.readyState<2)){var et=(this||w).map.painter.context,rt=et.gl;for(var it in(this||w).boundsBuffer||((this||w).boundsBuffer=et.createVertexBuffer((this||w)._boundsArray,Ze.members)),(this||w).boundsSegments||((this||w).boundsSegments=tt.SegmentVector.simpleSegment(0,0,4,2)),(this||w).texture?(this||w).video.paused||((this||w).texture.bind(rt.LINEAR,rt.CLAMP_TO_EDGE),rt.texSubImage2D(rt.TEXTURE_2D,0,0,0,rt.RGBA,rt.UNSIGNED_BYTE,(this||w).video)):((this||w).texture=new tt.Texture(et,(this||w).video,rt.RGBA),(this||w).texture.bind(rt.LINEAR,rt.CLAMP_TO_EDGE)),(this||w).tiles){var nt=(this||w).tiles[it];"loaded"!==nt.state&&(nt.state="loaded",nt.texture=(this||w).texture)}}},i.prototype.serialize=function(){return{type:"video",urls:(this||w).urls,coordinates:(this||w).coordinates}},i.prototype.hasTransition=function(){return(this||w).video&&!(this||w).video.paused},i}(Ge),er=function(et){function i(rt,it,nt,ot){et.call(this||w,rt,it,nt,ot),it.coordinates?Array.isArray(it.coordinates)&&4===it.coordinates.length&&!it.coordinates.some((function(w){return!Array.isArray(w)||2!==w.length||w.some((function(w){return"number"!=typeof w}))}))||this.fire(new tt.ErrorEvent(new tt.ValidationError("sources."+rt,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new tt.ErrorEvent(new tt.ValidationError("sources."+rt,null,'missing required property "coordinates"'))),it.animate&&"boolean"!=typeof it.animate&&this.fire(new tt.ErrorEvent(new tt.ValidationError("sources."+rt,null,'optional "animate" property must be a boolean value'))),it.canvas?"string"==typeof it.canvas||it.canvas instanceof tt.window.HTMLCanvasElement||this.fire(new tt.ErrorEvent(new tt.ValidationError("sources."+rt,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new tt.ErrorEvent(new tt.ValidationError("sources."+rt,null,'missing required property "canvas"'))),(this||w).options=it,(this||w).animate=void 0===it.animate||it.animate}return et&&(i.__proto__=et),(i.prototype=Object.create(et&&et.prototype)).constructor=i,i.prototype.load=function(){(this||w)._loaded=!0,(this||w).canvas||((this||w).canvas=(this||w).options.canvas instanceof tt.window.HTMLCanvasElement?(this||w).options.canvas:tt.window.document.getElementById((this||w).options.canvas)),(this||w).width=(this||w).canvas.width,(this||w).height=(this||w).canvas.height,this._hasInvalidDimensions()?this.fire(new tt.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):((this||w).play=function(){(this||w)._playing=!0,(this||w).map.triggerRepaint()},(this||w).pause=function(){(this||w)._playing&&(this.prepare(),(this||w)._playing=!1)},this._finishLoading())},i.prototype.getCanvas=function(){return(this||w).canvas},i.prototype.onAdd=function(tt){(this||w).map=tt,this.load(),(this||w).canvas&&(this||w).animate&&this.play()},i.prototype.onRemove=function(){this.pause()},i.prototype.prepare=function(){var et=!1;if((this||w).canvas.width!==(this||w).width&&((this||w).width=(this||w).canvas.width,et=!0),(this||w).canvas.height!==(this||w).height&&((this||w).height=(this||w).canvas.height,et=!0),!this._hasInvalidDimensions()&&0!==Object.keys((this||w).tiles).length){var rt=(this||w).map.painter.context,it=rt.gl;for(var nt in(this||w).boundsBuffer||((this||w).boundsBuffer=rt.createVertexBuffer((this||w)._boundsArray,Ze.members)),(this||w).boundsSegments||((this||w).boundsSegments=tt.SegmentVector.simpleSegment(0,0,4,2)),(this||w).texture?(et||(this||w)._playing)&&(this||w).texture.update((this||w).canvas,{premultiply:!0}):(this||w).texture=new tt.Texture(rt,(this||w).canvas,it.RGBA,{premultiply:!0}),(this||w).tiles){var ot=(this||w).tiles[nt];"loaded"!==ot.state&&(ot.state="loaded",ot.texture=(this||w).texture)}}},i.prototype.serialize=function(){return{type:"canvas",coordinates:(this||w).coordinates}},i.prototype.hasTransition=function(){return(this||w)._playing},i.prototype._hasInvalidDimensions=function(){for(var tt=0,et=[(this||w).canvas.width,(this||w).canvas.height];tt<et.length;tt+=1){var rt=et[tt];if(isNaN(rt)||rt<=0)return!0}return!1},i}(Ge),rr={vector:Rt,raster:Bt,"raster-dem":Ot,geojson:Ne,video:Ke,image:Ge,canvas:er};function B(w,et){var rt=tt.identity([]);return tt.translate(rt,rt,[1,1,0]),tt.scale(rt,rt,[.5*w.width,.5*w.height,1]),tt.multiply(rt,rt,w.calculatePosMatrix(et.toUnwrapped()))}function O(w,tt,et,rt,it,nt){var ot=function(w,tt,et){if(w)for(var rt=0,it=w;rt<it.length;rt+=1){var nt=tt[it[rt]];if(nt&&nt.source===et&&"fill-extrusion"===nt.type)return!0}else for(var ot in tt){var at=tt[ot];if(at.source===et&&"fill-extrusion"===at.type)return!0}return!1}(it&&it.layers,tt,w.id),at=nt.maxPitchScaleFactor(),st=w.tilesIn(rt,at,ot);st.sort(F);for(var ct=[],pt=0,ft=st;pt<ft.length;pt+=1){var dt=ft[pt];ct.push({wrappedTileID:dt.tileID.wrapped().key,queryResults:dt.tile.queryRenderedFeatures(tt,et,w._state,dt.queryGeometry,dt.cameraQueryGeometry,dt.scale,it,nt,at,B(w.transform,dt.tileID))})}var mt=function(w){for(var tt={},et={},rt=0,it=w;rt<it.length;rt+=1){var nt=it[rt],ot=nt.queryResults,at=nt.wrappedTileID,st=et[at]=et[at]||{};for(var ct in ot)for(var pt=ot[ct],ft=st[ct]=st[ct]||{},dt=tt[ct]=tt[ct]||[],mt=0,yt=pt;mt<yt.length;mt+=1){var vt=yt[mt];ft[vt.featureIndex]||(ft[vt.featureIndex]=!0,dt.push(vt))}}return tt}(ct);for(var yt in mt)mt[yt].forEach((function(tt){var et=tt.feature,rt=w.getFeatureState(et.layer["source-layer"],et.id);et.source=et.layer.source,et.layer["source-layer"]&&(et.sourceLayer=et.layer["source-layer"]),et.state=rt}));return mt}function F(w,tt){var et=w.tileID,rt=tt.tileID;return et.overscaledZ-rt.overscaledZ||et.canonical.y-rt.canonical.y||et.wrap-rt.wrap||et.canonical.x-rt.canonical.x}var U=function(tt,et){(this||w).max=tt,(this||w).onRemove=et,this.reset()};U.prototype.reset=function(){for(var tt in(this||w).data)for(var et=0,rt=(this||w).data[tt];et<rt.length;et+=1){var it=rt[et];it.timeout&&clearTimeout(it.timeout),this.onRemove(it.value)}return(this||w).data={},(this||w).order=[],this||w},U.prototype.add=function(tt,et,rt){var it=this||w,nt=tt.wrapped().key;void 0===(this||w).data[nt]&&((this||w).data[nt]=[]);var ot={value:et,timeout:void 0};if(void 0!==rt&&(ot.timeout=setTimeout((function(){it.remove(tt,ot)}),rt)),(this||w).data[nt].push(ot),(this||w).order.push(nt),(this||w).order.length>(this||w).max){var at=this._getAndRemoveByKey((this||w).order[0]);at&&this.onRemove(at)}return this||w},U.prototype.has=function(tt){return tt.wrapped().key in(this||w).data},U.prototype.getAndRemove=function(w){return this.has(w)?this._getAndRemoveByKey(w.wrapped().key):null},U.prototype._getAndRemoveByKey=function(tt){var et=(this||w).data[tt].shift();return et.timeout&&clearTimeout(et.timeout),0===(this||w).data[tt].length&&delete(this||w).data[tt],(this||w).order.splice((this||w).order.indexOf(tt),1),et.value},U.prototype.getByKey=function(tt){var et=(this||w).data[tt];return et?et[0].value:null},U.prototype.get=function(tt){return this.has(tt)?(this||w).data[tt.wrapped().key][0].value:null},U.prototype.remove=function(tt,et){if(!this.has(tt))return this||w;var rt=tt.wrapped().key,it=void 0===et?0:(this||w).data[rt].indexOf(et),nt=(this||w).data[rt][it];return(this||w).data[rt].splice(it,1),nt.timeout&&clearTimeout(nt.timeout),0===(this||w).data[rt].length&&delete(this||w).data[rt],this.onRemove(nt.value),(this||w).order.splice((this||w).order.indexOf(rt),1),this||w},U.prototype.setMaxSize=function(tt){for((this||w).max=tt;(this||w).order.length>(this||w).max;){var et=this._getAndRemoveByKey((this||w).order[0]);et&&this.onRemove(et)}return this||w},U.prototype.filter=function(tt){var et=[];for(var rt in(this||w).data)for(var it=0,nt=(this||w).data[rt];it<nt.length;it+=1){var ot=nt[it];tt(ot.value)||et.push(ot)}for(var at=0,st=et;at<st.length;at+=1){var ct=st[at];this.remove(ct.value.tileID,ct)}};var N=function(tt,et,rt){(this||w).context=tt;var it=tt.gl;(this||w).buffer=it.createBuffer(),(this||w).dynamicDraw=Boolean(rt),(this||w).context.unbindVAO(),tt.bindElementBuffer.set((this||w).buffer),it.bufferData(it.ELEMENT_ARRAY_BUFFER,et.arrayBuffer,(this||w).dynamicDraw?it.DYNAMIC_DRAW:it.STATIC_DRAW),(this||w).dynamicDraw||delete et.arrayBuffer};N.prototype.bind=function(){(this||w).context.bindElementBuffer.set((this||w).buffer)},N.prototype.updateData=function(tt){var et=(this||w).context.gl;(this||w).context.unbindVAO(),this.bind(),et.bufferSubData(et.ELEMENT_ARRAY_BUFFER,0,tt.arrayBuffer)},N.prototype.destroy=function(){(this||w).buffer&&((this||w).context.gl.deleteBuffer((this||w).buffer),delete(this||w).buffer)};var vr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},j=function(tt,et,rt,it){(this||w).length=et.length,(this||w).attributes=rt,(this||w).itemSize=et.bytesPerElement,(this||w).dynamicDraw=it,(this||w).context=tt;var nt=tt.gl;(this||w).buffer=nt.createBuffer(),tt.bindVertexBuffer.set((this||w).buffer),nt.bufferData(nt.ARRAY_BUFFER,et.arrayBuffer,(this||w).dynamicDraw?nt.DYNAMIC_DRAW:nt.STATIC_DRAW),(this||w).dynamicDraw||delete et.arrayBuffer};j.prototype.bind=function(){(this||w).context.bindVertexBuffer.set((this||w).buffer)},j.prototype.updateData=function(tt){var et=(this||w).context.gl;this.bind(),et.bufferSubData(et.ARRAY_BUFFER,0,tt.arrayBuffer)},j.prototype.enableAttributes=function(tt,et){for(var rt=0;rt<(this||w).attributes.length;rt++){var it=et.attributes[(this||w).attributes[rt].name];void 0!==it&&tt.enableVertexAttribArray(it)}},j.prototype.setVertexAttribPointers=function(tt,et,rt){for(var it=0;it<(this||w).attributes.length;it++){var nt=(this||w).attributes[it],ot=et.attributes[nt.name];void 0!==ot&&tt.vertexAttribPointer(ot,nt.components,tt[vr[nt.type]],!1,(this||w).itemSize,nt.offset+(this||w).itemSize*(rt||0))}},j.prototype.destroy=function(){(this||w).buffer&&((this||w).context.gl.deleteBuffer((this||w).buffer),delete(this||w).buffer)};var q=function(tt){(this||w).gl=tt.gl,(this||w).default=this.getDefault(),(this||w).current=(this||w).default,(this||w).dirty=!1};q.prototype.get=function(){return(this||w).current},q.prototype.set=function(w){},q.prototype.getDefault=function(){return(this||w).default},q.prototype.setDefault=function(){this.set((this||w).default)};var wr=function(et){function i(){et.apply(this||w,arguments)}return et&&(i.__proto__=et),(i.prototype=Object.create(et&&et.prototype)).constructor=i,i.prototype.getDefault=function(){return tt.Color.transparent},i.prototype.set=function(tt){var et=(this||w).current;(tt.r!==et.r||tt.g!==et.g||tt.b!==et.b||tt.a!==et.a||(this||w).dirty)&&((this||w).gl.clearColor(tt.r,tt.g,tt.b,tt.a),(this||w).current=tt,(this||w).dirty=!1)},i}(q),Sr=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return 1},e.prototype.set=function(tt){(tt!==(this||w).current||(this||w).dirty)&&((this||w).gl.clearDepth(tt),(this||w).current=tt,(this||w).dirty=!1)},e}(q),ei=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return 0},e.prototype.set=function(tt){(tt!==(this||w).current||(this||w).dirty)&&((this||w).gl.clearStencil(tt),(this||w).current=tt,(this||w).dirty=!1)},e}(q),ii=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return[!0,!0,!0,!0]},e.prototype.set=function(tt){var et=(this||w).current;(tt[0]!==et[0]||tt[1]!==et[1]||tt[2]!==et[2]||tt[3]!==et[3]||(this||w).dirty)&&((this||w).gl.colorMask(tt[0],tt[1],tt[2],tt[3]),(this||w).current=tt,(this||w).dirty=!1)},e}(q),mi=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return!0},e.prototype.set=function(tt){(tt!==(this||w).current||(this||w).dirty)&&((this||w).gl.depthMask(tt),(this||w).current=tt,(this||w).dirty=!1)},e}(q),qi=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return 255},e.prototype.set=function(tt){(tt!==(this||w).current||(this||w).dirty)&&((this||w).gl.stencilMask(tt),(this||w).current=tt,(this||w).dirty=!1)},e}(q),Ki=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return{func:(this||w).gl.ALWAYS,ref:0,mask:255}},e.prototype.set=function(tt){var et=(this||w).current;(tt.func!==et.func||tt.ref!==et.ref||tt.mask!==et.mask||(this||w).dirty)&&((this||w).gl.stencilFunc(tt.func,tt.ref,tt.mask),(this||w).current=tt,(this||w).dirty=!1)},e}(q),Ji=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){var tt=(this||w).gl;return[tt.KEEP,tt.KEEP,tt.KEEP]},e.prototype.set=function(tt){var et=(this||w).current;(tt[0]!==et[0]||tt[1]!==et[1]||tt[2]!==et[2]||(this||w).dirty)&&((this||w).gl.stencilOp(tt[0],tt[1],tt[2]),(this||w).current=tt,(this||w).dirty=!1)},e}(q),rn=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(tt){if(tt!==(this||w).current||(this||w).dirty){var et=(this||w).gl;tt?et.enable(et.STENCIL_TEST):et.disable(et.STENCIL_TEST),(this||w).current=tt,(this||w).dirty=!1}},e}(q),vn=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return[0,1]},e.prototype.set=function(tt){var et=(this||w).current;(tt[0]!==et[0]||tt[1]!==et[1]||(this||w).dirty)&&((this||w).gl.depthRange(tt[0],tt[1]),(this||w).current=tt,(this||w).dirty=!1)},e}(q),bn=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(tt){if(tt!==(this||w).current||(this||w).dirty){var et=(this||w).gl;tt?et.enable(et.DEPTH_TEST):et.disable(et.DEPTH_TEST),(this||w).current=tt,(this||w).dirty=!1}},e}(q),Tn=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return(this||w).gl.LESS},e.prototype.set=function(tt){(tt!==(this||w).current||(this||w).dirty)&&((this||w).gl.depthFunc(tt),(this||w).current=tt,(this||w).dirty=!1)},e}(q),In=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(tt){if(tt!==(this||w).current||(this||w).dirty){var et=(this||w).gl;tt?et.enable(et.BLEND):et.disable(et.BLEND),(this||w).current=tt,(this||w).dirty=!1}},e}(q),zn=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){var tt=(this||w).gl;return[tt.ONE,tt.ZERO]},e.prototype.set=function(tt){var et=(this||w).current;(tt[0]!==et[0]||tt[1]!==et[1]||(this||w).dirty)&&((this||w).gl.blendFunc(tt[0],tt[1]),(this||w).current=tt,(this||w).dirty=!1)},e}(q),Cn=function(et){function i(){et.apply(this||w,arguments)}return et&&(i.__proto__=et),(i.prototype=Object.create(et&&et.prototype)).constructor=i,i.prototype.getDefault=function(){return tt.Color.transparent},i.prototype.set=function(tt){var et=(this||w).current;(tt.r!==et.r||tt.g!==et.g||tt.b!==et.b||tt.a!==et.a||(this||w).dirty)&&((this||w).gl.blendColor(tt.r,tt.g,tt.b,tt.a),(this||w).current=tt,(this||w).dirty=!1)},i}(q),Mn=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return(this||w).gl.FUNC_ADD},e.prototype.set=function(tt){(tt!==(this||w).current||(this||w).dirty)&&((this||w).gl.blendEquation(tt),(this||w).current=tt,(this||w).dirty=!1)},e}(q),Ln=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(tt){if(tt!==(this||w).current||(this||w).dirty){var et=(this||w).gl;tt?et.enable(et.CULL_FACE):et.disable(et.CULL_FACE),(this||w).current=tt,(this||w).dirty=!1}},e}(q),Bn=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return(this||w).gl.BACK},e.prototype.set=function(tt){(tt!==(this||w).current||(this||w).dirty)&&((this||w).gl.cullFace(tt),(this||w).current=tt,(this||w).dirty=!1)},e}(q),Fn=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return(this||w).gl.CCW},e.prototype.set=function(tt){(tt!==(this||w).current||(this||w).dirty)&&((this||w).gl.frontFace(tt),(this||w).current=tt,(this||w).dirty=!1)},e}(q),Vn=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(tt){(tt!==(this||w).current||(this||w).dirty)&&((this||w).gl.useProgram(tt),(this||w).current=tt,(this||w).dirty=!1)},e}(q),Nn=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return(this||w).gl.TEXTURE0},e.prototype.set=function(tt){(tt!==(this||w).current||(this||w).dirty)&&((this||w).gl.activeTexture(tt),(this||w).current=tt,(this||w).dirty=!1)},e}(q),Wn=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){var tt=(this||w).gl;return[0,0,tt.drawingBufferWidth,tt.drawingBufferHeight]},e.prototype.set=function(tt){var et=(this||w).current;(tt[0]!==et[0]||tt[1]!==et[1]||tt[2]!==et[2]||tt[3]!==et[3]||(this||w).dirty)&&((this||w).gl.viewport(tt[0],tt[1],tt[2],tt[3]),(this||w).current=tt,(this||w).dirty=!1)},e}(q),Yn=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(tt){if(tt!==(this||w).current||(this||w).dirty){var et=(this||w).gl;et.bindFramebuffer(et.FRAMEBUFFER,tt),(this||w).current=tt,(this||w).dirty=!1}},e}(q),$n=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(tt){if(tt!==(this||w).current||(this||w).dirty){var et=(this||w).gl;et.bindRenderbuffer(et.RENDERBUFFER,tt),(this||w).current=tt,(this||w).dirty=!1}},e}(q),uo=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(tt){if(tt!==(this||w).current||(this||w).dirty){var et=(this||w).gl;et.bindTexture(et.TEXTURE_2D,tt),(this||w).current=tt,(this||w).dirty=!1}},e}(q),po=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(tt){if(tt!==(this||w).current||(this||w).dirty){var et=(this||w).gl;et.bindBuffer(et.ARRAY_BUFFER,tt),(this||w).current=tt,(this||w).dirty=!1}},e}(q),vo=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(tt){var et=(this||w).gl;et.bindBuffer(et.ELEMENT_ARRAY_BUFFER,tt),(this||w).current=tt,(this||w).dirty=!1},e}(q),So=function(tt){function e(et){tt.call(this||w,et),(this||w).vao=et.extVertexArrayObject}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(tt){(this||w).vao&&(tt!==(this||w).current||(this||w).dirty)&&((this||w).vao.bindVertexArrayOES(tt),(this||w).current=tt,(this||w).dirty=!1)},e}(q),ta=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return 4},e.prototype.set=function(tt){if(tt!==(this||w).current||(this||w).dirty){var et=(this||w).gl;et.pixelStorei(et.UNPACK_ALIGNMENT,tt),(this||w).current=tt,(this||w).dirty=!1}},e}(q),ea=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(tt){if(tt!==(this||w).current||(this||w).dirty){var et=(this||w).gl;et.pixelStorei(et.UNPACK_PREMULTIPLY_ALPHA_WEBGL,tt),(this||w).current=tt,(this||w).dirty=!1}},e}(q),ra=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(tt){if(tt!==(this||w).current||(this||w).dirty){var et=(this||w).gl;et.pixelStorei(et.UNPACK_FLIP_Y_WEBGL,tt),(this||w).current=tt,(this||w).dirty=!1}},e}(q),ia=function(tt){function e(et,rt){tt.call(this||w,et),(this||w).context=et,(this||w).parent=rt}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e}(q),na=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.setDirty=function(){(this||w).dirty=!0},e.prototype.set=function(tt){if(tt!==(this||w).current||(this||w).dirty){(this||w).context.bindFramebuffer.set((this||w).parent);var et=(this||w).gl;et.framebufferTexture2D(et.FRAMEBUFFER,et.COLOR_ATTACHMENT0,et.TEXTURE_2D,tt,0),(this||w).current=tt,(this||w).dirty=!1}},e}(ia),sa=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.set=function(tt){if(tt!==(this||w).current||(this||w).dirty){(this||w).context.bindFramebuffer.set((this||w).parent);var et=(this||w).gl;et.framebufferRenderbuffer(et.FRAMEBUFFER,et.DEPTH_ATTACHMENT,et.RENDERBUFFER,tt),(this||w).current=tt,(this||w).dirty=!1}},e}(ia),Et=function(tt,et,rt,it){(this||w).context=tt,(this||w).width=et,(this||w).height=rt;var nt=(this||w).framebuffer=tt.gl.createFramebuffer();(this||w).colorAttachment=new na(tt,nt),it&&((this||w).depthAttachment=new sa(tt,nt))};Et.prototype.destroy=function(){var tt=(this||w).context.gl,et=(this||w).colorAttachment.get();if(et&&tt.deleteTexture(et),(this||w).depthAttachment){var rt=(this||w).depthAttachment.get();rt&&tt.deleteRenderbuffer(rt)}tt.deleteFramebuffer((this||w).framebuffer)};var It=function(tt,et,rt){(this||w).func=tt,(this||w).mask=et,(this||w).range=rt};It.ReadOnly=!1,It.ReadWrite=!0,It.disabled=new It(519,It.ReadOnly,[0,1]);var Pt=function(tt,et,rt,it,nt,ot){(this||w).test=tt,(this||w).ref=et,(this||w).mask=rt,(this||w).fail=it,(this||w).depthFail=nt,(this||w).pass=ot};Pt.disabled=new Pt({func:519,mask:0},0,0,7680,7680,7680);var St=function(tt,et,rt){(this||w).blendFunction=tt,(this||w).blendColor=et,(this||w).mask=rt};St.disabled=new St(St.Replace=[1,0],tt.Color.transparent,[!1,!1,!1,!1]),St.unblended=new St(St.Replace,tt.Color.transparent,[!0,!0,!0,!0]),St.alphaBlended=new St([1,771],tt.Color.transparent,[!0,!0,!0,!0]);var Ct=function(tt,et,rt){(this||w).enable=tt,(this||w).mode=et,(this||w).frontFace=rt};Ct.disabled=new Ct(!1,1029,2305),Ct.backCCW=new Ct(!0,1029,2305);var zt=function(tt){(this||w).gl=tt,(this||w).extVertexArrayObject=(this||w).gl.getExtension("OES_vertex_array_object"),(this||w).clearColor=new wr(this||w),(this||w).clearDepth=new Sr(this||w),(this||w).clearStencil=new ei(this||w),(this||w).colorMask=new ii(this||w),(this||w).depthMask=new mi(this||w),(this||w).stencilMask=new qi(this||w),(this||w).stencilFunc=new Ki(this||w),(this||w).stencilOp=new Ji(this||w),(this||w).stencilTest=new rn(this||w),(this||w).depthRange=new vn(this||w),(this||w).depthTest=new bn(this||w),(this||w).depthFunc=new Tn(this||w),(this||w).blend=new In(this||w),(this||w).blendFunc=new zn(this||w),(this||w).blendColor=new Cn(this||w),(this||w).blendEquation=new Mn(this||w),(this||w).cullFace=new Ln(this||w),(this||w).cullFaceSide=new Bn(this||w),(this||w).frontFace=new Fn(this||w),(this||w).program=new Vn(this||w),(this||w).activeTexture=new Nn(this||w),(this||w).viewport=new Wn(this||w),(this||w).bindFramebuffer=new Yn(this||w),(this||w).bindRenderbuffer=new $n(this||w),(this||w).bindTexture=new uo(this||w),(this||w).bindVertexBuffer=new po(this||w),(this||w).bindElementBuffer=new vo(this||w),(this||w).bindVertexArrayOES=(this||w).extVertexArrayObject&&new So(this||w),(this||w).pixelStoreUnpack=new ta(this||w),(this||w).pixelStoreUnpackPremultiplyAlpha=new ea(this||w),(this||w).pixelStoreUnpackFlipY=new ra(this||w),(this||w).extTextureFilterAnisotropic=tt.getExtension("EXT_texture_filter_anisotropic")||tt.getExtension("MOZ_EXT_texture_filter_anisotropic")||tt.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),(this||w).extTextureFilterAnisotropic&&((this||w).extTextureFilterAnisotropicMax=tt.getParameter((this||w).extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),(this||w).extTextureHalfFloat=tt.getExtension("OES_texture_half_float"),(this||w).extTextureHalfFloat&&(tt.getExtension("OES_texture_half_float_linear"),(this||w).extRenderToTextureHalfFloat=tt.getExtension("EXT_color_buffer_half_float")),(this||w).extTimerQuery=tt.getExtension("EXT_disjoint_timer_query")};zt.prototype.setDefault=function(){this.unbindVAO(),(this||w).clearColor.setDefault(),(this||w).clearDepth.setDefault(),(this||w).clearStencil.setDefault(),(this||w).colorMask.setDefault(),(this||w).depthMask.setDefault(),(this||w).stencilMask.setDefault(),(this||w).stencilFunc.setDefault(),(this||w).stencilOp.setDefault(),(this||w).stencilTest.setDefault(),(this||w).depthRange.setDefault(),(this||w).depthTest.setDefault(),(this||w).depthFunc.setDefault(),(this||w).blend.setDefault(),(this||w).blendFunc.setDefault(),(this||w).blendColor.setDefault(),(this||w).blendEquation.setDefault(),(this||w).cullFace.setDefault(),(this||w).cullFaceSide.setDefault(),(this||w).frontFace.setDefault(),(this||w).program.setDefault(),(this||w).activeTexture.setDefault(),(this||w).bindFramebuffer.setDefault(),(this||w).pixelStoreUnpack.setDefault(),(this||w).pixelStoreUnpackPremultiplyAlpha.setDefault(),(this||w).pixelStoreUnpackFlipY.setDefault()},zt.prototype.setDirty=function(){(this||w).clearColor.dirty=!0,(this||w).clearDepth.dirty=!0,(this||w).clearStencil.dirty=!0,(this||w).colorMask.dirty=!0,(this||w).depthMask.dirty=!0,(this||w).stencilMask.dirty=!0,(this||w).stencilFunc.dirty=!0,(this||w).stencilOp.dirty=!0,(this||w).stencilTest.dirty=!0,(this||w).depthRange.dirty=!0,(this||w).depthTest.dirty=!0,(this||w).depthFunc.dirty=!0,(this||w).blend.dirty=!0,(this||w).blendFunc.dirty=!0,(this||w).blendColor.dirty=!0,(this||w).blendEquation.dirty=!0,(this||w).cullFace.dirty=!0,(this||w).cullFaceSide.dirty=!0,(this||w).frontFace.dirty=!0,(this||w).program.dirty=!0,(this||w).activeTexture.dirty=!0,(this||w).viewport.dirty=!0,(this||w).bindFramebuffer.dirty=!0,(this||w).bindRenderbuffer.dirty=!0,(this||w).bindTexture.dirty=!0,(this||w).bindVertexBuffer.dirty=!0,(this||w).bindElementBuffer.dirty=!0,(this||w).extVertexArrayObject&&((this||w).bindVertexArrayOES.dirty=!0),(this||w).pixelStoreUnpack.dirty=!0,(this||w).pixelStoreUnpackPremultiplyAlpha.dirty=!0,(this||w).pixelStoreUnpackFlipY.dirty=!0},zt.prototype.createIndexBuffer=function(tt,et){return new N(this||w,tt,et)},zt.prototype.createVertexBuffer=function(tt,et,rt){return new j(this||w,tt,et,rt)},zt.prototype.createRenderbuffer=function(tt,et,rt){var it=(this||w).gl,nt=it.createRenderbuffer();return(this||w).bindRenderbuffer.set(nt),it.renderbufferStorage(it.RENDERBUFFER,tt,et,rt),(this||w).bindRenderbuffer.set(null),nt},zt.prototype.createFramebuffer=function(tt,et,rt){return new Et(this||w,tt,et,rt)},zt.prototype.clear=function(tt){var et=tt.color,rt=tt.depth,it=(this||w).gl,nt=0;et&&(nt|=it.COLOR_BUFFER_BIT,(this||w).clearColor.set(et),(this||w).colorMask.set([!0,!0,!0,!0])),void 0!==rt&&(nt|=it.DEPTH_BUFFER_BIT,(this||w).depthRange.set([0,1]),(this||w).clearDepth.set(rt),(this||w).depthMask.set(!0)),it.clear(nt)},zt.prototype.setCullFace=function(tt){!1===tt.enable?(this||w).cullFace.set(!1):((this||w).cullFace.set(!0),(this||w).cullFaceSide.set(tt.mode),(this||w).frontFace.set(tt.frontFace))},zt.prototype.setDepthMode=function(tt){tt.func!==(this||w).gl.ALWAYS||tt.mask?((this||w).depthTest.set(!0),(this||w).depthFunc.set(tt.func),(this||w).depthMask.set(tt.mask),(this||w).depthRange.set(tt.range)):(this||w).depthTest.set(!1)},zt.prototype.setStencilMode=function(tt){tt.test.func!==(this||w).gl.ALWAYS||tt.mask?((this||w).stencilTest.set(!0),(this||w).stencilMask.set(tt.mask),(this||w).stencilOp.set([tt.fail,tt.depthFail,tt.pass]),(this||w).stencilFunc.set({func:tt.test.func,ref:tt.ref,mask:tt.test.mask})):(this||w).stencilTest.set(!1)},zt.prototype.setColorMode=function(et){tt.deepEqual(et.blendFunction,St.Replace)?(this||w).blend.set(!1):((this||w).blend.set(!0),(this||w).blendFunc.set(et.blendFunction),(this||w).blendColor.set(et.blendColor)),(this||w).colorMask.set(et.mask)},zt.prototype.unbindVAO=function(){(this||w).extVertexArrayObject&&(this||w).bindVertexArrayOES.set(null)};var la=function(et){function i(rt,it,nt){var ot=this||w;et.call(this||w),(this||w).id=rt,(this||w).dispatcher=nt,this.on("data",(function(w){"source"===w.dataType&&"metadata"===w.sourceDataType&&(ot._sourceLoaded=!0),ot._sourceLoaded&&!ot._paused&&"source"===w.dataType&&"content"===w.sourceDataType&&(ot.reload(),ot.transform&&ot.update(ot.transform))})),this.on("error",(function(){ot._sourceErrored=!0})),(this||w)._source=function(w,et,rt,it){var nt=new rr[et.type](w,et,rt,it);if(nt.id!==w)throw new Error("Expected Source id to be "+w+" instead of "+nt.id);return tt.bindAll(["load","abort","unload","serialize","prepare"],nt),nt}(rt,it,nt,this||w),(this||w)._tiles={},(this||w)._cache=new U(0,(this||w)._unloadTile.bind(this||w)),(this||w)._timers={},(this||w)._cacheTimers={},(this||w)._maxTileCacheSize=null,(this||w)._loadedParentTiles={},(this||w)._coveredTiles={},(this||w)._state=new tt.SourceFeatureState}return et&&(i.__proto__=et),(i.prototype=Object.create(et&&et.prototype)).constructor=i,i.prototype.onAdd=function(tt){(this||w).map=tt,(this||w)._maxTileCacheSize=tt?tt._maxTileCacheSize:null,(this||w)._source&&(this||w)._source.onAdd&&(this||w)._source.onAdd(tt)},i.prototype.onRemove=function(tt){(this||w)._source&&(this||w)._source.onRemove&&(this||w)._source.onRemove(tt)},i.prototype.loaded=function(){if((this||w)._sourceErrored)return!0;if(!(this||w)._sourceLoaded)return!1;if(!(this||w)._source.loaded())return!1;for(var tt in(this||w)._tiles){var et=(this||w)._tiles[tt];if("loaded"!==et.state&&"errored"!==et.state)return!1}return!0},i.prototype.getSource=function(){return(this||w)._source},i.prototype.pause=function(){(this||w)._paused=!0},i.prototype.resume=function(){if((this||w)._paused){var tt=(this||w)._shouldReloadOnResume;(this||w)._paused=!1,(this||w)._shouldReloadOnResume=!1,tt&&this.reload(),(this||w).transform&&this.update((this||w).transform)}},i.prototype._loadTile=function(tt,et){return(this||w)._source.loadTile(tt,et)},i.prototype._unloadTile=function(tt){if((this||w)._source.unloadTile)return(this||w)._source.unloadTile(tt,(function(){}))},i.prototype._abortTile=function(tt){if((this||w)._source.abortTile)return(this||w)._source.abortTile(tt,(function(){}))},i.prototype.serialize=function(){return(this||w)._source.serialize()},i.prototype.prepare=function(tt){for(var et in(this||w)._source.prepare&&(this||w)._source.prepare(),(this||w)._state.coalesceChanges((this||w)._tiles,(this||w).map?(this||w).map.painter:null),(this||w)._tiles){var rt=(this||w)._tiles[et];rt.upload(tt),rt.prepare((this||w).map.style.imageManager)}},i.prototype.getIds=function(){return tt.values((this||w)._tiles).map((function(w){return w.tileID})).sort(Mt).map((function(w){return w.key}))},i.prototype.getRenderableIds=function(et){var rt=this||w,it=[];for(var nt in(this||w)._tiles)this._isIdRenderable(nt,et)&&it.push((this||w)._tiles[nt]);return et?it.sort((function(w,et){var it=w.tileID,nt=et.tileID,ot=new tt.Point(it.canonical.x,it.canonical.y)._rotate(rt.transform.angle),at=new tt.Point(nt.canonical.x,nt.canonical.y)._rotate(rt.transform.angle);return it.overscaledZ-nt.overscaledZ||at.y-ot.y||at.x-ot.x})).map((function(w){return w.tileID.key})):it.map((function(w){return w.tileID})).sort(Mt).map((function(w){return w.key}))},i.prototype.hasRenderableParent=function(w){var tt=this.findLoadedParent(w,0);return!!tt&&this._isIdRenderable(tt.tileID.key)},i.prototype._isIdRenderable=function(tt,et){return(this||w)._tiles[tt]&&(this||w)._tiles[tt].hasData()&&!(this||w)._coveredTiles[tt]&&(et||!(this||w)._tiles[tt].holdingForFade())},i.prototype.reload=function(){if((this||w)._paused)(this||w)._shouldReloadOnResume=!0;else for(var tt in(this||w)._cache.reset(),(this||w)._tiles)"errored"!==(this||w)._tiles[tt].state&&this._reloadTile(tt,"reloading")},i.prototype._reloadTile=function(tt,et){var rt=(this||w)._tiles[tt];rt&&("loading"!==rt.state&&(rt.state=et),this._loadTile(rt,(this||w)._tileLoaded.bind(this||w,rt,tt,et)))},i.prototype._tileLoaded=function(et,rt,it,nt){if(nt)return et.state="errored",void(404!==nt.status?(this||w)._source.fire(new tt.ErrorEvent(nt,{tile:et})):this.update((this||w).transform));et.timeAdded=tt.browser.now(),"expired"===it&&(et.refreshedUponExpiration=!0),this._setTileReloadTimer(rt,et),"raster-dem"===this.getSource().type&&et.dem&&this._backfillDEM(et),(this||w)._state.initializeTileState(et,(this||w).map?(this||w).map.painter:null),(this||w)._source.fire(new tt.Event("data",{dataType:"source",tile:et,coord:et.tileID}))},i.prototype._backfillDEM=function(w){for(var tt=this.getRenderableIds(),et=0;et<tt.length;et++){var rt=tt[et];if(w.neighboringTiles&&w.neighboringTiles[rt]){var it=this.getTileByID(rt);a(w,it),a(it,w)}}function a(w,tt){w.needsHillshadePrepare=!0;var et=tt.tileID.canonical.x-w.tileID.canonical.x,rt=tt.tileID.canonical.y-w.tileID.canonical.y,it=Math.pow(2,w.tileID.canonical.z),nt=tt.tileID.key;0===et&&0===rt||Math.abs(rt)>1||(Math.abs(et)>1&&(1===Math.abs(et+it)?et+=it:1===Math.abs(et-it)&&(et-=it)),tt.dem&&w.dem&&(w.dem.backfillBorder(tt.dem,et,rt),w.neighboringTiles&&w.neighboringTiles[nt]&&(w.neighboringTiles[nt].backfilled=!0)))}},i.prototype.getTile=function(w){return this.getTileByID(w.key)},i.prototype.getTileByID=function(tt){return(this||w)._tiles[tt]},i.prototype._retainLoadedChildren=function(tt,et,rt,it){for(var nt in(this||w)._tiles){var ot=(this||w)._tiles[nt];if(!(it[nt]||!ot.hasData()||ot.tileID.overscaledZ<=et||ot.tileID.overscaledZ>rt)){for(var at=ot.tileID;ot&&ot.tileID.overscaledZ>et+1;){var st=ot.tileID.scaledTo(ot.tileID.overscaledZ-1);(ot=(this||w)._tiles[st.key])&&ot.hasData()&&(at=st)}for(var ct=at;ct.overscaledZ>et;)if(tt[(ct=ct.scaledTo(ct.overscaledZ-1)).key]){it[at.key]=at;break}}}},i.prototype.findLoadedParent=function(tt,et){if(tt.key in(this||w)._loadedParentTiles){var rt=(this||w)._loadedParentTiles[tt.key];return rt&&rt.tileID.overscaledZ>=et?rt:null}for(var it=tt.overscaledZ-1;it>=et;it--){var nt=tt.scaledTo(it),ot=this._getLoadedTile(nt);if(ot)return ot}},i.prototype._getLoadedTile=function(tt){var et=(this||w)._tiles[tt.key];return et&&et.hasData()?et:(this||w)._cache.getByKey(tt.wrapped().key)},i.prototype.updateCacheSize=function(tt){var et=Math.ceil(tt.width/(this||w)._source.tileSize)+1,rt=Math.ceil(tt.height/(this||w)._source.tileSize)+1,it=Math.floor(et*rt*5),nt="number"==typeof(this||w)._maxTileCacheSize?Math.min((this||w)._maxTileCacheSize,it):it;(this||w)._cache.setMaxSize(nt)},i.prototype.handleWrapJump=function(tt){var et=Math.round((tt-(void 0===(this||w)._prevLng?tt:(this||w)._prevLng))/360);if((this||w)._prevLng=tt,et){var rt={};for(var it in(this||w)._tiles){var nt=(this||w)._tiles[it];nt.tileID=nt.tileID.unwrapTo(nt.tileID.wrap+et),rt[nt.tileID.key]=nt}for(var ot in(this||w)._tiles=rt,(this||w)._timers)clearTimeout((this||w)._timers[ot]),delete(this||w)._timers[ot];for(var at in(this||w)._tiles)this._setTileReloadTimer(at,(this||w)._tiles[at])}},i.prototype.update=function(et){var rt=this||w;if((this||w).transform=et,(this||w)._sourceLoaded&&!(this||w)._paused){var it;this.updateCacheSize(et),this.handleWrapJump((this||w).transform.center.lng),(this||w)._coveredTiles={},(this||w).used?(this||w)._source.tileID?it=et.getVisibleUnwrappedCoordinates((this||w)._source.tileID).map((function(w){return new tt.OverscaledTileID(w.canonical.z,w.wrap,w.canonical.z,w.canonical.x,w.canonical.y)})):(it=et.coveringTiles({tileSize:(this||w)._source.tileSize,minzoom:(this||w)._source.minzoom,maxzoom:(this||w)._source.maxzoom,roundZoom:(this||w)._source.roundZoom,reparseOverscaled:(this||w)._source.reparseOverscaled}),(this||w)._source.hasTile&&(it=it.filter((function(w){return rt._source.hasTile(w)})))):it=[];var nt=et.coveringZoomLevel((this||w)._source),ot=Math.max(nt-i.maxOverzooming,(this||w)._source.minzoom),at=Math.max(nt+i.maxUnderzooming,(this||w)._source.minzoom),st=this._updateRetainedTiles(it,nt);if(Lt((this||w)._source.type)){for(var ct={},pt={},ft=0,dt=Object.keys(st);ft<dt.length;ft+=1){var mt=dt[ft],yt=st[mt],vt=(this||w)._tiles[mt];if(vt&&!(vt.fadeEndTime&&vt.fadeEndTime<=tt.browser.now())){var Dt=this.findLoadedParent(yt,ot);Dt&&(this._addTile(Dt.tileID),ct[Dt.tileID.key]=Dt.tileID),pt[mt]=yt}}for(var Rt in this._retainLoadedChildren(pt,nt,at,st),ct)st[Rt]||((this||w)._coveredTiles[Rt]=!0,st[Rt]=ct[Rt])}for(var Bt in st)(this||w)._tiles[Bt].clearFadeHold();for(var Ot=0,Ne=tt.keysDifference((this||w)._tiles,st);Ot<Ne.length;Ot+=1){var Ze=Ne[Ot],Ge=(this||w)._tiles[Ze];Ge.hasSymbolBuckets&&!Ge.holdingForFade()?Ge.setHoldDuration((this||w).map._fadeDuration):Ge.hasSymbolBuckets&&!Ge.symbolFadeFinished()||this._removeTile(Ze)}this._updateLoadedParentTileCache()}},i.prototype.releaseSymbolFadeTiles=function(){for(var tt in(this||w)._tiles)(this||w)._tiles[tt].holdingForFade()&&this._removeTile(tt)},i.prototype._updateRetainedTiles=function(tt,et){for(var rt={},it={},nt=Math.max(et-i.maxOverzooming,(this||w)._source.minzoom),ot=Math.max(et+i.maxUnderzooming,(this||w)._source.minzoom),at={},st=0,ct=tt;st<ct.length;st+=1){var pt=ct[st],ft=this._addTile(pt);rt[pt.key]=pt,ft.hasData()||et<(this||w)._source.maxzoom&&(at[pt.key]=pt)}this._retainLoadedChildren(at,et,ot,rt);for(var dt=0,mt=tt;dt<mt.length;dt+=1){var yt=mt[dt],vt=(this||w)._tiles[yt.key];if(!vt.hasData()){if(et+1>(this||w)._source.maxzoom){var Dt=yt.children((this||w)._source.maxzoom)[0],Rt=this.getTile(Dt);if(Rt&&Rt.hasData()){rt[Dt.key]=Dt;continue}}else{var Bt=yt.children((this||w)._source.maxzoom);if(rt[Bt[0].key]&&rt[Bt[1].key]&&rt[Bt[2].key]&&rt[Bt[3].key])continue}for(var Ot=vt.wasRequested(),Ne=yt.overscaledZ-1;Ne>=nt;--Ne){var Ze=yt.scaledTo(Ne);if(it[Ze.key])break;if(it[Ze.key]=!0,!(vt=this.getTile(Ze))&&Ot&&(vt=this._addTile(Ze)),vt&&(rt[Ze.key]=Ze,Ot=vt.wasRequested(),vt.hasData()))break}}}return rt},i.prototype._updateLoadedParentTileCache=function(){for(var tt in(this||w)._loadedParentTiles={},(this||w)._tiles){for(var et=[],rt=void 0,it=(this||w)._tiles[tt].tileID;it.overscaledZ>0;){if(it.key in(this||w)._loadedParentTiles){rt=(this||w)._loadedParentTiles[it.key];break}et.push(it.key);var nt=it.scaledTo(it.overscaledZ-1);if(rt=this._getLoadedTile(nt))break;it=nt}for(var ot=0,at=et;ot<at.length;ot+=1)(this||w)._loadedParentTiles[at[ot]]=rt}},i.prototype._addTile=function(et){var rt=(this||w)._tiles[et.key];if(rt)return rt;(rt=(this||w)._cache.getAndRemove(et))&&(this._setTileReloadTimer(et.key,rt),rt.tileID=et,(this||w)._state.initializeTileState(rt,(this||w).map?(this||w).map.painter:null),(this||w)._cacheTimers[et.key]&&(clearTimeout((this||w)._cacheTimers[et.key]),delete(this||w)._cacheTimers[et.key],this._setTileReloadTimer(et.key,rt)));var it=Boolean(rt);return it||(rt=new tt.Tile(et,(this||w)._source.tileSize*et.overscaleFactor()),this._loadTile(rt,(this||w)._tileLoaded.bind(this||w,rt,et.key,rt.state))),rt?(rt.uses++,(this||w)._tiles[et.key]=rt,it||(this||w)._source.fire(new tt.Event("dataloading",{tile:rt,coord:rt.tileID,dataType:"source"})),rt):null},i.prototype._setTileReloadTimer=function(tt,et){var rt=this||w;tt in(this||w)._timers&&(clearTimeout((this||w)._timers[tt]),delete(this||w)._timers[tt]);var it=et.getExpiryTimeout();it&&((this||w)._timers[tt]=setTimeout((function(){rt._reloadTile(tt,"expired"),delete rt._timers[tt]}),it))},i.prototype._removeTile=function(tt){var et=(this||w)._tiles[tt];et&&(et.uses--,delete(this||w)._tiles[tt],(this||w)._timers[tt]&&(clearTimeout((this||w)._timers[tt]),delete(this||w)._timers[tt]),et.uses>0||(et.hasData()&&"reloading"!==et.state?(this||w)._cache.add(et.tileID,et,et.getExpiryTimeout()):(et.aborted=!0,this._abortTile(et),this._unloadTile(et))))},i.prototype.clearTiles=function(){for(var tt in(this||w)._shouldReloadOnResume=!1,(this||w)._paused=!1,(this||w)._tiles)this._removeTile(tt);(this||w)._cache.reset()},i.prototype.tilesIn=function(et,rt,it){var nt=this||w,ot=[],at=(this||w).transform;if(!at)return ot;for(var st=it?at.getCameraQueryGeometry(et):et,ct=et.map((function(w){return at.pointCoordinate(w)})),pt=st.map((function(w){return at.pointCoordinate(w)})),ft=this.getIds(),dt=1/0,mt=1/0,yt=-1/0,vt=-1/0,Dt=0,Rt=pt;Dt<Rt.length;Dt+=1){var Bt=Rt[Dt];dt=Math.min(dt,Bt.x),mt=Math.min(mt,Bt.y),yt=Math.max(yt,Bt.x),vt=Math.max(vt,Bt.y)}for(var v=function(w){var et=nt._tiles[ft[w]];if(!et.holdingForFade()){var it=et.tileID,st=Math.pow(2,at.zoom-et.tileID.overscaledZ),Dt=rt*et.queryPadding*tt.EXTENT/et.tileSize/st,Rt=[it.getTilePoint(new tt.MercatorCoordinate(dt,mt)),it.getTilePoint(new tt.MercatorCoordinate(yt,vt))];if(Rt[0].x-Dt<tt.EXTENT&&Rt[0].y-Dt<tt.EXTENT&&Rt[1].x+Dt>=0&&Rt[1].y+Dt>=0){var Bt=ct.map((function(w){return it.getTilePoint(w)})),Ot=pt.map((function(w){return it.getTilePoint(w)}));ot.push({tile:et,tileID:it,queryGeometry:Bt,cameraQueryGeometry:Ot,scale:st})}}},Ot=0;Ot<ft.length;Ot++)v(Ot);return ot},i.prototype.getVisibleCoordinates=function(tt){for(var et=this||w,rt=this.getRenderableIds(tt).map((function(w){return et._tiles[w].tileID})),it=0,nt=rt;it<nt.length;it+=1){var ot=nt[it];ot.posMatrix=(this||w).transform.calculatePosMatrix(ot.toUnwrapped())}return rt},i.prototype.hasTransition=function(){if((this||w)._source.hasTransition())return!0;if(Lt((this||w)._source.type))for(var et in(this||w)._tiles){var rt=(this||w)._tiles[et];if(void 0!==rt.fadeEndTime&&rt.fadeEndTime>=tt.browser.now())return!0}return!1},i.prototype.setFeatureState=function(tt,et,rt){(this||w)._state.updateState(tt=tt||"_geojsonTileLayer",et,rt)},i.prototype.removeFeatureState=function(tt,et,rt){(this||w)._state.removeFeatureState(tt=tt||"_geojsonTileLayer",et,rt)},i.prototype.getFeatureState=function(tt,et){return(this||w)._state.getState(tt=tt||"_geojsonTileLayer",et)},i.prototype.setDependencies=function(tt,et,rt){var it=(this||w)._tiles[tt];it&&it.setDependencies(et,rt)},i.prototype.reloadTilesForDependencies=function(tt,et){for(var rt in(this||w)._tiles)(this||w)._tiles[rt].hasDependency(tt,et)&&this._reloadTile(rt,"reloading");(this||w)._cache.filter((function(w){return!w.hasDependency(tt,et)}))},i}(tt.Evented);function Mt(w,tt){var et=Math.abs(2*w.wrap)-+(w.wrap<0),rt=Math.abs(2*tt.wrap)-+(tt.wrap<0);return w.overscaledZ-tt.overscaledZ||rt-et||tt.canonical.y-w.canonical.y||tt.canonical.x-w.canonical.x}function Lt(w){return"raster"===w||"image"===w||"video"===w}function At(){return new tt.window.Worker(Ic.workerUrl)}la.maxOverzooming=10,la.maxUnderzooming=3;var ua="mapboxgl_preloaded_worker_pool",kt=function(){(this||w).active={}};kt.prototype.acquire=function(tt){if(!(this||w).workers)for((this||w).workers=[];(this||w).workers.length<kt.workerCount;)(this||w).workers.push(new At);return(this||w).active[tt]=!0,(this||w).workers.slice()},kt.prototype.release=function(tt){delete(this||w).active[tt],0===this.numActive()&&((this||w).workers.forEach((function(w){w.terminate()})),(this||w).workers=null)},kt.prototype.isPreloaded=function(){return!!(this||w).active[ua]},kt.prototype.numActive=function(){return Object.keys((this||w).active).length};var ca,pa=Math.floor(tt.browser.hardwareConcurrency/2);function Ft(){return ca||(ca=new kt),ca}function Ut(w,et){var rt={};for(var it in w)"ref"!==it&&(rt[it]=w[it]);return tt.refProperties.forEach((function(w){w in et&&(rt[w]=et[w])})),rt}function Nt(w){w=w.slice();for(var tt=Object.create(null),et=0;et<w.length;et++)tt[w[et].id]=w[et];for(var rt=0;rt<w.length;rt++)"ref"in w[rt]&&(w[rt]=Ut(w[rt],tt[w[rt].ref]));return w}kt.workerCount=Math.max(Math.min(pa,6),1);var fa={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function jt(w,tt,et){et.push({command:fa.addSource,args:[w,tt[w]]})}function qt(w,tt,et){tt.push({command:fa.removeSource,args:[w]}),et[w]=!0}function Vt(w,tt,et,rt){qt(w,et,rt),jt(w,tt,et)}function Gt(w,et,rt){var it;for(it in w[rt])if(w[rt].hasOwnProperty(it)&&"data"!==it&&!tt.deepEqual(w[rt][it],et[rt][it]))return!1;for(it in et[rt])if(et[rt].hasOwnProperty(it)&&"data"!==it&&!tt.deepEqual(w[rt][it],et[rt][it]))return!1;return!0}function Wt(w,et,rt,it,nt,ot){var at;for(at in et=et||{},w=w||{})w.hasOwnProperty(at)&&(tt.deepEqual(w[at],et[at])||rt.push({command:ot,args:[it,at,et[at],nt]}));for(at in et)et.hasOwnProperty(at)&&!w.hasOwnProperty(at)&&(tt.deepEqual(w[at],et[at])||rt.push({command:ot,args:[it,at,et[at],nt]}))}function Xt(w){return w.id}function Ht(w,tt){return w[tt.id]=tt,w}var Kt=function(w,tt){this.reset(w,tt)};Kt.prototype.reset=function(tt,et){(this||w).points=tt||[],(this||w)._distances=[0];for(var rt=1;rt<(this||w).points.length;rt++)(this||w)._distances[rt]=(this||w)._distances[rt-1]+(this||w).points[rt].dist((this||w).points[rt-1]);(this||w).length=(this||w)._distances[(this||w)._distances.length-1],(this||w).padding=Math.min(et||0,.5*(this||w).length),(this||w).paddedLength=(this||w).length-2*(this||w).padding},Kt.prototype.lerp=function(et){if(1===(this||w).points.length)return(this||w).points[0];et=tt.clamp(et,0,1);for(var rt=1,it=(this||w)._distances[rt],nt=et*(this||w).paddedLength+(this||w).padding;it<nt&&rt<(this||w)._distances.length;)it=(this||w)._distances[++rt];var ot=rt-1,at=(this||w)._distances[ot],st=it-at,ct=st>0?(nt-at)/st:0;return(this||w).points[ot].mult(1-ct).add((this||w).points[rt].mult(ct))};var Yt=function(tt,et,rt){var it=(this||w).boxCells=[],nt=(this||w).circleCells=[];(this||w).xCellCount=Math.ceil(tt/rt),(this||w).yCellCount=Math.ceil(et/rt);for(var ot=0;ot<(this||w).xCellCount*(this||w).yCellCount;ot++)it.push([]),nt.push([]);(this||w).circleKeys=[],(this||w).boxKeys=[],(this||w).bboxes=[],(this||w).circles=[],(this||w).width=tt,(this||w).height=et,(this||w).xScale=(this||w).xCellCount/tt,(this||w).yScale=(this||w).yCellCount/et,(this||w).boxUid=0,(this||w).circleUid=0};function Jt(w,et,rt,it,nt){var ot=tt.create();return et?(tt.scale(ot,ot,[1/nt,1/nt,1]),rt||tt.rotateZ(ot,ot,it.angle)):tt.multiply(ot,it.labelPlaneMatrix,w),ot}function Qt(w,et,rt,it,nt){if(et){var ot=tt.clone(w);return tt.scale(ot,ot,[nt,nt,1]),rt||tt.rotateZ(ot,ot,-it.angle),ot}return it.glCoordMatrix}function $t(w,et){var rt=[w.x,w.y,0,1];ue(rt,rt,et);var it=rt[3];return{point:new tt.Point(rt[0]/it,rt[1]/it),signedDistanceFromCamera:it}}function te(w,tt){return.5+w/tt*.5}function ee(w,tt){var et=w[0]/w[3],rt=w[1]/w[3];return et>=-tt[0]&&et<=tt[0]&&rt>=-tt[1]&&rt<=tt[1]}function ie(w,et,rt,it,nt,ot,at,st){var ct=it?w.textSizeData:w.iconSizeData,pt=tt.evaluateSizeForZoom(ct,rt.transform.zoom),ft=[256/rt.width*2+1,256/rt.height*2+1],dt=it?w.text.dynamicLayoutVertexArray:w.icon.dynamicLayoutVertexArray;dt.clear();for(var mt=w.lineVertexArray,yt=it?w.text.placedSymbolArray:w.icon.placedSymbolArray,vt=rt.transform.width/rt.transform.height,Dt=!1,Rt=0;Rt<yt.length;Rt++){var Bt=yt.get(Rt);if(Bt.hidden||Bt.writingMode===tt.WritingMode.vertical&&!Dt)ce(Bt.numGlyphs,dt);else{Dt=!1;var Ot=[Bt.anchorX,Bt.anchorY,0,1];if(tt.transformMat4(Ot,Ot,et),ee(Ot,ft)){var Ne=te(rt.transform.cameraToCenterDistance,Ot[3]),Ze=tt.evaluateSizeForFeature(ct,pt,Bt),Ge=at?Ze/Ne:Ze*Ne,Ke=new tt.Point(Bt.anchorX,Bt.anchorY),er=$t(Ke,nt).point,rr={},vr=ae(Bt,Ge,!1,st,et,nt,ot,w.glyphOffsetArray,mt,dt,er,Ke,rr,vt);Dt=vr.useVertical,(vr.notEnoughRoom||Dt||vr.needsFlipping&&ae(Bt,Ge,!0,st,et,nt,ot,w.glyphOffsetArray,mt,dt,er,Ke,rr,vt).notEnoughRoom)&&ce(Bt.numGlyphs,dt)}else ce(Bt.numGlyphs,dt)}}it?w.text.dynamicLayoutVertexBuffer.updateData(dt):w.icon.dynamicLayoutVertexBuffer.updateData(dt)}function oe(w,tt,et,rt,it,nt,ot,at,st,ct,pt){var ft=at.glyphStartIndex+at.numGlyphs,dt=at.lineStartIndex,mt=at.lineStartIndex+at.lineLength,yt=tt.getoffsetX(at.glyphStartIndex),vt=tt.getoffsetX(ft-1),Dt=se(w*yt,et,rt,it,nt,ot,at.segment,dt,mt,st,ct,pt);if(!Dt)return null;var Rt=se(w*vt,et,rt,it,nt,ot,at.segment,dt,mt,st,ct,pt);return Rt?{first:Dt,last:Rt}:null}function re(w,et,rt,it){return w===tt.WritingMode.horizontal&&Math.abs(rt.y-et.y)>Math.abs(rt.x-et.x)*it?{useVertical:!0}:(w===tt.WritingMode.vertical?et.y<rt.y:et.x>rt.x)?{needsFlipping:!0}:null}function ae(w,et,rt,it,nt,ot,at,st,ct,pt,ft,dt,mt,yt){var vt,Dt=et/24,Rt=w.lineOffsetX*Dt,Bt=w.lineOffsetY*Dt;if(w.numGlyphs>1){var Ot=w.glyphStartIndex+w.numGlyphs,Ne=w.lineStartIndex,Ze=w.lineStartIndex+w.lineLength,Ge=oe(Dt,st,Rt,Bt,rt,ft,dt,w,ct,ot,mt);if(!Ge)return{notEnoughRoom:!0};var Ke=$t(Ge.first.point,at).point,er=$t(Ge.last.point,at).point;if(it&&!rt){var rr=re(w.writingMode,Ke,er,yt);if(rr)return rr}vt=[Ge.first];for(var vr=w.glyphStartIndex+1;vr<Ot-1;vr++)vt.push(se(Dt*st.getoffsetX(vr),Rt,Bt,rt,ft,dt,w.segment,Ne,Ze,ct,ot,mt));vt.push(Ge.last)}else{if(it&&!rt){var wr=$t(dt,nt).point,Sr=w.lineStartIndex+w.segment+1,ei=new tt.Point(ct.getx(Sr),ct.gety(Sr)),ii=$t(ei,nt),mi=ii.signedDistanceFromCamera>0?ii.point:ne(dt,ei,wr,1,nt),qi=re(w.writingMode,wr,mi,yt);if(qi)return qi}var Ki=se(Dt*st.getoffsetX(w.glyphStartIndex),Rt,Bt,rt,ft,dt,w.segment,w.lineStartIndex,w.lineStartIndex+w.lineLength,ct,ot,mt);if(!Ki)return{notEnoughRoom:!0};vt=[Ki]}for(var Ji=0,rn=vt;Ji<rn.length;Ji+=1){var vn=rn[Ji];tt.addDynamicAttributes(pt,vn.point,vn.angle)}return{}}function ne(w,tt,et,rt,it){var nt=$t(w.add(w.sub(tt)._unit()),it).point,ot=et.sub(nt);return et.add(ot._mult(rt/ot.mag()))}function se(w,et,rt,it,nt,ot,at,st,ct,pt,ft,dt){var mt=it?w-et:w+et,yt=mt>0?1:-1,vt=0;it&&(yt*=-1,vt=Math.PI),yt<0&&(vt+=Math.PI);for(var Dt=yt>0?st+at:st+at+1,Rt=nt,Bt=nt,Ot=0,Ne=0,Ze=Math.abs(mt),Ge=[];Ot+Ne<=Ze;){if((Dt+=yt)<st||Dt>=ct)return null;if(Bt=Rt,Ge.push(Rt),void 0===(Rt=dt[Dt])){var Ke=new tt.Point(pt.getx(Dt),pt.gety(Dt)),er=$t(Ke,ft);if(er.signedDistanceFromCamera>0)Rt=dt[Dt]=er.point;else{var rr=Dt-yt;Rt=ne(0===Ot?ot:new tt.Point(pt.getx(rr),pt.gety(rr)),Ke,Bt,Ze-Ot+1,ft)}}Ot+=Ne,Ne=Bt.dist(Rt)}var vr=(Ze-Ot)/Ne,wr=Rt.sub(Bt),Sr=wr.mult(vr)._add(Bt);Sr._add(wr._unit()._perp()._mult(rt*yt));var ei=vt+Math.atan2(Rt.y-Bt.y,Rt.x-Bt.x);return Ge.push(Sr),{point:Sr,angle:ei,path:Ge}}Yt.prototype.keysLength=function(){return(this||w).boxKeys.length+(this||w).circleKeys.length},Yt.prototype.insert=function(tt,et,rt,it,nt){this._forEachCell(et,rt,it,nt,(this||w)._insertBoxCell,(this||w).boxUid++),(this||w).boxKeys.push(tt),(this||w).bboxes.push(et),(this||w).bboxes.push(rt),(this||w).bboxes.push(it),(this||w).bboxes.push(nt)},Yt.prototype.insertCircle=function(tt,et,rt,it){this._forEachCell(et-it,rt-it,et+it,rt+it,(this||w)._insertCircleCell,(this||w).circleUid++),(this||w).circleKeys.push(tt),(this||w).circles.push(et),(this||w).circles.push(rt),(this||w).circles.push(it)},Yt.prototype._insertBoxCell=function(tt,et,rt,it,nt,ot){(this||w).boxCells[nt].push(ot)},Yt.prototype._insertCircleCell=function(tt,et,rt,it,nt,ot){(this||w).circleCells[nt].push(ot)},Yt.prototype._query=function(tt,et,rt,it,nt,ot){if(rt<0||tt>(this||w).width||it<0||et>(this||w).height)return!nt&&[];var at=[];if(tt<=0&&et<=0&&(this||w).width<=rt&&(this||w).height<=it){if(nt)return!0;for(var st=0;st<(this||w).boxKeys.length;st++)at.push({key:(this||w).boxKeys[st],x1:(this||w).bboxes[4*st],y1:(this||w).bboxes[4*st+1],x2:(this||w).bboxes[4*st+2],y2:(this||w).bboxes[4*st+3]});for(var ct=0;ct<(this||w).circleKeys.length;ct++){var pt=(this||w).circles[3*ct],ft=(this||w).circles[3*ct+1],dt=(this||w).circles[3*ct+2];at.push({key:(this||w).circleKeys[ct],x1:pt-dt,y1:ft-dt,x2:pt+dt,y2:ft+dt})}return ot?at.filter(ot):at}return this._forEachCell(tt,et,rt,it,(this||w)._queryCell,at,{hitTest:nt,seenUids:{box:{},circle:{}}},ot),nt?at.length>0:at},Yt.prototype._queryCircle=function(tt,et,rt,it,nt){var ot=tt-rt,at=tt+rt,st=et-rt,ct=et+rt;if(at<0||ot>(this||w).width||ct<0||st>(this||w).height)return!it&&[];var pt=[];return this._forEachCell(ot,st,at,ct,(this||w)._queryCellCircle,pt,{hitTest:it,circle:{x:tt,y:et,radius:rt},seenUids:{box:{},circle:{}}},nt),it?pt.length>0:pt},Yt.prototype.query=function(w,tt,et,rt,it){return this._query(w,tt,et,rt,!1,it)},Yt.prototype.hitTest=function(w,tt,et,rt,it){return this._query(w,tt,et,rt,!0,it)},Yt.prototype.hitTestCircle=function(w,tt,et,rt){return this._queryCircle(w,tt,et,!0,rt)},Yt.prototype._queryCell=function(tt,et,rt,it,nt,ot,at,st){var ct=at.seenUids,pt=(this||w).boxCells[nt];if(null!==pt)for(var ft=(this||w).bboxes,dt=0,mt=pt;dt<mt.length;dt+=1){var yt=mt[dt];if(!ct.box[yt]){ct.box[yt]=!0;var vt=4*yt;if(tt<=ft[vt+2]&&et<=ft[vt+3]&&rt>=ft[vt+0]&&it>=ft[vt+1]&&(!st||st((this||w).boxKeys[yt]))){if(at.hitTest)return ot.push(!0),!0;ot.push({key:(this||w).boxKeys[yt],x1:ft[vt],y1:ft[vt+1],x2:ft[vt+2],y2:ft[vt+3]})}}}var Dt=(this||w).circleCells[nt];if(null!==Dt)for(var Rt=(this||w).circles,Bt=0,Ot=Dt;Bt<Ot.length;Bt+=1){var Ne=Ot[Bt];if(!ct.circle[Ne]){ct.circle[Ne]=!0;var Ze=3*Ne;if(this._circleAndRectCollide(Rt[Ze],Rt[Ze+1],Rt[Ze+2],tt,et,rt,it)&&(!st||st((this||w).circleKeys[Ne]))){if(at.hitTest)return ot.push(!0),!0;var Ge=Rt[Ze],Ke=Rt[Ze+1],er=Rt[Ze+2];ot.push({key:(this||w).circleKeys[Ne],x1:Ge-er,y1:Ke-er,x2:Ge+er,y2:Ke+er})}}}},Yt.prototype._queryCellCircle=function(tt,et,rt,it,nt,ot,at,st){var ct=at.circle,pt=at.seenUids,ft=(this||w).boxCells[nt];if(null!==ft)for(var dt=(this||w).bboxes,mt=0,yt=ft;mt<yt.length;mt+=1){var vt=yt[mt];if(!pt.box[vt]){pt.box[vt]=!0;var Dt=4*vt;if(this._circleAndRectCollide(ct.x,ct.y,ct.radius,dt[Dt+0],dt[Dt+1],dt[Dt+2],dt[Dt+3])&&(!st||st((this||w).boxKeys[vt])))return ot.push(!0),!0}}var Rt=(this||w).circleCells[nt];if(null!==Rt)for(var Bt=(this||w).circles,Ot=0,Ne=Rt;Ot<Ne.length;Ot+=1){var Ze=Ne[Ot];if(!pt.circle[Ze]){pt.circle[Ze]=!0;var Ge=3*Ze;if(this._circlesCollide(Bt[Ge],Bt[Ge+1],Bt[Ge+2],ct.x,ct.y,ct.radius)&&(!st||st((this||w).circleKeys[Ze])))return ot.push(!0),!0}}},Yt.prototype._forEachCell=function(tt,et,rt,it,nt,ot,at,st){for(var ct=this._convertToXCellCoord(tt),pt=this._convertToYCellCoord(et),ft=this._convertToXCellCoord(rt),dt=this._convertToYCellCoord(it),mt=ct;mt<=ft;mt++)for(var yt=pt;yt<=dt;yt++)if(nt.call(this||w,tt,et,rt,it,(this||w).xCellCount*yt+mt,ot,at,st))return},Yt.prototype._convertToXCellCoord=function(tt){return Math.max(0,Math.min((this||w).xCellCount-1,Math.floor(tt*(this||w).xScale)))},Yt.prototype._convertToYCellCoord=function(tt){return Math.max(0,Math.min((this||w).yCellCount-1,Math.floor(tt*(this||w).yScale)))},Yt.prototype._circlesCollide=function(w,tt,et,rt,it,nt){var ot=rt-w,at=it-tt,st=et+nt;return st*st>ot*ot+at*at},Yt.prototype._circleAndRectCollide=function(w,tt,et,rt,it,nt,ot){var at=(nt-rt)/2,st=Math.abs(w-(rt+at));if(st>at+et)return!1;var ct=(ot-it)/2,pt=Math.abs(tt-(it+ct));if(pt>ct+et)return!1;if(st<=at||pt<=ct)return!0;var ft=st-at,dt=pt-ct;return ft*ft+dt*dt<=et*et};var ga=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ce(w,tt){for(var et=0;et<w;et++){var rt=tt.length;tt.resize(rt+4),tt.float32.set(ga,3*rt)}}function ue(w,tt,et){var rt=tt[0],it=tt[1];return w[0]=et[0]*rt+et[4]*it+et[12],w[1]=et[1]*rt+et[5]*it+et[13],w[3]=et[3]*rt+et[7]*it+et[15],w}var he=function(tt,et,rt){void 0===et&&(et=new Yt(tt.width+200,tt.height+200,25)),void 0===rt&&(rt=new Yt(tt.width+200,tt.height+200,25)),(this||w).transform=tt,(this||w).grid=et,(this||w).ignoredGrid=rt,(this||w).pitchfactor=Math.cos(tt._pitch)*tt.cameraToCenterDistance,(this||w).screenRightBoundary=tt.width+100,(this||w).screenBottomBoundary=tt.height+100,(this||w).gridRightBoundary=tt.width+200,(this||w).gridBottomBoundary=tt.height+200};function pe(w,et,rt){return et*(tt.EXTENT/(w.tileSize*Math.pow(2,rt-w.tileID.overscaledZ)))}he.prototype.placeCollisionBox=function(tt,et,rt,it,nt){var ot=this.projectAndGetPerspectiveRatio(it,tt.anchorPointX,tt.anchorPointY),at=rt*ot.perspectiveRatio,st=tt.x1*at+ot.point.x,ct=tt.y1*at+ot.point.y,pt=tt.x2*at+ot.point.x,ft=tt.y2*at+ot.point.y;return!this.isInsideGrid(st,ct,pt,ft)||!et&&(this||w).grid.hitTest(st,ct,pt,ft,nt)?{box:[],offscreen:!1}:{box:[st,ct,pt,ft],offscreen:this.isOffscreen(st,ct,pt,ft)}},he.prototype.placeCollisionCircles=function(et,rt,it,nt,ot,at,st,ct,pt,ft,dt,mt,yt){var vt=[],Dt=new tt.Point(rt.anchorX,rt.anchorY),Rt=$t(Dt,at),Bt=te((this||w).transform.cameraToCenterDistance,Rt.signedDistanceFromCamera),Ot=(ft?ot/Bt:ot*Bt)/tt.ONE_EM,Ne=$t(Dt,st).point,Ze=oe(Ot,nt,rt.lineOffsetX*Ot,rt.lineOffsetY*Ot,!1,Ne,Dt,rt,it,st,{}),Ge=!1,Ke=!1,er=!0;if(Ze){for(var rr=.5*mt*Bt+yt,vr=new tt.Point(-100,-100),wr=new tt.Point((this||w).screenRightBoundary,(this||w).screenBottomBoundary),Sr=new Kt,ei=Ze.first,ii=Ze.last,mi=[],qi=ei.path.length-1;qi>=1;qi--)mi.push(ei.path[qi]);for(var Ki=1;Ki<ii.path.length;Ki++)mi.push(ii.path[Ki]);var Ji=2.5*rr;if(ct){var rn=mi.map((function(w){return $t(w,ct)}));mi=rn.some((function(w){return w.signedDistanceFromCamera<=0}))?[]:rn.map((function(w){return w.point}))}var vn=[];if(mi.length>0){for(var bn=mi[0].clone(),Tn=mi[0].clone(),In=1;In<mi.length;In++)bn.x=Math.min(bn.x,mi[In].x),bn.y=Math.min(bn.y,mi[In].y),Tn.x=Math.max(Tn.x,mi[In].x),Tn.y=Math.max(Tn.y,mi[In].y);vn=bn.x>=vr.x&&Tn.x<=wr.x&&bn.y>=vr.y&&Tn.y<=wr.y?[mi]:Tn.x<vr.x||bn.x>wr.x||Tn.y<vr.y||bn.y>wr.y?[]:tt.clipLine([mi],vr.x,vr.y,wr.x,wr.y)}for(var zn=0,Cn=vn;zn<Cn.length;zn+=1){var Mn;Sr.reset(Cn[zn],.25*rr),Mn=Sr.length<=.5*rr?1:Math.ceil(Sr.paddedLength/Ji)+1;for(var Ln=0;Ln<Mn;Ln++){var Bn=Ln/Math.max(Mn-1,1),Fn=Sr.lerp(Bn),Vn=Fn.x+100,Nn=Fn.y+100;vt.push(Vn,Nn,rr,0);var Wn=Vn-rr,Yn=Nn-rr,$n=Vn+rr,uo=Nn+rr;if(er=er&&this.isOffscreen(Wn,Yn,$n,uo),Ke=Ke||this.isInsideGrid(Wn,Yn,$n,uo),!et&&(this||w).grid.hitTestCircle(Vn,Nn,rr,dt)&&(Ge=!0,!pt))return{circles:[],offscreen:!1,collisionDetected:Ge}}}}return{circles:!pt&&Ge||!Ke?[]:vt,offscreen:er,collisionDetected:Ge}},he.prototype.queryRenderedSymbols=function(et){if(0===et.length||0===(this||w).grid.keysLength()&&0===(this||w).ignoredGrid.keysLength())return{};for(var rt=[],it=1/0,nt=1/0,ot=-1/0,at=-1/0,st=0,ct=et;st<ct.length;st+=1){var pt=ct[st],ft=new tt.Point(pt.x+100,pt.y+100);it=Math.min(it,ft.x),nt=Math.min(nt,ft.y),ot=Math.max(ot,ft.x),at=Math.max(at,ft.y),rt.push(ft)}for(var dt={},mt={},yt=0,vt=(this||w).grid.query(it,nt,ot,at).concat((this||w).ignoredGrid.query(it,nt,ot,at));yt<vt.length;yt+=1){var Dt=vt[yt],Rt=Dt.key;if(void 0===dt[Rt.bucketInstanceId]&&(dt[Rt.bucketInstanceId]={}),!dt[Rt.bucketInstanceId][Rt.featureIndex]){var Bt=[new tt.Point(Dt.x1,Dt.y1),new tt.Point(Dt.x2,Dt.y1),new tt.Point(Dt.x2,Dt.y2),new tt.Point(Dt.x1,Dt.y2)];tt.polygonIntersectsPolygon(rt,Bt)&&(dt[Rt.bucketInstanceId][Rt.featureIndex]=!0,void 0===mt[Rt.bucketInstanceId]&&(mt[Rt.bucketInstanceId]=[]),mt[Rt.bucketInstanceId].push(Rt.featureIndex))}}return mt},he.prototype.insertCollisionBox=function(tt,et,rt,it,nt){(et?(this||w).ignoredGrid:(this||w).grid).insert({bucketInstanceId:rt,featureIndex:it,collisionGroupID:nt},tt[0],tt[1],tt[2],tt[3])},he.prototype.insertCollisionCircles=function(tt,et,rt,it,nt){for(var ot=et?(this||w).ignoredGrid:(this||w).grid,at={bucketInstanceId:rt,featureIndex:it,collisionGroupID:nt},st=0;st<tt.length;st+=4)ot.insertCircle(at,tt[st],tt[st+1],tt[st+2])},he.prototype.projectAndGetPerspectiveRatio=function(et,rt,it){var nt=[rt,it,0,1];return ue(nt,nt,et),{point:new tt.Point((nt[0]/nt[3]+1)/2*(this||w).transform.width+100,(-nt[1]/nt[3]+1)/2*(this||w).transform.height+100),perspectiveRatio:.5+(this||w).transform.cameraToCenterDistance/nt[3]*.5}},he.prototype.isOffscreen=function(tt,et,rt,it){return rt<100||tt>=(this||w).screenRightBoundary||it<100||et>(this||w).screenBottomBoundary},he.prototype.isInsideGrid=function(tt,et,rt,it){return rt>=0&&tt<(this||w).gridRightBoundary&&it>=0&&et<(this||w).gridBottomBoundary},he.prototype.getViewportMatrix=function(){var w=tt.identity([]);return tt.translate(w,w,[-100,-100,0]),w};var de=function(tt,et,rt,it){(this||w).opacity=tt?Math.max(0,Math.min(1,tt.opacity+(tt.placed?et:-et))):it&&rt?1:0,(this||w).placed=rt};de.prototype.isHidden=function(){return 0===(this||w).opacity&&!(this||w).placed};var _e=function(tt,et,rt,it,nt){(this||w).text=new de(tt?tt.text:null,et,rt,nt),(this||w).icon=new de(tt?tt.icon:null,et,it,nt)};_e.prototype.isHidden=function(){return(this||w).text.isHidden()&&(this||w).icon.isHidden()};var fe=function(tt,et,rt){(this||w).text=tt,(this||w).icon=et,(this||w).skipFade=rt},me=function(){(this||w).invProjMatrix=tt.create(),(this||w).viewportMatrix=tt.create(),(this||w).circles=[]},ge=function(tt,et,rt,it,nt){(this||w).bucketInstanceId=tt,(this||w).featureIndex=et,(this||w).sourceLayerIndex=rt,(this||w).bucketIndex=it,(this||w).tileID=nt},ve=function(tt){(this||w).crossSourceCollisions=tt,(this||w).maxGroupID=0,(this||w).collisionGroups={}};function ye(w,et,rt,it,nt){var ot=tt.getAnchorAlignment(w),at=-(ot.horizontalAlign-.5)*et,st=-(ot.verticalAlign-.5)*rt,ct=tt.evaluateVariableOffset(w,it);return new tt.Point(at+ct[0]*nt,st+ct[1]*nt)}function xe(w,et,rt,it,nt,ot){var at=w.x1,st=w.x2,ct=w.y1,pt=w.y2,ft=w.anchorPointX,dt=w.anchorPointY,mt=new tt.Point(et,rt);return it&&mt._rotate(nt?ot:-ot),{x1:at+mt.x,y1:ct+mt.y,x2:st+mt.x,y2:pt+mt.y,anchorPointX:ft,anchorPointY:dt}}ve.prototype.get=function(tt){if((this||w).crossSourceCollisions)return{ID:0,predicate:null};if(!(this||w).collisionGroups[tt]){var et=++(this||w).maxGroupID;(this||w).collisionGroups[tt]={ID:et,predicate:function(w){return w.collisionGroupID===et}}}return(this||w).collisionGroups[tt]};var be=function(tt,et,rt,it){(this||w).transform=tt.clone(),(this||w).collisionIndex=new he((this||w).transform),(this||w).placements={},(this||w).opacities={},(this||w).variableOffsets={},(this||w).stale=!1,(this||w).commitTime=0,(this||w).fadeDuration=et,(this||w).retainedQueryData={},(this||w).collisionGroups=new ve(rt),(this||w).collisionCircleArrays={},(this||w).prevPlacement=it,it&&(it.prevPlacement=void 0),(this||w).placedOrientations={}};function we(w,tt,et,rt,it){w.emplaceBack(tt?1:0,et?1:0,rt||0,it||0),w.emplaceBack(tt?1:0,et?1:0,rt||0,it||0),w.emplaceBack(tt?1:0,et?1:0,rt||0,it||0),w.emplaceBack(tt?1:0,et?1:0,rt||0,it||0)}be.prototype.getBucketParts=function(et,rt,it,nt){var ot=it.getBucket(rt),at=it.latestFeatureIndex;if(ot&&at&&rt.id===ot.layerIds[0]){var st=it.collisionBoxArray,ct=ot.layers[0].layout,pt=Math.pow(2,(this||w).transform.zoom-it.tileID.overscaledZ),ft=it.tileSize/tt.EXTENT,dt=(this||w).transform.calculatePosMatrix(it.tileID.toUnwrapped()),mt="map"===ct.get("text-pitch-alignment"),yt="map"===ct.get("text-rotation-alignment"),vt=pe(it,1,(this||w).transform.zoom),Dt=Jt(dt,mt,yt,(this||w).transform,vt),Rt=null;if(mt){var Bt=Qt(dt,mt,yt,(this||w).transform,vt);Rt=tt.multiply([],(this||w).transform.labelPlaneMatrix,Bt)}(this||w).retainedQueryData[ot.bucketInstanceId]=new ge(ot.bucketInstanceId,at,ot.sourceLayerIndex,ot.index,it.tileID);var Ot={bucket:ot,layout:ct,posMatrix:dt,textLabelPlaneMatrix:Dt,labelToScreenMatrix:Rt,scale:pt,textPixelRatio:ft,holdingForFade:it.holdingForFade(),collisionBoxArray:st,partiallyEvaluatedTextSize:tt.evaluateSizeForZoom(ot.textSizeData,(this||w).transform.zoom),collisionGroup:(this||w).collisionGroups.get(ot.sourceID)};if(nt)for(var Ne=0,Ze=ot.sortKeyRanges;Ne<Ze.length;Ne+=1){var Ge=Ze[Ne];et.push({sortKey:Ge.sortKey,symbolInstanceStart:Ge.symbolInstanceStart,symbolInstanceEnd:Ge.symbolInstanceEnd,parameters:Ot})}else et.push({symbolInstanceStart:0,symbolInstanceEnd:ot.symbolInstances.length,parameters:Ot})}},be.prototype.attemptAnchorPlacement=function(tt,et,rt,it,nt,ot,at,st,ct,pt,ft,dt,mt,yt,vt){var Dt,Rt=[dt.textOffset0,dt.textOffset1],Bt=ye(tt,rt,it,Rt,nt),Ot=(this||w).collisionIndex.placeCollisionBox(xe(et,Bt.x,Bt.y,ot,at,(this||w).transform.angle),ft,st,ct,pt.predicate);if(!vt||0!==(this||w).collisionIndex.placeCollisionBox(xe(vt,Bt.x,Bt.y,ot,at,(this||w).transform.angle),ft,st,ct,pt.predicate).box.length)return Ot.box.length>0?((this||w).prevPlacement&&(this||w).prevPlacement.variableOffsets[dt.crossTileID]&&(this||w).prevPlacement.placements[dt.crossTileID]&&(this||w).prevPlacement.placements[dt.crossTileID].text&&(Dt=(this||w).prevPlacement.variableOffsets[dt.crossTileID].anchor),(this||w).variableOffsets[dt.crossTileID]={textOffset:Rt,width:rt,height:it,anchor:tt,textBoxScale:nt,prevAnchor:Dt},this.markUsedJustification(mt,tt,dt,yt),mt.allowVerticalPlacement&&(this.markUsedOrientation(mt,yt,dt),(this||w).placedOrientations[dt.crossTileID]=yt),{shift:Bt,placedGlyphBoxes:Ot}):void 0},be.prototype.placeLayerBucketPart=function(et,rt,it){var nt=this||w,ot=et.parameters,at=ot.bucket,st=ot.layout,ct=ot.posMatrix,pt=ot.textLabelPlaneMatrix,ft=ot.labelToScreenMatrix,dt=ot.textPixelRatio,mt=ot.holdingForFade,yt=ot.collisionBoxArray,vt=ot.partiallyEvaluatedTextSize,Dt=ot.collisionGroup,Rt=st.get("text-optional"),Bt=st.get("icon-optional"),Ot=st.get("text-allow-overlap"),Ne=st.get("icon-allow-overlap"),Ze="map"===st.get("text-rotation-alignment"),Ge="map"===st.get("text-pitch-alignment"),Ke="none"!==st.get("icon-text-fit"),er="viewport-y"===st.get("symbol-z-order"),rr=Ot&&(Ne||!at.hasIconData()||Bt),vr=Ne&&(Ot||!at.hasTextData()||Rt);!at.collisionArrays&&yt&&at.deserializeCollisionBoxes(yt);var P=function(w,et){if(!rt[w.crossTileID])if(mt)nt.placements[w.crossTileID]=new fe(!1,!1,!1);else{var ot,yt=!1,er=!1,wr=!0,Sr=null,ei={box:null,offscreen:null},ii={box:null,offscreen:null},mi=null,qi=null,Ki=0,Ji=0,rn=0;et.textFeatureIndex?Ki=et.textFeatureIndex:w.useRuntimeCollisionCircles&&(Ki=w.featureIndex),et.verticalTextFeatureIndex&&(Ji=et.verticalTextFeatureIndex);var vn=et.textBox;if(vn){var O=function(et){var rt=tt.WritingMode.horizontal;if(at.allowVerticalPlacement&&!et&&nt.prevPlacement){var it=nt.prevPlacement.placedOrientations[w.crossTileID];it&&(nt.placedOrientations[w.crossTileID]=it,nt.markUsedOrientation(at,rt=it,w))}return rt},F=function(rt,it){if(at.allowVerticalPlacement&&w.numVerticalGlyphVertices>0&&et.verticalTextBox)for(var nt=0,ot=at.writingModes;nt<ot.length&&(ot[nt]===tt.WritingMode.vertical?(ei=it(),ii=ei):ei=rt(),!(ei&&ei.box&&ei.box.length));nt+=1);else ei=rt()};if(st.get("text-variable-anchor")){var bn=st.get("text-variable-anchor");if(nt.prevPlacement&&nt.prevPlacement.variableOffsets[w.crossTileID]){var Tn=nt.prevPlacement.variableOffsets[w.crossTileID];bn.indexOf(Tn.anchor)>0&&(bn=bn.filter((function(w){return w!==Tn.anchor}))).unshift(Tn.anchor)}var Z=function(tt,et,rt){for(var it=tt.x2-tt.x1,ot=tt.y2-tt.y1,st=w.textBoxScale,pt=Ke&&!Ne?et:null,ft={box:[],offscreen:!1},mt=Ot?2*bn.length:bn.length,vt=0;vt<mt;++vt){var Rt=nt.attemptAnchorPlacement(bn[vt%bn.length],tt,it,ot,st,Ze,Ge,dt,ct,Dt,vt>=bn.length,w,at,rt,pt);if(Rt&&(ft=Rt.placedGlyphBoxes)&&ft.box&&ft.box.length){yt=!0,Sr=Rt.shift;break}}return ft};F((function(){return Z(vn,et.iconBox,tt.WritingMode.horizontal)}),(function(){var rt=et.verticalTextBox;return at.allowVerticalPlacement&&!(ei&&ei.box&&ei.box.length)&&w.numVerticalGlyphVertices>0&&rt?Z(rt,et.verticalIconBox,tt.WritingMode.vertical):{box:null,offscreen:null}})),ei&&(yt=ei.box,wr=ei.offscreen);var In=O(ei&&ei.box);if(!yt&&nt.prevPlacement){var zn=nt.prevPlacement.variableOffsets[w.crossTileID];zn&&(nt.variableOffsets[w.crossTileID]=zn,nt.markUsedJustification(at,zn.anchor,w,In))}}else{var V=function(tt,et){var rt=nt.collisionIndex.placeCollisionBox(tt,Ot,dt,ct,Dt.predicate);return rt&&rt.box&&rt.box.length&&(nt.markUsedOrientation(at,et,w),nt.placedOrientations[w.crossTileID]=et),rt};F((function(){return V(vn,tt.WritingMode.horizontal)}),(function(){var rt=et.verticalTextBox;return at.allowVerticalPlacement&&w.numVerticalGlyphVertices>0&&rt?V(rt,tt.WritingMode.vertical):{box:null,offscreen:null}})),O(ei&&ei.box&&ei.box.length)}}if(yt=(ot=ei)&&ot.box&&ot.box.length>0,wr=ot&&ot.offscreen,w.useRuntimeCollisionCircles){var Cn=at.text.placedSymbolArray.get(w.centerJustifiedTextSymbolIndex),Mn=tt.evaluateSizeForFeature(at.textSizeData,vt,Cn),Ln=st.get("text-padding");mi=nt.collisionIndex.placeCollisionCircles(Ot,Cn,at.lineVertexArray,at.glyphOffsetArray,Mn,ct,pt,ft,it,Ge,Dt.predicate,w.collisionCircleDiameter,Ln),yt=Ot||mi.circles.length>0&&!mi.collisionDetected,wr=wr&&mi.offscreen}if(et.iconFeatureIndex&&(rn=et.iconFeatureIndex),et.iconBox){var H=function(w){var tt=Ke&&Sr?xe(w,Sr.x,Sr.y,Ze,Ge,nt.transform.angle):w;return nt.collisionIndex.placeCollisionBox(tt,Ne,dt,ct,Dt.predicate)};er=ii&&ii.box&&ii.box.length&&et.verticalIconBox?(qi=H(et.verticalIconBox)).box.length>0:(qi=H(et.iconBox)).box.length>0,wr=wr&&qi.offscreen}var Bn=Rt||0===w.numHorizontalGlyphVertices&&0===w.numVerticalGlyphVertices,Fn=Bt||0===w.numIconVertices;if(Bn||Fn?Fn?Bn||(er=er&&yt):yt=er&&yt:er=yt=er&&yt,yt&&ot&&ot.box&&nt.collisionIndex.insertCollisionBox(ot.box,st.get("text-ignore-placement"),at.bucketInstanceId,ii&&ii.box&&Ji?Ji:Ki,Dt.ID),er&&qi&&nt.collisionIndex.insertCollisionBox(qi.box,st.get("icon-ignore-placement"),at.bucketInstanceId,rn,Dt.ID),mi&&(yt&&nt.collisionIndex.insertCollisionCircles(mi.circles,st.get("text-ignore-placement"),at.bucketInstanceId,Ki,Dt.ID),it)){var Vn=at.bucketInstanceId,Nn=nt.collisionCircleArrays[Vn];void 0===Nn&&(Nn=nt.collisionCircleArrays[Vn]=new me);for(var Wn=0;Wn<mi.circles.length;Wn+=4)Nn.circles.push(mi.circles[Wn+0]),Nn.circles.push(mi.circles[Wn+1]),Nn.circles.push(mi.circles[Wn+2]),Nn.circles.push(mi.collisionDetected?1:0)}nt.placements[w.crossTileID]=new fe(yt||rr,er||vr,wr||at.justReloaded),rt[w.crossTileID]=!0}};if(er)for(var wr=at.getSortedSymbolIndexes((this||w).transform.angle),Sr=wr.length-1;Sr>=0;--Sr){var ei=wr[Sr];P(at.symbolInstances.get(ei),at.collisionArrays[ei])}else for(var ii=et.symbolInstanceStart;ii<et.symbolInstanceEnd;ii++)P(at.symbolInstances.get(ii),at.collisionArrays[ii]);if(it&&at.bucketInstanceId in(this||w).collisionCircleArrays){var mi=(this||w).collisionCircleArrays[at.bucketInstanceId];tt.invert(mi.invProjMatrix,ct),mi.viewportMatrix=(this||w).collisionIndex.getViewportMatrix()}at.justReloaded=!1},be.prototype.markUsedJustification=function(w,et,rt,it){var nt;nt=it===tt.WritingMode.vertical?rt.verticalPlacedTextSymbolIndex:{left:rt.leftJustifiedTextSymbolIndex,center:rt.centerJustifiedTextSymbolIndex,right:rt.rightJustifiedTextSymbolIndex}[tt.getAnchorJustification(et)];for(var ot=0,at=[rt.leftJustifiedTextSymbolIndex,rt.centerJustifiedTextSymbolIndex,rt.rightJustifiedTextSymbolIndex,rt.verticalPlacedTextSymbolIndex];ot<at.length;ot+=1){var st=at[ot];st>=0&&(w.text.placedSymbolArray.get(st).crossTileID=nt>=0&&st!==nt?0:rt.crossTileID)}},be.prototype.markUsedOrientation=function(w,et,rt){for(var it=et===tt.WritingMode.horizontal||et===tt.WritingMode.horizontalOnly?et:0,nt=et===tt.WritingMode.vertical?et:0,ot=0,at=[rt.leftJustifiedTextSymbolIndex,rt.centerJustifiedTextSymbolIndex,rt.rightJustifiedTextSymbolIndex];ot<at.length;ot+=1)w.text.placedSymbolArray.get(at[ot]).placedOrientation=it;rt.verticalPlacedTextSymbolIndex&&(w.text.placedSymbolArray.get(rt.verticalPlacedTextSymbolIndex).placedOrientation=nt)},be.prototype.commit=function(tt){(this||w).commitTime=tt,(this||w).zoomAtLastRecencyCheck=(this||w).transform.zoom;var et=(this||w).prevPlacement,rt=!1;(this||w).prevZoomAdjustment=et?et.zoomAdjustment((this||w).transform.zoom):0;var it=et?et.symbolFadeChange(tt):1,nt=et?et.opacities:{},ot=et?et.variableOffsets:{},at=et?et.placedOrientations:{};for(var st in(this||w).placements){var ct=(this||w).placements[st],pt=nt[st];pt?((this||w).opacities[st]=new _e(pt,it,ct.text,ct.icon),rt=rt||ct.text!==pt.text.placed||ct.icon!==pt.icon.placed):((this||w).opacities[st]=new _e(null,it,ct.text,ct.icon,ct.skipFade),rt=rt||ct.text||ct.icon)}for(var ft in nt){var dt=nt[ft];if(!(this||w).opacities[ft]){var mt=new _e(dt,it,!1,!1);mt.isHidden()||((this||w).opacities[ft]=mt,rt=rt||dt.text.placed||dt.icon.placed)}}for(var yt in ot)(this||w).variableOffsets[yt]||!(this||w).opacities[yt]||(this||w).opacities[yt].isHidden()||((this||w).variableOffsets[yt]=ot[yt]);for(var vt in at)(this||w).placedOrientations[vt]||!(this||w).opacities[vt]||(this||w).opacities[vt].isHidden()||((this||w).placedOrientations[vt]=at[vt]);rt?(this||w).lastPlacementChangeTime=tt:"number"!=typeof(this||w).lastPlacementChangeTime&&((this||w).lastPlacementChangeTime=et?et.lastPlacementChangeTime:tt)},be.prototype.updateLayerOpacities=function(w,tt){for(var et={},rt=0,it=tt;rt<it.length;rt+=1){var nt=it[rt],ot=nt.getBucket(w);ot&&nt.latestFeatureIndex&&w.id===ot.layerIds[0]&&this.updateBucketOpacities(ot,et,nt.collisionBoxArray)}},be.prototype.updateBucketOpacities=function(et,rt,it){var nt=this||w;et.hasTextData()&&et.text.opacityVertexArray.clear(),et.hasIconData()&&et.icon.opacityVertexArray.clear(),et.hasIconCollisionBoxData()&&et.iconCollisionBox.collisionVertexArray.clear(),et.hasTextCollisionBoxData()&&et.textCollisionBox.collisionVertexArray.clear();var ot=et.layers[0].layout,at=new _e(null,0,!1,!1,!0),st=ot.get("text-allow-overlap"),ct=ot.get("icon-allow-overlap"),pt=ot.get("text-variable-anchor"),ft="map"===ot.get("text-rotation-alignment"),dt="map"===ot.get("text-pitch-alignment"),mt="none"!==ot.get("icon-text-fit"),yt=new _e(null,0,st&&(ct||!et.hasIconData()||ot.get("icon-optional")),ct&&(st||!et.hasTextData()||ot.get("text-optional")),!0);!et.collisionArrays&&it&&(et.hasIconCollisionBoxData()||et.hasTextCollisionBoxData())&&et.deserializeCollisionBoxes(it);for(var _=function(w,tt,et){for(var rt=0;rt<tt/4;rt++)w.opacityVertexArray.emplaceBack(et)},f=function(w){var it=et.symbolInstances.get(w),ot=it.numHorizontalGlyphVertices,st=it.numVerticalGlyphVertices,ct=it.crossTileID,vt=nt.opacities[ct];rt[ct]?vt=at:vt||(nt.opacities[ct]=vt=yt),rt[ct]=!0;var Dt=it.numIconVertices>0,Rt=nt.placedOrientations[it.crossTileID],Bt=Rt===tt.WritingMode.vertical,Ot=Rt===tt.WritingMode.horizontal||Rt===tt.WritingMode.horizontalOnly;if(ot>0||st>0){var Ne=De(vt.text);_(et.text,ot,Bt?Da:Ne),_(et.text,st,Ot?Da:Ne);var Ze=vt.text.isHidden();[it.rightJustifiedTextSymbolIndex,it.centerJustifiedTextSymbolIndex,it.leftJustifiedTextSymbolIndex].forEach((function(w){w>=0&&(et.text.placedSymbolArray.get(w).hidden=Ze||Bt?1:0)})),it.verticalPlacedTextSymbolIndex>=0&&(et.text.placedSymbolArray.get(it.verticalPlacedTextSymbolIndex).hidden=Ze||Ot?1:0);var Ge=nt.variableOffsets[it.crossTileID];Ge&&nt.markUsedJustification(et,Ge.anchor,it,Rt);var Ke=nt.placedOrientations[it.crossTileID];Ke&&(nt.markUsedJustification(et,"left",it,Ke),nt.markUsedOrientation(et,Ke,it))}if(Dt){var er=De(vt.icon),rr=!(mt&&it.verticalPlacedIconSymbolIndex&&Bt);it.placedIconSymbolIndex>=0&&(_(et.icon,it.numIconVertices,rr?er:Da),et.icon.placedSymbolArray.get(it.placedIconSymbolIndex).hidden=vt.icon.isHidden()),it.verticalPlacedIconSymbolIndex>=0&&(_(et.icon,it.numVerticalIconVertices,rr?Da:er),et.icon.placedSymbolArray.get(it.verticalPlacedIconSymbolIndex).hidden=vt.icon.isHidden())}if(et.hasIconCollisionBoxData()||et.hasTextCollisionBoxData()){var vr=et.collisionArrays[w];if(vr){var wr=new tt.Point(0,0);if(vr.textBox||vr.verticalTextBox){var Sr=!0;if(pt){var ei=nt.variableOffsets[ct];ei?(wr=ye(ei.anchor,ei.width,ei.height,ei.textOffset,ei.textBoxScale),ft&&wr._rotate(dt?nt.transform.angle:-nt.transform.angle)):Sr=!1}vr.textBox&&we(et.textCollisionBox.collisionVertexArray,vt.text.placed,!Sr||Bt,wr.x,wr.y),vr.verticalTextBox&&we(et.textCollisionBox.collisionVertexArray,vt.text.placed,!Sr||Ot,wr.x,wr.y)}var ii=Boolean(!Ot&&vr.verticalIconBox);vr.iconBox&&we(et.iconCollisionBox.collisionVertexArray,vt.icon.placed,ii,mt?wr.x:0,mt?wr.y:0),vr.verticalIconBox&&we(et.iconCollisionBox.collisionVertexArray,vt.icon.placed,!ii,mt?wr.x:0,mt?wr.y:0)}}},vt=0;vt<et.symbolInstances.length;vt++)f(vt);if(et.sortFeatures((this||w).transform.angle),(this||w).retainedQueryData[et.bucketInstanceId]&&((this||w).retainedQueryData[et.bucketInstanceId].featureSortOrder=et.featureSortOrder),et.hasTextData()&&et.text.opacityVertexBuffer&&et.text.opacityVertexBuffer.updateData(et.text.opacityVertexArray),et.hasIconData()&&et.icon.opacityVertexBuffer&&et.icon.opacityVertexBuffer.updateData(et.icon.opacityVertexArray),et.hasIconCollisionBoxData()&&et.iconCollisionBox.collisionVertexBuffer&&et.iconCollisionBox.collisionVertexBuffer.updateData(et.iconCollisionBox.collisionVertexArray),et.hasTextCollisionBoxData()&&et.textCollisionBox.collisionVertexBuffer&&et.textCollisionBox.collisionVertexBuffer.updateData(et.textCollisionBox.collisionVertexArray),et.bucketInstanceId in(this||w).collisionCircleArrays){var Dt=(this||w).collisionCircleArrays[et.bucketInstanceId];et.placementInvProjMatrix=Dt.invProjMatrix,et.placementViewportMatrix=Dt.viewportMatrix,et.collisionCircleArray=Dt.circles,delete(this||w).collisionCircleArrays[et.bucketInstanceId]}},be.prototype.symbolFadeChange=function(tt){return 0===(this||w).fadeDuration?1:(tt-(this||w).commitTime)/(this||w).fadeDuration+(this||w).prevZoomAdjustment},be.prototype.zoomAdjustment=function(tt){return Math.max(0,((this||w).transform.zoom-tt)/1.5)},be.prototype.hasTransitions=function(tt){return(this||w).stale||tt-(this||w).lastPlacementChangeTime<(this||w).fadeDuration},be.prototype.stillRecent=function(tt,et){var rt=(this||w).zoomAtLastRecencyCheck===et?1-this.zoomAdjustment(et):1;return(this||w).zoomAtLastRecencyCheck=et,(this||w).commitTime+(this||w).fadeDuration*rt>tt},be.prototype.setStale=function(){(this||w).stale=!0};var _a=Math.pow(2,25),va=Math.pow(2,24),xa=Math.pow(2,17),ba=Math.pow(2,16),wa=Math.pow(2,9),Sa=Math.pow(2,8),Aa=Math.pow(2,1);function De(w){if(0===w.opacity&&!w.placed)return 0;if(1===w.opacity&&w.placed)return 4294967295;var tt=w.placed?1:0,et=Math.floor(127*w.opacity);return et*_a+tt*va+et*xa+tt*ba+et*wa+tt*Sa+et*Aa+tt}var Da=0,Le=function(tt){(this||w)._sortAcrossTiles="viewport-y"!==tt.layout.get("symbol-z-order")&&void 0!==tt.layout.get("symbol-sort-key").constantOr(1),(this||w)._currentTileIndex=0,(this||w)._currentPartIndex=0,(this||w)._seenCrossTileIDs={},(this||w)._bucketParts=[]};Le.prototype.continuePlacement=function(tt,et,rt,it,nt){for(var ot=(this||w)._bucketParts;(this||w)._currentTileIndex<tt.length;)if(et.getBucketParts(ot,it,tt[(this||w)._currentTileIndex],(this||w)._sortAcrossTiles),(this||w)._currentTileIndex++,nt())return!0;for((this||w)._sortAcrossTiles&&((this||w)._sortAcrossTiles=!1,ot.sort((function(w,tt){return w.sortKey-tt.sortKey})));(this||w)._currentPartIndex<ot.length;)if(et.placeLayerBucketPart(ot[(this||w)._currentPartIndex],(this||w)._seenCrossTileIDs,rt),(this||w)._currentPartIndex++,nt())return!0;return!1};var Ae=function(tt,et,rt,it,nt,ot,at){(this||w).placement=new be(tt,nt,ot,at),(this||w)._currentPlacementIndex=et.length-1,(this||w)._forceFullPlacement=rt,(this||w)._showCollisionBoxes=it,(this||w)._done=!1};Ae.prototype.isDone=function(){return(this||w)._done},Ae.prototype.continuePlacement=function(et,rt,it){for(var nt=this||w,ot=tt.browser.now(),n=function(){var w=tt.browser.now()-ot;return!nt._forceFullPlacement&&w>2};(this||w)._currentPlacementIndex>=0;){var at=rt[et[(this||w)._currentPlacementIndex]],st=(this||w).placement.collisionIndex.transform.zoom;if("symbol"===at.type&&(!at.minzoom||at.minzoom<=st)&&(!at.maxzoom||at.maxzoom>st)){if((this||w)._inProgressLayer||((this||w)._inProgressLayer=new Le(at)),(this||w)._inProgressLayer.continuePlacement(it[at.source],(this||w).placement,(this||w)._showCollisionBoxes,at,n))return;delete(this||w)._inProgressLayer}(this||w)._currentPlacementIndex--}(this||w)._done=!0},Ae.prototype.commit=function(tt){return(this||w).placement.commit(tt),(this||w).placement};var Fa=512/tt.EXTENT/2,ke=function(tt,et,rt){(this||w).tileID=tt,(this||w).indexedSymbolInstances={},(this||w).bucketInstanceId=rt;for(var it=0;it<et.length;it++){var nt=et.get(it),ot=nt.key;(this||w).indexedSymbolInstances[ot]||((this||w).indexedSymbolInstances[ot]=[]),(this||w).indexedSymbolInstances[ot].push({crossTileID:nt.crossTileID,coord:this.getScaledCoordinates(nt,tt)})}};ke.prototype.getScaledCoordinates=function(et,rt){var it=Fa/Math.pow(2,rt.canonical.z-(this||w).tileID.canonical.z);return{x:Math.floor((rt.canonical.x*tt.EXTENT+et.anchorX)*it),y:Math.floor((rt.canonical.y*tt.EXTENT+et.anchorY)*it)}},ke.prototype.findMatches=function(tt,et,rt){for(var it=(this||w).tileID.canonical.z<et.canonical.z?1:Math.pow(2,(this||w).tileID.canonical.z-et.canonical.z),nt=0;nt<tt.length;nt++){var ot=tt.get(nt);if(!ot.crossTileID){var at=(this||w).indexedSymbolInstances[ot.key];if(at)for(var st=this.getScaledCoordinates(ot,et),ct=0,pt=at;ct<pt.length;ct+=1){var ft=pt[ct];if(Math.abs(ft.coord.x-st.x)<=it&&Math.abs(ft.coord.y-st.y)<=it&&!rt[ft.crossTileID]){rt[ft.crossTileID]=!0,ot.crossTileID=ft.crossTileID;break}}}}};var Be=function(){(this||w).maxCrossTileID=0};Be.prototype.generate=function(){return++(this||w).maxCrossTileID};var Oe=function(){(this||w).indexes={},(this||w).usedCrossTileIDs={},(this||w).lng=0};Oe.prototype.handleWrapJump=function(tt){var et=Math.round((tt-(this||w).lng)/360);if(0!==et)for(var rt in(this||w).indexes){var it=(this||w).indexes[rt],nt={};for(var ot in it){var at=it[ot];at.tileID=at.tileID.unwrapTo(at.tileID.wrap+et),nt[at.tileID.key]=at}(this||w).indexes[rt]=nt}(this||w).lng=tt},Oe.prototype.addBucket=function(tt,et,rt){if((this||w).indexes[tt.overscaledZ]&&(this||w).indexes[tt.overscaledZ][tt.key]){if((this||w).indexes[tt.overscaledZ][tt.key].bucketInstanceId===et.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(tt.overscaledZ,(this||w).indexes[tt.overscaledZ][tt.key])}for(var it=0;it<et.symbolInstances.length;it++)et.symbolInstances.get(it).crossTileID=0;(this||w).usedCrossTileIDs[tt.overscaledZ]||((this||w).usedCrossTileIDs[tt.overscaledZ]={});var nt=(this||w).usedCrossTileIDs[tt.overscaledZ];for(var ot in(this||w).indexes){var at=(this||w).indexes[ot];if(Number(ot)>tt.overscaledZ)for(var st in at){var ct=at[st];ct.tileID.isChildOf(tt)&&ct.findMatches(et.symbolInstances,tt,nt)}else{var pt=at[tt.scaledTo(Number(ot)).key];pt&&pt.findMatches(et.symbolInstances,tt,nt)}}for(var ft=0;ft<et.symbolInstances.length;ft++){var dt=et.symbolInstances.get(ft);dt.crossTileID||(dt.crossTileID=rt.generate(),nt[dt.crossTileID]=!0)}return void 0===(this||w).indexes[tt.overscaledZ]&&((this||w).indexes[tt.overscaledZ]={}),(this||w).indexes[tt.overscaledZ][tt.key]=new ke(tt,et.symbolInstances,et.bucketInstanceId),!0},Oe.prototype.removeBucketCrossTileIDs=function(tt,et){for(var rt in et.indexedSymbolInstances)for(var it=0,nt=et.indexedSymbolInstances[rt];it<nt.length;it+=1)delete(this||w).usedCrossTileIDs[tt][nt[it].crossTileID]},Oe.prototype.removeStaleBuckets=function(tt){var et=!1;for(var rt in(this||w).indexes){var it=(this||w).indexes[rt];for(var nt in it)tt[it[nt].bucketInstanceId]||(this.removeBucketCrossTileIDs(rt,it[nt]),delete it[nt],et=!0)}return et};var Fe=function(){(this||w).layerIndexes={},(this||w).crossTileIDs=new Be,(this||w).maxBucketInstanceId=0,(this||w).bucketsInCurrentPlacement={}};Fe.prototype.addLayer=function(tt,et,rt){var it=(this||w).layerIndexes[tt.id];void 0===it&&(it=(this||w).layerIndexes[tt.id]=new Oe);var nt=!1,ot={};it.handleWrapJump(rt);for(var at=0,st=et;at<st.length;at+=1){var ct=st[at],pt=ct.getBucket(tt);pt&&tt.id===pt.layerIds[0]&&(pt.bucketInstanceId||(pt.bucketInstanceId=++(this||w).maxBucketInstanceId),it.addBucket(ct.tileID,pt,(this||w).crossTileIDs)&&(nt=!0),ot[pt.bucketInstanceId]=!0)}return it.removeStaleBuckets(ot)&&(nt=!0),nt},Fe.prototype.pruneUnusedLayers=function(tt){var et={};for(var rt in tt.forEach((function(w){et[w]=!0})),(this||w).layerIndexes)et[rt]||delete(this||w).layerIndexes[rt]};var Ue=function(w,et){return tt.emitValidationErrors(w,et&&et.filter((function(w){return"source.canvas"!==w.identifier})))},os=tt.pick(fa,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),as=tt.pick(fa,["setCenter","setZoom","setBearing","setPitch"]),ss=function(){var w={},et=tt.styleSpec.$version;for(var rt in tt.styleSpec.$root){var it,nt=tt.styleSpec.$root[rt];nt.required&&null!=(it="version"===rt?et:"array"===nt.type?[]:{})&&(w[rt]=it)}return w}(),ls=function(et){function i(rt,it){var nt=this||w;void 0===it&&(it={}),et.call(this||w),(this||w).map=rt,(this||w).dispatcher=new Dt(Ft(),this||w),(this||w).imageManager=new pt,(this||w).imageManager.setEventedParent(this||w),(this||w).glyphManager=new y(rt._requestManager,it.localIdeographFontFamily),(this||w).lineAtlas=new T(256,512),(this||w).crossTileSymbolIndex=new Fe,(this||w)._layers={},(this||w)._serializedLayers={},(this||w)._order=[],(this||w).sourceCaches={},(this||w).zoomHistory=new tt.ZoomHistory,(this||w)._loaded=!1,(this||w)._availableImages=[],this._resetUpdates(),(this||w).dispatcher.broadcast("setReferrer",tt.getReferrer());var ot=this||w;(this||w)._rtlTextPluginCallback=i.registerForPluginStateChange((function(w){ot.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},(function(w,et){if(tt.triggerPluginCompletionEvent(w),et&&et.every((function(w){return w})))for(var rt in ot.sourceCaches)ot.sourceCaches[rt].reload()}))})),this.on("data",(function(w){if("source"===w.dataType&&"metadata"===w.sourceDataType){var tt=nt.sourceCaches[w.sourceId];if(tt){var et=tt.getSource();if(et&&et.vectorLayerIds)for(var rt in nt._layers){var it=nt._layers[rt];it.source===et.id&&nt._validateLayer(it)}}}}))}return et&&(i.__proto__=et),(i.prototype=Object.create(et&&et.prototype)).constructor=i,i.prototype.loadURL=function(et,rt){var it=this||w;void 0===rt&&(rt={}),this.fire(new tt.Event("dataloading",{dataType:"style"}));var nt="boolean"==typeof rt.validate?rt.validate:!tt.isMapboxURL(et);et=(this||w).map._requestManager.normalizeStyleURL(et,rt.accessToken);var ot=(this||w).map._requestManager.transformRequest(et,tt.ResourceType.Style);(this||w)._request=tt.getJSON(ot,(function(w,et){it._request=null,w?it.fire(new tt.ErrorEvent(w)):et&&it._load(et,nt)}))},i.prototype.loadJSON=function(et,rt){var it=this||w;void 0===rt&&(rt={}),this.fire(new tt.Event("dataloading",{dataType:"style"})),(this||w)._request=tt.browser.frame((function(){it._request=null,it._load(et,!1!==rt.validate)}))},i.prototype.loadEmpty=function(){this.fire(new tt.Event("dataloading",{dataType:"style"})),this._load(ss,!1)},i.prototype._load=function(et,rt){if(!rt||!Ue(this||w,tt.validateStyle(et))){for(var it in(this||w)._loaded=!0,(this||w).stylesheet=et,et.sources)this.addSource(it,et.sources[it],{validate:!1});et.sprite?this._loadSprite(et.sprite):(this||w).imageManager.setLoaded(!0),(this||w).glyphManager.setURL(et.glyphs);var nt=Nt((this||w).stylesheet.layers);(this||w)._order=nt.map((function(w){return w.id})),(this||w)._layers={},(this||w)._serializedLayers={};for(var ot=0,at=nt;ot<at.length;ot+=1){var st=at[ot];(st=tt.createStyleLayer(st)).setEventedParent(this||w,{layer:{id:st.id}}),(this||w)._layers[st.id]=st,(this||w)._serializedLayers[st.id]=st.serialize()}(this||w).dispatcher.broadcast("setLayers",this._serializeLayers((this||w)._order)),(this||w).light=new vt((this||w).stylesheet.light),this.fire(new tt.Event("data",{dataType:"style"})),this.fire(new tt.Event("style.load"))}},i.prototype._loadSprite=function(et){var rt=this||w;(this||w)._spriteRequest=function(w,et,rt){var it,nt,ot,at=tt.browser.devicePixelRatio>1?"@2x":"",st=tt.getJSON(et.transformRequest(et.normalizeSpriteURL(w,at,".json"),tt.ResourceType.SpriteJSON),(function(w,tt){st=null,ot||(ot=w,it=tt,u())})),ct=tt.getImage(et.transformRequest(et.normalizeSpriteURL(w,at,".png"),tt.ResourceType.SpriteImage),(function(w,tt){ct=null,ot||(ot=w,nt=tt,u())}));function u(){if(ot)rt(ot);else if(it&&nt){var w=tt.browser.getImageData(nt),et={};for(var at in it){var st=it[at],ct=st.width,pt=st.height,ft=st.x,dt=st.y,mt=st.sdf,yt=st.pixelRatio,vt=st.stretchX,Dt=st.stretchY,Rt=st.content,Bt=new tt.RGBAImage({width:ct,height:pt});tt.RGBAImage.copy(w,Bt,{x:ft,y:dt},{x:0,y:0},{width:ct,height:pt}),et[at]={data:Bt,pixelRatio:yt,sdf:mt,stretchX:vt,stretchY:Dt,content:Rt}}rt(null,et)}}return{cancel:function(){st&&(st.cancel(),st=null),ct&&(ct.cancel(),ct=null)}}}(et,(this||w).map._requestManager,(function(w,et){if(rt._spriteRequest=null,w)rt.fire(new tt.ErrorEvent(w));else if(et)for(var it in et)rt.imageManager.addImage(it,et[it]);rt.imageManager.setLoaded(!0),rt._availableImages=rt.imageManager.listImages(),rt.dispatcher.broadcast("setImages",rt._availableImages),rt.fire(new tt.Event("data",{dataType:"style"}))}))},i.prototype._validateLayer=function(et){var rt=(this||w).sourceCaches[et.source];if(rt){var it=et.sourceLayer;if(it){var nt=rt.getSource();("geojson"===nt.type||nt.vectorLayerIds&&-1===nt.vectorLayerIds.indexOf(it))&&this.fire(new tt.ErrorEvent(new Error('Source layer "'+it+'" does not exist on source "'+nt.id+'" as specified by style layer "'+et.id+'"')))}}},i.prototype.loaded=function(){if(!(this||w)._loaded)return!1;if(Object.keys((this||w)._updatedSources).length)return!1;for(var tt in(this||w).sourceCaches)if(!(this||w).sourceCaches[tt].loaded())return!1;return!!(this||w).imageManager.isLoaded()},i.prototype._serializeLayers=function(tt){for(var et=[],rt=0,it=tt;rt<it.length;rt+=1){var nt=(this||w)._layers[it[rt]];"custom"!==nt.type&&et.push(nt.serialize())}return et},i.prototype.hasTransitions=function(){if((this||w).light&&(this||w).light.hasTransition())return!0;for(var tt in(this||w).sourceCaches)if((this||w).sourceCaches[tt].hasTransition())return!0;for(var et in(this||w)._layers)if((this||w)._layers[et].hasTransition())return!0;return!1},i.prototype._checkLoaded=function(){if(!(this||w)._loaded)throw new Error("Style is not done loading")},i.prototype.update=function(et){if((this||w)._loaded){var rt=(this||w)._changed;if((this||w)._changed){var it=Object.keys((this||w)._updatedLayers),nt=Object.keys((this||w)._removedLayers);for(var ot in(it.length||nt.length)&&this._updateWorkerLayers(it,nt),(this||w)._updatedSources){var at=(this||w)._updatedSources[ot];"reload"===at?this._reloadSource(ot):"clear"===at&&this._clearSource(ot)}for(var st in this._updateTilesForChangedImages(),(this||w)._updatedPaintProps)(this||w)._layers[st].updateTransitions(et);(this||w).light.updateTransitions(et),this._resetUpdates()}for(var ct in(this||w).sourceCaches)(this||w).sourceCaches[ct].used=!1;for(var pt=0,ft=(this||w)._order;pt<ft.length;pt+=1){var dt=(this||w)._layers[ft[pt]];dt.recalculate(et,(this||w)._availableImages),!dt.isHidden(et.zoom)&&dt.source&&((this||w).sourceCaches[dt.source].used=!0)}(this||w).light.recalculate(et),(this||w).z=et.zoom,rt&&this.fire(new tt.Event("data",{dataType:"style"}))}},i.prototype._updateTilesForChangedImages=function(){var tt=Object.keys((this||w)._changedImages);if(tt.length){for(var et in(this||w).sourceCaches)(this||w).sourceCaches[et].reloadTilesForDependencies(["icons","patterns"],tt);(this||w)._changedImages={}}},i.prototype._updateWorkerLayers=function(tt,et){(this||w).dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(tt),removedIds:et})},i.prototype._resetUpdates=function(){(this||w)._changed=!1,(this||w)._updatedLayers={},(this||w)._removedLayers={},(this||w)._updatedSources={},(this||w)._updatedPaintProps={},(this||w)._changedImages={}},i.prototype.setState=function(et){var rt=this||w;if(this._checkLoaded(),Ue(this||w,tt.validateStyle(et)))return!1;(et=tt.clone$1(et)).layers=Nt(et.layers);var it=function(w,et){if(!w)return[{command:fa.setStyle,args:[et]}];var rt=[];try{if(!tt.deepEqual(w.version,et.version))return[{command:fa.setStyle,args:[et]}];tt.deepEqual(w.center,et.center)||rt.push({command:fa.setCenter,args:[et.center]}),tt.deepEqual(w.zoom,et.zoom)||rt.push({command:fa.setZoom,args:[et.zoom]}),tt.deepEqual(w.bearing,et.bearing)||rt.push({command:fa.setBearing,args:[et.bearing]}),tt.deepEqual(w.pitch,et.pitch)||rt.push({command:fa.setPitch,args:[et.pitch]}),tt.deepEqual(w.sprite,et.sprite)||rt.push({command:fa.setSprite,args:[et.sprite]}),tt.deepEqual(w.glyphs,et.glyphs)||rt.push({command:fa.setGlyphs,args:[et.glyphs]}),tt.deepEqual(w.transition,et.transition)||rt.push({command:fa.setTransition,args:[et.transition]}),tt.deepEqual(w.light,et.light)||rt.push({command:fa.setLight,args:[et.light]});var it={},nt=[];!function(w,et,rt,it){var nt;for(nt in et=et||{},w=w||{})w.hasOwnProperty(nt)&&(et.hasOwnProperty(nt)||qt(nt,rt,it));for(nt in et)et.hasOwnProperty(nt)&&(w.hasOwnProperty(nt)?tt.deepEqual(w[nt],et[nt])||("geojson"===w[nt].type&&"geojson"===et[nt].type&&Gt(w,et,nt)?rt.push({command:fa.setGeoJSONSourceData,args:[nt,et[nt].data]}):Vt(nt,et,rt,it)):jt(nt,et,rt))}(w.sources,et.sources,nt,it);var ot=[];w.layers&&w.layers.forEach((function(w){it[w.source]?rt.push({command:fa.removeLayer,args:[w.id]}):ot.push(w)})),rt=rt.concat(nt),function(w,et,rt){et=et||[];var it,nt,ot,at,st,ct,pt,ft=(w=w||[]).map(Xt),dt=et.map(Xt),mt=w.reduce(Ht,{}),yt=et.reduce(Ht,{}),vt=ft.slice(),Dt=Object.create(null);for(it=0,nt=0;it<ft.length;it++)yt.hasOwnProperty(ot=ft[it])?nt++:(rt.push({command:fa.removeLayer,args:[ot]}),vt.splice(vt.indexOf(ot,nt),1));for(it=0,nt=0;it<dt.length;it++)vt[vt.length-1-it]!==(ot=dt[dt.length-1-it])&&(mt.hasOwnProperty(ot)?(rt.push({command:fa.removeLayer,args:[ot]}),vt.splice(vt.lastIndexOf(ot,vt.length-nt),1)):nt++,rt.push({command:fa.addLayer,args:[yt[ot],ct=vt[vt.length-it]]}),vt.splice(vt.length-it,0,ot),Dt[ot]=!0);for(it=0;it<dt.length;it++)if(at=mt[ot=dt[it]],st=yt[ot],!Dt[ot]&&!tt.deepEqual(at,st))if(tt.deepEqual(at.source,st.source)&&tt.deepEqual(at["source-layer"],st["source-layer"])&&tt.deepEqual(at.type,st.type)){for(pt in Wt(at.layout,st.layout,rt,ot,null,fa.setLayoutProperty),Wt(at.paint,st.paint,rt,ot,null,fa.setPaintProperty),tt.deepEqual(at.filter,st.filter)||rt.push({command:fa.setFilter,args:[ot,st.filter]}),tt.deepEqual(at.minzoom,st.minzoom)&&tt.deepEqual(at.maxzoom,st.maxzoom)||rt.push({command:fa.setLayerZoomRange,args:[ot,st.minzoom,st.maxzoom]}),at)at.hasOwnProperty(pt)&&"layout"!==pt&&"paint"!==pt&&"filter"!==pt&&"metadata"!==pt&&"minzoom"!==pt&&"maxzoom"!==pt&&(0===pt.indexOf("paint.")?Wt(at[pt],st[pt],rt,ot,pt.slice(6),fa.setPaintProperty):tt.deepEqual(at[pt],st[pt])||rt.push({command:fa.setLayerProperty,args:[ot,pt,st[pt]]}));for(pt in st)st.hasOwnProperty(pt)&&!at.hasOwnProperty(pt)&&"layout"!==pt&&"paint"!==pt&&"filter"!==pt&&"metadata"!==pt&&"minzoom"!==pt&&"maxzoom"!==pt&&(0===pt.indexOf("paint.")?Wt(at[pt],st[pt],rt,ot,pt.slice(6),fa.setPaintProperty):tt.deepEqual(at[pt],st[pt])||rt.push({command:fa.setLayerProperty,args:[ot,pt,st[pt]]}))}else rt.push({command:fa.removeLayer,args:[ot]}),ct=vt[vt.lastIndexOf(ot)+1],rt.push({command:fa.addLayer,args:[st,ct]})}(ot,et.layers,rt)}catch(w){console.warn("Unable to compute style diff:",w),rt=[{command:fa.setStyle,args:[et]}]}return rt}(this.serialize(),et).filter((function(w){return!(w.command in as)}));if(0===it.length)return!1;var nt=it.filter((function(w){return!(w.command in os)}));if(nt.length>0)throw new Error("Unimplemented: "+nt.map((function(w){return w.command})).join(", ")+".");return it.forEach((function(w){"setTransition"!==w.command&&rt[w.command].apply(rt,w.args)})),(this||w).stylesheet=et,!0},i.prototype.addImage=function(et,rt){if(this.getImage(et))return this.fire(new tt.ErrorEvent(new Error("An image with this name already exists.")));(this||w).imageManager.addImage(et,rt),(this||w)._availableImages=(this||w).imageManager.listImages(),(this||w)._changedImages[et]=!0,(this||w)._changed=!0,this.fire(new tt.Event("data",{dataType:"style"}))},i.prototype.updateImage=function(tt,et){(this||w).imageManager.updateImage(tt,et)},i.prototype.getImage=function(tt){return(this||w).imageManager.getImage(tt)},i.prototype.removeImage=function(et){if(!this.getImage(et))return this.fire(new tt.ErrorEvent(new Error("No image with this name exists.")));(this||w).imageManager.removeImage(et),(this||w)._availableImages=(this||w).imageManager.listImages(),(this||w)._changedImages[et]=!0,(this||w)._changed=!0,this.fire(new tt.Event("data",{dataType:"style"}))},i.prototype.listImages=function(){return this._checkLoaded(),(this||w).imageManager.listImages()},i.prototype.addSource=function(et,rt,it){var nt=this||w;if(void 0===it&&(it={}),this._checkLoaded(),void 0!==(this||w).sourceCaches[et])throw new Error("There is already a source with this ID");if(!rt.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(rt).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(rt.type)>=0&&this._validate(tt.validateStyle.source,"sources."+et,rt,null,it))){(this||w).map&&(this||w).map._collectResourceTiming&&(rt.collectResourceTiming=!0);var ot=(this||w).sourceCaches[et]=new la(et,rt,(this||w).dispatcher);ot.style=this||w,ot.setEventedParent(this||w,(function(){return{isSourceLoaded:nt.loaded(),source:ot.serialize(),sourceId:et}})),ot.onAdd((this||w).map),(this||w)._changed=!0}},i.prototype.removeSource=function(et){if(this._checkLoaded(),void 0===(this||w).sourceCaches[et])throw new Error("There is no source with this ID");for(var rt in(this||w)._layers)if((this||w)._layers[rt].source===et)return this.fire(new tt.ErrorEvent(new Error('Source "'+et+'" cannot be removed while layer "'+rt+'" is using it.')));var it=(this||w).sourceCaches[et];delete(this||w).sourceCaches[et],delete(this||w)._updatedSources[et],it.fire(new tt.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:et})),it.setEventedParent(null),it.clearTiles(),it.onRemove&&it.onRemove((this||w).map),(this||w)._changed=!0},i.prototype.setGeoJSONSourceData=function(tt,et){this._checkLoaded(),(this||w).sourceCaches[tt].getSource().setData(et),(this||w)._changed=!0},i.prototype.getSource=function(tt){return(this||w).sourceCaches[tt]&&(this||w).sourceCaches[tt].getSource()},i.prototype.addLayer=function(et,rt,it){void 0===it&&(it={}),this._checkLoaded();var nt=et.id;if(this.getLayer(nt))this.fire(new tt.ErrorEvent(new Error('Layer with id "'+nt+'" already exists on this map')));else{var ot;if("custom"===et.type){if(Ue(this||w,tt.validateCustomStyleLayer(et)))return;ot=tt.createStyleLayer(et)}else{if("object"==typeof et.source&&(this.addSource(nt,et.source),et=tt.clone$1(et),et=tt.extend(et,{source:nt})),this._validate(tt.validateStyle.layer,"layers."+nt,et,{arrayIndex:-1},it))return;ot=tt.createStyleLayer(et),this._validateLayer(ot),ot.setEventedParent(this||w,{layer:{id:nt}}),(this||w)._serializedLayers[ot.id]=ot.serialize()}var at=rt?(this||w)._order.indexOf(rt):(this||w)._order.length;if(rt&&-1===at)this.fire(new tt.ErrorEvent(new Error('Layer with id "'+rt+'" does not exist on this map.')));else{if((this||w)._order.splice(at,0,nt),(this||w)._layerOrderChanged=!0,(this||w)._layers[nt]=ot,(this||w)._removedLayers[nt]&&ot.source&&"custom"!==ot.type){var st=(this||w)._removedLayers[nt];delete(this||w)._removedLayers[nt],st.type!==ot.type?(this||w)._updatedSources[ot.source]="clear":((this||w)._updatedSources[ot.source]="reload",(this||w).sourceCaches[ot.source].pause())}this._updateLayer(ot),ot.onAdd&&ot.onAdd((this||w).map)}}},i.prototype.moveLayer=function(et,rt){if(this._checkLoaded(),(this||w)._changed=!0,(this||w)._layers[et]){if(et!==rt){var it=(this||w)._order.indexOf(et);(this||w)._order.splice(it,1);var nt=rt?(this||w)._order.indexOf(rt):(this||w)._order.length;rt&&-1===nt?this.fire(new tt.ErrorEvent(new Error('Layer with id "'+rt+'" does not exist on this map.'))):((this||w)._order.splice(nt,0,et),(this||w)._layerOrderChanged=!0)}}else this.fire(new tt.ErrorEvent(new Error("The layer '"+et+"' does not exist in the map's style and cannot be moved.")))},i.prototype.removeLayer=function(et){this._checkLoaded();var rt=(this||w)._layers[et];if(rt){rt.setEventedParent(null);var it=(this||w)._order.indexOf(et);(this||w)._order.splice(it,1),(this||w)._layerOrderChanged=!0,(this||w)._changed=!0,(this||w)._removedLayers[et]=rt,delete(this||w)._layers[et],delete(this||w)._serializedLayers[et],delete(this||w)._updatedLayers[et],delete(this||w)._updatedPaintProps[et],rt.onRemove&&rt.onRemove((this||w).map)}else this.fire(new tt.ErrorEvent(new Error("The layer '"+et+"' does not exist in the map's style and cannot be removed.")))},i.prototype.getLayer=function(tt){return(this||w)._layers[tt]},i.prototype.hasLayer=function(tt){return tt in(this||w)._layers},i.prototype.setLayerZoomRange=function(w,et,rt){this._checkLoaded();var it=this.getLayer(w);it?it.minzoom===et&&it.maxzoom===rt||(null!=et&&(it.minzoom=et),null!=rt&&(it.maxzoom=rt),this._updateLayer(it)):this.fire(new tt.ErrorEvent(new Error("The layer '"+w+"' does not exist in the map's style and cannot have zoom extent.")))},i.prototype.setFilter=function(w,et,rt){void 0===rt&&(rt={}),this._checkLoaded();var it=this.getLayer(w);if(it){if(!tt.deepEqual(it.filter,et))return null==et?(it.filter=void 0,void this._updateLayer(it)):void(this._validate(tt.validateStyle.filter,"layers."+it.id+".filter",et,null,rt)||(it.filter=tt.clone$1(et),this._updateLayer(it)))}else this.fire(new tt.ErrorEvent(new Error("The layer '"+w+"' does not exist in the map's style and cannot be filtered.")))},i.prototype.getFilter=function(w){return tt.clone$1(this.getLayer(w).filter)},i.prototype.setLayoutProperty=function(w,et,rt,it){void 0===it&&(it={}),this._checkLoaded();var nt=this.getLayer(w);nt?tt.deepEqual(nt.getLayoutProperty(et),rt)||(nt.setLayoutProperty(et,rt,it),this._updateLayer(nt)):this.fire(new tt.ErrorEvent(new Error("The layer '"+w+"' does not exist in the map's style and cannot be styled.")))},i.prototype.getLayoutProperty=function(w,et){var rt=this.getLayer(w);if(rt)return rt.getLayoutProperty(et);this.fire(new tt.ErrorEvent(new Error("The layer '"+w+"' does not exist in the map's style.")))},i.prototype.setPaintProperty=function(et,rt,it,nt){void 0===nt&&(nt={}),this._checkLoaded();var ot=this.getLayer(et);ot?tt.deepEqual(ot.getPaintProperty(rt),it)||(ot.setPaintProperty(rt,it,nt)&&this._updateLayer(ot),(this||w)._changed=!0,(this||w)._updatedPaintProps[et]=!0):this.fire(new tt.ErrorEvent(new Error("The layer '"+et+"' does not exist in the map's style and cannot be styled.")))},i.prototype.getPaintProperty=function(w,tt){return this.getLayer(w).getPaintProperty(tt)},i.prototype.setFeatureState=function(et,rt){this._checkLoaded();var it=et.source,nt=et.sourceLayer,ot=(this||w).sourceCaches[it];if(void 0!==ot){var at=ot.getSource().type;"geojson"===at&&nt?this.fire(new tt.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==at||nt?(void 0===et.id&&this.fire(new tt.ErrorEvent(new Error("The feature id parameter must be provided."))),ot.setFeatureState(nt,et.id,rt)):this.fire(new tt.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new tt.ErrorEvent(new Error("The source '"+it+"' does not exist in the map's style.")))},i.prototype.removeFeatureState=function(et,rt){this._checkLoaded();var it=et.source,nt=(this||w).sourceCaches[it];if(void 0!==nt){var ot=nt.getSource().type,at="vector"===ot?et.sourceLayer:void 0;"vector"!==ot||at?rt&&"string"!=typeof et.id&&"number"!=typeof et.id?this.fire(new tt.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):nt.removeFeatureState(at,et.id,rt):this.fire(new tt.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new tt.ErrorEvent(new Error("The source '"+it+"' does not exist in the map's style.")))},i.prototype.getFeatureState=function(et){this._checkLoaded();var rt=et.source,it=et.sourceLayer,nt=(this||w).sourceCaches[rt];if(void 0!==nt){if("vector"!==nt.getSource().type||it)return void 0===et.id&&this.fire(new tt.ErrorEvent(new Error("The feature id parameter must be provided."))),nt.getFeatureState(it,et.id);this.fire(new tt.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new tt.ErrorEvent(new Error("The source '"+rt+"' does not exist in the map's style.")))},i.prototype.getTransition=function(){return tt.extend({duration:300,delay:0},(this||w).stylesheet&&(this||w).stylesheet.transition)},i.prototype.serialize=function(){return tt.filterObject({version:(this||w).stylesheet.version,name:(this||w).stylesheet.name,metadata:(this||w).stylesheet.metadata,light:(this||w).stylesheet.light,center:(this||w).stylesheet.center,zoom:(this||w).stylesheet.zoom,bearing:(this||w).stylesheet.bearing,pitch:(this||w).stylesheet.pitch,sprite:(this||w).stylesheet.sprite,glyphs:(this||w).stylesheet.glyphs,transition:(this||w).stylesheet.transition,sources:tt.mapObject((this||w).sourceCaches,(function(w){return w.serialize()})),layers:this._serializeLayers((this||w)._order)},(function(w){return void 0!==w}))},i.prototype._updateLayer=function(tt){(this||w)._updatedLayers[tt.id]=!0,tt.source&&!(this||w)._updatedSources[tt.source]&&"raster"!==(this||w).sourceCaches[tt.source].getSource().type&&((this||w)._updatedSources[tt.source]="reload",(this||w).sourceCaches[tt.source].pause()),(this||w)._changed=!0},i.prototype._flattenAndSortRenderedFeatures=function(tt){for(var et=this||w,i=function(w){return"fill-extrusion"===et._layers[w].type},rt={},it=[],nt=(this||w)._order.length-1;nt>=0;nt--){var ot=(this||w)._order[nt];if(i(ot)){rt[ot]=nt;for(var at=0,st=tt;at<st.length;at+=1){var ct=st[at][ot];if(ct)for(var pt=0,ft=ct;pt<ft.length;pt+=1)it.push(ft[pt])}}}it.sort((function(w,tt){return tt.intersectionZ-w.intersectionZ}));for(var dt=[],mt=(this||w)._order.length-1;mt>=0;mt--){var yt=(this||w)._order[mt];if(i(yt))for(var vt=it.length-1;vt>=0;vt--){var Dt=it[vt].feature;if(rt[Dt.layer.id]<mt)break;dt.push(Dt),it.pop()}else for(var Rt=0,Bt=tt;Rt<Bt.length;Rt+=1){var Ot=Bt[Rt][yt];if(Ot)for(var Ne=0,Ze=Ot;Ne<Ze.length;Ne+=1)dt.push(Ze[Ne].feature)}}return dt},i.prototype.queryRenderedFeatures=function(et,rt,it){rt&&rt.filter&&this._validate(tt.validateStyle.filter,"queryRenderedFeatures.filter",rt.filter,null,rt);var nt={};if(rt&&rt.layers){if(!Array.isArray(rt.layers))return this.fire(new tt.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var ot=0,at=rt.layers;ot<at.length;ot+=1){var st=at[ot],ct=(this||w)._layers[st];if(!ct)return this.fire(new tt.ErrorEvent(new Error("The layer '"+st+"' does not exist in the map's style and cannot be queried for features."))),[];nt[ct.source]=!0}}var pt=[];for(var ft in rt.availableImages=(this||w)._availableImages,(this||w).sourceCaches)rt.layers&&!nt[ft]||pt.push(O((this||w).sourceCaches[ft],(this||w)._layers,(this||w)._serializedLayers,et,rt,it));return(this||w).placement&&pt.push(function(w,tt,et,rt,it,nt,ot){for(var at={},st=nt.queryRenderedSymbols(rt),ct=[],pt=0,ft=Object.keys(st).map(Number);pt<ft.length;pt+=1)ct.push(ot[ft[pt]]);ct.sort(F);for(var p=function(){var et=mt[dt],rt=et.featureIndex.lookupSymbolFeatures(st[et.bucketInstanceId],tt,et.bucketIndex,et.sourceLayerIndex,it.filter,it.layers,it.availableImages,w);for(var nt in rt){var ot=at[nt]=at[nt]||[],ct=rt[nt];ct.sort((function(w,tt){var rt=et.featureSortOrder;if(rt){var it=rt.indexOf(w.featureIndex);return rt.indexOf(tt.featureIndex)-it}return tt.featureIndex-w.featureIndex}));for(var pt=0,ft=ct;pt<ft.length;pt+=1)ot.push(ft[pt])}},dt=0,mt=ct;dt<mt.length;dt+=1)p();var f=function(tt){at[tt].forEach((function(rt){var it=rt.feature,nt=et[w[tt].source].getFeatureState(it.layer["source-layer"],it.id);it.source=it.layer.source,it.layer["source-layer"]&&(it.sourceLayer=it.layer["source-layer"]),it.state=nt}))};for(var yt in at)f(yt);return at}((this||w)._layers,(this||w)._serializedLayers,(this||w).sourceCaches,et,rt,(this||w).placement.collisionIndex,(this||w).placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(pt)},i.prototype.querySourceFeatures=function(et,rt){rt&&rt.filter&&this._validate(tt.validateStyle.filter,"querySourceFeatures.filter",rt.filter,null,rt);var it=(this||w).sourceCaches[et];return it?function(w,tt){for(var et=w.getRenderableIds().map((function(tt){return w.getTileByID(tt)})),rt=[],it={},nt=0;nt<et.length;nt++){var ot=et[nt],at=ot.tileID.canonical.key;it[at]||(it[at]=!0,ot.querySourceFeatures(rt,tt))}return rt}(it,rt):[]},i.prototype.addSourceType=function(tt,et,rt){return i.getSourceType(tt)?rt(new Error('A source type called "'+tt+'" already exists.')):(i.setSourceType(tt,et),et.workerSourceURL?void(this||w).dispatcher.broadcast("loadWorkerSource",{name:tt,url:et.workerSourceURL},rt):rt(null,null))},i.prototype.getLight=function(){return(this||w).light.getLight()},i.prototype.setLight=function(et,rt){void 0===rt&&(rt={}),this._checkLoaded();var it=(this||w).light.getLight(),nt=!1;for(var ot in et)if(!tt.deepEqual(et[ot],it[ot])){nt=!0;break}if(nt){var at={now:tt.browser.now(),transition:tt.extend({duration:300,delay:0},(this||w).stylesheet.transition)};(this||w).light.setLight(et,rt),(this||w).light.updateTransitions(at)}},i.prototype._validate=function(et,rt,it,nt,ot){return void 0===ot&&(ot={}),(!ot||!1!==ot.validate)&&Ue(this||w,et.call(tt.validateStyle,tt.extend({key:rt,style:this.serialize(),value:it,styleSpec:tt.styleSpec},nt)))},i.prototype._remove=function(){for(var et in(this||w)._request&&((this||w)._request.cancel(),(this||w)._request=null),(this||w)._spriteRequest&&((this||w)._spriteRequest.cancel(),(this||w)._spriteRequest=null),tt.evented.off("pluginStateChange",(this||w)._rtlTextPluginCallback),(this||w)._layers)(this||w)._layers[et].setEventedParent(null);for(var rt in(this||w).sourceCaches)(this||w).sourceCaches[rt].clearTiles(),(this||w).sourceCaches[rt].setEventedParent(null);(this||w).imageManager.setEventedParent(null),this.setEventedParent(null),(this||w).dispatcher.remove()},i.prototype._clearSource=function(tt){(this||w).sourceCaches[tt].clearTiles()},i.prototype._reloadSource=function(tt){(this||w).sourceCaches[tt].resume(),(this||w).sourceCaches[tt].reload()},i.prototype._updateSources=function(tt){for(var et in(this||w).sourceCaches)(this||w).sourceCaches[et].update(tt)},i.prototype._generateCollisionBoxes=function(){for(var tt in(this||w).sourceCaches)this._reloadSource(tt)},i.prototype._updatePlacement=function(et,rt,it,nt,ot){void 0===ot&&(ot=!1);for(var at=!1,st=!1,ct={},pt=0,ft=(this||w)._order;pt<ft.length;pt+=1){var dt=(this||w)._layers[ft[pt]];if("symbol"===dt.type){if(!ct[dt.source]){var mt=(this||w).sourceCaches[dt.source];ct[dt.source]=mt.getRenderableIds(!0).map((function(w){return mt.getTileByID(w)})).sort((function(w,tt){return tt.tileID.overscaledZ-w.tileID.overscaledZ||(w.tileID.isLessThan(tt.tileID)?-1:1)}))}var yt=(this||w).crossTileSymbolIndex.addLayer(dt,ct[dt.source],et.center.lng);at=at||yt}}if((this||w).crossTileSymbolIndex.pruneUnusedLayers((this||w)._order),((ot=ot||(this||w)._layerOrderChanged||0===it)||!(this||w).pauseablePlacement||(this||w).pauseablePlacement.isDone()&&!(this||w).placement.stillRecent(tt.browser.now(),et.zoom))&&((this||w).pauseablePlacement=new Ae(et,(this||w)._order,ot,rt,it,nt,(this||w).placement),(this||w)._layerOrderChanged=!1),(this||w).pauseablePlacement.isDone()?(this||w).placement.setStale():((this||w).pauseablePlacement.continuePlacement((this||w)._order,(this||w)._layers,ct),(this||w).pauseablePlacement.isDone()&&((this||w).placement=(this||w).pauseablePlacement.commit(tt.browser.now()),st=!0),at&&(this||w).pauseablePlacement.placement.setStale()),st||at)for(var vt=0,Dt=(this||w)._order;vt<Dt.length;vt+=1){var Rt=(this||w)._layers[Dt[vt]];"symbol"===Rt.type&&(this||w).placement.updateLayerOpacities(Rt,ct[Rt.source])}return!(this||w).pauseablePlacement.isDone()||(this||w).placement.hasTransitions(tt.browser.now())},i.prototype._releaseSymbolFadeTiles=function(){for(var tt in(this||w).sourceCaches)(this||w).sourceCaches[tt].releaseSymbolFadeTiles()},i.prototype.getImages=function(tt,et,rt){(this||w).imageManager.getImages(et.icons,rt),this._updateTilesForChangedImages();var it=(this||w).sourceCaches[et.source];it&&it.setDependencies(et.tileID.key,et.type,et.icons)},i.prototype.getGlyphs=function(tt,et,rt){(this||w).glyphManager.getGlyphs(et.stacks,rt)},i.prototype.getResource=function(w,et,rt){return tt.makeRequest(et,rt)},i}(tt.Evented);ls.getSourceType=function(w){return rr[w]},ls.setSourceType=function(w,tt){rr[w]=tt},ls.registerForPluginStateChange=tt.registerForPluginStateChange;var us=tt.createLayout([{name:"a_pos",type:"Int16",components:2}]),fs=gi("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),gs=gi("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),vs=gi("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),xs=gi("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Ss=gi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Es=gi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),As=gi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),zs=gi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Ps=gi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Cs=gi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Ms=gi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),Ls=gi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Rs=gi("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Bs=gi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),Fs=gi("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),Os=gi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),Us=gi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Vs=gi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Ns=gi("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),js=gi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Zs=gi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),Js=gi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),tl=gi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),ol=gi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),sl=gi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),dl=gi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function gi(w,tt){var et=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,rt=tt.match(/attribute ([\w]+) ([\w]+)/g),it=w.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),nt=tt.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),ot=nt?nt.concat(it):it,at={};return{fragmentSource:w=w.replace(et,(function(w,tt,et,rt,it){return at[it]=!0,"define"===tt?"\n#ifndef HAS_UNIFORM_u_"+it+"\nvarying "+et+" "+rt+" "+it+";\n#else\nuniform "+et+" "+rt+" u_"+it+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+it+"\n    "+et+" "+rt+" "+it+" = u_"+it+";\n#endif\n"})),vertexSource:tt=tt.replace(et,(function(w,tt,et,rt,it){var nt="float"===rt?"vec2":"vec4",ot=it.match(/color/)?"color":nt;return at[it]?"define"===tt?"\n#ifndef HAS_UNIFORM_u_"+it+"\nuniform lowp float u_"+it+"_t;\nattribute "+et+" "+nt+" a_"+it+";\nvarying "+et+" "+rt+" "+it+";\n#else\nuniform "+et+" "+rt+" u_"+it+";\n#endif\n":"vec4"===ot?"\n#ifndef HAS_UNIFORM_u_"+it+"\n    "+it+" = a_"+it+";\n#else\n    "+et+" "+rt+" "+it+" = u_"+it+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+it+"\n    "+it+" = unpack_mix_"+ot+"(a_"+it+", u_"+it+"_t);\n#else\n    "+et+" "+rt+" "+it+" = u_"+it+";\n#endif\n":"define"===tt?"\n#ifndef HAS_UNIFORM_u_"+it+"\nuniform lowp float u_"+it+"_t;\nattribute "+et+" "+nt+" a_"+it+";\n#else\nuniform "+et+" "+rt+" u_"+it+";\n#endif\n":"vec4"===ot?"\n#ifndef HAS_UNIFORM_u_"+it+"\n    "+et+" "+rt+" "+it+" = a_"+it+";\n#else\n    "+et+" "+rt+" "+it+" = u_"+it+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+it+"\n    "+et+" "+rt+" "+it+" = unpack_mix_"+ot+"(a_"+it+", u_"+it+"_t);\n#else\n    "+et+" "+rt+" "+it+" = u_"+it+";\n#endif\n"})),staticAttributes:rt,staticUniforms:ot}}var yl=Object.freeze({__proto__:null,prelude:fs,background:gs,backgroundPattern:vs,circle:xs,clippingMask:Ss,heatmap:Es,heatmapTexture:As,collisionBox:zs,collisionCircle:Ps,debug:Cs,fill:Ms,fillOutline:Ls,fillOutlinePattern:Rs,fillPattern:Bs,fillExtrusion:Fs,fillExtrusionPattern:Os,hillshadePrepare:Us,hillshade:Vs,line:Ns,lineGradient:js,linePattern:Zs,lineSDF:Js,raster:tl,symbolIcon:ol,symbolSDF:sl,symbolTextAndIcon:dl}),yi=function(){(this||w).boundProgram=null,(this||w).boundLayoutVertexBuffer=null,(this||w).boundPaintVertexBuffers=[],(this||w).boundIndexBuffer=null,(this||w).boundVertexOffset=null,(this||w).boundDynamicVertexBuffer=null,(this||w).vao=null};function xi(w){for(var tt=[],et=0;et<w.length;et++)if(null!==w[et]){var rt=w[et].split(" ");tt.push(rt.pop())}return tt}yi.prototype.bind=function(tt,et,rt,it,nt,ot,at,st){(this||w).context=tt;for(var ct=(this||w).boundPaintVertexBuffers.length!==it.length,pt=0;!ct&&pt<it.length;pt++)(this||w).boundPaintVertexBuffers[pt]!==it[pt]&&(ct=!0);tt.extVertexArrayObject&&(this||w).vao&&(this||w).boundProgram===et&&(this||w).boundLayoutVertexBuffer===rt&&!ct&&(this||w).boundIndexBuffer===nt&&(this||w).boundVertexOffset===ot&&(this||w).boundDynamicVertexBuffer===at&&(this||w).boundDynamicVertexBuffer2===st?(tt.bindVertexArrayOES.set((this||w).vao),at&&at.bind(),nt&&nt.dynamicDraw&&nt.bind(),st&&st.bind()):this.freshBind(et,rt,it,nt,ot,at,st)},yi.prototype.freshBind=function(tt,et,rt,it,nt,ot,at){var st,ct=tt.numAttributes,pt=(this||w).context,ft=pt.gl;if(pt.extVertexArrayObject)(this||w).vao&&this.destroy(),(this||w).vao=pt.extVertexArrayObject.createVertexArrayOES(),pt.bindVertexArrayOES.set((this||w).vao),st=0,(this||w).boundProgram=tt,(this||w).boundLayoutVertexBuffer=et,(this||w).boundPaintVertexBuffers=rt,(this||w).boundIndexBuffer=it,(this||w).boundVertexOffset=nt,(this||w).boundDynamicVertexBuffer=ot,(this||w).boundDynamicVertexBuffer2=at;else{st=pt.currentNumAttributes||0;for(var dt=ct;dt<st;dt++)ft.disableVertexAttribArray(dt)}et.enableAttributes(ft,tt);for(var mt=0,yt=rt;mt<yt.length;mt+=1)yt[mt].enableAttributes(ft,tt);ot&&ot.enableAttributes(ft,tt),at&&at.enableAttributes(ft,tt),et.bind(),et.setVertexAttribPointers(ft,tt,nt);for(var vt=0,Dt=rt;vt<Dt.length;vt+=1){var Rt=Dt[vt];Rt.bind(),Rt.setVertexAttribPointers(ft,tt,nt)}ot&&(ot.bind(),ot.setVertexAttribPointers(ft,tt,nt)),it&&it.bind(),at&&(at.bind(),at.setVertexAttribPointers(ft,tt,nt)),pt.currentNumAttributes=ct},yi.prototype.destroy=function(){(this||w).vao&&((this||w).context.extVertexArrayObject.deleteVertexArrayOES((this||w).vao),(this||w).vao=null)};var bi=function(tt,et,rt,it,nt,ot){var at=tt.gl;(this||w).program=at.createProgram();for(var st=xi(rt.staticAttributes),ct=it?it.getBinderAttributes():[],pt=st.concat(ct),ft=rt.staticUniforms?xi(rt.staticUniforms):[],dt=it?it.getBinderUniforms():[],mt=[],yt=0,vt=ft.concat(dt);yt<vt.length;yt+=1){var Dt=vt[yt];mt.indexOf(Dt)<0&&mt.push(Dt)}var Rt=it?it.defines():[];ot&&Rt.push("#define OVERDRAW_INSPECTOR;");var Bt=Rt.concat(fs.fragmentSource,rt.fragmentSource).join("\n"),Ot=Rt.concat(fs.vertexSource,rt.vertexSource).join("\n"),Ne=at.createShader(at.FRAGMENT_SHADER);if(at.isContextLost())(this||w).failedToCreate=!0;else{at.shaderSource(Ne,Bt),at.compileShader(Ne),at.attachShader((this||w).program,Ne);var Ze=at.createShader(at.VERTEX_SHADER);if(at.isContextLost())(this||w).failedToCreate=!0;else{at.shaderSource(Ze,Ot),at.compileShader(Ze),at.attachShader((this||w).program,Ze),(this||w).attributes={};var Ge={};(this||w).numAttributes=pt.length;for(var Ke=0;Ke<(this||w).numAttributes;Ke++)pt[Ke]&&(at.bindAttribLocation((this||w).program,Ke,pt[Ke]),(this||w).attributes[pt[Ke]]=Ke);at.linkProgram((this||w).program),at.deleteShader(Ze),at.deleteShader(Ne);for(var er=0;er<mt.length;er++){var rr=mt[er];if(rr&&!Ge[rr]){var vr=at.getUniformLocation((this||w).program,rr);vr&&(Ge[rr]=vr)}}(this||w).fixedUniforms=nt(tt,Ge),(this||w).binderUniforms=it?it.getUniforms(tt,Ge):[]}}};function wi(w,tt,et){var rt=1/pe(et,1,tt.transform.tileZoom),it=Math.pow(2,et.tileID.overscaledZ),nt=et.tileSize*Math.pow(2,tt.transform.tileZoom)/it,ot=nt*(et.tileID.canonical.x+et.tileID.wrap*it),at=nt*et.tileID.canonical.y;return{u_image:0,u_texsize:et.imageAtlasTexture.size,u_scale:[rt,w.fromScale,w.toScale],u_fade:w.t,u_pixel_coord_upper:[ot>>16,at>>16],u_pixel_coord_lower:[65535&ot,65535&at]}}bi.prototype.draw=function(tt,et,rt,it,nt,ot,at,st,ct,pt,ft,dt,mt,yt,vt,Dt){var Rt,Bt=tt.gl;if(!(this||w).failedToCreate){for(var Ot in tt.program.set((this||w).program),tt.setDepthMode(rt),tt.setStencilMode(it),tt.setColorMode(nt),tt.setCullFace(ot),(this||w).fixedUniforms)(this||w).fixedUniforms[Ot].set(at[Ot]);yt&&yt.setUniforms(tt,(this||w).binderUniforms,dt,{zoom:mt});for(var Ne=(Rt={},Rt[Bt.LINES]=2,Rt[Bt.TRIANGLES]=3,Rt[Bt.LINE_STRIP]=1,Rt)[et],Ze=0,Ge=ft.get();Ze<Ge.length;Ze+=1){var Ke=Ge[Ze],er=Ke.vaos||(Ke.vaos={});(er[st]||(er[st]=new yi)).bind(tt,this||w,ct,yt?yt.getPaintVertexBuffers():[],pt,Ke.vertexOffset,vt,Dt),Bt.drawElements(et,Ke.primitiveLength*Ne,Bt.UNSIGNED_SHORT,Ke.primitiveOffset*Ne*2)}}};var Ti=function(w,et,rt,it){var nt=et.style.light,ot=nt.properties.get("position"),at=[ot.x,ot.y,ot.z],st=tt.create$1();"viewport"===nt.properties.get("anchor")&&tt.fromRotation(st,-et.transform.angle),tt.transformMat3(at,at,st);var ct=nt.properties.get("color");return{u_matrix:w,u_lightpos:at,u_lightintensity:nt.properties.get("intensity"),u_lightcolor:[ct.r,ct.g,ct.b],u_vertical_gradient:+rt,u_opacity:it}},Ei=function(w,et,rt,it,nt,ot,at){return tt.extend(Ti(w,et,rt,it),wi(ot,et,at),{u_height_factor:-Math.pow(2,nt.overscaledZ)/at.tileSize/8})},Ii=function(w){return{u_matrix:w}},Pi=function(w,et,rt,it){return tt.extend(Ii(w),wi(rt,et,it))},Si=function(w,tt){return{u_matrix:w,u_world:tt}},Ci=function(w,et,rt,it,nt){return tt.extend(Pi(w,et,rt,it),{u_world:nt})},zi=function(w,et,rt,it){var nt,ot,at=w.transform;if("map"===it.paint.get("circle-pitch-alignment")){var st=pe(rt,1,at.zoom);nt=!0,ot=[st,st]}else nt=!1,ot=at.pixelsToGLUnits;return{u_camera_to_center_distance:at.cameraToCenterDistance,u_scale_with_map:+("map"===it.paint.get("circle-pitch-scale")),u_matrix:w.translatePosMatrix(et.posMatrix,rt,it.paint.get("circle-translate"),it.paint.get("circle-translate-anchor")),u_pitch_with_map:+nt,u_device_pixel_ratio:tt.browser.devicePixelRatio,u_extrude_scale:ot}},Di=function(w,tt,et){var rt=pe(et,1,tt.zoom),it=Math.pow(2,tt.zoom-et.tileID.overscaledZ),nt=et.tileID.overscaleFactor();return{u_matrix:w,u_camera_to_center_distance:tt.cameraToCenterDistance,u_pixels_to_tile_units:rt,u_extrude_scale:[tt.pixelsToGLUnits[0]/(rt*it),tt.pixelsToGLUnits[1]/(rt*it)],u_overscale_factor:nt}},Mi=function(w,tt,et){return{u_matrix:w,u_inv_matrix:tt,u_camera_to_center_distance:et.cameraToCenterDistance,u_viewport_size:[et.width,et.height]}},Li=function(w,tt,et){return void 0===et&&(et=1),{u_matrix:w,u_color:tt,u_overlay:0,u_overlay_scale:et}},Ai=function(w){return{u_matrix:w}},Ri=function(w,tt,et,rt){return{u_matrix:w,u_extrude_scale:pe(tt,1,et),u_intensity:rt}},ki=function(w,et,rt){var it=w.transform;return{u_matrix:Ni(w,et,rt),u_ratio:1/pe(et,1,it.zoom),u_device_pixel_ratio:tt.browser.devicePixelRatio,u_units_to_pixels:[1/it.pixelsToGLUnits[0],1/it.pixelsToGLUnits[1]]}},Bi=function(w,et,rt){return tt.extend(ki(w,et,rt),{u_image:0})},Oi=function(w,et,rt,it){var nt=w.transform,ot=Ui(et,nt);return{u_matrix:Ni(w,et,rt),u_texsize:et.imageAtlasTexture.size,u_ratio:1/pe(et,1,nt.zoom),u_device_pixel_ratio:tt.browser.devicePixelRatio,u_image:0,u_scale:[ot,it.fromScale,it.toScale],u_fade:it.t,u_units_to_pixels:[1/nt.pixelsToGLUnits[0],1/nt.pixelsToGLUnits[1]]}},Fi=function(w,et,rt,it,nt){var ot=w.lineAtlas,at=Ui(et,w.transform),st="round"===rt.layout.get("line-cap"),ct=ot.getDash(it.from,st),pt=ot.getDash(it.to,st),ft=ct.width*nt.fromScale,dt=pt.width*nt.toScale;return tt.extend(ki(w,et,rt),{u_patternscale_a:[at/ft,-ct.height/2],u_patternscale_b:[at/dt,-pt.height/2],u_sdfgamma:ot.width/(256*Math.min(ft,dt)*tt.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:ct.y,u_tex_y_b:pt.y,u_mix:nt.t})};function Ui(w,tt){return 1/pe(w,1,tt.tileZoom)}function Ni(w,tt,et){return w.translatePosMatrix(tt.tileID.posMatrix,tt,et.paint.get("line-translate"),et.paint.get("line-translate-anchor"))}var Zi=function(w,tt,et,rt,it){return{u_matrix:w,u_tl_parent:tt,u_scale_parent:et,u_buffer_scale:1,u_fade_t:rt.mix,u_opacity:rt.opacity*it.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:it.paint.get("raster-brightness-min"),u_brightness_high:it.paint.get("raster-brightness-max"),u_saturation_factor:(ot=it.paint.get("raster-saturation"),ot>0?1-1/(1.001-ot):-ot),u_contrast_factor:(nt=it.paint.get("raster-contrast"),nt>0?1/(1-nt):1+nt),u_spin_weights:ji(it.paint.get("raster-hue-rotate"))};var nt,ot};function ji(w){w*=Math.PI/180;var tt=Math.sin(w),et=Math.cos(w);return[(2*et+1)/3,(-Math.sqrt(3)*tt-et+1)/3,(Math.sqrt(3)*tt-et+1)/3]}var gl,Vi=function(w,tt,et,rt,it,nt,ot,at,st,ct){var pt=it.transform;return{u_is_size_zoom_constant:+("constant"===w||"source"===w),u_is_size_feature_constant:+("constant"===w||"camera"===w),u_size_t:tt?tt.uSizeT:0,u_size:tt?tt.uSize:0,u_camera_to_center_distance:pt.cameraToCenterDistance,u_pitch:pt.pitch/360*2*Math.PI,u_rotate_symbol:+et,u_aspect_ratio:pt.width/pt.height,u_fade_change:it.options.fadeDuration?it.symbolFadeChange:1,u_matrix:nt,u_label_plane_matrix:ot,u_coord_matrix:at,u_is_text:+st,u_pitch_with_map:+rt,u_texsize:ct,u_texture:0}},Gi=function(w,et,rt,it,nt,ot,at,st,ct,pt,ft){var dt=nt.transform;return tt.extend(Vi(w,et,rt,it,nt,ot,at,st,ct,pt),{u_gamma_scale:it?Math.cos(dt._pitch)*dt.cameraToCenterDistance:1,u_device_pixel_ratio:tt.browser.devicePixelRatio,u_is_halo:+ft})},Wi=function(w,et,rt,it,nt,ot,at,st,ct,pt){return tt.extend(Gi(w,et,rt,it,nt,ot,at,st,!0,ct,!0),{u_texsize_icon:pt,u_texture_icon:1})},Xi=function(w,tt,et){return{u_matrix:w,u_opacity:tt,u_color:et}},Hi=function(w,et,rt,it,nt,ot){return tt.extend(function(w,tt,et,rt){var it=et.imageManager.getPattern(w.from.toString()),nt=et.imageManager.getPattern(w.to.toString()),ot=et.imageManager.getPixelSize(),at=ot.width,st=ot.height,ct=Math.pow(2,rt.tileID.overscaledZ),pt=rt.tileSize*Math.pow(2,et.transform.tileZoom)/ct,ft=pt*(rt.tileID.canonical.x+rt.tileID.wrap*ct),dt=pt*rt.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:it.tl,u_pattern_br_a:it.br,u_pattern_tl_b:nt.tl,u_pattern_br_b:nt.br,u_texsize:[at,st],u_mix:tt.t,u_pattern_size_a:it.displaySize,u_pattern_size_b:nt.displaySize,u_scale_a:tt.fromScale,u_scale_b:tt.toScale,u_tile_units_to_pixels:1/pe(rt,1,et.transform.tileZoom),u_pixel_coord_upper:[ft>>16,dt>>16],u_pixel_coord_lower:[65535&ft,65535&dt]}}(it,ot,rt,nt),{u_matrix:w,u_opacity:et})},_l={fillExtrusion:function(w,et){return{u_matrix:new tt.UniformMatrix4f(w,et.u_matrix),u_lightpos:new tt.Uniform3f(w,et.u_lightpos),u_lightintensity:new tt.Uniform1f(w,et.u_lightintensity),u_lightcolor:new tt.Uniform3f(w,et.u_lightcolor),u_vertical_gradient:new tt.Uniform1f(w,et.u_vertical_gradient),u_opacity:new tt.Uniform1f(w,et.u_opacity)}},fillExtrusionPattern:function(w,et){return{u_matrix:new tt.UniformMatrix4f(w,et.u_matrix),u_lightpos:new tt.Uniform3f(w,et.u_lightpos),u_lightintensity:new tt.Uniform1f(w,et.u_lightintensity),u_lightcolor:new tt.Uniform3f(w,et.u_lightcolor),u_vertical_gradient:new tt.Uniform1f(w,et.u_vertical_gradient),u_height_factor:new tt.Uniform1f(w,et.u_height_factor),u_image:new tt.Uniform1i(w,et.u_image),u_texsize:new tt.Uniform2f(w,et.u_texsize),u_pixel_coord_upper:new tt.Uniform2f(w,et.u_pixel_coord_upper),u_pixel_coord_lower:new tt.Uniform2f(w,et.u_pixel_coord_lower),u_scale:new tt.Uniform3f(w,et.u_scale),u_fade:new tt.Uniform1f(w,et.u_fade),u_opacity:new tt.Uniform1f(w,et.u_opacity)}},fill:function(w,et){return{u_matrix:new tt.UniformMatrix4f(w,et.u_matrix)}},fillPattern:function(w,et){return{u_matrix:new tt.UniformMatrix4f(w,et.u_matrix),u_image:new tt.Uniform1i(w,et.u_image),u_texsize:new tt.Uniform2f(w,et.u_texsize),u_pixel_coord_upper:new tt.Uniform2f(w,et.u_pixel_coord_upper),u_pixel_coord_lower:new tt.Uniform2f(w,et.u_pixel_coord_lower),u_scale:new tt.Uniform3f(w,et.u_scale),u_fade:new tt.Uniform1f(w,et.u_fade)}},fillOutline:function(w,et){return{u_matrix:new tt.UniformMatrix4f(w,et.u_matrix),u_world:new tt.Uniform2f(w,et.u_world)}},fillOutlinePattern:function(w,et){return{u_matrix:new tt.UniformMatrix4f(w,et.u_matrix),u_world:new tt.Uniform2f(w,et.u_world),u_image:new tt.Uniform1i(w,et.u_image),u_texsize:new tt.Uniform2f(w,et.u_texsize),u_pixel_coord_upper:new tt.Uniform2f(w,et.u_pixel_coord_upper),u_pixel_coord_lower:new tt.Uniform2f(w,et.u_pixel_coord_lower),u_scale:new tt.Uniform3f(w,et.u_scale),u_fade:new tt.Uniform1f(w,et.u_fade)}},circle:function(w,et){return{u_camera_to_center_distance:new tt.Uniform1f(w,et.u_camera_to_center_distance),u_scale_with_map:new tt.Uniform1i(w,et.u_scale_with_map),u_pitch_with_map:new tt.Uniform1i(w,et.u_pitch_with_map),u_extrude_scale:new tt.Uniform2f(w,et.u_extrude_scale),u_device_pixel_ratio:new tt.Uniform1f(w,et.u_device_pixel_ratio),u_matrix:new tt.UniformMatrix4f(w,et.u_matrix)}},collisionBox:function(w,et){return{u_matrix:new tt.UniformMatrix4f(w,et.u_matrix),u_camera_to_center_distance:new tt.Uniform1f(w,et.u_camera_to_center_distance),u_pixels_to_tile_units:new tt.Uniform1f(w,et.u_pixels_to_tile_units),u_extrude_scale:new tt.Uniform2f(w,et.u_extrude_scale),u_overscale_factor:new tt.Uniform1f(w,et.u_overscale_factor)}},collisionCircle:function(w,et){return{u_matrix:new tt.UniformMatrix4f(w,et.u_matrix),u_inv_matrix:new tt.UniformMatrix4f(w,et.u_inv_matrix),u_camera_to_center_distance:new tt.Uniform1f(w,et.u_camera_to_center_distance),u_viewport_size:new tt.Uniform2f(w,et.u_viewport_size)}},debug:function(w,et){return{u_color:new tt.UniformColor(w,et.u_color),u_matrix:new tt.UniformMatrix4f(w,et.u_matrix),u_overlay:new tt.Uniform1i(w,et.u_overlay),u_overlay_scale:new tt.Uniform1f(w,et.u_overlay_scale)}},clippingMask:function(w,et){return{u_matrix:new tt.UniformMatrix4f(w,et.u_matrix)}},heatmap:function(w,et){return{u_extrude_scale:new tt.Uniform1f(w,et.u_extrude_scale),u_intensity:new tt.Uniform1f(w,et.u_intensity),u_matrix:new tt.UniformMatrix4f(w,et.u_matrix)}},heatmapTexture:function(w,et){return{u_matrix:new tt.UniformMatrix4f(w,et.u_matrix),u_world:new tt.Uniform2f(w,et.u_world),u_image:new tt.Uniform1i(w,et.u_image),u_color_ramp:new tt.Uniform1i(w,et.u_color_ramp),u_opacity:new tt.Uniform1f(w,et.u_opacity)}},hillshade:function(w,et){return{u_matrix:new tt.UniformMatrix4f(w,et.u_matrix),u_image:new tt.Uniform1i(w,et.u_image),u_latrange:new tt.Uniform2f(w,et.u_latrange),u_light:new tt.Uniform2f(w,et.u_light),u_shadow:new tt.UniformColor(w,et.u_shadow),u_highlight:new tt.UniformColor(w,et.u_highlight),u_accent:new tt.UniformColor(w,et.u_accent)}},hillshadePrepare:function(w,et){return{u_matrix:new tt.UniformMatrix4f(w,et.u_matrix),u_image:new tt.Uniform1i(w,et.u_image),u_dimension:new tt.Uniform2f(w,et.u_dimension),u_zoom:new tt.Uniform1f(w,et.u_zoom),u_maxzoom:new tt.Uniform1f(w,et.u_maxzoom),u_unpack:new tt.Uniform4f(w,et.u_unpack)}},line:function(w,et){return{u_matrix:new tt.UniformMatrix4f(w,et.u_matrix),u_ratio:new tt.Uniform1f(w,et.u_ratio),u_device_pixel_ratio:new tt.Uniform1f(w,et.u_device_pixel_ratio),u_units_to_pixels:new tt.Uniform2f(w,et.u_units_to_pixels)}},lineGradient:function(w,et){return{u_matrix:new tt.UniformMatrix4f(w,et.u_matrix),u_ratio:new tt.Uniform1f(w,et.u_ratio),u_device_pixel_ratio:new tt.Uniform1f(w,et.u_device_pixel_ratio),u_units_to_pixels:new tt.Uniform2f(w,et.u_units_to_pixels),u_image:new tt.Uniform1i(w,et.u_image)}},linePattern:function(w,et){return{u_matrix:new tt.UniformMatrix4f(w,et.u_matrix),u_texsize:new tt.Uniform2f(w,et.u_texsize),u_ratio:new tt.Uniform1f(w,et.u_ratio),u_device_pixel_ratio:new tt.Uniform1f(w,et.u_device_pixel_ratio),u_image:new tt.Uniform1i(w,et.u_image),u_units_to_pixels:new tt.Uniform2f(w,et.u_units_to_pixels),u_scale:new tt.Uniform3f(w,et.u_scale),u_fade:new tt.Uniform1f(w,et.u_fade)}},lineSDF:function(w,et){return{u_matrix:new tt.UniformMatrix4f(w,et.u_matrix),u_ratio:new tt.Uniform1f(w,et.u_ratio),u_device_pixel_ratio:new tt.Uniform1f(w,et.u_device_pixel_ratio),u_units_to_pixels:new tt.Uniform2f(w,et.u_units_to_pixels),u_patternscale_a:new tt.Uniform2f(w,et.u_patternscale_a),u_patternscale_b:new tt.Uniform2f(w,et.u_patternscale_b),u_sdfgamma:new tt.Uniform1f(w,et.u_sdfgamma),u_image:new tt.Uniform1i(w,et.u_image),u_tex_y_a:new tt.Uniform1f(w,et.u_tex_y_a),u_tex_y_b:new tt.Uniform1f(w,et.u_tex_y_b),u_mix:new tt.Uniform1f(w,et.u_mix)}},raster:function(w,et){return{u_matrix:new tt.UniformMatrix4f(w,et.u_matrix),u_tl_parent:new tt.Uniform2f(w,et.u_tl_parent),u_scale_parent:new tt.Uniform1f(w,et.u_scale_parent),u_buffer_scale:new tt.Uniform1f(w,et.u_buffer_scale),u_fade_t:new tt.Uniform1f(w,et.u_fade_t),u_opacity:new tt.Uniform1f(w,et.u_opacity),u_image0:new tt.Uniform1i(w,et.u_image0),u_image1:new tt.Uniform1i(w,et.u_image1),u_brightness_low:new tt.Uniform1f(w,et.u_brightness_low),u_brightness_high:new tt.Uniform1f(w,et.u_brightness_high),u_saturation_factor:new tt.Uniform1f(w,et.u_saturation_factor),u_contrast_factor:new tt.Uniform1f(w,et.u_contrast_factor),u_spin_weights:new tt.Uniform3f(w,et.u_spin_weights)}},symbolIcon:function(w,et){return{u_is_size_zoom_constant:new tt.Uniform1i(w,et.u_is_size_zoom_constant),u_is_size_feature_constant:new tt.Uniform1i(w,et.u_is_size_feature_constant),u_size_t:new tt.Uniform1f(w,et.u_size_t),u_size:new tt.Uniform1f(w,et.u_size),u_camera_to_center_distance:new tt.Uniform1f(w,et.u_camera_to_center_distance),u_pitch:new tt.Uniform1f(w,et.u_pitch),u_rotate_symbol:new tt.Uniform1i(w,et.u_rotate_symbol),u_aspect_ratio:new tt.Uniform1f(w,et.u_aspect_ratio),u_fade_change:new tt.Uniform1f(w,et.u_fade_change),u_matrix:new tt.UniformMatrix4f(w,et.u_matrix),u_label_plane_matrix:new tt.UniformMatrix4f(w,et.u_label_plane_matrix),u_coord_matrix:new tt.UniformMatrix4f(w,et.u_coord_matrix),u_is_text:new tt.Uniform1i(w,et.u_is_text),u_pitch_with_map:new tt.Uniform1i(w,et.u_pitch_with_map),u_texsize:new tt.Uniform2f(w,et.u_texsize),u_texture:new tt.Uniform1i(w,et.u_texture)}},symbolSDF:function(w,et){return{u_is_size_zoom_constant:new tt.Uniform1i(w,et.u_is_size_zoom_constant),u_is_size_feature_constant:new tt.Uniform1i(w,et.u_is_size_feature_constant),u_size_t:new tt.Uniform1f(w,et.u_size_t),u_size:new tt.Uniform1f(w,et.u_size),u_camera_to_center_distance:new tt.Uniform1f(w,et.u_camera_to_center_distance),u_pitch:new tt.Uniform1f(w,et.u_pitch),u_rotate_symbol:new tt.Uniform1i(w,et.u_rotate_symbol),u_aspect_ratio:new tt.Uniform1f(w,et.u_aspect_ratio),u_fade_change:new tt.Uniform1f(w,et.u_fade_change),u_matrix:new tt.UniformMatrix4f(w,et.u_matrix),u_label_plane_matrix:new tt.UniformMatrix4f(w,et.u_label_plane_matrix),u_coord_matrix:new tt.UniformMatrix4f(w,et.u_coord_matrix),u_is_text:new tt.Uniform1i(w,et.u_is_text),u_pitch_with_map:new tt.Uniform1i(w,et.u_pitch_with_map),u_texsize:new tt.Uniform2f(w,et.u_texsize),u_texture:new tt.Uniform1i(w,et.u_texture),u_gamma_scale:new tt.Uniform1f(w,et.u_gamma_scale),u_device_pixel_ratio:new tt.Uniform1f(w,et.u_device_pixel_ratio),u_is_halo:new tt.Uniform1i(w,et.u_is_halo)}},symbolTextAndIcon:function(w,et){return{u_is_size_zoom_constant:new tt.Uniform1i(w,et.u_is_size_zoom_constant),u_is_size_feature_constant:new tt.Uniform1i(w,et.u_is_size_feature_constant),u_size_t:new tt.Uniform1f(w,et.u_size_t),u_size:new tt.Uniform1f(w,et.u_size),u_camera_to_center_distance:new tt.Uniform1f(w,et.u_camera_to_center_distance),u_pitch:new tt.Uniform1f(w,et.u_pitch),u_rotate_symbol:new tt.Uniform1i(w,et.u_rotate_symbol),u_aspect_ratio:new tt.Uniform1f(w,et.u_aspect_ratio),u_fade_change:new tt.Uniform1f(w,et.u_fade_change),u_matrix:new tt.UniformMatrix4f(w,et.u_matrix),u_label_plane_matrix:new tt.UniformMatrix4f(w,et.u_label_plane_matrix),u_coord_matrix:new tt.UniformMatrix4f(w,et.u_coord_matrix),u_is_text:new tt.Uniform1i(w,et.u_is_text),u_pitch_with_map:new tt.Uniform1i(w,et.u_pitch_with_map),u_texsize:new tt.Uniform2f(w,et.u_texsize),u_texsize_icon:new tt.Uniform2f(w,et.u_texsize_icon),u_texture:new tt.Uniform1i(w,et.u_texture),u_texture_icon:new tt.Uniform1i(w,et.u_texture_icon),u_gamma_scale:new tt.Uniform1f(w,et.u_gamma_scale),u_device_pixel_ratio:new tt.Uniform1f(w,et.u_device_pixel_ratio),u_is_halo:new tt.Uniform1i(w,et.u_is_halo)}},background:function(w,et){return{u_matrix:new tt.UniformMatrix4f(w,et.u_matrix),u_opacity:new tt.Uniform1f(w,et.u_opacity),u_color:new tt.UniformColor(w,et.u_color)}},backgroundPattern:function(w,et){return{u_matrix:new tt.UniformMatrix4f(w,et.u_matrix),u_opacity:new tt.Uniform1f(w,et.u_opacity),u_image:new tt.Uniform1i(w,et.u_image),u_pattern_tl_a:new tt.Uniform2f(w,et.u_pattern_tl_a),u_pattern_br_a:new tt.Uniform2f(w,et.u_pattern_br_a),u_pattern_tl_b:new tt.Uniform2f(w,et.u_pattern_tl_b),u_pattern_br_b:new tt.Uniform2f(w,et.u_pattern_br_b),u_texsize:new tt.Uniform2f(w,et.u_texsize),u_mix:new tt.Uniform1f(w,et.u_mix),u_pattern_size_a:new tt.Uniform2f(w,et.u_pattern_size_a),u_pattern_size_b:new tt.Uniform2f(w,et.u_pattern_size_b),u_scale_a:new tt.Uniform1f(w,et.u_scale_a),u_scale_b:new tt.Uniform1f(w,et.u_scale_b),u_pixel_coord_upper:new tt.Uniform2f(w,et.u_pixel_coord_upper),u_pixel_coord_lower:new tt.Uniform2f(w,et.u_pixel_coord_lower),u_tile_units_to_pixels:new tt.Uniform1f(w,et.u_tile_units_to_pixels)}}};function Yi(w,et,rt,it,nt,ot,at){for(var st=w.context,ct=st.gl,pt=w.useProgram("collisionBox"),ft=[],dt=0,mt=0,yt=0;yt<it.length;yt++){var vt=it[yt],Dt=et.getTile(vt),Rt=Dt.getBucket(rt);if(Rt){var Bt=vt.posMatrix;0===nt[0]&&0===nt[1]||(Bt=w.translatePosMatrix(vt.posMatrix,Dt,nt,ot));var Ot=at?Rt.textCollisionBox:Rt.iconCollisionBox,Ne=Rt.collisionCircleArray;if(Ne.length>0){var Ze=tt.create(),Ge=Bt;tt.mul(Ze,Rt.placementInvProjMatrix,w.transform.glCoordMatrix),tt.mul(Ze,Ze,Rt.placementViewportMatrix),ft.push({circleArray:Ne,circleOffset:mt,transform:Ge,invTransform:Ze}),mt=dt+=Ne.length/4}Ot&&pt.draw(st,ct.LINES,It.disabled,Pt.disabled,w.colorModeForRenderPass(),Ct.disabled,Di(Bt,w.transform,Dt),rt.id,Ot.layoutVertexBuffer,Ot.indexBuffer,Ot.segments,null,w.transform.zoom,null,null,Ot.collisionVertexBuffer)}}if(at&&ft.length){var Ke=w.useProgram("collisionCircle"),er=new tt.StructArrayLayout2f1f2i16;er.resize(4*dt),er._trim();for(var rr=0,vr=0,wr=ft;vr<wr.length;vr+=1)for(var Sr=wr[vr],ei=0;ei<Sr.circleArray.length/4;ei++){var ii=4*ei,mi=Sr.circleArray[ii+0],qi=Sr.circleArray[ii+1],Ki=Sr.circleArray[ii+2],Ji=Sr.circleArray[ii+3];er.emplace(rr++,mi,qi,Ki,Ji,0),er.emplace(rr++,mi,qi,Ki,Ji,1),er.emplace(rr++,mi,qi,Ki,Ji,2),er.emplace(rr++,mi,qi,Ki,Ji,3)}(!gl||gl.length<2*dt)&&(gl=function(w){var et=2*w,rt=new tt.StructArrayLayout3ui6;rt.resize(et),rt._trim();for(var it=0;it<et;it++){var nt=6*it;rt.uint16[nt+0]=4*it+0,rt.uint16[nt+1]=4*it+1,rt.uint16[nt+2]=4*it+2,rt.uint16[nt+3]=4*it+2,rt.uint16[nt+4]=4*it+3,rt.uint16[nt+5]=4*it+0}return rt}(dt));for(var rn=st.createIndexBuffer(gl,!0),vn=st.createVertexBuffer(er,tt.collisionCircleLayout.members,!0),bn=0,Tn=ft;bn<Tn.length;bn+=1){var In=Tn[bn],zn=Mi(In.transform,In.invTransform,w.transform);Ke.draw(st,ct.TRIANGLES,It.disabled,Pt.disabled,w.colorModeForRenderPass(),Ct.disabled,zn,rt.id,vn,rn,tt.SegmentVector.simpleSegment(0,2*In.circleOffset,In.circleArray.length,In.circleArray.length/2),null,w.transform.zoom,null,null,null)}vn.destroy(),rn.destroy()}}var vl=tt.identity(new Float32Array(16));function Qi(w,et,rt,it,nt,ot){var at=tt.getAnchorAlignment(w),st=-(at.horizontalAlign-.5)*et,ct=-(at.verticalAlign-.5)*rt,pt=tt.evaluateVariableOffset(w,it);return new tt.Point((st/nt+pt[0])*ot,(ct/nt+pt[1])*ot)}function $i(w,et,rt,it,nt,ot,at,st,ct,pt,ft){var dt=w.text.placedSymbolArray,mt=w.text.dynamicLayoutVertexArray,yt=w.icon.dynamicLayoutVertexArray,vt={};mt.clear();for(var Dt=0;Dt<dt.length;Dt++){var Rt=dt.get(Dt),Bt=Rt.hidden||!Rt.crossTileID||w.allowVerticalPlacement&&!Rt.placedOrientation?null:it[Rt.crossTileID];if(Bt){var Ot=new tt.Point(Rt.anchorX,Rt.anchorY),Ne=$t(Ot,rt?st:at),Ze=te(ot.cameraToCenterDistance,Ne.signedDistanceFromCamera),Ge=nt.evaluateSizeForFeature(w.textSizeData,pt,Rt)*Ze/tt.ONE_EM;rt&&(Ge*=w.tilePixelRatio/ct);for(var Ke=Qi(Bt.anchor,Bt.width,Bt.height,Bt.textOffset,Bt.textBoxScale,Ge),er=rt?$t(Ot.add(Ke),at).point:Ne.point.add(et?Ke.rotate(-ot.angle):Ke),rr=w.allowVerticalPlacement&&Rt.placedOrientation===tt.WritingMode.vertical?Math.PI/2:0,vr=0;vr<Rt.numGlyphs;vr++)tt.addDynamicAttributes(mt,er,rr);ft&&Rt.associatedIconIndex>=0&&(vt[Rt.associatedIconIndex]={shiftedAnchor:er,angle:rr})}else ce(Rt.numGlyphs,mt)}if(ft){yt.clear();for(var wr=w.icon.placedSymbolArray,Sr=0;Sr<wr.length;Sr++){var ei=wr.get(Sr);if(ei.hidden)ce(ei.numGlyphs,yt);else{var ii=vt[Sr];if(ii)for(var mi=0;mi<ei.numGlyphs;mi++)tt.addDynamicAttributes(yt,ii.shiftedAnchor,ii.angle);else ce(ei.numGlyphs,yt)}}w.icon.dynamicLayoutVertexBuffer.updateData(yt)}w.text.dynamicLayoutVertexBuffer.updateData(mt)}function to(w,tt,et){return et.iconsInText&&tt?"symbolTextAndIcon":w?"symbolSDF":"symbolIcon"}function eo(w,et,rt,it,nt,ot,at,st,ct,pt,ft,dt){for(var mt=w.context,yt=mt.gl,vt=w.transform,Dt="map"===st,Rt="map"===ct,Bt=Dt&&"point"!==rt.layout.get("symbol-placement"),Ot=Dt&&!Rt&&!Bt,Ne=void 0!==rt.layout.get("symbol-sort-key").constantOr(1),Ze=w.depthModeForSublayer(0,It.ReadOnly),Ge=rt.layout.get("text-variable-anchor"),Ke=[],er=0,rr=it;er<rr.length;er+=1){var vr=rr[er],wr=et.getTile(vr),Sr=wr.getBucket(rt);if(Sr){var ei=nt?Sr.text:Sr.icon;if(ei&&ei.segments.get().length){var ii=ei.programConfigurations.get(rt.id),mi=nt||Sr.sdfIcons,qi=nt?Sr.textSizeData:Sr.iconSizeData,Ki=Rt||0!==vt.pitch,Ji=w.useProgram(to(mi,nt,Sr),ii),rn=tt.evaluateSizeForZoom(qi,vt.zoom),vn=void 0,bn=[0,0],Tn=void 0,In=void 0,zn=null,Cn=void 0;if(nt)Tn=wr.glyphAtlasTexture,In=yt.LINEAR,vn=wr.glyphAtlasTexture.size,Sr.iconsInText&&(bn=wr.imageAtlasTexture.size,zn=wr.imageAtlasTexture,Cn=Ki||w.options.rotating||w.options.zooming||"composite"===qi.kind||"camera"===qi.kind?yt.LINEAR:yt.NEAREST);else{var Mn=1!==rt.layout.get("icon-size").constantOr(0)||Sr.iconsNeedLinear;Tn=wr.imageAtlasTexture,In=mi||w.options.rotating||w.options.zooming||Mn||Ki?yt.LINEAR:yt.NEAREST,vn=wr.imageAtlasTexture.size}var Ln=pe(wr,1,w.transform.zoom),Bn=Jt(vr.posMatrix,Rt,Dt,w.transform,Ln),Fn=Qt(vr.posMatrix,Rt,Dt,w.transform,Ln),Vn=Ge&&Sr.hasTextData(),Nn="none"!==rt.layout.get("icon-text-fit")&&Vn&&Sr.hasIconData();Bt&&ie(Sr,vr.posMatrix,w,nt,Bn,Fn,Rt,pt);var Wn=w.translatePosMatrix(vr.posMatrix,wr,ot,at),Yn=Bt||nt&&Ge||Nn?vl:Bn,$n=w.translatePosMatrix(Fn,wr,ot,at,!0),uo=mi&&0!==rt.paint.get(nt?"text-halo-width":"icon-halo-width").constantOr(1),po={program:Ji,buffers:ei,uniformValues:mi?Sr.iconsInText?Wi(qi.kind,rn,Ot,Rt,w,Wn,Yn,$n,vn,bn):Gi(qi.kind,rn,Ot,Rt,w,Wn,Yn,$n,nt,vn,!0):Vi(qi.kind,rn,Ot,Rt,w,Wn,Yn,$n,nt,vn),atlasTexture:Tn,atlasTextureIcon:zn,atlasInterpolation:In,atlasInterpolationIcon:Cn,isSDF:mi,hasHalo:uo};if(Ne)for(var vo=0,So=ei.segments.get();vo<So.length;vo+=1){var ta=So[vo];Ke.push({segments:new tt.SegmentVector([ta]),sortKey:ta.sortKey,state:po})}else Ke.push({segments:ei.segments,sortKey:0,state:po})}}}Ne&&Ke.sort((function(w,tt){return w.sortKey-tt.sortKey}));for(var ea=0,ra=Ke;ea<ra.length;ea+=1){var ia=ra[ea],na=ia.state;if(mt.activeTexture.set(yt.TEXTURE0),na.atlasTexture.bind(na.atlasInterpolation,yt.CLAMP_TO_EDGE),na.atlasTextureIcon&&(mt.activeTexture.set(yt.TEXTURE1),na.atlasTextureIcon&&na.atlasTextureIcon.bind(na.atlasInterpolationIcon,yt.CLAMP_TO_EDGE)),na.isSDF){var sa=na.uniformValues;na.hasHalo&&(sa.u_is_halo=1,io(na.buffers,ia.segments,rt,w,na.program,Ze,ft,dt,sa)),sa.u_is_halo=0}io(na.buffers,ia.segments,rt,w,na.program,Ze,ft,dt,na.uniformValues)}}function io(w,tt,et,rt,it,nt,ot,at,st){var ct=rt.context;it.draw(ct,ct.gl.TRIANGLES,nt,ot,at,Ct.disabled,st,et.id,w.layoutVertexBuffer,w.indexBuffer,tt,et.paint,rt.transform.zoom,w.programConfigurations.get(et.id),w.dynamicLayoutVertexBuffer,w.opacityVertexBuffer)}function oo(w,tt,et,rt,it,nt,ot){var at,st,ct,pt,ft,dt=w.context.gl,mt=et.paint.get("fill-pattern"),yt=mt&&mt.constantOr(1),vt=et.getCrossfadeParameters();ot?(st=yt&&!et.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",at=dt.LINES):(st=yt?"fillPattern":"fill",at=dt.TRIANGLES);for(var Dt=0,Rt=rt;Dt<Rt.length;Dt+=1){var Bt=Rt[Dt],Ot=tt.getTile(Bt);if(!yt||Ot.patternsLoaded()){var Ne=Ot.getBucket(et);if(Ne){var Ze=Ne.programConfigurations.get(et.id),Ge=w.useProgram(st,Ze);yt&&(w.context.activeTexture.set(dt.TEXTURE0),Ot.imageAtlasTexture.bind(dt.LINEAR,dt.CLAMP_TO_EDGE),Ze.updatePaintBuffers(vt));var Ke=mt.constantOr(null);if(Ke&&Ot.imageAtlas){var er=Ot.imageAtlas,rr=er.patternPositions[Ke.to.toString()],vr=er.patternPositions[Ke.from.toString()];rr&&vr&&Ze.setConstantPatternPositions(rr,vr)}var wr=w.translatePosMatrix(Bt.posMatrix,Ot,et.paint.get("fill-translate"),et.paint.get("fill-translate-anchor"));if(ot){pt=Ne.indexBuffer2,ft=Ne.segments2;var Sr=[dt.drawingBufferWidth,dt.drawingBufferHeight];ct="fillOutlinePattern"===st&&yt?Ci(wr,w,vt,Ot,Sr):Si(wr,Sr)}else pt=Ne.indexBuffer,ft=Ne.segments,ct=yt?Pi(wr,w,vt,Ot):Ii(wr);Ge.draw(w.context,at,it,w.stencilModeForClipping(Bt),nt,Ct.disabled,ct,et.id,Ne.layoutVertexBuffer,pt,ft,et.paint,w.transform.zoom,Ze)}}}}function ro(w,tt,et,rt,it,nt,ot){for(var at=w.context,st=at.gl,ct=et.paint.get("fill-extrusion-pattern"),pt=ct.constantOr(1),ft=et.getCrossfadeParameters(),dt=et.paint.get("fill-extrusion-opacity"),mt=0,yt=rt;mt<yt.length;mt+=1){var vt=yt[mt],Dt=tt.getTile(vt),Rt=Dt.getBucket(et);if(Rt){var Bt=Rt.programConfigurations.get(et.id),Ot=w.useProgram(pt?"fillExtrusionPattern":"fillExtrusion",Bt);pt&&(w.context.activeTexture.set(st.TEXTURE0),Dt.imageAtlasTexture.bind(st.LINEAR,st.CLAMP_TO_EDGE),Bt.updatePaintBuffers(ft));var Ne=ct.constantOr(null);if(Ne&&Dt.imageAtlas){var Ze=Dt.imageAtlas,Ge=Ze.patternPositions[Ne.to.toString()],Ke=Ze.patternPositions[Ne.from.toString()];Ge&&Ke&&Bt.setConstantPatternPositions(Ge,Ke)}var er=w.translatePosMatrix(vt.posMatrix,Dt,et.paint.get("fill-extrusion-translate"),et.paint.get("fill-extrusion-translate-anchor")),rr=et.paint.get("fill-extrusion-vertical-gradient"),vr=pt?Ei(er,w,rr,dt,vt,ft,Dt):Ti(er,w,rr,dt);Ot.draw(at,at.gl.TRIANGLES,it,nt,ot,Ct.backCCW,vr,et.id,Rt.layoutVertexBuffer,Rt.indexBuffer,Rt.segments,et.paint,w.transform.zoom,Bt)}}}function ao(w,et,rt,it,nt,ot){var at=w.context,st=at.gl,ct=et.fbo;if(ct){var pt=w.useProgram("hillshade");at.activeTexture.set(st.TEXTURE0),st.bindTexture(st.TEXTURE_2D,ct.colorAttachment.get());var ft=function(w,et,rt){var it=rt.paint.get("hillshade-shadow-color"),nt=rt.paint.get("hillshade-highlight-color"),ot=rt.paint.get("hillshade-accent-color"),at=rt.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===rt.paint.get("hillshade-illumination-anchor")&&(at-=w.transform.angle);var st,ct,pt,ft=!w.options.moving;return{u_matrix:w.transform.calculatePosMatrix(et.tileID.toUnwrapped(),ft),u_image:0,u_latrange:(st=et.tileID,ct=Math.pow(2,st.canonical.z),pt=st.canonical.y,[new tt.MercatorCoordinate(0,pt/ct).toLngLat().lat,new tt.MercatorCoordinate(0,(pt+1)/ct).toLngLat().lat]),u_light:[rt.paint.get("hillshade-exaggeration"),at],u_shadow:it,u_highlight:nt,u_accent:ot}}(w,et,rt);pt.draw(at,st.TRIANGLES,it,nt,ot,Ct.disabled,ft,rt.id,w.rasterBoundsBuffer,w.quadTriangleIndexBuffer,w.rasterBoundsSegments)}}function no(w,et,rt,it,nt,ot,at){var st=w.context,ct=st.gl,pt=et.dem;if(pt&&pt.data){var ft=pt.dim,dt=pt.stride,mt=pt.getPixels();if(st.activeTexture.set(ct.TEXTURE1),st.pixelStoreUnpackPremultiplyAlpha.set(!1),et.demTexture=et.demTexture||w.getTileTexture(dt),et.demTexture){var yt=et.demTexture;yt.update(mt,{premultiply:!1}),yt.bind(ct.NEAREST,ct.CLAMP_TO_EDGE)}else et.demTexture=new tt.Texture(st,mt,ct.RGBA,{premultiply:!1}),et.demTexture.bind(ct.NEAREST,ct.CLAMP_TO_EDGE);st.activeTexture.set(ct.TEXTURE0);var vt=et.fbo;if(!vt){var Dt=new tt.Texture(st,{width:ft,height:ft,data:null},ct.RGBA);Dt.bind(ct.LINEAR,ct.CLAMP_TO_EDGE),(vt=et.fbo=st.createFramebuffer(ft,ft,!0)).colorAttachment.set(Dt.texture)}st.bindFramebuffer.set(vt.framebuffer),st.viewport.set([0,0,ft,ft]),w.useProgram("hillshadePrepare").draw(st,ct.TRIANGLES,nt,ot,at,Ct.disabled,function(w,et,rt){var it=et.stride,nt=tt.create();return tt.ortho(nt,0,tt.EXTENT,-tt.EXTENT,0,0,1),tt.translate(nt,nt,[0,-tt.EXTENT,0]),{u_matrix:nt,u_image:1,u_dimension:[it,it],u_zoom:w.overscaledZ,u_maxzoom:rt,u_unpack:et.getUnpackVector()}}(et.tileID,pt,it),rt.id,w.rasterBoundsBuffer,w.quadTriangleIndexBuffer,w.rasterBoundsSegments),et.needsHillshadePrepare=!1}}function so(w,et,rt,it,nt){var ot=it.paint.get("raster-fade-duration");if(ot>0){var at=tt.browser.now(),st=(at-w.timeAdded)/ot,ct=et?(at-et.timeAdded)/ot:-1,pt=rt.getSource(),ft=nt.coveringZoomLevel({tileSize:pt.tileSize,roundZoom:pt.roundZoom}),dt=!et||Math.abs(et.tileID.overscaledZ-ft)>Math.abs(w.tileID.overscaledZ-ft),mt=dt&&w.refreshedUponExpiration?1:tt.clamp(dt?st:1-ct,0,1);return w.refreshedUponExpiration&&st>=1&&(w.refreshedUponExpiration=!1),et?{opacity:1,mix:1-mt}:{opacity:mt,mix:0}}return{opacity:1,mix:0}}var xl=new tt.Color(1,0,0,1),bl=new tt.Color(0,1,0,1),wl=new tt.Color(0,0,1,1),Sl=new tt.Color(1,0,1,1),Il=new tt.Color(0,1,1,1);function _o(w,tt,et,rt){mo(w,0,tt+et/2,w.transform.width,et,rt)}function fo(w,tt,et,rt){mo(w,tt-et/2,0,et,w.transform.height,rt)}function mo(w,et,rt,it,nt,ot){var at=w.context,st=at.gl;st.enable(st.SCISSOR_TEST),st.scissor(et*tt.browser.devicePixelRatio,rt*tt.browser.devicePixelRatio,it*tt.browser.devicePixelRatio,nt*tt.browser.devicePixelRatio),at.clear({color:ot}),st.disable(st.SCISSOR_TEST)}function go(w,et,rt){var it=w.context,nt=it.gl,ot=rt.posMatrix,at=w.useProgram("debug"),st=It.disabled,ct=Pt.disabled,pt=w.colorModeForRenderPass();it.activeTexture.set(nt.TEXTURE0),w.emptyTexture.bind(nt.LINEAR,nt.CLAMP_TO_EDGE),at.draw(it,nt.LINE_STRIP,st,ct,pt,Ct.disabled,Li(ot,tt.Color.red),"$debug",w.debugBuffer,w.tileBorderIndexBuffer,w.debugSegments);var ft=et.getTileByID(rt.key).latestRawTileData,dt=Math.floor((ft&&ft.byteLength||0)/1024),mt=et.getTile(rt).tileSize,yt=512/Math.min(mt,512)*(rt.overscaledZ/w.transform.zoom)*.5,vt=rt.canonical.toString();rt.overscaledZ!==rt.canonical.z&&(vt+=" => "+rt.overscaledZ),function(w,tt){w.initDebugOverlayCanvas();var et=w.debugOverlayCanvas,rt=w.context.gl,it=w.debugOverlayCanvas.getContext("2d");it.clearRect(0,0,et.width,et.height),it.shadowColor="white",it.shadowBlur=2,it.lineWidth=1.5,it.strokeStyle="white",it.textBaseline="top",it.font="bold 36px Open Sans, sans-serif",it.fillText(tt,5,5),it.strokeText(tt,5,5),w.debugOverlayTexture.update(et),w.debugOverlayTexture.bind(rt.LINEAR,rt.CLAMP_TO_EDGE)}(w,vt+" "+dt+"kb"),at.draw(it,nt.TRIANGLES,st,ct,St.alphaBlended,Ct.disabled,Li(ot,tt.Color.transparent,yt),"$debug",w.debugBuffer,w.quadTriangleIndexBuffer,w.debugSegments)}var Al={symbol:function(w,et,rt,it,nt){if("translucent"===w.renderPass){var ot=Pt.disabled,at=w.colorModeForRenderPass();rt.layout.get("text-variable-anchor")&&function(w,et,rt,it,nt,ot,at){for(var st=et.transform,ct="map"===nt,pt="map"===ot,ft=0,dt=w;ft<dt.length;ft+=1){var mt=dt[ft],yt=it.getTile(mt),vt=yt.getBucket(rt);if(vt&&vt.text&&vt.text.segments.get().length){var Dt=tt.evaluateSizeForZoom(vt.textSizeData,st.zoom),Rt=pe(yt,1,et.transform.zoom),Bt=Jt(mt.posMatrix,pt,ct,et.transform,Rt),Ot="none"!==rt.layout.get("icon-text-fit")&&vt.hasIconData();if(Dt){var Ne=Math.pow(2,st.zoom-yt.tileID.overscaledZ);$i(vt,ct,pt,at,tt.symbolSize,st,Bt,mt.posMatrix,Ne,Dt,Ot)}}}}(it,w,rt,et,rt.layout.get("text-rotation-alignment"),rt.layout.get("text-pitch-alignment"),nt),0!==rt.paint.get("icon-opacity").constantOr(1)&&eo(w,et,rt,it,!1,rt.paint.get("icon-translate"),rt.paint.get("icon-translate-anchor"),rt.layout.get("icon-rotation-alignment"),rt.layout.get("icon-pitch-alignment"),rt.layout.get("icon-keep-upright"),ot,at),0!==rt.paint.get("text-opacity").constantOr(1)&&eo(w,et,rt,it,!0,rt.paint.get("text-translate"),rt.paint.get("text-translate-anchor"),rt.layout.get("text-rotation-alignment"),rt.layout.get("text-pitch-alignment"),rt.layout.get("text-keep-upright"),ot,at),et.map.showCollisionBoxes&&(Yi(w,et,rt,it,rt.paint.get("text-translate"),rt.paint.get("text-translate-anchor"),!0),Yi(w,et,rt,it,rt.paint.get("icon-translate"),rt.paint.get("icon-translate-anchor"),!1))}},circle:function(w,et,rt,it){if("translucent"===w.renderPass){var nt=rt.paint.get("circle-opacity"),ot=rt.paint.get("circle-stroke-width"),at=rt.paint.get("circle-stroke-opacity"),st=void 0!==rt.layout.get("circle-sort-key").constantOr(1);if(0!==nt.constantOr(1)||0!==ot.constantOr(1)&&0!==at.constantOr(1)){for(var ct=w.context,pt=ct.gl,ft=w.depthModeForSublayer(0,It.ReadOnly),dt=Pt.disabled,mt=w.colorModeForRenderPass(),yt=[],vt=0;vt<it.length;vt++){var Dt=it[vt],Rt=et.getTile(Dt),Bt=Rt.getBucket(rt);if(Bt){var Ot=Bt.programConfigurations.get(rt.id),Ne={programConfiguration:Ot,program:w.useProgram("circle",Ot),layoutVertexBuffer:Bt.layoutVertexBuffer,indexBuffer:Bt.indexBuffer,uniformValues:zi(w,Dt,Rt,rt)};if(st)for(var Ze=0,Ge=Bt.segments.get();Ze<Ge.length;Ze+=1){var Ke=Ge[Ze];yt.push({segments:new tt.SegmentVector([Ke]),sortKey:Ke.sortKey,state:Ne})}else yt.push({segments:Bt.segments,sortKey:0,state:Ne})}}st&&yt.sort((function(w,tt){return w.sortKey-tt.sortKey}));for(var er=0,rr=yt;er<rr.length;er+=1){var vr=rr[er],wr=vr.state;wr.program.draw(ct,pt.TRIANGLES,ft,dt,mt,Ct.disabled,wr.uniformValues,rt.id,wr.layoutVertexBuffer,wr.indexBuffer,vr.segments,rt.paint,w.transform.zoom,wr.programConfiguration)}}}},heatmap:function(w,et,rt,it){if(0!==rt.paint.get("heatmap-opacity"))if("offscreen"===w.renderPass){var nt=w.context,ot=nt.gl,at=Pt.disabled,st=new St([ot.ONE,ot.ONE],tt.Color.transparent,[!0,!0,!0,!0]);!function(w,tt,et){var rt=w.gl;w.activeTexture.set(rt.TEXTURE1),w.viewport.set([0,0,tt.width/4,tt.height/4]);var it=et.heatmapFbo;if(it)rt.bindTexture(rt.TEXTURE_2D,it.colorAttachment.get()),w.bindFramebuffer.set(it.framebuffer);else{var nt=rt.createTexture();rt.bindTexture(rt.TEXTURE_2D,nt),rt.texParameteri(rt.TEXTURE_2D,rt.TEXTURE_WRAP_S,rt.CLAMP_TO_EDGE),rt.texParameteri(rt.TEXTURE_2D,rt.TEXTURE_WRAP_T,rt.CLAMP_TO_EDGE),rt.texParameteri(rt.TEXTURE_2D,rt.TEXTURE_MIN_FILTER,rt.LINEAR),rt.texParameteri(rt.TEXTURE_2D,rt.TEXTURE_MAG_FILTER,rt.LINEAR),it=et.heatmapFbo=w.createFramebuffer(tt.width/4,tt.height/4,!1),function(w,tt,et,rt){var it=w.gl;it.texImage2D(it.TEXTURE_2D,0,it.RGBA,tt.width/4,tt.height/4,0,it.RGBA,w.extRenderToTextureHalfFloat?w.extTextureHalfFloat.HALF_FLOAT_OES:it.UNSIGNED_BYTE,null),rt.colorAttachment.set(et)}(w,tt,nt,it)}}(nt,w,rt),nt.clear({color:tt.Color.transparent});for(var ct=0;ct<it.length;ct++){var pt=it[ct];if(!et.hasRenderableParent(pt)){var ft=et.getTile(pt),dt=ft.getBucket(rt);if(dt){var mt=dt.programConfigurations.get(rt.id);w.useProgram("heatmap",mt).draw(nt,ot.TRIANGLES,It.disabled,at,st,Ct.disabled,Ri(pt.posMatrix,ft,w.transform.zoom,rt.paint.get("heatmap-intensity")),rt.id,dt.layoutVertexBuffer,dt.indexBuffer,dt.segments,rt.paint,w.transform.zoom,mt)}}}nt.viewport.set([0,0,w.width,w.height])}else"translucent"===w.renderPass&&(w.context.setColorMode(w.colorModeForRenderPass()),function(w,et){var rt=w.context,it=rt.gl,nt=et.heatmapFbo;if(nt){rt.activeTexture.set(it.TEXTURE0),it.bindTexture(it.TEXTURE_2D,nt.colorAttachment.get()),rt.activeTexture.set(it.TEXTURE1);var ot=et.colorRampTexture;ot||(ot=et.colorRampTexture=new tt.Texture(rt,et.colorRamp,it.RGBA)),ot.bind(it.LINEAR,it.CLAMP_TO_EDGE),w.useProgram("heatmapTexture").draw(rt,it.TRIANGLES,It.disabled,Pt.disabled,w.colorModeForRenderPass(),Ct.disabled,function(w,et,rt,it){var nt=tt.create();tt.ortho(nt,0,w.width,w.height,0,0,1);var ot=w.context.gl;return{u_matrix:nt,u_world:[ot.drawingBufferWidth,ot.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:et.paint.get("heatmap-opacity")}}(w,et),et.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,et.paint,w.transform.zoom)}}(w,rt))},line:function(w,et,rt,it){if("translucent"===w.renderPass){var nt=rt.paint.get("line-opacity"),ot=rt.paint.get("line-width");if(0!==nt.constantOr(1)&&0!==ot.constantOr(1)){var at=w.depthModeForSublayer(0,It.ReadOnly),st=w.colorModeForRenderPass(),ct=rt.paint.get("line-dasharray"),pt=rt.paint.get("line-pattern"),ft=pt.constantOr(1),dt=rt.paint.get("line-gradient"),mt=rt.getCrossfadeParameters(),yt=ft?"linePattern":ct?"lineSDF":dt?"lineGradient":"line",vt=w.context,Dt=vt.gl,Rt=!0;if(dt){vt.activeTexture.set(Dt.TEXTURE0);var Bt=rt.gradientTexture;if(!rt.gradient)return;Bt||(Bt=rt.gradientTexture=new tt.Texture(vt,rt.gradient,Dt.RGBA)),Bt.bind(Dt.LINEAR,Dt.CLAMP_TO_EDGE)}for(var Ot=0,Ne=it;Ot<Ne.length;Ot+=1){var Ze=Ne[Ot],Ge=et.getTile(Ze);if(!ft||Ge.patternsLoaded()){var Ke=Ge.getBucket(rt);if(Ke){var er=Ke.programConfigurations.get(rt.id),rr=w.context.program.get(),vr=w.useProgram(yt,er),wr=Rt||vr.program!==rr,Sr=pt.constantOr(null);if(Sr&&Ge.imageAtlas){var ei=Ge.imageAtlas,ii=ei.patternPositions[Sr.to.toString()],mi=ei.patternPositions[Sr.from.toString()];ii&&mi&&er.setConstantPatternPositions(ii,mi)}var qi=ft?Oi(w,Ge,rt,mt):ct?Fi(w,Ge,rt,ct,mt):dt?Bi(w,Ge,rt):ki(w,Ge,rt);ft?(vt.activeTexture.set(Dt.TEXTURE0),Ge.imageAtlasTexture.bind(Dt.LINEAR,Dt.CLAMP_TO_EDGE),er.updatePaintBuffers(mt)):ct&&(wr||w.lineAtlas.dirty)&&(vt.activeTexture.set(Dt.TEXTURE0),w.lineAtlas.bind(vt)),vr.draw(vt,Dt.TRIANGLES,at,w.stencilModeForClipping(Ze),st,Ct.disabled,qi,rt.id,Ke.layoutVertexBuffer,Ke.indexBuffer,Ke.segments,rt.paint,w.transform.zoom,er),Rt=!1}}}}}},fill:function(w,et,rt,it){var nt=rt.paint.get("fill-color"),ot=rt.paint.get("fill-opacity");if(0!==ot.constantOr(1)){var at=w.colorModeForRenderPass(),st=rt.paint.get("fill-pattern"),ct=w.opaquePassEnabledForLayer()&&!st.constantOr(1)&&1===nt.constantOr(tt.Color.transparent).a&&1===ot.constantOr(0)?"opaque":"translucent";if(w.renderPass===ct){var pt=w.depthModeForSublayer(1,"opaque"===w.renderPass?It.ReadWrite:It.ReadOnly);oo(w,et,rt,it,pt,at,!1)}if("translucent"===w.renderPass&&rt.paint.get("fill-antialias")){var ft=w.depthModeForSublayer(rt.getPaintProperty("fill-outline-color")?2:0,It.ReadOnly);oo(w,et,rt,it,ft,at,!0)}}},"fill-extrusion":function(w,tt,et,rt){var it=et.paint.get("fill-extrusion-opacity");if(0!==it&&"translucent"===w.renderPass){var nt=new It(w.context.gl.LEQUAL,It.ReadWrite,w.depthRangeFor3D);if(1!==it||et.paint.get("fill-extrusion-pattern").constantOr(1))ro(w,tt,et,rt,nt,Pt.disabled,St.disabled),ro(w,tt,et,rt,nt,w.stencilModeFor3D(),w.colorModeForRenderPass());else{var ot=w.colorModeForRenderPass();ro(w,tt,et,rt,nt,Pt.disabled,ot)}}},hillshade:function(w,tt,et,rt){if("offscreen"===w.renderPass||"translucent"===w.renderPass){for(var it=w.context,nt=tt.getSource().maxzoom,ot=w.depthModeForSublayer(0,It.ReadOnly),at=w.colorModeForRenderPass(),st="translucent"===w.renderPass?w.stencilConfigForOverlap(rt):[{},rt],ct=st[0],pt=0,ft=st[1];pt<ft.length;pt+=1){var dt=ft[pt],mt=tt.getTile(dt);mt.needsHillshadePrepare&&"offscreen"===w.renderPass?no(w,mt,et,nt,ot,Pt.disabled,at):"translucent"===w.renderPass&&ao(w,mt,et,ot,ct[dt.overscaledZ],at)}it.viewport.set([0,0,w.width,w.height])}},raster:function(w,tt,et,rt){if("translucent"===w.renderPass&&0!==et.paint.get("raster-opacity")&&rt.length)for(var it=w.context,nt=it.gl,ot=tt.getSource(),at=w.useProgram("raster"),st=w.colorModeForRenderPass(),ct=ot instanceof Ge?[{},rt]:w.stencilConfigForOverlap(rt),pt=ct[0],ft=ct[1],dt=ft[ft.length-1].overscaledZ,mt=!w.options.moving,yt=0,vt=ft;yt<vt.length;yt+=1){var Dt=vt[yt],Rt=w.depthModeForSublayer(Dt.overscaledZ-dt,1===et.paint.get("raster-opacity")?It.ReadWrite:It.ReadOnly,nt.LESS),Bt=tt.getTile(Dt),Ot=w.transform.calculatePosMatrix(Dt.toUnwrapped(),mt);Bt.registerFadeDuration(et.paint.get("raster-fade-duration"));var Ne=tt.findLoadedParent(Dt,0),Ze=so(Bt,Ne,tt,et,w.transform),Ke=void 0,er=void 0,rr="nearest"===et.paint.get("raster-resampling")?nt.NEAREST:nt.LINEAR;it.activeTexture.set(nt.TEXTURE0),Bt.texture.bind(rr,nt.CLAMP_TO_EDGE,nt.LINEAR_MIPMAP_NEAREST),it.activeTexture.set(nt.TEXTURE1),Ne?(Ne.texture.bind(rr,nt.CLAMP_TO_EDGE,nt.LINEAR_MIPMAP_NEAREST),Ke=Math.pow(2,Ne.tileID.overscaledZ-Bt.tileID.overscaledZ),er=[Bt.tileID.canonical.x*Ke%1,Bt.tileID.canonical.y*Ke%1]):Bt.texture.bind(rr,nt.CLAMP_TO_EDGE,nt.LINEAR_MIPMAP_NEAREST);var vr=Zi(Ot,er||[0,0],Ke||1,Ze,et);ot instanceof Ge?at.draw(it,nt.TRIANGLES,Rt,Pt.disabled,st,Ct.disabled,vr,et.id,ot.boundsBuffer,w.quadTriangleIndexBuffer,ot.boundsSegments):at.draw(it,nt.TRIANGLES,Rt,pt[Dt.overscaledZ],st,Ct.disabled,vr,et.id,w.rasterBoundsBuffer,w.quadTriangleIndexBuffer,w.rasterBoundsSegments)}},background:function(w,tt,et){var rt=et.paint.get("background-color"),it=et.paint.get("background-opacity");if(0!==it){var nt=w.context,ot=nt.gl,at=w.transform,st=at.tileSize,ct=et.paint.get("background-pattern");if(!w.isPatternMissing(ct)){var pt=!ct&&1===rt.a&&1===it&&w.opaquePassEnabledForLayer()?"opaque":"translucent";if(w.renderPass===pt){var ft=Pt.disabled,dt=w.depthModeForSublayer(0,"opaque"===pt?It.ReadWrite:It.ReadOnly),mt=w.colorModeForRenderPass(),yt=w.useProgram(ct?"backgroundPattern":"background"),vt=at.coveringTiles({tileSize:st});ct&&(nt.activeTexture.set(ot.TEXTURE0),w.imageManager.bind(w.context));for(var Dt=et.getCrossfadeParameters(),Rt=0,Bt=vt;Rt<Bt.length;Rt+=1){var Ot=Bt[Rt],Ne=w.transform.calculatePosMatrix(Ot.toUnwrapped()),Ze=ct?Hi(Ne,it,w,ct,{tileID:Ot,tileSize:st},Dt):Xi(Ne,it,rt);yt.draw(nt,ot.TRIANGLES,dt,ft,mt,Ct.disabled,Ze,et.id,w.tileExtentBuffer,w.quadTriangleIndexBuffer,w.tileExtentSegments)}}}}},debug:function(w,tt,et){for(var rt=0;rt<et.length;rt++)go(w,tt,et[rt])},custom:function(w,tt,et){var rt=w.context,it=et.implementation;if("offscreen"===w.renderPass){var nt=it.prerender;nt&&(w.setCustomLayerDefaults(),rt.setColorMode(w.colorModeForRenderPass()),nt.call(it,rt.gl,w.transform.customLayerMatrix()),rt.setDirty(),w.setBaseState())}else if("translucent"===w.renderPass){w.setCustomLayerDefaults(),rt.setColorMode(w.colorModeForRenderPass()),rt.setStencilMode(Pt.disabled);var ot="3d"===it.renderingMode?new It(w.context.gl.LEQUAL,It.ReadWrite,w.depthRangeFor3D):w.depthModeForSublayer(0,It.ReadOnly);rt.setDepthMode(ot),it.render(rt.gl,w.transform.customLayerMatrix()),rt.setDirty(),w.setBaseState(),rt.bindFramebuffer.set(null)}}},yo=function(tt,et){(this||w).context=new zt(tt),(this||w).transform=et,(this||w)._tileTextures={},this.setup(),(this||w).numSublayers=la.maxUnderzooming+la.maxOverzooming+1,(this||w).depthEpsilon=1/Math.pow(2,16),(this||w).crossTileSymbolIndex=new Fe,(this||w).gpuTimers={}};yo.prototype.resize=function(et,rt){if((this||w).width=et*tt.browser.devicePixelRatio,(this||w).height=rt*tt.browser.devicePixelRatio,(this||w).context.viewport.set([0,0,(this||w).width,(this||w).height]),(this||w).style)for(var it=0,nt=(this||w).style._order;it<nt.length;it+=1)(this||w).style._layers[nt[it]].resize()},yo.prototype.setup=function(){var et=(this||w).context,rt=new tt.StructArrayLayout2i4;rt.emplaceBack(0,0),rt.emplaceBack(tt.EXTENT,0),rt.emplaceBack(0,tt.EXTENT),rt.emplaceBack(tt.EXTENT,tt.EXTENT),(this||w).tileExtentBuffer=et.createVertexBuffer(rt,us.members),(this||w).tileExtentSegments=tt.SegmentVector.simpleSegment(0,0,4,2);var it=new tt.StructArrayLayout2i4;it.emplaceBack(0,0),it.emplaceBack(tt.EXTENT,0),it.emplaceBack(0,tt.EXTENT),it.emplaceBack(tt.EXTENT,tt.EXTENT),(this||w).debugBuffer=et.createVertexBuffer(it,us.members),(this||w).debugSegments=tt.SegmentVector.simpleSegment(0,0,4,5);var nt=new tt.StructArrayLayout4i8;nt.emplaceBack(0,0,0,0),nt.emplaceBack(tt.EXTENT,0,tt.EXTENT,0),nt.emplaceBack(0,tt.EXTENT,0,tt.EXTENT),nt.emplaceBack(tt.EXTENT,tt.EXTENT,tt.EXTENT,tt.EXTENT),(this||w).rasterBoundsBuffer=et.createVertexBuffer(nt,Ze.members),(this||w).rasterBoundsSegments=tt.SegmentVector.simpleSegment(0,0,4,2);var ot=new tt.StructArrayLayout2i4;ot.emplaceBack(0,0),ot.emplaceBack(1,0),ot.emplaceBack(0,1),ot.emplaceBack(1,1),(this||w).viewportBuffer=et.createVertexBuffer(ot,us.members),(this||w).viewportSegments=tt.SegmentVector.simpleSegment(0,0,4,2);var at=new tt.StructArrayLayout1ui2;at.emplaceBack(0),at.emplaceBack(1),at.emplaceBack(3),at.emplaceBack(2),at.emplaceBack(0),(this||w).tileBorderIndexBuffer=et.createIndexBuffer(at);var st=new tt.StructArrayLayout3ui6;st.emplaceBack(0,1,2),st.emplaceBack(2,1,3),(this||w).quadTriangleIndexBuffer=et.createIndexBuffer(st),(this||w).emptyTexture=new tt.Texture(et,{width:1,height:1,data:new Uint8Array([0,0,0,0])},et.gl.RGBA);var ct=(this||w).context.gl;(this||w).stencilClearMode=new Pt({func:ct.ALWAYS,mask:0},0,255,ct.ZERO,ct.ZERO,ct.ZERO)},yo.prototype.clearStencil=function(){var et=(this||w).context,rt=et.gl;(this||w).nextStencilID=1,(this||w).currentStencilSource=void 0;var it=tt.create();tt.ortho(it,0,(this||w).width,(this||w).height,0,0,1),tt.scale(it,it,[rt.drawingBufferWidth,rt.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(et,rt.TRIANGLES,It.disabled,(this||w).stencilClearMode,St.disabled,Ct.disabled,Ai(it),"$clipping",(this||w).viewportBuffer,(this||w).quadTriangleIndexBuffer,(this||w).viewportSegments)},yo.prototype._renderTileClippingMasks=function(tt,et){if((this||w).currentStencilSource!==tt.source&&tt.isTileClipped()&&et&&et.length){(this||w).currentStencilSource=tt.source;var rt=(this||w).context,it=rt.gl;(this||w).nextStencilID+et.length>256&&this.clearStencil(),rt.setColorMode(St.disabled),rt.setDepthMode(It.disabled);var nt=this.useProgram("clippingMask");(this||w)._tileClippingMaskIDs={};for(var ot=0,at=et;ot<at.length;ot+=1){var st=at[ot],ct=(this||w)._tileClippingMaskIDs[st.key]=(this||w).nextStencilID++;nt.draw(rt,it.TRIANGLES,It.disabled,new Pt({func:it.ALWAYS,mask:0},ct,255,it.KEEP,it.KEEP,it.REPLACE),St.disabled,Ct.disabled,Ai(st.posMatrix),"$clipping",(this||w).tileExtentBuffer,(this||w).quadTriangleIndexBuffer,(this||w).tileExtentSegments)}}},yo.prototype.stencilModeFor3D=function(){(this||w).currentStencilSource=void 0,(this||w).nextStencilID+1>256&&this.clearStencil();var tt=(this||w).nextStencilID++,et=(this||w).context.gl;return new Pt({func:et.NOTEQUAL,mask:255},tt,255,et.KEEP,et.KEEP,et.REPLACE)},yo.prototype.stencilModeForClipping=function(tt){var et=(this||w).context.gl;return new Pt({func:et.EQUAL,mask:255},(this||w)._tileClippingMaskIDs[tt.key],0,et.KEEP,et.KEEP,et.REPLACE)},yo.prototype.stencilConfigForOverlap=function(tt){var et,rt=(this||w).context.gl,it=tt.sort((function(w,tt){return tt.overscaledZ-w.overscaledZ})),nt=it[it.length-1].overscaledZ,ot=it[0].overscaledZ-nt+1;if(ot>1){(this||w).currentStencilSource=void 0,(this||w).nextStencilID+ot>256&&this.clearStencil();for(var at={},st=0;st<ot;st++)at[st+nt]=new Pt({func:rt.GEQUAL,mask:255},st+(this||w).nextStencilID,255,rt.KEEP,rt.KEEP,rt.REPLACE);return(this||w).nextStencilID+=ot,[at,it]}return[(et={},et[nt]=Pt.disabled,et),it]},yo.prototype.colorModeForRenderPass=function(){var et=(this||w).context.gl;return(this||w)._showOverdrawInspector?new St([et.CONSTANT_COLOR,et.ONE],new tt.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===(this||w).renderPass?St.unblended:St.alphaBlended},yo.prototype.depthModeForSublayer=function(tt,et,rt){if(!this.opaquePassEnabledForLayer())return It.disabled;var it=1-((1+(this||w).currentLayer)*(this||w).numSublayers+tt)*(this||w).depthEpsilon;return new It(rt||(this||w).context.gl.LEQUAL,et,[it,it])},yo.prototype.opaquePassEnabledForLayer=function(){return(this||w).currentLayer<(this||w).opaquePassCutoff},yo.prototype.render=function(et,rt){var it=this||w;(this||w).style=et,(this||w).options=rt,(this||w).lineAtlas=et.lineAtlas,(this||w).imageManager=et.imageManager,(this||w).glyphManager=et.glyphManager,(this||w).symbolFadeChange=et.placement.symbolFadeChange(tt.browser.now()),(this||w).imageManager.beginFrame();var nt=(this||w).style._order,ot=(this||w).style.sourceCaches;for(var at in ot){var st=ot[at];st.used&&st.prepare((this||w).context)}var ct,pt,ft={},dt={},mt={};for(var yt in ot){var vt=ot[yt];ft[yt]=vt.getVisibleCoordinates(),dt[yt]=ft[yt].slice().reverse(),mt[yt]=vt.getVisibleCoordinates(!0).reverse()}(this||w).opaquePassCutoff=1/0;for(var Dt=0;Dt<nt.length;Dt++)if((this||w).style._layers[nt[Dt]].is3D()){(this||w).opaquePassCutoff=Dt;break}(this||w).renderPass="offscreen";for(var Rt=0,Bt=nt;Rt<Bt.length;Rt+=1){var Ot=(this||w).style._layers[Bt[Rt]];if(Ot.hasOffscreenPass()&&!Ot.isHidden((this||w).transform.zoom)){var Ne=dt[Ot.source];("custom"===Ot.type||Ne.length)&&this.renderLayer(this||w,ot[Ot.source],Ot,Ne)}}for((this||w).context.bindFramebuffer.set(null),(this||w).context.clear({color:rt.showOverdrawInspector?tt.Color.black:tt.Color.transparent,depth:1}),this.clearStencil(),(this||w)._showOverdrawInspector=rt.showOverdrawInspector,(this||w).depthRangeFor3D=[0,1-(et._order.length+2)*(this||w).numSublayers*(this||w).depthEpsilon],(this||w).renderPass="opaque",(this||w).currentLayer=nt.length-1;(this||w).currentLayer>=0;(this||w).currentLayer--){var Ze=(this||w).style._layers[nt[(this||w).currentLayer]],Ge=ot[Ze.source],Ke=ft[Ze.source];this._renderTileClippingMasks(Ze,Ke),this.renderLayer(this||w,Ge,Ze,Ke)}for((this||w).renderPass="translucent",(this||w).currentLayer=0;(this||w).currentLayer<nt.length;(this||w).currentLayer++){var er=(this||w).style._layers[nt[(this||w).currentLayer]],rr=ot[er.source],vr=("symbol"===er.type?mt:dt)[er.source];this._renderTileClippingMasks(er,ft[er.source]),this.renderLayer(this||w,rr,er,vr)}(this||w).options.showTileBoundaries&&(tt.values((this||w).style._layers).forEach((function(w){w.source&&!w.isHidden(it.transform.zoom)&&(w.source!==(pt&&pt.id)&&(pt=it.style.sourceCaches[w.source]),(!ct||ct.getSource().maxzoom<pt.getSource().maxzoom)&&(ct=pt))})),ct&&Al.debug(this||w,ct,ct.getVisibleCoordinates())),(this||w).options.showPadding&&function(w){var tt=w.transform.padding;_o(w,w.transform.height-(tt.top||0),3,xl),_o(w,tt.bottom||0,3,bl),fo(w,tt.left||0,3,wl),fo(w,w.transform.width-(tt.right||0),3,Sl);var et=w.transform.centerPoint;!function(w,tt,et,rt){mo(w,tt-1,et-10,2,20,rt),mo(w,tt-10,et-1,20,2,rt)}(w,et.x,w.transform.height-et.y,Il)}(this||w),(this||w).context.setDefault()},yo.prototype.renderLayer=function(tt,et,rt,it){rt.isHidden((this||w).transform.zoom)||("background"===rt.type||"custom"===rt.type||it.length)&&((this||w).id=rt.id,this.gpuTimingStart(rt),Al[rt.type](tt,et,rt,it,(this||w).style.placement.variableOffsets),this.gpuTimingEnd())},yo.prototype.gpuTimingStart=function(tt){if((this||w).options.gpuTiming){var et=(this||w).context.extTimerQuery,rt=(this||w).gpuTimers[tt.id];rt||(rt=(this||w).gpuTimers[tt.id]={calls:0,cpuTime:0,query:et.createQueryEXT()}),rt.calls++,et.beginQueryEXT(et.TIME_ELAPSED_EXT,rt.query)}},yo.prototype.gpuTimingEnd=function(){if((this||w).options.gpuTiming){var tt=(this||w).context.extTimerQuery;tt.endQueryEXT(tt.TIME_ELAPSED_EXT)}},yo.prototype.collectGpuTimers=function(){var tt=(this||w).gpuTimers;return(this||w).gpuTimers={},tt},yo.prototype.queryGpuTimers=function(tt){var et={};for(var rt in tt){var it=tt[rt],nt=(this||w).context.extTimerQuery,ot=nt.getQueryObjectEXT(it.query,nt.QUERY_RESULT_EXT)/1e6;nt.deleteQueryEXT(it.query),et[rt]=ot}return et},yo.prototype.translatePosMatrix=function(et,rt,it,nt,ot){if(!it[0]&&!it[1])return et;var at=ot?"map"===nt?(this||w).transform.angle:0:"viewport"===nt?-(this||w).transform.angle:0;if(at){var st=Math.sin(at),ct=Math.cos(at);it=[it[0]*ct-it[1]*st,it[0]*st+it[1]*ct]}var pt=[ot?it[0]:pe(rt,it[0],(this||w).transform.zoom),ot?it[1]:pe(rt,it[1],(this||w).transform.zoom),0],ft=new Float32Array(16);return tt.translate(ft,et,pt),ft},yo.prototype.saveTileTexture=function(tt){var et=(this||w)._tileTextures[tt.size[0]];et?et.push(tt):(this||w)._tileTextures[tt.size[0]]=[tt]},yo.prototype.getTileTexture=function(tt){var et=(this||w)._tileTextures[tt];return et&&et.length>0?et.pop():null},yo.prototype.isPatternMissing=function(tt){if(!tt)return!1;if(!tt.from||!tt.to)return!0;var et=(this||w).imageManager.getPattern(tt.from.toString()),rt=(this||w).imageManager.getPattern(tt.to.toString());return!et||!rt},yo.prototype.useProgram=function(tt,et){(this||w).cache=(this||w).cache||{};var rt=""+tt+(et?et.cacheKey:"")+((this||w)._showOverdrawInspector?"/overdraw":"");return(this||w).cache[rt]||((this||w).cache[rt]=new bi((this||w).context,tt,yl[tt],et,_l[tt],(this||w)._showOverdrawInspector)),(this||w).cache[rt]},yo.prototype.setCustomLayerDefaults=function(){(this||w).context.unbindVAO(),(this||w).context.cullFace.setDefault(),(this||w).context.activeTexture.setDefault(),(this||w).context.pixelStoreUnpack.setDefault(),(this||w).context.pixelStoreUnpackPremultiplyAlpha.setDefault(),(this||w).context.pixelStoreUnpackFlipY.setDefault()},yo.prototype.setBaseState=function(){var tt=(this||w).context.gl;(this||w).context.cullFace.set(!1),(this||w).context.viewport.set([0,0,(this||w).width,(this||w).height]),(this||w).context.blendEquation.set(tt.FUNC_ADD)},yo.prototype.initDebugOverlayCanvas=function(){null==(this||w).debugOverlayCanvas&&((this||w).debugOverlayCanvas=tt.window.document.createElement("canvas"),(this||w).debugOverlayCanvas.width=512,(this||w).debugOverlayCanvas.height=512,(this||w).debugOverlayTexture=new tt.Texture((this||w).context,(this||w).debugOverlayCanvas,(this||w).context.gl.RGBA))},yo.prototype.destroy=function(){(this||w).emptyTexture.destroy(),(this||w).debugOverlayTexture&&(this||w).debugOverlayTexture.destroy()};var xo=function(tt,et){(this||w).points=tt,(this||w).planes=et};xo.fromInvProjectionMatrix=function(w,et,rt){var it=Math.pow(2,rt),nt=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((function(et){return tt.transformMat4([],et,w)})).map((function(w){return tt.scale$1([],w,1/w[3]/et*it)})),ot=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((function(w){var et=tt.sub([],nt[w[0]],nt[w[1]]),rt=tt.sub([],nt[w[2]],nt[w[1]]),it=tt.normalize([],tt.cross([],et,rt)),ot=-tt.dot(it,nt[w[1]]);return it.concat(ot)}));return new xo(nt,ot)};var bo=function(et,rt){(this||w).min=et,(this||w).max=rt,(this||w).center=tt.scale$2([],tt.add([],(this||w).min,(this||w).max),.5)};bo.prototype.quadrant=function(et){for(var rt=[et%2==0,et<2],it=tt.clone$2((this||w).min),nt=tt.clone$2((this||w).max),ot=0;ot<rt.length;ot++)it[ot]=rt[ot]?(this||w).min[ot]:(this||w).center[ot],nt[ot]=rt[ot]?(this||w).center[ot]:(this||w).max[ot];return nt[2]=(this||w).max[2],new bo(it,nt)},bo.prototype.distanceX=function(tt){return Math.max(Math.min((this||w).max[0],tt[0]),(this||w).min[0])-tt[0]},bo.prototype.distanceY=function(tt){return Math.max(Math.min((this||w).max[1],tt[1]),(this||w).min[1])-tt[1]},bo.prototype.intersects=function(et){for(var rt=[[(this||w).min[0],(this||w).min[1],0,1],[(this||w).max[0],(this||w).min[1],0,1],[(this||w).max[0],(this||w).max[1],0,1],[(this||w).min[0],(this||w).max[1],0,1]],it=!0,nt=0;nt<et.planes.length;nt++){for(var ot=et.planes[nt],at=0,st=0;st<rt.length;st++)at+=tt.dot$1(ot,rt[st])>=0;if(0===at)return 0;at!==rt.length&&(it=!1)}if(it)return 2;for(var ct=0;ct<3;ct++){for(var pt=Number.MAX_VALUE,ft=-Number.MAX_VALUE,dt=0;dt<et.points.length;dt++){var mt=et.points[dt][ct]-(this||w).min[ct];pt=Math.min(pt,mt),ft=Math.max(ft,mt)}if(ft<0||pt>(this||w).max[ct]-(this||w).min[ct])return 0}return 1};var wo=function(tt,et,rt,it){if(void 0===tt&&(tt=0),void 0===et&&(et=0),void 0===rt&&(rt=0),void 0===it&&(it=0),isNaN(tt)||tt<0||isNaN(et)||et<0||isNaN(rt)||rt<0||isNaN(it)||it<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");(this||w).top=tt,(this||w).bottom=et,(this||w).left=rt,(this||w).right=it};wo.prototype.interpolate=function(et,rt,it){return null!=rt.top&&null!=et.top&&((this||w).top=tt.number(et.top,rt.top,it)),null!=rt.bottom&&null!=et.bottom&&((this||w).bottom=tt.number(et.bottom,rt.bottom,it)),null!=rt.left&&null!=et.left&&((this||w).left=tt.number(et.left,rt.left,it)),null!=rt.right&&null!=et.right&&((this||w).right=tt.number(et.right,rt.right,it)),this||w},wo.prototype.getCenter=function(et,rt){var it=tt.clamp(((this||w).left+et-(this||w).right)/2,0,et),nt=tt.clamp(((this||w).top+rt-(this||w).bottom)/2,0,rt);return new tt.Point(it,nt)},wo.prototype.equals=function(tt){return(this||w).top===tt.top&&(this||w).bottom===tt.bottom&&(this||w).left===tt.left&&(this||w).right===tt.right},wo.prototype.clone=function(){return new wo((this||w).top,(this||w).bottom,(this||w).left,(this||w).right)},wo.prototype.toJSON=function(){return{top:(this||w).top,bottom:(this||w).bottom,left:(this||w).left,right:(this||w).right}};var To=function(et,rt,it,nt,ot){(this||w).tileSize=512,(this||w).maxValidLatitude=85.051129,(this||w)._renderWorldCopies=void 0===ot||ot,(this||w)._minZoom=et||0,(this||w)._maxZoom=rt||22,(this||w)._minPitch=null==it?0:it,(this||w)._maxPitch=null==nt?60:nt,this.setMaxBounds(),(this||w).width=0,(this||w).height=0,(this||w)._center=new tt.LngLat(0,0),(this||w).zoom=0,(this||w).angle=0,(this||w)._fov=.6435011087932844,(this||w)._pitch=0,(this||w)._unmodified=!0,(this||w)._edgeInsets=new wo,(this||w)._posMatrixCache={},(this||w)._alignedPosMatrixCache={}},zl={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};To.prototype.clone=function(){var tt=new To((this||w)._minZoom,(this||w)._maxZoom,(this||w)._minPitch,(this||w).maxPitch,(this||w)._renderWorldCopies);return tt.tileSize=(this||w).tileSize,tt.latRange=(this||w).latRange,tt.width=(this||w).width,tt.height=(this||w).height,tt._center=(this||w)._center,tt.zoom=(this||w).zoom,tt.angle=(this||w).angle,tt._fov=(this||w)._fov,tt._pitch=(this||w)._pitch,tt._unmodified=(this||w)._unmodified,tt._edgeInsets=(this||w)._edgeInsets.clone(),tt._calcMatrices(),tt},zl.minZoom.get=function(){return(this||w)._minZoom},zl.minZoom.set=function(tt){(this||w)._minZoom!==tt&&((this||w)._minZoom=tt,(this||w).zoom=Math.max((this||w).zoom,tt))},zl.maxZoom.get=function(){return(this||w)._maxZoom},zl.maxZoom.set=function(tt){(this||w)._maxZoom!==tt&&((this||w)._maxZoom=tt,(this||w).zoom=Math.min((this||w).zoom,tt))},zl.minPitch.get=function(){return(this||w)._minPitch},zl.minPitch.set=function(tt){(this||w)._minPitch!==tt&&((this||w)._minPitch=tt,(this||w).pitch=Math.max((this||w).pitch,tt))},zl.maxPitch.get=function(){return(this||w)._maxPitch},zl.maxPitch.set=function(tt){(this||w)._maxPitch!==tt&&((this||w)._maxPitch=tt,(this||w).pitch=Math.min((this||w).pitch,tt))},zl.renderWorldCopies.get=function(){return(this||w)._renderWorldCopies},zl.renderWorldCopies.set=function(tt){void 0===tt?tt=!0:null===tt&&(tt=!1),(this||w)._renderWorldCopies=tt},zl.worldSize.get=function(){return(this||w).tileSize*(this||w).scale},zl.centerOffset.get=function(){return(this||w).centerPoint._sub((this||w).size._div(2))},zl.size.get=function(){return new tt.Point((this||w).width,(this||w).height)},zl.bearing.get=function(){return-(this||w).angle/Math.PI*180},zl.bearing.set=function(et){var rt=-tt.wrap(et,-180,180)*Math.PI/180;(this||w).angle!==rt&&((this||w)._unmodified=!1,(this||w).angle=rt,this._calcMatrices(),(this||w).rotationMatrix=tt.create$2(),tt.rotate((this||w).rotationMatrix,(this||w).rotationMatrix,(this||w).angle))},zl.pitch.get=function(){return(this||w)._pitch/Math.PI*180},zl.pitch.set=function(et){var rt=tt.clamp(et,(this||w).minPitch,(this||w).maxPitch)/180*Math.PI;(this||w)._pitch!==rt&&((this||w)._unmodified=!1,(this||w)._pitch=rt,this._calcMatrices())},zl.fov.get=function(){return(this||w)._fov/Math.PI*180},zl.fov.set=function(tt){tt=Math.max(.01,Math.min(60,tt)),(this||w)._fov!==tt&&((this||w)._unmodified=!1,(this||w)._fov=tt/180*Math.PI,this._calcMatrices())},zl.zoom.get=function(){return(this||w)._zoom},zl.zoom.set=function(tt){var et=Math.min(Math.max(tt,(this||w).minZoom),(this||w).maxZoom);(this||w)._zoom!==et&&((this||w)._unmodified=!1,(this||w)._zoom=et,(this||w).scale=this.zoomScale(et),(this||w).tileZoom=Math.floor(et),(this||w).zoomFraction=et-(this||w).tileZoom,this._constrain(),this._calcMatrices())},zl.center.get=function(){return(this||w)._center},zl.center.set=function(tt){tt.lat===(this||w)._center.lat&&tt.lng===(this||w)._center.lng||((this||w)._unmodified=!1,(this||w)._center=tt,this._constrain(),this._calcMatrices())},zl.padding.get=function(){return(this||w)._edgeInsets.toJSON()},zl.padding.set=function(tt){(this||w)._edgeInsets.equals(tt)||((this||w)._unmodified=!1,(this||w)._edgeInsets.interpolate((this||w)._edgeInsets,tt,1),this._calcMatrices())},zl.centerPoint.get=function(){return(this||w)._edgeInsets.getCenter((this||w).width,(this||w).height)},To.prototype.isPaddingEqual=function(tt){return(this||w)._edgeInsets.equals(tt)},To.prototype.interpolatePadding=function(tt,et,rt){(this||w)._unmodified=!1,(this||w)._edgeInsets.interpolate(tt,et,rt),this._constrain(),this._calcMatrices()},To.prototype.coveringZoomLevel=function(tt){var et=(tt.roundZoom?Math.round:Math.floor)((this||w).zoom+this.scaleZoom((this||w).tileSize/tt.tileSize));return Math.max(0,et)},To.prototype.getVisibleUnwrappedCoordinates=function(et){var rt=[new tt.UnwrappedTileID(0,et)];if((this||w)._renderWorldCopies)for(var it=this.pointCoordinate(new tt.Point(0,0)),nt=this.pointCoordinate(new tt.Point((this||w).width,0)),ot=this.pointCoordinate(new tt.Point((this||w).width,(this||w).height)),at=this.pointCoordinate(new tt.Point(0,(this||w).height)),st=Math.floor(Math.min(it.x,nt.x,ot.x,at.x)),ct=Math.floor(Math.max(it.x,nt.x,ot.x,at.x)),pt=st-1;pt<=ct+1;pt++)0!==pt&&rt.push(new tt.UnwrappedTileID(pt,et));return rt},To.prototype.coveringTiles=function(et){var rt=this.coveringZoomLevel(et),it=rt;if(void 0!==et.minzoom&&rt<et.minzoom)return[];void 0!==et.maxzoom&&rt>et.maxzoom&&(rt=et.maxzoom);var nt=tt.MercatorCoordinate.fromLngLat((this||w).center),ot=Math.pow(2,rt),at=[ot*nt.x,ot*nt.y,0],st=xo.fromInvProjectionMatrix((this||w).invProjMatrix,(this||w).worldSize,rt),ct=et.minzoom||0;(this||w).pitch<=60&&(this||w)._edgeInsets.top<.1&&(ct=rt);var c=function(w){return{aabb:new bo([w*ot,0,0],[(w+1)*ot,ot,0]),zoom:0,x:0,y:0,wrap:w,fullyVisible:!1}},pt=[],ft=[],dt=rt,mt=et.reparseOverscaled?it:rt;if((this||w)._renderWorldCopies)for(var yt=1;yt<=3;yt++)pt.push(c(-yt)),pt.push(c(yt));for(pt.push(c(0));pt.length>0;){var vt=pt.pop(),Dt=vt.x,Rt=vt.y,Bt=vt.fullyVisible;if(!Bt){var Ot=vt.aabb.intersects(st);if(0===Ot)continue;Bt=2===Ot}var Ne=vt.aabb.distanceX(at),Ze=vt.aabb.distanceY(at),Ge=Math.max(Math.abs(Ne),Math.abs(Ze));if(vt.zoom===dt||Ge>3+(1<<dt-vt.zoom)-2&&vt.zoom>=ct)ft.push({tileID:new tt.OverscaledTileID(vt.zoom===dt?mt:vt.zoom,vt.wrap,vt.zoom,Dt,Rt),distanceSq:tt.sqrLen([at[0]-.5-Dt,at[1]-.5-Rt])});else for(var Ke=0;Ke<4;Ke++){var er=(Dt<<1)+Ke%2,rr=(Rt<<1)+(Ke>>1);pt.push({aabb:vt.aabb.quadrant(Ke),zoom:vt.zoom+1,x:er,y:rr,wrap:vt.wrap,fullyVisible:Bt})}}return ft.sort((function(w,tt){return w.distanceSq-tt.distanceSq})).map((function(w){return w.tileID}))},To.prototype.resize=function(tt,et){(this||w).width=tt,(this||w).height=et,(this||w).pixelsToGLUnits=[2/tt,-2/et],this._constrain(),this._calcMatrices()},zl.unmodified.get=function(){return(this||w)._unmodified},To.prototype.zoomScale=function(w){return Math.pow(2,w)},To.prototype.scaleZoom=function(w){return Math.log(w)/Math.LN2},To.prototype.project=function(et){var rt=tt.clamp(et.lat,-(this||w).maxValidLatitude,(this||w).maxValidLatitude);return new tt.Point(tt.mercatorXfromLng(et.lng)*(this||w).worldSize,tt.mercatorYfromLat(rt)*(this||w).worldSize)},To.prototype.unproject=function(et){return new tt.MercatorCoordinate(et.x/(this||w).worldSize,et.y/(this||w).worldSize).toLngLat()},zl.point.get=function(){return this.project((this||w).center)},To.prototype.setLocationAtPoint=function(et,rt){var it=this.pointCoordinate(rt),nt=this.pointCoordinate((this||w).centerPoint),ot=this.locationCoordinate(et),at=new tt.MercatorCoordinate(ot.x-(it.x-nt.x),ot.y-(it.y-nt.y));(this||w).center=this.coordinateLocation(at),(this||w)._renderWorldCopies&&((this||w).center=(this||w).center.wrap())},To.prototype.locationPoint=function(w){return this.coordinatePoint(this.locationCoordinate(w))},To.prototype.pointLocation=function(w){return this.coordinateLocation(this.pointCoordinate(w))},To.prototype.locationCoordinate=function(w){return tt.MercatorCoordinate.fromLngLat(w)},To.prototype.coordinateLocation=function(w){return w.toLngLat()},To.prototype.pointCoordinate=function(et){var rt=[et.x,et.y,0,1],it=[et.x,et.y,1,1];tt.transformMat4(rt,rt,(this||w).pixelMatrixInverse),tt.transformMat4(it,it,(this||w).pixelMatrixInverse);var nt=rt[3],ot=it[3],at=rt[1]/nt,st=it[1]/ot,ct=rt[2]/nt,pt=it[2]/ot,ft=ct===pt?0:(0-ct)/(pt-ct);return new tt.MercatorCoordinate(tt.number(rt[0]/nt,it[0]/ot,ft)/(this||w).worldSize,tt.number(at,st,ft)/(this||w).worldSize)},To.prototype.coordinatePoint=function(et){var rt=[et.x*(this||w).worldSize,et.y*(this||w).worldSize,0,1];return tt.transformMat4(rt,rt,(this||w).pixelMatrix),new tt.Point(rt[0]/rt[3],rt[1]/rt[3])},To.prototype.getBounds=function(){return(new tt.LngLatBounds).extend(this.pointLocation(new tt.Point(0,0))).extend(this.pointLocation(new tt.Point((this||w).width,0))).extend(this.pointLocation(new tt.Point((this||w).width,(this||w).height))).extend(this.pointLocation(new tt.Point(0,(this||w).height)))},To.prototype.getMaxBounds=function(){return(this||w).latRange&&2===(this||w).latRange.length&&(this||w).lngRange&&2===(this||w).lngRange.length?new tt.LngLatBounds([(this||w).lngRange[0],(this||w).latRange[0]],[(this||w).lngRange[1],(this||w).latRange[1]]):null},To.prototype.setMaxBounds=function(tt){tt?((this||w).lngRange=[tt.getWest(),tt.getEast()],(this||w).latRange=[tt.getSouth(),tt.getNorth()],this._constrain()):((this||w).lngRange=null,(this||w).latRange=[-(this||w).maxValidLatitude,(this||w).maxValidLatitude])},To.prototype.calculatePosMatrix=function(et,rt){void 0===rt&&(rt=!1);var it=et.key,nt=rt?(this||w)._alignedPosMatrixCache:(this||w)._posMatrixCache;if(nt[it])return nt[it];var ot=et.canonical,at=(this||w).worldSize/this.zoomScale(ot.z),st=ot.x+Math.pow(2,ot.z)*et.wrap,ct=tt.identity(new Float64Array(16));return tt.translate(ct,ct,[st*at,ot.y*at,0]),tt.scale(ct,ct,[at/tt.EXTENT,at/tt.EXTENT,1]),tt.multiply(ct,rt?(this||w).alignedProjMatrix:(this||w).projMatrix,ct),nt[it]=new Float32Array(ct),nt[it]},To.prototype.customLayerMatrix=function(){return(this||w).mercatorMatrix.slice()},To.prototype._constrain=function(){if((this||w).center&&(this||w).width&&(this||w).height&&!(this||w)._constraining){(this||w)._constraining=!0;var et,rt,it,nt,ot=-90,at=90,st=-180,ct=180,pt=(this||w).size,ft=(this||w)._unmodified;if((this||w).latRange){var dt=(this||w).latRange;ot=tt.mercatorYfromLat(dt[1])*(this||w).worldSize,et=(at=tt.mercatorYfromLat(dt[0])*(this||w).worldSize)-ot<pt.y?pt.y/(at-ot):0}if((this||w).lngRange){var mt=(this||w).lngRange;st=tt.mercatorXfromLng(mt[0])*(this||w).worldSize,rt=(ct=tt.mercatorXfromLng(mt[1])*(this||w).worldSize)-st<pt.x?pt.x/(ct-st):0}var yt=(this||w).point,vt=Math.max(rt||0,et||0);if(vt)return(this||w).center=this.unproject(new tt.Point(rt?(ct+st)/2:yt.x,et?(at+ot)/2:yt.y)),(this||w).zoom+=this.scaleZoom(vt),(this||w)._unmodified=ft,void((this||w)._constraining=!1);if((this||w).latRange){var Dt=yt.y,Rt=pt.y/2;Dt-Rt<ot&&(nt=ot+Rt),Dt+Rt>at&&(nt=at-Rt)}if((this||w).lngRange){var Bt=yt.x,Ot=pt.x/2;Bt-Ot<st&&(it=st+Ot),Bt+Ot>ct&&(it=ct-Ot)}void 0===it&&void 0===nt||((this||w).center=this.unproject(new tt.Point(void 0!==it?it:yt.x,void 0!==nt?nt:yt.y))),(this||w)._unmodified=ft,(this||w)._constraining=!1}},To.prototype._calcMatrices=function(){if((this||w).height){var et=(this||w).centerOffset;(this||w).cameraToCenterDistance=.5/Math.tan((this||w)._fov/2)*(this||w).height;var rt=Math.PI/2+(this||w)._pitch,it=(this||w)._fov*(.5+et.y/(this||w).height),nt=Math.sin(it)*(this||w).cameraToCenterDistance/Math.sin(tt.clamp(Math.PI-rt-it,.01,Math.PI-.01)),ot=(this||w).point,at=ot.x,st=ot.y,ct=1.01*(Math.cos(Math.PI/2-(this||w)._pitch)*nt+(this||w).cameraToCenterDistance),pt=(this||w).height/50,ft=new Float64Array(16);tt.perspective(ft,(this||w)._fov,(this||w).width/(this||w).height,pt,ct),ft[8]=2*-et.x/(this||w).width,ft[9]=2*et.y/(this||w).height,tt.scale(ft,ft,[1,-1,1]),tt.translate(ft,ft,[0,0,-(this||w).cameraToCenterDistance]),tt.rotateX(ft,ft,(this||w)._pitch),tt.rotateZ(ft,ft,(this||w).angle),tt.translate(ft,ft,[-at,-st,0]),(this||w).mercatorMatrix=tt.scale([],ft,[(this||w).worldSize,(this||w).worldSize,(this||w).worldSize]),tt.scale(ft,ft,[1,1,tt.mercatorZfromAltitude(1,(this||w).center.lat)*(this||w).worldSize,1]),(this||w).projMatrix=ft,(this||w).invProjMatrix=tt.invert([],(this||w).projMatrix);var dt=(this||w).width%2/2,mt=(this||w).height%2/2,yt=Math.cos((this||w).angle),vt=Math.sin((this||w).angle),Dt=at-Math.round(at)+yt*dt+vt*mt,Rt=st-Math.round(st)+yt*mt+vt*dt,Bt=new Float64Array(ft);if(tt.translate(Bt,Bt,[Dt>.5?Dt-1:Dt,Rt>.5?Rt-1:Rt,0]),(this||w).alignedProjMatrix=Bt,ft=tt.create(),tt.scale(ft,ft,[(this||w).width/2,-(this||w).height/2,1]),tt.translate(ft,ft,[1,-1,0]),(this||w).labelPlaneMatrix=ft,ft=tt.create(),tt.scale(ft,ft,[1,-1,1]),tt.translate(ft,ft,[-1,-1,0]),tt.scale(ft,ft,[2/(this||w).width,2/(this||w).height,1]),(this||w).glCoordMatrix=ft,(this||w).pixelMatrix=tt.multiply(new Float64Array(16),(this||w).labelPlaneMatrix,(this||w).projMatrix),!(ft=tt.invert(new Float64Array(16),(this||w).pixelMatrix)))throw new Error("failed to invert matrix");(this||w).pixelMatrixInverse=ft,(this||w)._posMatrixCache={},(this||w)._alignedPosMatrixCache={}}},To.prototype.maxPitchScaleFactor=function(){if(!(this||w).pixelMatrixInverse)return 1;var et=this.pointCoordinate(new tt.Point(0,0)),rt=[et.x*(this||w).worldSize,et.y*(this||w).worldSize,0,1];return tt.transformMat4(rt,rt,(this||w).pixelMatrix)[3]/(this||w).cameraToCenterDistance},To.prototype.getCameraPoint=function(){var et=Math.tan((this||w)._pitch)*((this||w).cameraToCenterDistance||1);return(this||w).centerPoint.add(new tt.Point(0,et))},To.prototype.getCameraQueryGeometry=function(w){var et=this.getCameraPoint();if(1===w.length)return[w[0],et];for(var rt=et.x,it=et.y,nt=et.x,ot=et.y,at=0,st=w;at<st.length;at+=1){var ct=st[at];rt=Math.min(rt,ct.x),it=Math.min(it,ct.y),nt=Math.max(nt,ct.x),ot=Math.max(ot,ct.y)}return[new tt.Point(rt,it),new tt.Point(nt,it),new tt.Point(nt,ot),new tt.Point(rt,ot),new tt.Point(rt,it)]},Object.defineProperties(To.prototype,zl);var Io=function(et){var rt,it,nt,ot;(this||w)._hashName=et&&encodeURIComponent(et),tt.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this||w),(this||w)._updateHash=(rt=(this||w)._updateHashUnthrottled.bind(this||w),it=!1,nt=null,ot=function(){nt=null,it&&(rt(),nt=setTimeout(ot,300),it=!1)},function(){return it=!0,nt||ot(),nt})};Io.prototype.addTo=function(et){return(this||w)._map=et,tt.window.addEventListener("hashchange",(this||w)._onHashChange,!1),(this||w)._map.on("moveend",(this||w)._updateHash),this||w},Io.prototype.remove=function(){return tt.window.removeEventListener("hashchange",(this||w)._onHashChange,!1),(this||w)._map.off("moveend",(this||w)._updateHash),clearTimeout(this._updateHash()),delete(this||w)._map,this||w},Io.prototype.getHashString=function(et){var rt=(this||w)._map.getCenter(),it=Math.round(100*(this||w)._map.getZoom())/100,nt=Math.ceil((it*Math.LN2+Math.log(512/360/.5))/Math.LN10),ot=Math.pow(10,nt),at=Math.round(rt.lng*ot)/ot,st=Math.round(rt.lat*ot)/ot,ct=(this||w)._map.getBearing(),pt=(this||w)._map.getPitch(),ft="";if(ft+=et?"/"+at+"/"+st+"/"+it:it+"/"+st+"/"+at,(ct||pt)&&(ft+="/"+Math.round(10*ct)/10),pt&&(ft+="/"+Math.round(pt)),(this||w)._hashName){var dt=(this||w)._hashName,mt=!1,yt=tt.window.location.hash.slice(1).split("&").map((function(w){var tt=w.split("=")[0];return tt===dt?(mt=!0,tt+"="+ft):w})).filter((function(w){return w}));return mt||yt.push(dt+"="+ft),"#"+yt.join("&")}return"#"+ft},Io.prototype._getCurrentHash=function(){var et,rt=this||w,it=tt.window.location.hash.replace("#","");return(this||w)._hashName?(it.split("&").map((function(w){return w.split("=")})).forEach((function(w){w[0]===rt._hashName&&(et=w)})),(et&&et[1]||"").split("/")):it.split("/")},Io.prototype._onHashChange=function(){var tt=this._getCurrentHash();if(tt.length>=3&&!tt.some((function(w){return isNaN(w)}))){var et=(this||w)._map.dragRotate.isEnabled()&&(this||w)._map.touchZoomRotate.isEnabled()?+(tt[3]||0):(this||w)._map.getBearing();return(this||w)._map.jumpTo({center:[+tt[2],+tt[1]],zoom:+tt[0],bearing:et,pitch:+(tt[4]||0)}),!0}return!1},Io.prototype._updateHashUnthrottled=function(){var w=this.getHashString();try{tt.window.history.replaceState(tt.window.history.state,"",w)}catch(w){}};var Cl={linearity:.3,easing:tt.bezier(0,0,.3,1)},kl=tt.extend({deceleration:2500,maxSpeed:1400},Cl),Fl=tt.extend({deceleration:20,maxSpeed:1400},Cl),Hl=tt.extend({deceleration:1e3,maxSpeed:360},Cl),du=tt.extend({deceleration:1e3,maxSpeed:90},Cl),Mo=function(tt){(this||w)._map=tt,this.clear()};function Lo(w,tt){(!w.duration||w.duration<tt.duration)&&(w.duration=tt.duration,w.easing=tt.easing)}function Ao(w,et,rt){var it=rt.maxSpeed,nt=rt.linearity,ot=rt.deceleration,at=tt.clamp(w*nt/(et/1e3),-it,it),st=Math.abs(at)/(ot*nt);return{easing:rt.easing,duration:1e3*st,amount:at*(st/2)}}Mo.prototype.clear=function(){(this||w)._inertiaBuffer=[]},Mo.prototype.record=function(et){this._drainInertiaBuffer(),(this||w)._inertiaBuffer.push({time:tt.browser.now(),settings:et})},Mo.prototype._drainInertiaBuffer=function(){for(var et=(this||w)._inertiaBuffer,rt=tt.browser.now();et.length>0&&rt-et[0].time>160;)et.shift()},Mo.prototype._onMoveEnd=function(et){if(this._drainInertiaBuffer(),!((this||w)._inertiaBuffer.length<2)){for(var rt={zoom:0,bearing:0,pitch:0,pan:new tt.Point(0,0),pinchAround:void 0,around:void 0},it=0,nt=(this||w)._inertiaBuffer;it<nt.length;it+=1){var ot=nt[it].settings;rt.zoom+=ot.zoomDelta||0,rt.bearing+=ot.bearingDelta||0,rt.pitch+=ot.pitchDelta||0,ot.panDelta&&rt.pan._add(ot.panDelta),ot.around&&(rt.around=ot.around),ot.pinchAround&&(rt.pinchAround=ot.pinchAround)}var at=(this||w)._inertiaBuffer[(this||w)._inertiaBuffer.length-1].time-(this||w)._inertiaBuffer[0].time,st={};if(rt.pan.mag()){var ct=Ao(rt.pan.mag(),at,tt.extend({},kl,et||{}));st.offset=rt.pan.mult(ct.amount/rt.pan.mag()),st.center=(this||w)._map.transform.center,Lo(st,ct)}if(rt.zoom){var pt=Ao(rt.zoom,at,Fl);st.zoom=(this||w)._map.transform.zoom+pt.amount,Lo(st,pt)}if(rt.bearing){var ft=Ao(rt.bearing,at,Hl);st.bearing=(this||w)._map.transform.bearing+tt.clamp(ft.amount,-179,179),Lo(st,ft)}if(rt.pitch){var dt=Ao(rt.pitch,at,du);st.pitch=(this||w)._map.transform.pitch+dt.amount,Lo(st,dt)}if(st.zoom||st.bearing){var mt=void 0===rt.pinchAround?rt.around:rt.pinchAround;st.around=mt?(this||w)._map.unproject(mt):(this||w)._map.getCenter()}return this.clear(),tt.extend(st,{noMoveStart:!0})}};var _u=function(et){function o(it,nt,ot,at){void 0===at&&(at={});var st=rt.mousePos(nt.getCanvasContainer(),ot),ct=nt.unproject(st);et.call(this||w,it,tt.extend({point:st,lngLat:ct,originalEvent:ot},at)),(this||w)._defaultPrevented=!1,(this||w).target=nt}et&&(o.__proto__=et),(o.prototype=Object.create(et&&et.prototype)).constructor=o;var it={defaultPrevented:{configurable:!0}};return o.prototype.preventDefault=function(){(this||w)._defaultPrevented=!0},it.defaultPrevented.get=function(){return(this||w)._defaultPrevented},Object.defineProperties(o.prototype,it),o}(tt.Event),vu=function(et){function o(it,nt,ot){var at="touchend"===it?ot.changedTouches:ot.touches,st=rt.touchPos(nt.getCanvasContainer(),at),ct=st.map((function(w){return nt.unproject(w)})),pt=st.reduce((function(w,tt,et,rt){return w.add(tt.div(rt.length))}),new tt.Point(0,0)),ft=nt.unproject(pt);et.call(this||w,it,{points:st,point:pt,lngLats:ct,lngLat:ft,originalEvent:ot}),(this||w)._defaultPrevented=!1}et&&(o.__proto__=et),(o.prototype=Object.create(et&&et.prototype)).constructor=o;var it={defaultPrevented:{configurable:!0}};return o.prototype.preventDefault=function(){(this||w)._defaultPrevented=!0},it.defaultPrevented.get=function(){return(this||w)._defaultPrevented},Object.defineProperties(o.prototype,it),o}(tt.Event),wu=function(tt){function e(et,rt,it){tt.call(this||w,et,{originalEvent:it}),(this||w)._defaultPrevented=!1}tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e;var et={defaultPrevented:{configurable:!0}};return e.prototype.preventDefault=function(){(this||w)._defaultPrevented=!0},et.defaultPrevented.get=function(){return(this||w)._defaultPrevented},Object.defineProperties(e.prototype,et),e}(tt.Event),Oo=function(tt,et){(this||w)._map=tt,(this||w)._clickTolerance=et.clickTolerance};Oo.prototype.reset=function(){delete(this||w)._mousedownPos},Oo.prototype.wheel=function(tt){return this._firePreventable(new wu(tt.type,(this||w)._map,tt))},Oo.prototype.mousedown=function(tt,et){return(this||w)._mousedownPos=et,this._firePreventable(new _u(tt.type,(this||w)._map,tt))},Oo.prototype.mouseup=function(tt){(this||w)._map.fire(new _u(tt.type,(this||w)._map,tt))},Oo.prototype.click=function(tt,et){(this||w)._mousedownPos&&(this||w)._mousedownPos.dist(et)>=(this||w)._clickTolerance||(this||w)._map.fire(new _u(tt.type,(this||w)._map,tt))},Oo.prototype.dblclick=function(tt){return this._firePreventable(new _u(tt.type,(this||w)._map,tt))},Oo.prototype.mouseover=function(tt){(this||w)._map.fire(new _u(tt.type,(this||w)._map,tt))},Oo.prototype.mouseout=function(tt){(this||w)._map.fire(new _u(tt.type,(this||w)._map,tt))},Oo.prototype.touchstart=function(tt){return this._firePreventable(new vu(tt.type,(this||w)._map,tt))},Oo.prototype.touchmove=function(tt){(this||w)._map.fire(new vu(tt.type,(this||w)._map,tt))},Oo.prototype.touchend=function(tt){(this||w)._map.fire(new vu(tt.type,(this||w)._map,tt))},Oo.prototype.touchcancel=function(tt){(this||w)._map.fire(new vu(tt.type,(this||w)._map,tt))},Oo.prototype._firePreventable=function(tt){if((this||w)._map.fire(tt),tt.defaultPrevented)return{}},Oo.prototype.isEnabled=function(){return!0},Oo.prototype.isActive=function(){return!1},Oo.prototype.enable=function(){},Oo.prototype.disable=function(){};var Fo=function(tt){(this||w)._map=tt};Fo.prototype.reset=function(){(this||w)._delayContextMenu=!1,delete(this||w)._contextMenuEvent},Fo.prototype.mousemove=function(tt){(this||w)._map.fire(new _u(tt.type,(this||w)._map,tt))},Fo.prototype.mousedown=function(){(this||w)._delayContextMenu=!0},Fo.prototype.mouseup=function(){(this||w)._delayContextMenu=!1,(this||w)._contextMenuEvent&&((this||w)._map.fire(new _u("contextmenu",(this||w)._map,(this||w)._contextMenuEvent)),delete(this||w)._contextMenuEvent)},Fo.prototype.contextmenu=function(tt){(this||w)._delayContextMenu?(this||w)._contextMenuEvent=tt:(this||w)._map.fire(new _u(tt.type,(this||w)._map,tt)),(this||w)._map.listens("contextmenu")&&tt.preventDefault()},Fo.prototype.isEnabled=function(){return!0},Fo.prototype.isActive=function(){return!1},Fo.prototype.enable=function(){},Fo.prototype.disable=function(){};var Uo=function(tt,et){(this||w)._map=tt,(this||w)._el=tt.getCanvasContainer(),(this||w)._container=tt.getContainer(),(this||w)._clickTolerance=et.clickTolerance||1};function No(w,tt){for(var et={},rt=0;rt<w.length;rt++)et[w[rt].identifier]=tt[rt];return et}Uo.prototype.isEnabled=function(){return!!(this||w)._enabled},Uo.prototype.isActive=function(){return!!(this||w)._active},Uo.prototype.enable=function(){this.isEnabled()||((this||w)._enabled=!0)},Uo.prototype.disable=function(){this.isEnabled()&&((this||w)._enabled=!1)},Uo.prototype.mousedown=function(tt,et){this.isEnabled()&&tt.shiftKey&&0===tt.button&&(rt.disableDrag(),(this||w)._startPos=(this||w)._lastPos=et,(this||w)._active=!0)},Uo.prototype.mousemoveWindow=function(tt,et){if((this||w)._active){var it=et;if(!((this||w)._lastPos.equals(it)||!(this||w)._box&&it.dist((this||w)._startPos)<(this||w)._clickTolerance)){var nt=(this||w)._startPos;(this||w)._lastPos=it,(this||w)._box||((this||w)._box=rt.create("div","mapboxgl-boxzoom",(this||w)._container),(this||w)._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",tt));var ot=Math.min(nt.x,it.x),at=Math.max(nt.x,it.x),st=Math.min(nt.y,it.y),ct=Math.max(nt.y,it.y);rt.setTransform((this||w)._box,"translate("+ot+"px,"+st+"px)"),(this||w)._box.style.width=at-ot+"px",(this||w)._box.style.height=ct-st+"px"}}},Uo.prototype.mouseupWindow=function(et,it){var nt=this||w;if((this||w)._active&&0===et.button){var ot=(this||w)._startPos,at=it;if(this.reset(),rt.suppressClick(),ot.x!==at.x||ot.y!==at.y)return(this||w)._map.fire(new tt.Event("boxzoomend",{originalEvent:et})),{cameraAnimation:function(w){return w.fitScreenCoordinates(ot,at,nt._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",et)}},Uo.prototype.keydown=function(tt){(this||w)._active&&27===tt.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",tt))},Uo.prototype.reset=function(){(this||w)._active=!1,(this||w)._container.classList.remove("mapboxgl-crosshair"),(this||w)._box&&(rt.remove((this||w)._box),(this||w)._box=null),rt.enableDrag(),delete(this||w)._startPos,delete(this||w)._lastPos},Uo.prototype._fireEvent=function(et,rt){return(this||w)._map.fire(new tt.Event(et,{originalEvent:rt}))};var Zo=function(tt){this.reset(),(this||w).numTouches=tt.numTouches};Zo.prototype.reset=function(){delete(this||w).centroid,delete(this||w).startTime,delete(this||w).touches,(this||w).aborted=!1},Zo.prototype.touchstart=function(et,rt,it){((this||w).centroid||it.length>(this||w).numTouches)&&((this||w).aborted=!0),(this||w).aborted||(void 0===(this||w).startTime&&((this||w).startTime=et.timeStamp),it.length===(this||w).numTouches&&((this||w).centroid=function(w){for(var et=new tt.Point(0,0),rt=0,it=w;rt<it.length;rt+=1)et._add(it[rt]);return et.div(w.length)}(rt),(this||w).touches=No(it,rt)))},Zo.prototype.touchmove=function(tt,et,rt){if(!(this||w).aborted&&(this||w).centroid){var it=No(rt,et);for(var nt in(this||w).touches){var ot=it[nt];(!ot||ot.dist((this||w).touches[nt])>30)&&((this||w).aborted=!0)}}},Zo.prototype.touchend=function(tt,et,rt){if((!(this||w).centroid||tt.timeStamp-(this||w).startTime>500)&&((this||w).aborted=!0),0===rt.length){var it=!(this||w).aborted&&(this||w).centroid;if(this.reset(),it)return it}};var jo=function(tt){(this||w).singleTap=new Zo(tt),(this||w).numTaps=tt.numTaps,this.reset()};jo.prototype.reset=function(){(this||w).lastTime=1/0,delete(this||w).lastTap,(this||w).count=0,(this||w).singleTap.reset()},jo.prototype.touchstart=function(tt,et,rt){(this||w).singleTap.touchstart(tt,et,rt)},jo.prototype.touchmove=function(tt,et,rt){(this||w).singleTap.touchmove(tt,et,rt)},jo.prototype.touchend=function(tt,et,rt){var it=(this||w).singleTap.touchend(tt,et,rt);if(it){var nt=tt.timeStamp-(this||w).lastTime<500,ot=!(this||w).lastTap||(this||w).lastTap.dist(it)<30;if(nt&&ot||this.reset(),(this||w).count++,(this||w).lastTime=tt.timeStamp,(this||w).lastTap=it,(this||w).count===(this||w).numTaps)return this.reset(),it}};var qo=function(){(this||w)._zoomIn=new jo({numTouches:1,numTaps:2}),(this||w)._zoomOut=new jo({numTouches:2,numTaps:1}),this.reset()};qo.prototype.reset=function(){(this||w)._active=!1,(this||w)._zoomIn.reset(),(this||w)._zoomOut.reset()},qo.prototype.touchstart=function(tt,et,rt){(this||w)._zoomIn.touchstart(tt,et,rt),(this||w)._zoomOut.touchstart(tt,et,rt)},qo.prototype.touchmove=function(tt,et,rt){(this||w)._zoomIn.touchmove(tt,et,rt),(this||w)._zoomOut.touchmove(tt,et,rt)},qo.prototype.touchend=function(tt,et,rt){var it=this||w,nt=(this||w)._zoomIn.touchend(tt,et,rt),ot=(this||w)._zoomOut.touchend(tt,et,rt);return nt?((this||w)._active=!0,tt.preventDefault(),setTimeout((function(){return it.reset()}),0),{cameraAnimation:function(w){return w.easeTo({duration:300,zoom:w.getZoom()+1,around:w.unproject(nt)},{originalEvent:tt})}}):ot?((this||w)._active=!0,tt.preventDefault(),setTimeout((function(){return it.reset()}),0),{cameraAnimation:function(w){return w.easeTo({duration:300,zoom:w.getZoom()-1,around:w.unproject(ot)},{originalEvent:tt})}}):void 0},qo.prototype.touchcancel=function(){this.reset()},qo.prototype.enable=function(){(this||w)._enabled=!0},qo.prototype.disable=function(){(this||w)._enabled=!1,this.reset()},qo.prototype.isEnabled=function(){return(this||w)._enabled},qo.prototype.isActive=function(){return(this||w)._active};var Tu={0:1,2:2},Go=function(tt){this.reset(),(this||w)._clickTolerance=tt.clickTolerance||1};Go.prototype.reset=function(){(this||w)._active=!1,(this||w)._moved=!1,delete(this||w)._lastPoint,delete(this||w)._eventButton},Go.prototype._correctButton=function(w,tt){return!1},Go.prototype._move=function(w,tt){return{}},Go.prototype.mousedown=function(tt,et){if(!(this||w)._lastPoint){var it=rt.mouseButton(tt);this._correctButton(tt,it)&&((this||w)._lastPoint=et,(this||w)._eventButton=it)}},Go.prototype.mousemoveWindow=function(tt,et){var rt=(this||w)._lastPoint;if(rt)if(tt.preventDefault(),function(w,tt){var et=Tu[tt];return void 0===w.buttons||(w.buttons&et)!==et}(tt,(this||w)._eventButton))this.reset();else if((this||w)._moved||!(et.dist(rt)<(this||w)._clickTolerance))return(this||w)._moved=!0,(this||w)._lastPoint=et,this._move(rt,et)},Go.prototype.mouseupWindow=function(tt){(this||w)._lastPoint&&rt.mouseButton(tt)===(this||w)._eventButton&&((this||w)._moved&&rt.suppressClick(),this.reset())},Go.prototype.enable=function(){(this||w)._enabled=!0},Go.prototype.disable=function(){(this||w)._enabled=!1,this.reset()},Go.prototype.isEnabled=function(){return(this||w)._enabled},Go.prototype.isActive=function(){return(this||w)._active};var Fu=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.mousedown=function(et,rt){tt.prototype.mousedown.call(this||w,et,rt),(this||w)._lastPoint&&((this||w)._active=!0)},e.prototype._correctButton=function(w,tt){return 0===tt&&!w.ctrlKey},e.prototype._move=function(w,tt){return{around:tt,panDelta:tt.sub(w)}},e}(Go),tc=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._correctButton=function(w,tt){return 0===tt&&w.ctrlKey||2===tt},e.prototype._move=function(tt,et){var rt=.8*(et.x-tt.x);if(rt)return(this||w)._active=!0,{bearingDelta:rt}},e.prototype.contextmenu=function(w){w.preventDefault()},e}(Go),ec=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype._correctButton=function(w,tt){return 0===tt&&w.ctrlKey||2===tt},e.prototype._move=function(tt,et){var rt=-.5*(et.y-tt.y);if(rt)return(this||w)._active=!0,{pitchDelta:rt}},e.prototype.contextmenu=function(w){w.preventDefault()},e}(Go),Ko=function(tt){(this||w)._minTouches=1,(this||w)._clickTolerance=tt.clickTolerance||1,this.reset()};Ko.prototype.reset=function(){(this||w)._active=!1,(this||w)._touches={},(this||w)._sum=new tt.Point(0,0)},Ko.prototype.touchstart=function(w,tt,et){return this._calculateTransform(w,tt,et)},Ko.prototype.touchmove=function(tt,et,rt){if((this||w)._active)return tt.preventDefault(),this._calculateTransform(tt,et,rt)},Ko.prototype.touchend=function(tt,et,rt){this._calculateTransform(tt,et,rt),(this||w)._active&&rt.length<(this||w)._minTouches&&this.reset()},Ko.prototype.touchcancel=function(){this.reset()},Ko.prototype._calculateTransform=function(et,rt,it){it.length>0&&((this||w)._active=!0);var nt=No(it,rt),ot=new tt.Point(0,0),at=new tt.Point(0,0),st=0;for(var ct in nt){var pt=nt[ct],ft=(this||w)._touches[ct];ft&&(ot._add(pt),at._add(pt.sub(ft)),st++,nt[ct]=pt)}if((this||w)._touches=nt,!(st<(this||w)._minTouches)&&at.mag()){var dt=at.div(st);if((this||w)._sum._add(dt),!((this||w)._sum.mag()<(this||w)._clickTolerance))return{around:ot.div(st),panDelta:dt}}},Ko.prototype.enable=function(){(this||w)._enabled=!0},Ko.prototype.disable=function(){(this||w)._enabled=!1,this.reset()},Ko.prototype.isEnabled=function(){return(this||w)._enabled},Ko.prototype.isActive=function(){return(this||w)._active};var Yo=function(){this.reset()};function Jo(w,tt,et){for(var rt=0;rt<w.length;rt++)if(w[rt].identifier===et)return tt[rt]}function Qo(w,tt){return Math.log(w/tt)/Math.LN2}Yo.prototype.reset=function(){(this||w)._active=!1,delete(this||w)._firstTwoTouches},Yo.prototype._start=function(w){},Yo.prototype._move=function(w,tt,et){return{}},Yo.prototype.touchstart=function(tt,et,rt){(this||w)._firstTwoTouches||rt.length<2||((this||w)._firstTwoTouches=[rt[0].identifier,rt[1].identifier],this._start([et[0],et[1]]))},Yo.prototype.touchmove=function(tt,et,rt){if((this||w)._firstTwoTouches){tt.preventDefault();var it=(this||w)._firstTwoTouches,nt=it[1],ot=Jo(rt,et,it[0]),at=Jo(rt,et,nt);if(ot&&at){var st=(this||w)._aroundCenter?null:ot.add(at).div(2);return this._move([ot,at],st,tt)}}},Yo.prototype.touchend=function(tt,et,it){if((this||w)._firstTwoTouches){var nt=(this||w)._firstTwoTouches,ot=nt[1],at=Jo(it,et,nt[0]),st=Jo(it,et,ot);at&&st||((this||w)._active&&rt.suppressClick(),this.reset())}},Yo.prototype.touchcancel=function(){this.reset()},Yo.prototype.enable=function(tt){(this||w)._enabled=!0,(this||w)._aroundCenter=!!tt&&"center"===tt.around},Yo.prototype.disable=function(){(this||w)._enabled=!1,this.reset()},Yo.prototype.isEnabled=function(){return(this||w)._enabled},Yo.prototype.isActive=function(){return(this||w)._active};var rc=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.reset=function(){tt.prototype.reset.call(this||w),delete(this||w)._distance,delete(this||w)._startDistance},e.prototype._start=function(tt){(this||w)._startDistance=(this||w)._distance=tt[0].dist(tt[1])},e.prototype._move=function(tt,et){var rt=(this||w)._distance;if((this||w)._distance=tt[0].dist(tt[1]),(this||w)._active||!(Math.abs(Qo((this||w)._distance,(this||w)._startDistance))<.1))return(this||w)._active=!0,{zoomDelta:Qo((this||w)._distance,rt),pinchAround:et}},e}(Yo);function tr(w,tt){return 180*w.angleWith(tt)/Math.PI}var ic=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.reset=function(){tt.prototype.reset.call(this||w),delete(this||w)._minDiameter,delete(this||w)._startVector,delete(this||w)._vector},e.prototype._start=function(tt){(this||w)._startVector=(this||w)._vector=tt[0].sub(tt[1]),(this||w)._minDiameter=tt[0].dist(tt[1])},e.prototype._move=function(tt,et){var rt=(this||w)._vector;if((this||w)._vector=tt[0].sub(tt[1]),(this||w)._active||!this._isBelowThreshold((this||w)._vector))return(this||w)._active=!0,{bearingDelta:tr((this||w)._vector,rt),pinchAround:et}},e.prototype._isBelowThreshold=function(tt){(this||w)._minDiameter=Math.min((this||w)._minDiameter,tt.mag());var et=25/(Math.PI*(this||w)._minDiameter)*360,rt=tr(tt,(this||w)._startVector);return Math.abs(rt)<et},e}(Yo);function ir(w){return Math.abs(w.y)>Math.abs(w.x)}var nc=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e.prototype.reset=function(){tt.prototype.reset.call(this||w),(this||w)._valid=void 0,delete(this||w)._firstMove,delete(this||w)._lastPoints},e.prototype._start=function(tt){(this||w)._lastPoints=tt,ir(tt[0].sub(tt[1]))&&((this||w)._valid=!1)},e.prototype._move=function(tt,et,rt){var it=tt[0].sub((this||w)._lastPoints[0]),nt=tt[1].sub((this||w)._lastPoints[1]);if((this||w)._valid=this.gestureBeginsVertically(it,nt,rt.timeStamp),(this||w)._valid)return(this||w)._lastPoints=tt,(this||w)._active=!0,{pitchDelta:(it.y+nt.y)/2*-.5}},e.prototype.gestureBeginsVertically=function(tt,et,rt){if(void 0!==(this||w)._valid)return(this||w)._valid;var it=tt.mag()>=2,nt=et.mag()>=2;if(it||nt){if(!it||!nt)return void 0===(this||w)._firstMove&&((this||w)._firstMove=rt),rt-(this||w)._firstMove<100&&void 0;var ot=tt.y>0==et.y>0;return ir(tt)&&ir(et)&&ot}},e}(Yo),oc={panStep:100,bearingStep:15,pitchStep:10},ar=function(){var tt=oc;(this||w)._panStep=tt.panStep,(this||w)._bearingStep=tt.bearingStep,(this||w)._pitchStep=tt.pitchStep};function nr(w){return w*(2-w)}ar.prototype.reset=function(){(this||w)._active=!1},ar.prototype.keydown=function(tt){var et=this||w;if(!(tt.altKey||tt.ctrlKey||tt.metaKey)){var rt=0,it=0,nt=0,ot=0,at=0;switch(tt.keyCode){case 61:case 107:case 171:case 187:rt=1;break;case 189:case 109:case 173:rt=-1;break;case 37:tt.shiftKey?it=-1:(tt.preventDefault(),ot=-1);break;case 39:tt.shiftKey?it=1:(tt.preventDefault(),ot=1);break;case 38:tt.shiftKey?nt=1:(tt.preventDefault(),at=-1);break;case 40:tt.shiftKey?nt=-1:(tt.preventDefault(),at=1);break;default:return}return{cameraAnimation:function(w){var st=w.getZoom();w.easeTo({duration:300,easeId:"keyboardHandler",easing:nr,zoom:rt?Math.round(st)+rt*(tt.shiftKey?2:1):st,bearing:w.getBearing()+it*et._bearingStep,pitch:w.getPitch()+nt*et._pitchStep,offset:[-ot*et._panStep,-at*et._panStep],center:w.getCenter()},{originalEvent:tt})}}}},ar.prototype.enable=function(){(this||w)._enabled=!0},ar.prototype.disable=function(){(this||w)._enabled=!1,this.reset()},ar.prototype.isEnabled=function(){return(this||w)._enabled},ar.prototype.isActive=function(){return(this||w)._active};var sr=function(et,rt){(this||w)._map=et,(this||w)._el=et.getCanvasContainer(),(this||w)._handler=rt,(this||w)._delta=0,(this||w)._defaultZoomRate=.01,(this||w)._wheelZoomRate=1/450,tt.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this||w)};sr.prototype.setZoomRate=function(tt){(this||w)._defaultZoomRate=tt},sr.prototype.setWheelZoomRate=function(tt){(this||w)._wheelZoomRate=tt},sr.prototype.isEnabled=function(){return!!(this||w)._enabled},sr.prototype.isActive=function(){return!!(this||w)._active||void 0!==(this||w)._finishTimeout},sr.prototype.isZooming=function(){return!!(this||w)._zooming},sr.prototype.enable=function(tt){this.isEnabled()||((this||w)._enabled=!0,(this||w)._aroundCenter=tt&&"center"===tt.around)},sr.prototype.disable=function(){this.isEnabled()&&((this||w)._enabled=!1)},sr.prototype.wheel=function(et){if(this.isEnabled()){var rt=et.deltaMode===tt.window.WheelEvent.DOM_DELTA_LINE?40*et.deltaY:et.deltaY,it=tt.browser.now(),nt=it-((this||w)._lastWheelEventTime||0);(this||w)._lastWheelEventTime=it,0!==rt&&rt%4.000244140625==0?(this||w)._type="wheel":0!==rt&&Math.abs(rt)<4?(this||w)._type="trackpad":nt>400?((this||w)._type=null,(this||w)._lastValue=rt,(this||w)._timeout=setTimeout((this||w)._onTimeout,40,et)):(this||w)._type||((this||w)._type=Math.abs(nt*rt)<200?"trackpad":"wheel",(this||w)._timeout&&(clearTimeout((this||w)._timeout),(this||w)._timeout=null,rt+=(this||w)._lastValue)),et.shiftKey&&rt&&(rt/=4),(this||w)._type&&((this||w)._lastWheelEvent=et,(this||w)._delta-=rt,(this||w)._active||this._start(et)),et.preventDefault()}},sr.prototype._onTimeout=function(tt){(this||w)._type="wheel",(this||w)._delta-=(this||w)._lastValue,(this||w)._active||this._start(tt)},sr.prototype._start=function(et){if((this||w)._delta){(this||w)._frameId&&((this||w)._frameId=null),(this||w)._active=!0,this.isZooming()||((this||w)._zooming=!0),(this||w)._finishTimeout&&(clearTimeout((this||w)._finishTimeout),delete(this||w)._finishTimeout);var it=rt.mousePos((this||w)._el,et);(this||w)._around=tt.LngLat.convert((this||w)._aroundCenter?(this||w)._map.getCenter():(this||w)._map.unproject(it)),(this||w)._aroundPoint=(this||w)._map.transform.locationPoint((this||w)._around),(this||w)._frameId||((this||w)._frameId=!0,(this||w)._handler._triggerRenderFrame())}},sr.prototype.renderFrame=function(){return this._onScrollFrame()},sr.prototype._onScrollFrame=function(){var et=this||w;if((this||w)._frameId&&((this||w)._frameId=null,this.isActive())){var rt=(this||w)._map.transform;if(0!==(this||w)._delta){var it="wheel"===(this||w)._type&&Math.abs((this||w)._delta)>4.000244140625?(this||w)._wheelZoomRate:(this||w)._defaultZoomRate,nt=2/(1+Math.exp(-Math.abs((this||w)._delta*it)));(this||w)._delta<0&&0!==nt&&(nt=1/nt);var ot="number"==typeof(this||w)._targetZoom?rt.zoomScale((this||w)._targetZoom):rt.scale;(this||w)._targetZoom=Math.min(rt.maxZoom,Math.max(rt.minZoom,rt.scaleZoom(ot*nt))),"wheel"===(this||w)._type&&((this||w)._startZoom=rt.zoom,(this||w)._easing=this._smoothOutEasing(200)),(this||w)._delta=0}var at,st="number"==typeof(this||w)._targetZoom?(this||w)._targetZoom:rt.zoom,ct=(this||w)._startZoom,pt=(this||w)._easing,ft=!1;if("wheel"===(this||w)._type&&ct&&pt){var dt=Math.min((tt.browser.now()-(this||w)._lastWheelEventTime)/200,1),mt=pt(dt);at=tt.number(ct,st,mt),dt<1?(this||w)._frameId||((this||w)._frameId=!0):ft=!0}else at=st,ft=!0;return(this||w)._active=!0,ft&&((this||w)._active=!1,(this||w)._finishTimeout=setTimeout((function(){et._zooming=!1,et._handler._triggerRenderFrame(),delete et._targetZoom,delete et._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!ft,zoomDelta:at-rt.zoom,around:(this||w)._aroundPoint,originalEvent:(this||w)._lastWheelEvent}}},sr.prototype._smoothOutEasing=function(et){var rt=tt.ease;if((this||w)._prevEase){var it=(this||w)._prevEase,nt=(tt.browser.now()-it.start)/it.duration,ot=it.easing(nt+.01)-it.easing(nt),at=.27/Math.sqrt(ot*ot+1e-4)*.01,st=Math.sqrt(.0729-at*at);rt=tt.bezier(at,st,.25,1)}return(this||w)._prevEase={start:tt.browser.now(),duration:et,easing:rt},rt},sr.prototype.reset=function(){(this||w)._active=!1};var lr=function(tt,et){(this||w)._clickZoom=tt,(this||w)._tapZoom=et};lr.prototype.enable=function(){(this||w)._clickZoom.enable(),(this||w)._tapZoom.enable()},lr.prototype.disable=function(){(this||w)._clickZoom.disable(),(this||w)._tapZoom.disable()},lr.prototype.isEnabled=function(){return(this||w)._clickZoom.isEnabled()&&(this||w)._tapZoom.isEnabled()},lr.prototype.isActive=function(){return(this||w)._clickZoom.isActive()||(this||w)._tapZoom.isActive()};var cr=function(){this.reset()};cr.prototype.reset=function(){(this||w)._active=!1},cr.prototype.dblclick=function(w,tt){return w.preventDefault(),{cameraAnimation:function(et){et.easeTo({duration:300,zoom:et.getZoom()+(w.shiftKey?-1:1),around:et.unproject(tt)},{originalEvent:w})}}},cr.prototype.enable=function(){(this||w)._enabled=!0},cr.prototype.disable=function(){(this||w)._enabled=!1,this.reset()},cr.prototype.isEnabled=function(){return(this||w)._enabled},cr.prototype.isActive=function(){return(this||w)._active};var ur=function(){(this||w)._tap=new jo({numTouches:1,numTaps:1}),this.reset()};ur.prototype.reset=function(){(this||w)._active=!1,delete(this||w)._swipePoint,delete(this||w)._swipeTouch,delete(this||w)._tapTime,(this||w)._tap.reset()},ur.prototype.touchstart=function(tt,et,rt){(this||w)._swipePoint||((this||w)._tapTime&&tt.timeStamp-(this||w)._tapTime>500&&this.reset(),(this||w)._tapTime?rt.length>0&&((this||w)._swipePoint=et[0],(this||w)._swipeTouch=rt[0].identifier):(this||w)._tap.touchstart(tt,et,rt))},ur.prototype.touchmove=function(tt,et,rt){if((this||w)._tapTime){if((this||w)._swipePoint){if(rt[0].identifier!==(this||w)._swipeTouch)return;var it=et[0],nt=it.y-(this||w)._swipePoint.y;return(this||w)._swipePoint=it,tt.preventDefault(),(this||w)._active=!0,{zoomDelta:nt/128}}}else(this||w)._tap.touchmove(tt,et,rt)},ur.prototype.touchend=function(tt,et,rt){(this||w)._tapTime?(this||w)._swipePoint&&0===rt.length&&this.reset():(this||w)._tap.touchend(tt,et,rt)&&((this||w)._tapTime=tt.timeStamp)},ur.prototype.touchcancel=function(){this.reset()},ur.prototype.enable=function(){(this||w)._enabled=!0},ur.prototype.disable=function(){(this||w)._enabled=!1,this.reset()},ur.prototype.isEnabled=function(){return(this||w)._enabled},ur.prototype.isActive=function(){return(this||w)._active};var hr=function(tt,et,rt){(this||w)._el=tt,(this||w)._mousePan=et,(this||w)._touchPan=rt};hr.prototype.enable=function(tt){(this||w)._inertiaOptions=tt||{},(this||w)._mousePan.enable(),(this||w)._touchPan.enable(),(this||w)._el.classList.add("mapboxgl-touch-drag-pan")},hr.prototype.disable=function(){(this||w)._mousePan.disable(),(this||w)._touchPan.disable(),(this||w)._el.classList.remove("mapboxgl-touch-drag-pan")},hr.prototype.isEnabled=function(){return(this||w)._mousePan.isEnabled()&&(this||w)._touchPan.isEnabled()},hr.prototype.isActive=function(){return(this||w)._mousePan.isActive()||(this||w)._touchPan.isActive()};var pr=function(tt,et,rt){(this||w)._pitchWithRotate=tt.pitchWithRotate,(this||w)._mouseRotate=et,(this||w)._mousePitch=rt};pr.prototype.enable=function(){(this||w)._mouseRotate.enable(),(this||w)._pitchWithRotate&&(this||w)._mousePitch.enable()},pr.prototype.disable=function(){(this||w)._mouseRotate.disable(),(this||w)._mousePitch.disable()},pr.prototype.isEnabled=function(){return(this||w)._mouseRotate.isEnabled()&&(!(this||w)._pitchWithRotate||(this||w)._mousePitch.isEnabled())},pr.prototype.isActive=function(){return(this||w)._mouseRotate.isActive()||(this||w)._mousePitch.isActive()};var dr=function(tt,et,rt,it){(this||w)._el=tt,(this||w)._touchZoom=et,(this||w)._touchRotate=rt,(this||w)._tapDragZoom=it,(this||w)._rotationDisabled=!1,(this||w)._enabled=!0};dr.prototype.enable=function(tt){(this||w)._touchZoom.enable(tt),(this||w)._rotationDisabled||(this||w)._touchRotate.enable(tt),(this||w)._tapDragZoom.enable(),(this||w)._el.classList.add("mapboxgl-touch-zoom-rotate")},dr.prototype.disable=function(){(this||w)._touchZoom.disable(),(this||w)._touchRotate.disable(),(this||w)._tapDragZoom.disable(),(this||w)._el.classList.remove("mapboxgl-touch-zoom-rotate")},dr.prototype.isEnabled=function(){return(this||w)._touchZoom.isEnabled()&&((this||w)._rotationDisabled||(this||w)._touchRotate.isEnabled())&&(this||w)._tapDragZoom.isEnabled()},dr.prototype.isActive=function(){return(this||w)._touchZoom.isActive()||(this||w)._touchRotate.isActive()||(this||w)._tapDragZoom.isActive()},dr.prototype.disableRotation=function(){(this||w)._rotationDisabled=!0,(this||w)._touchRotate.disable()},dr.prototype.enableRotation=function(){(this||w)._rotationDisabled=!1,(this||w)._touchZoom.isEnabled()&&(this||w)._touchRotate.enable()};var _r=function(w){return w.zoom||w.drag||w.pitch||w.rotate},ac=function(tt){function e(){tt.apply(this||w,arguments)}return tt&&(e.__proto__=tt),(e.prototype=Object.create(tt&&tt.prototype)).constructor=e,e}(tt.Event);function mr(w){return w.panDelta&&w.panDelta.mag()||w.zoomDelta||w.bearingDelta||w.pitchDelta}var gr=function(et,it){(this||w)._map=et,(this||w)._el=(this||w)._map.getCanvasContainer(),(this||w)._handlers=[],(this||w)._handlersById={},(this||w)._changes=[],(this||w)._inertia=new Mo(et),(this||w)._bearingSnap=it.bearingSnap,(this||w)._previousActiveHandlers={},(this||w)._eventsInProgress={},this._addDefaultHandlers(it),tt.bindAll(["handleEvent","handleWindowEvent"],this||w);var nt=(this||w)._el;(this||w)._listeners=[[nt,"touchstart",{passive:!0}],[nt,"touchmove",{passive:!1}],[nt,"touchend",void 0],[nt,"touchcancel",void 0],[nt,"mousedown",void 0],[nt,"mousemove",void 0],[nt,"mouseup",void 0],[tt.window.document,"mousemove",{capture:!0}],[tt.window.document,"mouseup",void 0],[nt,"mouseover",void 0],[nt,"mouseout",void 0],[nt,"dblclick",void 0],[nt,"click",void 0],[nt,"keydown",{capture:!1}],[nt,"keyup",void 0],[nt,"wheel",{passive:!1}],[nt,"contextmenu",void 0],[tt.window,"blur",void 0]];for(var ot=0,at=(this||w)._listeners;ot<at.length;ot+=1){var st=at[ot],ct=st[0];rt.addEventListener(ct,st[1],ct===tt.window.document?(this||w).handleWindowEvent:(this||w).handleEvent,st[2])}};gr.prototype.destroy=function(){for(var et=0,it=(this||w)._listeners;et<it.length;et+=1){var nt=it[et],ot=nt[0];rt.removeEventListener(ot,nt[1],ot===tt.window.document?(this||w).handleWindowEvent:(this||w).handleEvent,nt[2])}},gr.prototype._addDefaultHandlers=function(tt){var et=(this||w)._map,rt=et.getCanvasContainer();this._add("mapEvent",new Oo(et,tt));var it=et.boxZoom=new Uo(et,tt);this._add("boxZoom",it);var nt=new qo,ot=new cr;et.doubleClickZoom=new lr(ot,nt),this._add("tapZoom",nt),this._add("clickZoom",ot);var at=new ur;this._add("tapDragZoom",at);var st=et.touchPitch=new nc;this._add("touchPitch",st);var ct=new tc(tt),pt=new ec(tt);et.dragRotate=new pr(tt,ct,pt),this._add("mouseRotate",ct,["mousePitch"]),this._add("mousePitch",pt,["mouseRotate"]);var ft=new Fu(tt),dt=new Ko(tt);et.dragPan=new hr(rt,ft,dt),this._add("mousePan",ft),this._add("touchPan",dt,["touchZoom","touchRotate"]);var mt=new ic,yt=new rc;et.touchZoomRotate=new dr(rt,yt,mt,at),this._add("touchRotate",mt,["touchPan","touchZoom"]),this._add("touchZoom",yt,["touchPan","touchRotate"]);var vt=et.scrollZoom=new sr(et,this||w);this._add("scrollZoom",vt,["mousePan"]);var Dt=et.keyboard=new ar;this._add("keyboard",Dt),this._add("blockableMapEvent",new Fo(et));for(var Rt=0,Bt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Rt<Bt.length;Rt+=1){var Ot=Bt[Rt];tt.interactive&&tt[Ot]&&et[Ot].enable(tt[Ot])}},gr.prototype._add=function(tt,et,rt){(this||w)._handlers.push({handlerName:tt,handler:et,allowed:rt}),(this||w)._handlersById[tt]=et},gr.prototype.stop=function(){if(!(this||w)._updatingCamera){for(var tt=0,et=(this||w)._handlers;tt<et.length;tt+=1)et[tt].handler.reset();(this||w)._inertia.clear(),this._fireEvents({},{}),(this||w)._changes=[]}},gr.prototype.isActive=function(){for(var tt=0,et=(this||w)._handlers;tt<et.length;tt+=1)if(et[tt].handler.isActive())return!0;return!1},gr.prototype.isZooming=function(){return!!(this||w)._eventsInProgress.zoom||(this||w)._map.scrollZoom.isZooming()},gr.prototype.isRotating=function(){return!!(this||w)._eventsInProgress.rotate},gr.prototype.isMoving=function(){return Boolean(_r((this||w)._eventsInProgress))||this.isZooming()},gr.prototype._blockedByActive=function(w,tt,et){for(var rt in w)if(rt!==et&&(!tt||tt.indexOf(rt)<0))return!0;return!1},gr.prototype.handleWindowEvent=function(w){this.handleEvent(w,w.type+"Window")},gr.prototype._getMapTouches=function(tt){for(var et=[],rt=0,it=tt;rt<it.length;rt+=1){var nt=it[rt];(this||w)._el.contains(nt.target)&&et.push(nt)}return et},gr.prototype.handleEvent=function(tt,et){if("blur"!==tt.type){(this||w)._updatingCamera=!0;for(var it="renderFrame"===tt.type?void 0:tt,nt={needsRenderFrame:!1},ot={},at={},st=tt.touches?this._getMapTouches(tt.touches):void 0,ct=st?rt.touchPos((this||w)._el,st):rt.mousePos((this||w)._el,tt),pt=0,ft=(this||w)._handlers;pt<ft.length;pt+=1){var dt=ft[pt],mt=dt.handlerName,yt=dt.handler,vt=dt.allowed;if(yt.isEnabled()){var Dt=void 0;this._blockedByActive(at,vt,mt)?yt.reset():yt[et||tt.type]&&(Dt=yt[et||tt.type](tt,ct,st),this.mergeHandlerResult(nt,ot,Dt,mt,it),Dt&&Dt.needsRenderFrame&&this._triggerRenderFrame()),(Dt||yt.isActive())&&(at[mt]=yt)}}var Rt={};for(var Bt in(this||w)._previousActiveHandlers)at[Bt]||(Rt[Bt]=it);(this||w)._previousActiveHandlers=at,(Object.keys(Rt).length||mr(nt))&&((this||w)._changes.push([nt,ot,Rt]),this._triggerRenderFrame()),(Object.keys(at).length||mr(nt))&&(this||w)._map._stop(!0),(this||w)._updatingCamera=!1;var Ot=nt.cameraAnimation;Ot&&((this||w)._inertia.clear(),this._fireEvents({},{}),(this||w)._changes=[],Ot((this||w)._map))}else this.stop()},gr.prototype.mergeHandlerResult=function(w,et,rt,it,nt){if(rt){tt.extend(w,rt);var ot={handlerName:it,originalEvent:rt.originalEvent||nt};void 0!==rt.zoomDelta&&(et.zoom=ot),void 0!==rt.panDelta&&(et.drag=ot),void 0!==rt.pitchDelta&&(et.pitch=ot),void 0!==rt.bearingDelta&&(et.rotate=ot)}},gr.prototype._applyChanges=function(){for(var et={},rt={},it={},nt=0,ot=(this||w)._changes;nt<ot.length;nt+=1){var at=ot[nt],st=at[0],ct=at[1],pt=at[2];st.panDelta&&(et.panDelta=(et.panDelta||new tt.Point(0,0))._add(st.panDelta)),st.zoomDelta&&(et.zoomDelta=(et.zoomDelta||0)+st.zoomDelta),st.bearingDelta&&(et.bearingDelta=(et.bearingDelta||0)+st.bearingDelta),st.pitchDelta&&(et.pitchDelta=(et.pitchDelta||0)+st.pitchDelta),void 0!==st.around&&(et.around=st.around),void 0!==st.pinchAround&&(et.pinchAround=st.pinchAround),st.noInertia&&(et.noInertia=st.noInertia),tt.extend(rt,ct),tt.extend(it,pt)}this._updateMapTransform(et,rt,it),(this||w)._changes=[]},gr.prototype._updateMapTransform=function(tt,et,rt){var it=(this||w)._map,nt=it.transform;if(!mr(tt))return this._fireEvents(et,rt);var ot=tt.panDelta,at=tt.zoomDelta,st=tt.bearingDelta,ct=tt.pitchDelta,pt=tt.around,ft=tt.pinchAround;void 0!==ft&&(pt=ft),it._stop(!0),pt=pt||it.transform.centerPoint;var dt=nt.pointLocation(ot?pt.sub(ot):pt);st&&(nt.bearing+=st),ct&&(nt.pitch+=ct),at&&(nt.zoom+=at),nt.setLocationAtPoint(dt,pt),(this||w)._map._update(),tt.noInertia||(this||w)._inertia.record(tt),this._fireEvents(et,rt)},gr.prototype._fireEvents=function(et,rt){var it=this||w,nt=_r((this||w)._eventsInProgress),ot=_r(et),at={};for(var st in et)(this||w)._eventsInProgress[st]||(at[st+"start"]=et[st].originalEvent),(this||w)._eventsInProgress[st]=et[st];for(var ct in!nt&&ot&&this._fireEvent("movestart",ot.originalEvent),at)this._fireEvent(ct,at[ct]);for(var pt in et.rotate&&((this||w)._bearingChanged=!0),ot&&this._fireEvent("move",ot.originalEvent),et)this._fireEvent(pt,et[pt].originalEvent);var ft,dt={};for(var mt in(this||w)._eventsInProgress){var yt=(this||w)._eventsInProgress[mt],vt=yt.handlerName,Dt=yt.originalEvent;(this||w)._handlersById[vt].isActive()||(delete(this||w)._eventsInProgress[mt],dt[mt+"end"]=ft=rt[vt]||Dt)}for(var Rt in dt)this._fireEvent(Rt,dt[Rt]);var Bt=_r((this||w)._eventsInProgress);if((nt||ot)&&!Bt){(this||w)._updatingCamera=!0;var Ot=(this||w)._inertia._onMoveEnd((this||w)._map.dragPan._inertiaOptions),y=function(w){return 0!==w&&-it._bearingSnap<w&&w<it._bearingSnap};Ot?(y(Ot.bearing||(this||w)._map.getBearing())&&(Ot.bearing=0),(this||w)._map.easeTo(Ot,{originalEvent:ft})):((this||w)._map.fire(new tt.Event("moveend",{originalEvent:ft})),y((this||w)._map.getBearing())&&(this||w)._map.resetNorth()),(this||w)._bearingChanged=!1,(this||w)._updatingCamera=!1}},gr.prototype._fireEvent=function(et,rt){(this||w)._map.fire(new tt.Event(et,rt?{originalEvent:rt}:{}))},gr.prototype._triggerRenderFrame=function(){var tt=this||w;void 0===(this||w)._frameId&&((this||w)._frameId=(this||w)._map._requestRenderFrame((function(w){delete tt._frameId,tt.handleEvent(new ac("renderFrame",{timeStamp:w})),tt._applyChanges()})))};var sc=function(et){function i(rt,it){et.call(this||w),(this||w)._moving=!1,(this||w)._zooming=!1,(this||w).transform=rt,(this||w)._bearingSnap=it.bearingSnap,tt.bindAll(["_renderFrameCallback"],this||w)}return et&&(i.__proto__=et),(i.prototype=Object.create(et&&et.prototype)).constructor=i,i.prototype.getCenter=function(){return new tt.LngLat((this||w).transform.center.lng,(this||w).transform.center.lat)},i.prototype.setCenter=function(w,tt){return this.jumpTo({center:w},tt)},i.prototype.panBy=function(et,rt,it){return et=tt.Point.convert(et).mult(-1),this.panTo((this||w).transform.center,tt.extend({offset:et},rt),it)},i.prototype.panTo=function(w,et,rt){return this.easeTo(tt.extend({center:w},et),rt)},i.prototype.getZoom=function(){return(this||w).transform.zoom},i.prototype.setZoom=function(tt,et){return this.jumpTo({zoom:tt},et),this||w},i.prototype.zoomTo=function(w,et,rt){return this.easeTo(tt.extend({zoom:w},et),rt)},i.prototype.zoomIn=function(tt,et){return this.zoomTo(this.getZoom()+1,tt,et),this||w},i.prototype.zoomOut=function(tt,et){return this.zoomTo(this.getZoom()-1,tt,et),this||w},i.prototype.getBearing=function(){return(this||w).transform.bearing},i.prototype.setBearing=function(tt,et){return this.jumpTo({bearing:tt},et),this||w},i.prototype.getPadding=function(){return(this||w).transform.padding},i.prototype.setPadding=function(tt,et){return this.jumpTo({padding:tt},et),this||w},i.prototype.rotateTo=function(w,et,rt){return this.easeTo(tt.extend({bearing:w},et),rt)},i.prototype.resetNorth=function(et,rt){return this.rotateTo(0,tt.extend({duration:1e3},et),rt),this||w},i.prototype.resetNorthPitch=function(et,rt){return this.easeTo(tt.extend({bearing:0,pitch:0,duration:1e3},et),rt),this||w},i.prototype.snapToNorth=function(tt,et){return Math.abs(this.getBearing())<(this||w)._bearingSnap?this.resetNorth(tt,et):this||w},i.prototype.getPitch=function(){return(this||w).transform.pitch},i.prototype.setPitch=function(tt,et){return this.jumpTo({pitch:tt},et),this||w},i.prototype.cameraForBounds=function(w,et){return w=tt.LngLatBounds.convert(w),this._cameraForBoxAndBearing(w.getNorthWest(),w.getSouthEast(),0,et)},i.prototype._cameraForBoxAndBearing=function(et,rt,it,nt){var ot={top:0,bottom:0,right:0,left:0};if("number"==typeof(nt=tt.extend({padding:ot,offset:[0,0],maxZoom:(this||w).transform.maxZoom},nt)).padding){var at=nt.padding;nt.padding={top:at,bottom:at,right:at,left:at}}nt.padding=tt.extend(ot,nt.padding);var st=(this||w).transform,ct=st.padding,pt=st.project(tt.LngLat.convert(et)),ft=st.project(tt.LngLat.convert(rt)),dt=pt.rotate(-it*Math.PI/180),mt=ft.rotate(-it*Math.PI/180),yt=new tt.Point(Math.max(dt.x,mt.x),Math.max(dt.y,mt.y)),vt=new tt.Point(Math.min(dt.x,mt.x),Math.min(dt.y,mt.y)),Dt=yt.sub(vt),Rt=(st.width-(ct.left+ct.right+nt.padding.left+nt.padding.right))/Dt.x,Bt=(st.height-(ct.top+ct.bottom+nt.padding.top+nt.padding.bottom))/Dt.y;if(!(Bt<0||Rt<0)){var Ot=Math.min(st.scaleZoom(st.scale*Math.min(Rt,Bt)),nt.maxZoom),Ne=tt.Point.convert(nt.offset),Ze=new tt.Point(Ne.x+(nt.padding.left-nt.padding.right)/2,Ne.y+(nt.padding.top-nt.padding.bottom)/2).mult(st.scale/st.zoomScale(Ot));return{center:st.unproject(pt.add(ft).div(2).sub(Ze)),zoom:Ot,bearing:it}}tt.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},i.prototype.fitBounds=function(w,tt,et){return this._fitInternal(this.cameraForBounds(w,tt),tt,et)},i.prototype.fitScreenCoordinates=function(et,rt,it,nt,ot){return this._fitInternal(this._cameraForBoxAndBearing((this||w).transform.pointLocation(tt.Point.convert(et)),(this||w).transform.pointLocation(tt.Point.convert(rt)),it,nt),nt,ot)},i.prototype._fitInternal=function(et,rt,it){return et?(delete(rt=tt.extend(et,rt)).padding,rt.linear?this.easeTo(rt,it):this.flyTo(rt,it)):this||w},i.prototype.jumpTo=function(et,rt){this.stop();var it=(this||w).transform,nt=!1,ot=!1,at=!1;return"zoom"in et&&it.zoom!==+et.zoom&&(nt=!0,it.zoom=+et.zoom),void 0!==et.center&&(it.center=tt.LngLat.convert(et.center)),"bearing"in et&&it.bearing!==+et.bearing&&(ot=!0,it.bearing=+et.bearing),"pitch"in et&&it.pitch!==+et.pitch&&(at=!0,it.pitch=+et.pitch),null==et.padding||it.isPaddingEqual(et.padding)||(it.padding=et.padding),this.fire(new tt.Event("movestart",rt)).fire(new tt.Event("move",rt)),nt&&this.fire(new tt.Event("zoomstart",rt)).fire(new tt.Event("zoom",rt)).fire(new tt.Event("zoomend",rt)),ot&&this.fire(new tt.Event("rotatestart",rt)).fire(new tt.Event("rotate",rt)).fire(new tt.Event("rotateend",rt)),at&&this.fire(new tt.Event("pitchstart",rt)).fire(new tt.Event("pitch",rt)).fire(new tt.Event("pitchend",rt)),this.fire(new tt.Event("moveend",rt))},i.prototype.easeTo=function(et,rt){var it=this||w;this._stop(!1,et.easeId),(!1===(et=tt.extend({offset:[0,0],duration:500,easing:tt.ease},et)).animate||!et.essential&&tt.browser.prefersReducedMotion)&&(et.duration=0);var nt=(this||w).transform,ot=this.getZoom(),at=this.getBearing(),st=this.getPitch(),ct=this.getPadding(),pt="zoom"in et?+et.zoom:ot,ft="bearing"in et?this._normalizeBearing(et.bearing,at):at,dt="pitch"in et?+et.pitch:st,mt="padding"in et?et.padding:nt.padding,yt=tt.Point.convert(et.offset),vt=nt.centerPoint.add(yt),Dt=nt.pointLocation(vt),Rt=tt.LngLat.convert(et.center||Dt);this._normalizeCenter(Rt);var Bt,Ot,Ne=nt.project(Dt),Ze=nt.project(Rt).sub(Ne),Ge=nt.zoomScale(pt-ot);et.around&&(Bt=tt.LngLat.convert(et.around),Ot=nt.locationPoint(Bt));var Ke={moving:(this||w)._moving,zooming:(this||w)._zooming,rotating:(this||w)._rotating,pitching:(this||w)._pitching};return(this||w)._zooming=(this||w)._zooming||pt!==ot,(this||w)._rotating=(this||w)._rotating||at!==ft,(this||w)._pitching=(this||w)._pitching||dt!==st,(this||w)._padding=!nt.isPaddingEqual(mt),(this||w)._easeId=et.easeId,this._prepareEase(rt,et.noMoveStart,Ke),clearTimeout((this||w)._easeEndTimeoutID),this._ease((function(w){if(it._zooming&&(nt.zoom=tt.number(ot,pt,w)),it._rotating&&(nt.bearing=tt.number(at,ft,w)),it._pitching&&(nt.pitch=tt.number(st,dt,w)),it._padding&&(nt.interpolatePadding(ct,mt,w),vt=nt.centerPoint.add(yt)),Bt)nt.setLocationAtPoint(Bt,Ot);else{var et=nt.zoomScale(nt.zoom-ot),Dt=pt>ot?Math.min(2,Ge):Math.max(.5,Ge),Rt=Math.pow(Dt,1-w),Ke=nt.unproject(Ne.add(Ze.mult(w*Rt)).mult(et));nt.setLocationAtPoint(nt.renderWorldCopies?Ke.wrap():Ke,vt)}it._fireMoveEvents(rt)}),(function(w){it._afterEase(rt,w)}),et),this||w},i.prototype._prepareEase=function(et,rt,it){void 0===it&&(it={}),(this||w)._moving=!0,rt||it.moving||this.fire(new tt.Event("movestart",et)),(this||w)._zooming&&!it.zooming&&this.fire(new tt.Event("zoomstart",et)),(this||w)._rotating&&!it.rotating&&this.fire(new tt.Event("rotatestart",et)),(this||w)._pitching&&!it.pitching&&this.fire(new tt.Event("pitchstart",et))},i.prototype._fireMoveEvents=function(et){this.fire(new tt.Event("move",et)),(this||w)._zooming&&this.fire(new tt.Event("zoom",et)),(this||w)._rotating&&this.fire(new tt.Event("rotate",et)),(this||w)._pitching&&this.fire(new tt.Event("pitch",et))},i.prototype._afterEase=function(et,rt){if(!(this||w)._easeId||!rt||(this||w)._easeId!==rt){delete(this||w)._easeId;var it=(this||w)._zooming,nt=(this||w)._rotating,ot=(this||w)._pitching;(this||w)._moving=!1,(this||w)._zooming=!1,(this||w)._rotating=!1,(this||w)._pitching=!1,(this||w)._padding=!1,it&&this.fire(new tt.Event("zoomend",et)),nt&&this.fire(new tt.Event("rotateend",et)),ot&&this.fire(new tt.Event("pitchend",et)),this.fire(new tt.Event("moveend",et))}},i.prototype.flyTo=function(et,rt){var it=this||w;if(!et.essential&&tt.browser.prefersReducedMotion){var nt=tt.pick(et,["center","zoom","bearing","pitch","around"]);return this.jumpTo(nt,rt)}this.stop(),et=tt.extend({offset:[0,0],speed:1.2,curve:1.42,easing:tt.ease},et);var ot=(this||w).transform,at=this.getZoom(),st=this.getBearing(),ct=this.getPitch(),pt=this.getPadding(),ft="zoom"in et?tt.clamp(+et.zoom,ot.minZoom,ot.maxZoom):at,dt="bearing"in et?this._normalizeBearing(et.bearing,st):st,mt="pitch"in et?+et.pitch:ct,yt="padding"in et?et.padding:ot.padding,vt=ot.zoomScale(ft-at),Dt=tt.Point.convert(et.offset),Rt=ot.centerPoint.add(Dt),Bt=ot.pointLocation(Rt),Ot=tt.LngLat.convert(et.center||Bt);this._normalizeCenter(Ot);var Ne=ot.project(Bt),Ze=ot.project(Ot).sub(Ne),Ge=et.curve,Ke=Math.max(ot.width,ot.height),er=Ke/vt,rr=Ze.mag();if("minZoom"in et){var vr=tt.clamp(Math.min(et.minZoom,at,ft),ot.minZoom,ot.maxZoom),wr=Ke/ot.zoomScale(vr-at);Ge=Math.sqrt(wr/rr*2)}var Sr=Ge*Ge;function C(w){var tt=(er*er-Ke*Ke+(w?-1:1)*Sr*Sr*rr*rr)/(2*(w?er:Ke)*Sr*rr);return Math.log(Math.sqrt(tt*tt+1)-tt)}function z(w){return(Math.exp(w)-Math.exp(-w))/2}function D(w){return(Math.exp(w)+Math.exp(-w))/2}var ei=C(0),L=function(w){return D(ei)/D(ei+Ge*w)},A=function(w){return Ke*((D(ei)*(z(tt=ei+Ge*w)/D(tt))-z(ei))/Sr)/rr;var tt},ii=(C(1)-ei)/Ge;if(Math.abs(rr)<1e-6||!isFinite(ii)){if(Math.abs(Ke-er)<1e-6)return this.easeTo(et,rt);var mi=er<Ke?-1:1;ii=Math.abs(Math.log(er/Ke))/Ge,A=function(){return 0},L=function(w){return Math.exp(mi*Ge*w)}}return et.duration="duration"in et?+et.duration:1e3*ii/("screenSpeed"in et?+et.screenSpeed/Ge:+et.speed),et.maxDuration&&et.duration>et.maxDuration&&(et.duration=0),(this||w)._zooming=!0,(this||w)._rotating=st!==dt,(this||w)._pitching=mt!==ct,(this||w)._padding=!ot.isPaddingEqual(yt),this._prepareEase(rt,!1),this._ease((function(w){var et=w*ii,nt=1/L(et);ot.zoom=1===w?ft:at+ot.scaleZoom(nt),it._rotating&&(ot.bearing=tt.number(st,dt,w)),it._pitching&&(ot.pitch=tt.number(ct,mt,w)),it._padding&&(ot.interpolatePadding(pt,yt,w),Rt=ot.centerPoint.add(Dt));var vt=1===w?Ot:ot.unproject(Ne.add(Ze.mult(A(et))).mult(nt));ot.setLocationAtPoint(ot.renderWorldCopies?vt.wrap():vt,Rt),it._fireMoveEvents(rt)}),(function(){return it._afterEase(rt)}),et),this||w},i.prototype.isEasing=function(){return!!(this||w)._easeFrameId},i.prototype.stop=function(){return this._stop()},i.prototype._stop=function(tt,et){if((this||w)._easeFrameId&&(this._cancelRenderFrame((this||w)._easeFrameId),delete(this||w)._easeFrameId,delete(this||w)._onEaseFrame),(this||w)._onEaseEnd){var rt=(this||w)._onEaseEnd;delete(this||w)._onEaseEnd,rt.call(this||w,et)}if(!tt){var it=(this||w).handlers;it&&it.stop()}return this||w},i.prototype._ease=function(et,rt,it){!1===it.animate||0===it.duration?(et(1),rt()):((this||w)._easeStart=tt.browser.now(),(this||w)._easeOptions=it,(this||w)._onEaseFrame=et,(this||w)._onEaseEnd=rt,(this||w)._easeFrameId=this._requestRenderFrame((this||w)._renderFrameCallback))},i.prototype._renderFrameCallback=function(){var et=Math.min((tt.browser.now()-(this||w)._easeStart)/(this||w)._easeOptions.duration,1);this._onEaseFrame((this||w)._easeOptions.easing(et)),et<1?(this||w)._easeFrameId=this._requestRenderFrame((this||w)._renderFrameCallback):this.stop()},i.prototype._normalizeBearing=function(w,et){w=tt.wrap(w,-180,180);var rt=Math.abs(w-et);return Math.abs(w-360-et)<rt&&(w-=360),Math.abs(w+360-et)<rt&&(w+=360),w},i.prototype._normalizeCenter=function(tt){var et=(this||w).transform;if(et.renderWorldCopies&&!et.lngRange){var rt=tt.lng-et.center.lng;tt.lng+=rt>180?-360:rt<-180?360:0}},i}(tt.Evented),yr=function(et){void 0===et&&(et={}),(this||w).options=et,tt.bindAll(["_updateEditLink","_updateData","_updateCompact"],this||w)};yr.prototype.getDefaultPosition=function(){return"bottom-right"},yr.prototype.onAdd=function(tt){var et=(this||w).options&&(this||w).options.compact;return(this||w)._map=tt,(this||w)._container=rt.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),(this||w)._innerContainer=rt.create("div","mapboxgl-ctrl-attrib-inner",(this||w)._container),et&&(this||w)._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),(this||w)._map.on("styledata",(this||w)._updateData),(this||w)._map.on("sourcedata",(this||w)._updateData),(this||w)._map.on("moveend",(this||w)._updateEditLink),void 0===et&&((this||w)._map.on("resize",(this||w)._updateCompact),this._updateCompact()),(this||w)._container},yr.prototype.onRemove=function(){rt.remove((this||w)._container),(this||w)._map.off("styledata",(this||w)._updateData),(this||w)._map.off("sourcedata",(this||w)._updateData),(this||w)._map.off("moveend",(this||w)._updateEditLink),(this||w)._map.off("resize",(this||w)._updateCompact),(this||w)._map=void 0,(this||w)._attribHTML=void 0},yr.prototype._updateEditLink=function(){var et=(this||w)._editLink;et||(et=(this||w)._editLink=(this||w)._container.querySelector(".mapbox-improve-map"));var rt=[{key:"owner",value:(this||w).styleOwner},{key:"id",value:(this||w).styleId},{key:"access_token",value:(this||w)._map._requestManager._customAccessToken||tt.config.ACCESS_TOKEN}];if(et){var it=rt.reduce((function(w,tt,et){return tt.value&&(w+=tt.key+"="+tt.value+(et<rt.length-1?"&":"")),w}),"?");et.href=tt.config.FEEDBACK_URL+"/"+it+((this||w)._map._hash?(this||w)._map._hash.getHashString(!0):""),et.rel="noopener nofollow"}},yr.prototype._updateData=function(w){!w||"metadata"!==w.sourceDataType&&"style"!==w.dataType||(this._updateAttributions(),this._updateEditLink())},yr.prototype._updateAttributions=function(){if((this||w)._map.style){var tt=[];if((this||w).options.customAttribution&&(Array.isArray((this||w).options.customAttribution)?tt=tt.concat((this||w).options.customAttribution.map((function(w){return"string"!=typeof w?"":w}))):"string"==typeof(this||w).options.customAttribution&&tt.push((this||w).options.customAttribution)),(this||w)._map.style.stylesheet){var et=(this||w)._map.style.stylesheet;(this||w).styleOwner=et.owner,(this||w).styleId=et.id}var rt=(this||w)._map.style.sourceCaches;for(var it in rt){var nt=rt[it];if(nt.used){var ot=nt.getSource();ot.attribution&&tt.indexOf(ot.attribution)<0&&tt.push(ot.attribution)}}tt.sort((function(w,tt){return w.length-tt.length}));var at=(tt=tt.filter((function(w,et){for(var rt=et+1;rt<tt.length;rt++)if(tt[rt].indexOf(w)>=0)return!1;return!0}))).join(" | ");at!==(this||w)._attribHTML&&((this||w)._attribHTML=at,tt.length?((this||w)._innerContainer.innerHTML=at,(this||w)._container.classList.remove("mapboxgl-attrib-empty")):(this||w)._container.classList.add("mapboxgl-attrib-empty"),(this||w)._editLink=null)}},yr.prototype._updateCompact=function(){(this||w)._map.getCanvasContainer().offsetWidth<=640?(this||w)._container.classList.add("mapboxgl-compact"):(this||w)._container.classList.remove("mapboxgl-compact")};var xr=function(){tt.bindAll(["_updateLogo"],this||w),tt.bindAll(["_updateCompact"],this||w)};xr.prototype.onAdd=function(tt){(this||w)._map=tt,(this||w)._container=rt.create("div","mapboxgl-ctrl");var et=rt.create("a","mapboxgl-ctrl-logo");return et.target="_blank",et.rel="noopener nofollow",et.href="https://www.mapbox.com/",et.setAttribute("aria-label",(this||w)._map._getUIString("LogoControl.Title")),et.setAttribute("rel","noopener nofollow"),(this||w)._container.appendChild(et),(this||w)._container.style.display="none",(this||w)._map.on("sourcedata",(this||w)._updateLogo),this._updateLogo(),(this||w)._map.on("resize",(this||w)._updateCompact),this._updateCompact(),(this||w)._container},xr.prototype.onRemove=function(){rt.remove((this||w)._container),(this||w)._map.off("sourcedata",(this||w)._updateLogo),(this||w)._map.off("resize",(this||w)._updateCompact)},xr.prototype.getDefaultPosition=function(){return"bottom-left"},xr.prototype._updateLogo=function(tt){tt&&"metadata"!==tt.sourceDataType||((this||w)._container.style.display=this._logoRequired()?"block":"none")},xr.prototype._logoRequired=function(){if((this||w)._map.style){var tt=(this||w)._map.style.sourceCaches;for(var et in tt)if(tt[et].getSource().mapbox_logo)return!0;return!1}},xr.prototype._updateCompact=function(){var tt=(this||w)._container.children;if(tt.length){var et=tt[0];(this||w)._map.getCanvasContainer().offsetWidth<250?et.classList.add("mapboxgl-compact"):et.classList.remove("mapboxgl-compact")}};var br=function(){(this||w)._queue=[],(this||w)._id=0,(this||w)._cleared=!1,(this||w)._currentlyRunning=!1};br.prototype.add=function(tt){var et=++(this||w)._id;return(this||w)._queue.push({callback:tt,id:et,cancelled:!1}),et},br.prototype.remove=function(tt){for(var et=(this||w)._currentlyRunning,rt=0,it=et?(this||w)._queue.concat(et):(this||w)._queue;rt<it.length;rt+=1){var nt=it[rt];if(nt.id===tt)return void(nt.cancelled=!0)}},br.prototype.run=function(tt){void 0===tt&&(tt=0);var et=(this||w)._currentlyRunning=(this||w)._queue;(this||w)._queue=[];for(var rt=0,it=et;rt<it.length;rt+=1){var nt=it[rt];if(!nt.cancelled&&(nt.callback(tt),(this||w)._cleared))break}(this||w)._cleared=!1,(this||w)._currentlyRunning=!1},br.prototype.clear=function(){(this||w)._currentlyRunning&&((this||w)._cleared=!0),(this||w)._queue=[]};var lc={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},uc=tt.window.HTMLImageElement,cc=tt.window.HTMLElement,pc=tt.window.ImageBitmap,hc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},fc=function(it){function r(et){var rt=this||w;if(null!=(et=tt.extend({},hc,et)).minZoom&&null!=et.maxZoom&&et.minZoom>et.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=et.minPitch&&null!=et.maxPitch&&et.minPitch>et.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=et.minPitch&&et.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=et.maxPitch&&et.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var nt=new To(et.minZoom,et.maxZoom,et.minPitch,et.maxPitch,et.renderWorldCopies);if(it.call(this||w,nt,et),(this||w)._interactive=et.interactive,(this||w)._maxTileCacheSize=et.maxTileCacheSize,(this||w)._failIfMajorPerformanceCaveat=et.failIfMajorPerformanceCaveat,(this||w)._preserveDrawingBuffer=et.preserveDrawingBuffer,(this||w)._antialias=et.antialias,(this||w)._trackResize=et.trackResize,(this||w)._bearingSnap=et.bearingSnap,(this||w)._refreshExpiredTiles=et.refreshExpiredTiles,(this||w)._fadeDuration=et.fadeDuration,(this||w)._crossSourceCollisions=et.crossSourceCollisions,(this||w)._crossFadingFactor=1,(this||w)._collectResourceTiming=et.collectResourceTiming,(this||w)._renderTaskQueue=new br,(this||w)._controls=[],(this||w)._mapId=tt.uniqueId(),(this||w)._locale=tt.extend({},lc,et.locale),(this||w)._requestManager=new tt.RequestManager(et.transformRequest,et.accessToken),"string"==typeof et.container){if((this||w)._container=tt.window.document.getElementById(et.container),!(this||w)._container)throw new Error("Container '"+et.container+"' not found.")}else{if(!(et.container instanceof cc))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");(this||w)._container=et.container}if(et.maxBounds&&this.setMaxBounds(et.maxBounds),tt.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this||w),this._setupContainer(),this._setupPainter(),void 0===(this||w).painter)throw new Error("Failed to initialize WebGL.");this.on("move",(function(){return rt._update(!1)})),this.on("moveend",(function(){return rt._update(!1)})),this.on("zoom",(function(){return rt._update(!0)})),void 0!==tt.window&&(tt.window.addEventListener("online",(this||w)._onWindowOnline,!1),tt.window.addEventListener("resize",(this||w)._onWindowResize,!1)),(this||w).handlers=new gr(this||w,et),(this||w)._hash=et.hash&&new Io("string"==typeof et.hash&&et.hash||void 0).addTo(this||w),(this||w)._hash&&(this||w)._hash._onHashChange()||(this.jumpTo({center:et.center,zoom:et.zoom,bearing:et.bearing,pitch:et.pitch}),et.bounds&&(this.resize(),this.fitBounds(et.bounds,tt.extend({},et.fitBoundsOptions,{duration:0})))),this.resize(),(this||w)._localIdeographFontFamily=et.localIdeographFontFamily,et.style&&this.setStyle(et.style,{localIdeographFontFamily:et.localIdeographFontFamily}),et.attributionControl&&this.addControl(new yr({customAttribution:et.customAttribution})),this.addControl(new xr,et.logoPosition),this.on("style.load",(function(){rt.transform.unmodified&&rt.jumpTo(rt.style.stylesheet)})),this.on("data",(function(w){rt._update("style"===w.dataType),rt.fire(new tt.Event(w.dataType+"data",w))})),this.on("dataloading",(function(w){rt.fire(new tt.Event(w.dataType+"dataloading",w))}))}it&&(r.__proto__=it),(r.prototype=Object.create(it&&it.prototype)).constructor=r;var nt={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return r.prototype._getMapId=function(){return(this||w)._mapId},r.prototype.addControl=function(et,rt){if(void 0===rt&&et.getDefaultPosition&&(rt=et.getDefaultPosition()),void 0===rt&&(rt="top-right"),!et||!et.onAdd)return this.fire(new tt.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var it=et.onAdd(this||w);(this||w)._controls.push(et);var nt=(this||w)._controlPositions[rt];return-1!==rt.indexOf("bottom")?nt.insertBefore(it,nt.firstChild):nt.appendChild(it),this||w},r.prototype.removeControl=function(et){if(!et||!et.onRemove)return this.fire(new tt.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var rt=(this||w)._controls.indexOf(et);return rt>-1&&(this||w)._controls.splice(rt,1),et.onRemove(this||w),this||w},r.prototype.resize=function(et){var rt=this._containerDimensions(),it=rt[0],nt=rt[1];this._resizeCanvas(it,nt),(this||w).transform.resize(it,nt),(this||w).painter.resize(it,nt);var ot=!(this||w)._moving;return ot&&(this.stop(),this.fire(new tt.Event("movestart",et)).fire(new tt.Event("move",et))),this.fire(new tt.Event("resize",et)),ot&&this.fire(new tt.Event("moveend",et)),this||w},r.prototype.getBounds=function(){return(this||w).transform.getBounds()},r.prototype.getMaxBounds=function(){return(this||w).transform.getMaxBounds()},r.prototype.setMaxBounds=function(et){return(this||w).transform.setMaxBounds(tt.LngLatBounds.convert(et)),this._update()},r.prototype.setMinZoom=function(tt){if((tt=null==tt?-2:tt)>=-2&&tt<=(this||w).transform.maxZoom)return(this||w).transform.minZoom=tt,this._update(),this.getZoom()<tt&&this.setZoom(tt),this||w;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},r.prototype.getMinZoom=function(){return(this||w).transform.minZoom},r.prototype.setMaxZoom=function(tt){if((tt=null==tt?22:tt)>=(this||w).transform.minZoom)return(this||w).transform.maxZoom=tt,this._update(),this.getZoom()>tt&&this.setZoom(tt),this||w;throw new Error("maxZoom must be greater than the current minZoom")},r.prototype.getMaxZoom=function(){return(this||w).transform.maxZoom},r.prototype.setMinPitch=function(tt){if((tt=null==tt?0:tt)<0)throw new Error("minPitch must be greater than or equal to 0");if(tt>=0&&tt<=(this||w).transform.maxPitch)return(this||w).transform.minPitch=tt,this._update(),this.getPitch()<tt&&this.setPitch(tt),this||w;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},r.prototype.getMinPitch=function(){return(this||w).transform.minPitch},r.prototype.setMaxPitch=function(tt){if((tt=null==tt?60:tt)>60)throw new Error("maxPitch must be less than or equal to 60");if(tt>=(this||w).transform.minPitch)return(this||w).transform.maxPitch=tt,this._update(),this.getPitch()>tt&&this.setPitch(tt),this||w;throw new Error("maxPitch must be greater than the current minPitch")},r.prototype.getMaxPitch=function(){return(this||w).transform.maxPitch},r.prototype.getRenderWorldCopies=function(){return(this||w).transform.renderWorldCopies},r.prototype.setRenderWorldCopies=function(tt){return(this||w).transform.renderWorldCopies=tt,this._update()},r.prototype.project=function(et){return(this||w).transform.locationPoint(tt.LngLat.convert(et))},r.prototype.unproject=function(et){return(this||w).transform.pointLocation(tt.Point.convert(et))},r.prototype.isMoving=function(){return(this||w)._moving||(this||w).handlers.isMoving()},r.prototype.isZooming=function(){return(this||w)._zooming||(this||w).handlers.isZooming()},r.prototype.isRotating=function(){return(this||w)._rotating||(this||w).handlers.isRotating()},r.prototype._createDelegatedListener=function(tt,et,rt){var it,nt=this||w;if("mouseenter"===tt||"mouseover"===tt){var ot=!1;return{layer:et,listener:rt,delegates:{mousemove:function(w){var it=nt.getLayer(et)?nt.queryRenderedFeatures(w.point,{layers:[et]}):[];it.length?ot||(ot=!0,rt.call(nt,new _u(tt,nt,w.originalEvent,{features:it}))):ot=!1},mouseout:function(){ot=!1}}}}if("mouseleave"===tt||"mouseout"===tt){var at=!1;return{layer:et,listener:rt,delegates:{mousemove:function(w){(nt.getLayer(et)?nt.queryRenderedFeatures(w.point,{layers:[et]}):[]).length?at=!0:at&&(at=!1,rt.call(nt,new _u(tt,nt,w.originalEvent)))},mouseout:function(w){at&&(at=!1,rt.call(nt,new _u(tt,nt,w.originalEvent)))}}}}return{layer:et,listener:rt,delegates:(it={},it[tt]=function(w){var tt=nt.getLayer(et)?nt.queryRenderedFeatures(w.point,{layers:[et]}):[];tt.length&&(w.features=tt,rt.call(nt,w),delete w.features)},it)}},r.prototype.on=function(tt,et,rt){if(void 0===rt)return it.prototype.on.call(this||w,tt,et);var nt=this._createDelegatedListener(tt,et,rt);for(var ot in(this||w)._delegatedListeners=(this||w)._delegatedListeners||{},(this||w)._delegatedListeners[tt]=(this||w)._delegatedListeners[tt]||[],(this||w)._delegatedListeners[tt].push(nt),nt.delegates)this.on(ot,nt.delegates[ot]);return this||w},r.prototype.once=function(tt,et,rt){if(void 0===rt)return it.prototype.once.call(this||w,tt,et);var nt=this._createDelegatedListener(tt,et,rt);for(var ot in nt.delegates)this.once(ot,nt.delegates[ot]);return this||w},r.prototype.off=function(tt,et,rt){var nt=this||w;return void 0===rt?it.prototype.off.call(this||w,tt,et):((this||w)._delegatedListeners&&(this||w)._delegatedListeners[tt]&&function(w){for(var it=w[tt],ot=0;ot<it.length;ot++){var at=it[ot];if(at.layer===et&&at.listener===rt){for(var st in at.delegates)nt.off(st,at.delegates[st]);return it.splice(ot,1),nt}}}((this||w)._delegatedListeners),this||w)},r.prototype.queryRenderedFeatures=function(et,rt){if(!(this||w).style)return[];var it;if(void 0!==rt||void 0===et||et instanceof tt.Point||Array.isArray(et)||(rt=et,et=void 0),rt=rt||{},(et=et||[[0,0],[(this||w).transform.width,(this||w).transform.height]])instanceof tt.Point||"number"==typeof et[0])it=[tt.Point.convert(et)];else{var nt=tt.Point.convert(et[0]),ot=tt.Point.convert(et[1]);it=[nt,new tt.Point(ot.x,nt.y),ot,new tt.Point(nt.x,ot.y),nt]}return(this||w).style.queryRenderedFeatures(it,rt,(this||w).transform)},r.prototype.querySourceFeatures=function(tt,et){return(this||w).style.querySourceFeatures(tt,et)},r.prototype.setStyle=function(et,rt){return!1!==(rt=tt.extend({},{localIdeographFontFamily:(this||w)._localIdeographFontFamily},rt)).diff&&rt.localIdeographFontFamily===(this||w)._localIdeographFontFamily&&(this||w).style&&et?(this._diffStyle(et,rt),this||w):((this||w)._localIdeographFontFamily=rt.localIdeographFontFamily,this._updateStyle(et,rt))},r.prototype._getUIString=function(tt){var et=(this||w)._locale[tt];if(null==et)throw new Error("Missing UI string '"+tt+"'");return et},r.prototype._updateStyle=function(tt,et){return(this||w).style&&((this||w).style.setEventedParent(null),(this||w).style._remove()),tt?((this||w).style=new ls(this||w,et||{}),(this||w).style.setEventedParent(this||w,{style:(this||w).style}),"string"==typeof tt?(this||w).style.loadURL(tt):(this||w).style.loadJSON(tt),this||w):(delete(this||w).style,this||w)},r.prototype._lazyInitEmptyStyle=function(){(this||w).style||((this||w).style=new ls(this||w,{}),(this||w).style.setEventedParent(this||w,{style:(this||w).style}),(this||w).style.loadEmpty())},r.prototype._diffStyle=function(et,rt){var it=this||w;if("string"==typeof et){var nt=(this||w)._requestManager.normalizeStyleURL(et),ot=(this||w)._requestManager.transformRequest(nt,tt.ResourceType.Style);tt.getJSON(ot,(function(w,et){w?it.fire(new tt.ErrorEvent(w)):et&&it._updateDiff(et,rt)}))}else"object"==typeof et&&this._updateDiff(et,rt)},r.prototype._updateDiff=function(et,rt){try{(this||w).style.setState(et)&&this._update(!0)}catch(w){tt.warnOnce("Unable to perform style diff: "+(w.message||w.error||w)+".  Rebuilding the style from scratch."),this._updateStyle(et,rt)}},r.prototype.getStyle=function(){if((this||w).style)return(this||w).style.serialize()},r.prototype.isStyleLoaded=function(){return(this||w).style?(this||w).style.loaded():tt.warnOnce("There is no style added to the map.")},r.prototype.addSource=function(tt,et){return this._lazyInitEmptyStyle(),(this||w).style.addSource(tt,et),this._update(!0)},r.prototype.isSourceLoaded=function(et){var rt=(this||w).style&&(this||w).style.sourceCaches[et];if(void 0!==rt)return rt.loaded();this.fire(new tt.ErrorEvent(new Error("There is no source with ID '"+et+"'")))},r.prototype.areTilesLoaded=function(){var tt=(this||w).style&&(this||w).style.sourceCaches;for(var et in tt){var rt=tt[et]._tiles;for(var it in rt){var nt=rt[it];if("loaded"!==nt.state&&"errored"!==nt.state)return!1}}return!0},r.prototype.addSourceType=function(tt,et,rt){return this._lazyInitEmptyStyle(),(this||w).style.addSourceType(tt,et,rt)},r.prototype.removeSource=function(tt){return(this||w).style.removeSource(tt),this._update(!0)},r.prototype.getSource=function(tt){return(this||w).style.getSource(tt)},r.prototype.addImage=function(et,rt,it){void 0===it&&(it={});var nt=it.pixelRatio;void 0===nt&&(nt=1);var ot=it.sdf;void 0===ot&&(ot=!1);var at=it.stretchX,st=it.stretchY,ct=it.content;if(this._lazyInitEmptyStyle(),rt instanceof uc||pc&&rt instanceof pc){var pt=tt.browser.getImageData(rt);(this||w).style.addImage(et,{data:new tt.RGBAImage({width:pt.width,height:pt.height},pt.data),pixelRatio:nt,stretchX:at,stretchY:st,content:ct,sdf:ot,version:0})}else{if(void 0===rt.width||void 0===rt.height)return this.fire(new tt.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var ft=rt;(this||w).style.addImage(et,{data:new tt.RGBAImage({width:rt.width,height:rt.height},new Uint8Array(rt.data)),pixelRatio:nt,stretchX:at,stretchY:st,content:ct,sdf:ot,version:0,userImage:ft}),ft.onAdd&&ft.onAdd(this||w,et)}},r.prototype.updateImage=function(et,rt){var it=(this||w).style.getImage(et);if(!it)return this.fire(new tt.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var nt=rt instanceof uc||pc&&rt instanceof pc?tt.browser.getImageData(rt):rt,ot=nt.width,at=nt.height,st=nt.data;return void 0===ot||void 0===at?this.fire(new tt.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):ot!==it.data.width||at!==it.data.height?this.fire(new tt.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(it.data.replace(st,!(rt instanceof uc||pc&&rt instanceof pc)),void(this||w).style.updateImage(et,it))},r.prototype.hasImage=function(et){return et?!!(this||w).style.getImage(et):(this.fire(new tt.ErrorEvent(new Error("Missing required image id"))),!1)},r.prototype.removeImage=function(tt){(this||w).style.removeImage(tt)},r.prototype.loadImage=function(et,rt){tt.getImage((this||w)._requestManager.transformRequest(et,tt.ResourceType.Image),rt)},r.prototype.listImages=function(){return(this||w).style.listImages()},r.prototype.addLayer=function(tt,et){return this._lazyInitEmptyStyle(),(this||w).style.addLayer(tt,et),this._update(!0)},r.prototype.moveLayer=function(tt,et){return(this||w).style.moveLayer(tt,et),this._update(!0)},r.prototype.removeLayer=function(tt){return(this||w).style.removeLayer(tt),this._update(!0)},r.prototype.getLayer=function(tt){return(this||w).style.getLayer(tt)},r.prototype.setLayerZoomRange=function(tt,et,rt){return(this||w).style.setLayerZoomRange(tt,et,rt),this._update(!0)},r.prototype.setFilter=function(tt,et,rt){return void 0===rt&&(rt={}),(this||w).style.setFilter(tt,et,rt),this._update(!0)},r.prototype.getFilter=function(tt){return(this||w).style.getFilter(tt)},r.prototype.setPaintProperty=function(tt,et,rt,it){return void 0===it&&(it={}),(this||w).style.setPaintProperty(tt,et,rt,it),this._update(!0)},r.prototype.getPaintProperty=function(tt,et){return(this||w).style.getPaintProperty(tt,et)},r.prototype.setLayoutProperty=function(tt,et,rt,it){return void 0===it&&(it={}),(this||w).style.setLayoutProperty(tt,et,rt,it),this._update(!0)},r.prototype.getLayoutProperty=function(tt,et){return(this||w).style.getLayoutProperty(tt,et)},r.prototype.setLight=function(tt,et){return void 0===et&&(et={}),this._lazyInitEmptyStyle(),(this||w).style.setLight(tt,et),this._update(!0)},r.prototype.getLight=function(){return(this||w).style.getLight()},r.prototype.setFeatureState=function(tt,et){return(this||w).style.setFeatureState(tt,et),this._update()},r.prototype.removeFeatureState=function(tt,et){return(this||w).style.removeFeatureState(tt,et),this._update()},r.prototype.getFeatureState=function(tt){return(this||w).style.getFeatureState(tt)},r.prototype.getContainer=function(){return(this||w)._container},r.prototype.getCanvasContainer=function(){return(this||w)._canvasContainer},r.prototype.getCanvas=function(){return(this||w)._canvas},r.prototype._containerDimensions=function(){var tt=0,et=0;return(this||w)._container&&(tt=(this||w)._container.clientWidth||400,et=(this||w)._container.clientHeight||300),[tt,et]},r.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==tt.window.getComputedStyle((this||w)._missingCSSCanary).getPropertyValue("background-color")&&tt.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},r.prototype._setupContainer=function(){var tt=(this||w)._container;tt.classList.add("mapboxgl-map"),((this||w)._missingCSSCanary=rt.create("div","mapboxgl-canary",tt)).style.visibility="hidden",this._detectMissingCSS();var et=(this||w)._canvasContainer=rt.create("div","mapboxgl-canvas-container",tt);(this||w)._interactive&&et.classList.add("mapboxgl-interactive"),(this||w)._canvas=rt.create("canvas","mapboxgl-canvas",et),(this||w)._canvas.addEventListener("webglcontextlost",(this||w)._contextLost,!1),(this||w)._canvas.addEventListener("webglcontextrestored",(this||w)._contextRestored,!1),(this||w)._canvas.setAttribute("tabindex","0"),(this||w)._canvas.setAttribute("aria-label","Map");var it=this._containerDimensions();this._resizeCanvas(it[0],it[1]);var nt=(this||w)._controlContainer=rt.create("div","mapboxgl-control-container",tt),ot=(this||w)._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((function(w){ot[w]=rt.create("div","mapboxgl-ctrl-"+w,nt)}))},r.prototype._resizeCanvas=function(et,rt){var it=tt.browser.devicePixelRatio||1;(this||w)._canvas.width=it*et,(this||w)._canvas.height=it*rt,(this||w)._canvas.style.width=et+"px",(this||w)._canvas.style.height=rt+"px"},r.prototype._setupPainter=function(){var rt=tt.extend({},et.webGLContextAttributes,{failIfMajorPerformanceCaveat:(this||w)._failIfMajorPerformanceCaveat,preserveDrawingBuffer:(this||w)._preserveDrawingBuffer,antialias:(this||w)._antialias||!1}),it=(this||w)._canvas.getContext("webgl",rt)||(this||w)._canvas.getContext("experimental-webgl",rt);it?((this||w).painter=new yo(it,(this||w).transform),tt.webpSupported.testSupport(it)):this.fire(new tt.ErrorEvent(new Error("Failed to initialize WebGL")))},r.prototype._contextLost=function(et){et.preventDefault(),(this||w)._frame&&((this||w)._frame.cancel(),(this||w)._frame=null),this.fire(new tt.Event("webglcontextlost",{originalEvent:et}))},r.prototype._contextRestored=function(w){this._setupPainter(),this.resize(),this._update(),this.fire(new tt.Event("webglcontextrestored",{originalEvent:w}))},r.prototype.loaded=function(){return!(this||w)._styleDirty&&!(this||w)._sourcesDirty&&!!(this||w).style&&(this||w).style.loaded()},r.prototype._update=function(tt){return(this||w).style?((this||w)._styleDirty=(this||w)._styleDirty||tt,(this||w)._sourcesDirty=!0,this.triggerRepaint(),this||w):this||w},r.prototype._requestRenderFrame=function(tt){return this._update(),(this||w)._renderTaskQueue.add(tt)},r.prototype._cancelRenderFrame=function(tt){(this||w)._renderTaskQueue.remove(tt)},r.prototype._render=function(et){var rt,it=this||w,nt=0,ot=(this||w).painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(rt=ot.createQueryEXT(),ot.beginQueryEXT(ot.TIME_ELAPSED_EXT,rt),nt=tt.browser.now()),(this||w).painter.context.setDirty(),(this||w).painter.setBaseState(),(this||w)._renderTaskQueue.run(et),!(this||w)._removed){var at=!1;if((this||w).style&&(this||w)._styleDirty){(this||w)._styleDirty=!1;var st=(this||w).transform.zoom,ct=tt.browser.now();(this||w).style.zoomHistory.update(st,ct);var pt=new tt.EvaluationParameters(st,{now:ct,fadeDuration:(this||w)._fadeDuration,zoomHistory:(this||w).style.zoomHistory,transition:(this||w).style.getTransition()}),ft=pt.crossFadingFactor();1===ft&&ft===(this||w)._crossFadingFactor||(at=!0,(this||w)._crossFadingFactor=ft),(this||w).style.update(pt)}if((this||w).style&&(this||w)._sourcesDirty&&((this||w)._sourcesDirty=!1,(this||w).style._updateSources((this||w).transform)),(this||w)._placementDirty=(this||w).style&&(this||w).style._updatePlacement((this||w).painter.transform,(this||w).showCollisionBoxes,(this||w)._fadeDuration,(this||w)._crossSourceCollisions),(this||w).painter.render((this||w).style,{showTileBoundaries:(this||w).showTileBoundaries,showOverdrawInspector:(this||w)._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:(this||w)._fadeDuration,showPadding:(this||w).showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new tt.Event("render")),this.loaded()&&!(this||w)._loaded&&((this||w)._loaded=!0,this.fire(new tt.Event("load"))),(this||w).style&&((this||w).style.hasTransitions()||at)&&((this||w)._styleDirty=!0),(this||w).style&&!(this||w)._placementDirty&&(this||w).style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var dt=tt.browser.now()-nt;ot.endQueryEXT(ot.TIME_ELAPSED_EXT,rt),setTimeout((function(){var w=ot.getQueryObjectEXT(rt,ot.QUERY_RESULT_EXT)/1e6;ot.deleteQueryEXT(rt),it.fire(new tt.Event("gpu-timing-frame",{cpuTime:dt,gpuTime:w}))}),50)}if(this.listens("gpu-timing-layer")){var mt=(this||w).painter.collectGpuTimers();setTimeout((function(){var w=it.painter.queryGpuTimers(mt);it.fire(new tt.Event("gpu-timing-layer",{layerTimes:w}))}),50)}var yt=(this||w)._sourcesDirty||(this||w)._styleDirty||(this||w)._placementDirty;return yt||(this||w)._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new tt.Event("idle")),!(this||w)._loaded||(this||w)._fullyLoaded||yt||((this||w)._fullyLoaded=!0),this||w}},r.prototype.remove=function(){(this||w)._hash&&(this||w)._hash.remove();for(var et=0,rt=(this||w)._controls;et<rt.length;et+=1)rt[et].onRemove(this||w);(this||w)._controls=[],(this||w)._frame&&((this||w)._frame.cancel(),(this||w)._frame=null),(this||w)._renderTaskQueue.clear(),(this||w).painter.destroy(),(this||w).handlers.destroy(),delete(this||w).handlers,this.setStyle(null),void 0!==tt.window&&(tt.window.removeEventListener("resize",(this||w)._onWindowResize,!1),tt.window.removeEventListener("online",(this||w)._onWindowOnline,!1));var it=(this||w).painter.context.gl.getExtension("WEBGL_lose_context");it&&it.loseContext(),Cr((this||w)._canvasContainer),Cr((this||w)._controlContainer),Cr((this||w)._missingCSSCanary),(this||w)._container.classList.remove("mapboxgl-map"),(this||w)._removed=!0,this.fire(new tt.Event("remove"))},r.prototype.triggerRepaint=function(){var et=this||w;(this||w).style&&!(this||w)._frame&&((this||w)._frame=tt.browser.frame((function(w){et._frame=null,et._render(w)})))},r.prototype._onWindowOnline=function(){this._update()},r.prototype._onWindowResize=function(tt){(this||w)._trackResize&&this.resize({originalEvent:tt})._update()},nt.showTileBoundaries.get=function(){return!!(this||w)._showTileBoundaries},nt.showTileBoundaries.set=function(tt){(this||w)._showTileBoundaries!==tt&&((this||w)._showTileBoundaries=tt,this._update())},nt.showPadding.get=function(){return!!(this||w)._showPadding},nt.showPadding.set=function(tt){(this||w)._showPadding!==tt&&((this||w)._showPadding=tt,this._update())},nt.showCollisionBoxes.get=function(){return!!(this||w)._showCollisionBoxes},nt.showCollisionBoxes.set=function(tt){(this||w)._showCollisionBoxes!==tt&&((this||w)._showCollisionBoxes=tt,tt?(this||w).style._generateCollisionBoxes():this._update())},nt.showOverdrawInspector.get=function(){return!!(this||w)._showOverdrawInspector},nt.showOverdrawInspector.set=function(tt){(this||w)._showOverdrawInspector!==tt&&((this||w)._showOverdrawInspector=tt,this._update())},nt.repaint.get=function(){return!!(this||w)._repaint},nt.repaint.set=function(tt){(this||w)._repaint!==tt&&((this||w)._repaint=tt,this.triggerRepaint())},nt.vertices.get=function(){return!!(this||w)._vertices},nt.vertices.set=function(tt){(this||w)._vertices=tt,this._update()},r.prototype._setCacheLimits=function(w,et){tt.setCacheLimits(w,et)},nt.version.get=function(){return tt.version},Object.defineProperties(r.prototype,nt),r}(sc);function Cr(w){w.parentNode&&w.parentNode.removeChild(w)}var dc={showCompass:!0,showZoom:!0,visualizePitch:!1},Dr=function(et){var it=this||w;(this||w).options=tt.extend({},dc,et),(this||w)._container=rt.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),(this||w)._container.addEventListener("contextmenu",(function(w){return w.preventDefault()})),(this||w).options.showZoom&&(tt.bindAll(["_setButtonTitle","_updateZoomButtons"],this||w),(this||w)._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(function(w){return it._map.zoomIn({},{originalEvent:w})})),rt.create("span","mapboxgl-ctrl-icon",(this||w)._zoomInButton).setAttribute("aria-hidden",!0),(this||w)._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(function(w){return it._map.zoomOut({},{originalEvent:w})})),rt.create("span","mapboxgl-ctrl-icon",(this||w)._zoomOutButton).setAttribute("aria-hidden",!0)),(this||w).options.showCompass&&(tt.bindAll(["_rotateCompassArrow"],this||w),(this||w)._compass=this._createButton("mapboxgl-ctrl-compass",(function(w){it.options.visualizePitch?it._map.resetNorthPitch({},{originalEvent:w}):it._map.resetNorth({},{originalEvent:w})})),(this||w)._compassIcon=rt.create("span","mapboxgl-ctrl-icon",(this||w)._compass),(this||w)._compassIcon.setAttribute("aria-hidden",!0))};Dr.prototype._updateZoomButtons=function(){var tt=(this||w)._map.getZoom();(this||w)._zoomInButton.disabled=tt===(this||w)._map.getMaxZoom(),(this||w)._zoomOutButton.disabled=tt===(this||w)._map.getMinZoom()},Dr.prototype._rotateCompassArrow=function(){var tt=(this||w).options.visualizePitch?"scale("+1/Math.pow(Math.cos((this||w)._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+(this||w)._map.transform.pitch+"deg) rotateZ("+(this||w)._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+(this||w)._map.transform.angle*(180/Math.PI)+"deg)";(this||w)._compassIcon.style.transform=tt},Dr.prototype.onAdd=function(tt){return(this||w)._map=tt,(this||w).options.showZoom&&(this._setButtonTitle((this||w)._zoomInButton,"ZoomIn"),this._setButtonTitle((this||w)._zoomOutButton,"ZoomOut"),(this||w)._map.on("zoom",(this||w)._updateZoomButtons),this._updateZoomButtons()),(this||w).options.showCompass&&(this._setButtonTitle((this||w)._compass,"ResetBearing"),(this||w).options.visualizePitch&&(this||w)._map.on("pitch",(this||w)._rotateCompassArrow),(this||w)._map.on("rotate",(this||w)._rotateCompassArrow),this._rotateCompassArrow(),(this||w)._handler=new Mr((this||w)._map,(this||w)._compass,(this||w).options.visualizePitch)),(this||w)._container},Dr.prototype.onRemove=function(){rt.remove((this||w)._container),(this||w).options.showZoom&&(this||w)._map.off("zoom",(this||w)._updateZoomButtons),(this||w).options.showCompass&&((this||w).options.visualizePitch&&(this||w)._map.off("pitch",(this||w)._rotateCompassArrow),(this||w)._map.off("rotate",(this||w)._rotateCompassArrow),(this||w)._handler.off(),delete(this||w)._handler),delete(this||w)._map},Dr.prototype._createButton=function(tt,et){var it=rt.create("button",tt,(this||w)._container);return it.type="button",it.addEventListener("click",et),it},Dr.prototype._setButtonTitle=function(tt,et){var rt=(this||w)._map._getUIString("NavigationControl."+et);tt.title=rt,tt.setAttribute("aria-label",rt)};var Mr=function(et,it,nt){void 0===nt&&(nt=!1),(this||w)._clickTolerance=10,(this||w).element=it,(this||w).mouseRotate=new tc({clickTolerance:et.dragRotate._mouseRotate._clickTolerance}),(this||w).map=et,nt&&((this||w).mousePitch=new ec({clickTolerance:et.dragRotate._mousePitch._clickTolerance})),tt.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this||w),rt.addEventListener(it,"mousedown",(this||w).mousedown),rt.addEventListener(it,"touchstart",(this||w).touchstart,{passive:!1}),rt.addEventListener(it,"touchmove",(this||w).touchmove),rt.addEventListener(it,"touchend",(this||w).touchend),rt.addEventListener(it,"touchcancel",(this||w).reset)};function Lr(w,et,rt){if(w=new tt.LngLat(w.lng,w.lat),et){var it=new tt.LngLat(w.lng-360,w.lat),nt=new tt.LngLat(w.lng+360,w.lat),ot=rt.locationPoint(w).distSqr(et);rt.locationPoint(it).distSqr(et)<ot?w=it:rt.locationPoint(nt).distSqr(et)<ot&&(w=nt)}for(;Math.abs(w.lng-rt.center.lng)>180;){var at=rt.locationPoint(w);if(at.x>=0&&at.y>=0&&at.x<=rt.width&&at.y<=rt.height)break;w.lng>rt.center.lng?w.lng-=360:w.lng+=360}return w}Mr.prototype.down=function(tt,et){(this||w).mouseRotate.mousedown(tt,et),(this||w).mousePitch&&(this||w).mousePitch.mousedown(tt,et),rt.disableDrag()},Mr.prototype.move=function(tt,et){var rt=(this||w).map,it=(this||w).mouseRotate.mousemoveWindow(tt,et);if(it&&it.bearingDelta&&rt.setBearing(rt.getBearing()+it.bearingDelta),(this||w).mousePitch){var nt=(this||w).mousePitch.mousemoveWindow(tt,et);nt&&nt.pitchDelta&&rt.setPitch(rt.getPitch()+nt.pitchDelta)}},Mr.prototype.off=function(){var tt=(this||w).element;rt.removeEventListener(tt,"mousedown",(this||w).mousedown),rt.removeEventListener(tt,"touchstart",(this||w).touchstart,{passive:!1}),rt.removeEventListener(tt,"touchmove",(this||w).touchmove),rt.removeEventListener(tt,"touchend",(this||w).touchend),rt.removeEventListener(tt,"touchcancel",(this||w).reset),this.offTemp()},Mr.prototype.offTemp=function(){rt.enableDrag(),rt.removeEventListener(tt.window,"mousemove",(this||w).mousemove),rt.removeEventListener(tt.window,"mouseup",(this||w).mouseup)},Mr.prototype.mousedown=function(et){this.down(tt.extend({},et,{ctrlKey:!0,preventDefault:function(){return et.preventDefault()}}),rt.mousePos((this||w).element,et)),rt.addEventListener(tt.window,"mousemove",(this||w).mousemove),rt.addEventListener(tt.window,"mouseup",(this||w).mouseup)},Mr.prototype.mousemove=function(tt){this.move(tt,rt.mousePos((this||w).element,tt))},Mr.prototype.mouseup=function(tt){(this||w).mouseRotate.mouseupWindow(tt),(this||w).mousePitch&&(this||w).mousePitch.mouseupWindow(tt),this.offTemp()},Mr.prototype.touchstart=function(tt){1!==tt.targetTouches.length?this.reset():((this||w)._startPos=(this||w)._lastPos=rt.touchPos((this||w).element,tt.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return tt.preventDefault()}},(this||w)._startPos))},Mr.prototype.touchmove=function(tt){1!==tt.targetTouches.length?this.reset():((this||w)._lastPos=rt.touchPos((this||w).element,tt.targetTouches)[0],this.move({preventDefault:function(){return tt.preventDefault()}},(this||w)._lastPos))},Mr.prototype.touchend=function(tt){0===tt.targetTouches.length&&(this||w)._startPos&&(this||w)._lastPos&&(this||w)._startPos.dist((this||w)._lastPos)<(this||w)._clickTolerance&&(this||w).element.click(),this.reset()},Mr.prototype.reset=function(){(this||w).mouseRotate.reset(),(this||w).mousePitch&&(this||w).mousePitch.reset(),delete(this||w)._startPos,delete(this||w)._lastPos,this.offTemp()};var mc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Rr(w,tt,et){var rt=w.classList;for(var it in mc)rt.remove("mapboxgl-"+et+"-anchor-"+it);rt.add("mapboxgl-"+et+"-anchor-"+tt)}var yc,gc=function(et){function o(it,nt){var ot=this||w;if(et.call(this||w),(it instanceof tt.window.HTMLElement||nt)&&(it=tt.extend({element:it},nt)),tt.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this||w),(this||w)._anchor=it&&it.anchor||"center",(this||w)._color=it&&it.color||"#3FB1CE",(this||w)._scale=it&&it.scale||1,(this||w)._draggable=it&&it.draggable||!1,(this||w)._state="inactive",(this||w)._rotation=it&&it.rotation||0,(this||w)._rotationAlignment=it&&it.rotationAlignment||"auto",(this||w)._pitchAlignment=it&&it.pitchAlignment&&"auto"!==it.pitchAlignment?it.pitchAlignment:(this||w)._rotationAlignment,it&&it.element)(this||w)._element=it.element,(this||w)._offset=tt.Point.convert(it&&it.offset||[0,0]);else{(this||w)._defaultMarker=!0,(this||w)._element=rt.create("div"),(this||w)._element.setAttribute("aria-label","Map marker");var at=rt.createNS("http://www.w3.org/2000/svg","svg");at.setAttributeNS(null,"display","block"),at.setAttributeNS(null,"height","41px"),at.setAttributeNS(null,"width","27px"),at.setAttributeNS(null,"viewBox","0 0 27 41");var st=rt.createNS("http://www.w3.org/2000/svg","g");st.setAttributeNS(null,"stroke","none"),st.setAttributeNS(null,"stroke-width","1"),st.setAttributeNS(null,"fill","none"),st.setAttributeNS(null,"fill-rule","evenodd");var ct=rt.createNS("http://www.w3.org/2000/svg","g");ct.setAttributeNS(null,"fill-rule","nonzero");var pt=rt.createNS("http://www.w3.org/2000/svg","g");pt.setAttributeNS(null,"transform","translate(3.0, 29.0)"),pt.setAttributeNS(null,"fill","#000000");for(var ft=0,dt=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];ft<dt.length;ft+=1){var mt=dt[ft],yt=rt.createNS("http://www.w3.org/2000/svg","ellipse");yt.setAttributeNS(null,"opacity","0.04"),yt.setAttributeNS(null,"cx","10.5"),yt.setAttributeNS(null,"cy","5.80029008"),yt.setAttributeNS(null,"rx",mt.rx),yt.setAttributeNS(null,"ry",mt.ry),pt.appendChild(yt)}var vt=rt.createNS("http://www.w3.org/2000/svg","g");vt.setAttributeNS(null,"fill",(this||w)._color);var Dt=rt.createNS("http://www.w3.org/2000/svg","path");Dt.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),vt.appendChild(Dt);var Rt=rt.createNS("http://www.w3.org/2000/svg","g");Rt.setAttributeNS(null,"opacity","0.25"),Rt.setAttributeNS(null,"fill","#000000");var Bt=rt.createNS("http://www.w3.org/2000/svg","path");Bt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Rt.appendChild(Bt);var Ot=rt.createNS("http://www.w3.org/2000/svg","g");Ot.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Ot.setAttributeNS(null,"fill","#FFFFFF");var Ne=rt.createNS("http://www.w3.org/2000/svg","g");Ne.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Ze=rt.createNS("http://www.w3.org/2000/svg","circle");Ze.setAttributeNS(null,"fill","#000000"),Ze.setAttributeNS(null,"opacity","0.25"),Ze.setAttributeNS(null,"cx","5.5"),Ze.setAttributeNS(null,"cy","5.5"),Ze.setAttributeNS(null,"r","5.4999962");var Ge=rt.createNS("http://www.w3.org/2000/svg","circle");Ge.setAttributeNS(null,"fill","#FFFFFF"),Ge.setAttributeNS(null,"cx","5.5"),Ge.setAttributeNS(null,"cy","5.5"),Ge.setAttributeNS(null,"r","5.4999962"),Ne.appendChild(Ze),Ne.appendChild(Ge),ct.appendChild(pt),ct.appendChild(vt),ct.appendChild(Rt),ct.appendChild(Ot),ct.appendChild(Ne),at.appendChild(ct),at.setAttributeNS(null,"height",41*(this||w)._scale+"px"),at.setAttributeNS(null,"width",27*(this||w)._scale+"px"),(this||w)._element.appendChild(at),(this||w)._offset=tt.Point.convert(it&&it.offset||[0,-14])}(this||w)._element.classList.add("mapboxgl-marker"),(this||w)._element.addEventListener("dragstart",(function(w){w.preventDefault()})),(this||w)._element.addEventListener("mousedown",(function(w){w.preventDefault()})),(this||w)._element.addEventListener("focus",(function(){var w=ot._map.getContainer();w.scrollTop=0,w.scrollLeft=0})),Rr((this||w)._element,(this||w)._anchor,"marker"),(this||w)._popup=null}return et&&(o.__proto__=et),(o.prototype=Object.create(et&&et.prototype)).constructor=o,o.prototype.addTo=function(tt){return this.remove(),(this||w)._map=tt,tt.getCanvasContainer().appendChild((this||w)._element),tt.on("move",(this||w)._update),tt.on("moveend",(this||w)._update),this.setDraggable((this||w)._draggable),this._update(),(this||w)._map.on("click",(this||w)._onMapClick),this||w},o.prototype.remove=function(){return(this||w)._map&&((this||w)._map.off("click",(this||w)._onMapClick),(this||w)._map.off("move",(this||w)._update),(this||w)._map.off("moveend",(this||w)._update),(this||w)._map.off("mousedown",(this||w)._addDragHandler),(this||w)._map.off("touchstart",(this||w)._addDragHandler),(this||w)._map.off("mouseup",(this||w)._onUp),(this||w)._map.off("touchend",(this||w)._onUp),(this||w)._map.off("mousemove",(this||w)._onMove),(this||w)._map.off("touchmove",(this||w)._onMove),delete(this||w)._map),rt.remove((this||w)._element),(this||w)._popup&&(this||w)._popup.remove(),this||w},o.prototype.getLngLat=function(){return(this||w)._lngLat},o.prototype.setLngLat=function(et){return(this||w)._lngLat=tt.LngLat.convert(et),(this||w)._pos=null,(this||w)._popup&&(this||w)._popup.setLngLat((this||w)._lngLat),this._update(),this||w},o.prototype.getElement=function(){return(this||w)._element},o.prototype.setPopup=function(tt){if((this||w)._popup&&((this||w)._popup.remove(),(this||w)._popup=null,(this||w)._element.removeEventListener("keypress",(this||w)._onKeyPress),(this||w)._originalTabIndex||(this||w)._element.removeAttribute("tabindex")),tt){if(!("offset"in tt.options)){var et=Math.sqrt(Math.pow(13.5,2)/2);tt.options.offset=(this||w)._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[et,-1*(24.6+et)],"bottom-right":[-et,-1*(24.6+et)],left:[13.5,-24.6],right:[-13.5,-24.6]}:(this||w)._offset}(this||w)._popup=tt,(this||w)._lngLat&&(this||w)._popup.setLngLat((this||w)._lngLat),(this||w)._originalTabIndex=(this||w)._element.getAttribute("tabindex"),(this||w)._originalTabIndex||(this||w)._element.setAttribute("tabindex","0"),(this||w)._element.addEventListener("keypress",(this||w)._onKeyPress)}return this||w},o.prototype._onKeyPress=function(w){var tt=w.code,et=w.charCode||w.keyCode;"Space"!==tt&&"Enter"!==tt&&32!==et&&13!==et||this.togglePopup()},o.prototype._onMapClick=function(tt){var et=tt.originalEvent.target,rt=(this||w)._element;(this||w)._popup&&(et===rt||rt.contains(et))&&this.togglePopup()},o.prototype.getPopup=function(){return(this||w)._popup},o.prototype.togglePopup=function(){var tt=(this||w)._popup;return tt?(tt.isOpen()?tt.remove():tt.addTo((this||w)._map),this||w):this||w},o.prototype._update=function(tt){if((this||w)._map){(this||w)._map.transform.renderWorldCopies&&((this||w)._lngLat=Lr((this||w)._lngLat,(this||w)._pos,(this||w)._map.transform)),(this||w)._pos=(this||w)._map.project((this||w)._lngLat)._add((this||w)._offset);var et="";"viewport"===(this||w)._rotationAlignment||"auto"===(this||w)._rotationAlignment?et="rotateZ("+(this||w)._rotation+"deg)":"map"===(this||w)._rotationAlignment&&(et="rotateZ("+((this||w)._rotation-(this||w)._map.getBearing())+"deg)");var it="";"viewport"===(this||w)._pitchAlignment||"auto"===(this||w)._pitchAlignment?it="rotateX(0deg)":"map"===(this||w)._pitchAlignment&&(it="rotateX("+(this||w)._map.getPitch()+"deg)"),tt&&"moveend"!==tt.type||((this||w)._pos=(this||w)._pos.round()),rt.setTransform((this||w)._element,mc[(this||w)._anchor]+" translate("+(this||w)._pos.x+"px, "+(this||w)._pos.y+"px) "+it+" "+et)}},o.prototype.getOffset=function(){return(this||w)._offset},o.prototype.setOffset=function(et){return(this||w)._offset=tt.Point.convert(et),this._update(),this||w},o.prototype._onMove=function(et){(this||w)._pos=et.point.sub((this||w)._positionDelta),(this||w)._lngLat=(this||w)._map.unproject((this||w)._pos),this.setLngLat((this||w)._lngLat),(this||w)._element.style.pointerEvents="none","pending"===(this||w)._state&&((this||w)._state="active",this.fire(new tt.Event("dragstart"))),this.fire(new tt.Event("drag"))},o.prototype._onUp=function(){(this||w)._element.style.pointerEvents="auto",(this||w)._positionDelta=null,(this||w)._map.off("mousemove",(this||w)._onMove),(this||w)._map.off("touchmove",(this||w)._onMove),"active"===(this||w)._state&&this.fire(new tt.Event("dragend")),(this||w)._state="inactive"},o.prototype._addDragHandler=function(tt){(this||w)._element.contains(tt.originalEvent.target)&&(tt.preventDefault(),(this||w)._positionDelta=tt.point.sub((this||w)._pos).add((this||w)._offset),(this||w)._state="pending",(this||w)._map.on("mousemove",(this||w)._onMove),(this||w)._map.on("touchmove",(this||w)._onMove),(this||w)._map.once("mouseup",(this||w)._onUp),(this||w)._map.once("touchend",(this||w)._onUp))},o.prototype.setDraggable=function(tt){return(this||w)._draggable=!!tt,(this||w)._map&&(tt?((this||w)._map.on("mousedown",(this||w)._addDragHandler),(this||w)._map.on("touchstart",(this||w)._addDragHandler)):((this||w)._map.off("mousedown",(this||w)._addDragHandler),(this||w)._map.off("touchstart",(this||w)._addDragHandler))),this||w},o.prototype.isDraggable=function(){return(this||w)._draggable},o.prototype.setRotation=function(tt){return(this||w)._rotation=tt||0,this._update(),this||w},o.prototype.getRotation=function(){return(this||w)._rotation},o.prototype.setRotationAlignment=function(tt){return(this||w)._rotationAlignment=tt||"auto",this._update(),this||w},o.prototype.getRotationAlignment=function(){return(this||w)._rotationAlignment},o.prototype.setPitchAlignment=function(tt){return(this||w)._pitchAlignment=tt&&"auto"!==tt?tt:(this||w)._rotationAlignment,this._update(),this||w},o.prototype.getPitchAlignment=function(){return(this||w)._pitchAlignment},o}(tt.Evented),_c={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},vc=0,xc=!1,bc=function(et){function o(rt){et.call(this||w),(this||w).options=tt.extend({},_c,rt),tt.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this||w)}return et&&(o.__proto__=et),(o.prototype=Object.create(et&&et.prototype)).constructor=o,o.prototype.onAdd=function(et){var it;return(this||w)._map=et,(this||w)._container=rt.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),it=(this||w)._setupUI,void 0!==yc?it(yc):void 0!==tt.window.navigator.permissions?tt.window.navigator.permissions.query({name:"geolocation"}).then((function(w){it(yc="denied"!==w.state)})):it(yc=!!tt.window.navigator.geolocation),(this||w)._container},o.prototype.onRemove=function(){void 0!==(this||w)._geolocationWatchID&&(tt.window.navigator.geolocation.clearWatch((this||w)._geolocationWatchID),(this||w)._geolocationWatchID=void 0),(this||w).options.showUserLocation&&(this||w)._userLocationDotMarker&&(this||w)._userLocationDotMarker.remove(),(this||w).options.showAccuracyCircle&&(this||w)._accuracyCircleMarker&&(this||w)._accuracyCircleMarker.remove(),rt.remove((this||w)._container),(this||w)._map.off("zoom",(this||w)._onZoom),(this||w)._map=void 0,vc=0,xc=!1},o.prototype._isOutOfMapMaxBounds=function(tt){var et=(this||w)._map.getMaxBounds(),rt=tt.coords;return et&&(rt.longitude<et.getWest()||rt.longitude>et.getEast()||rt.latitude<et.getSouth()||rt.latitude>et.getNorth())},o.prototype._setErrorState=function(){switch((this||w)._watchState){case"WAITING_ACTIVE":(this||w)._watchState="ACTIVE_ERROR",(this||w)._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),(this||w)._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":(this||w)._watchState="ACTIVE_ERROR",(this||w)._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),(this||w)._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),(this||w)._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":(this||w)._watchState="BACKGROUND_ERROR",(this||w)._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),(this||w)._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),(this||w)._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},o.prototype._onSuccess=function(et){if((this||w)._map){if(this._isOutOfMapMaxBounds(et))return this._setErrorState(),this.fire(new tt.Event("outofmaxbounds",et)),this._updateMarker(),void this._finish();if((this||w).options.trackUserLocation)switch((this||w)._lastKnownPosition=et,(this||w)._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":(this||w)._watchState="ACTIVE_LOCK",(this||w)._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),(this||w)._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),(this||w)._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":(this||w)._watchState="BACKGROUND",(this||w)._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),(this||w)._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),(this||w)._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}(this||w).options.showUserLocation&&"OFF"!==(this||w)._watchState&&this._updateMarker(et),(this||w).options.trackUserLocation&&"ACTIVE_LOCK"!==(this||w)._watchState||this._updateCamera(et),(this||w).options.showUserLocation&&(this||w)._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new tt.Event("geolocate",et)),this._finish()}},o.prototype._updateCamera=function(et){var rt=new tt.LngLat(et.coords.longitude,et.coords.latitude),it=et.coords.accuracy,nt=(this||w)._map.getBearing(),ot=tt.extend({bearing:nt},(this||w).options.fitBoundsOptions);(this||w)._map.fitBounds(rt.toBounds(it),ot,{geolocateSource:!0})},o.prototype._updateMarker=function(et){if(et){var rt=new tt.LngLat(et.coords.longitude,et.coords.latitude);(this||w)._accuracyCircleMarker.setLngLat(rt).addTo((this||w)._map),(this||w)._userLocationDotMarker.setLngLat(rt).addTo((this||w)._map),(this||w)._accuracy=et.coords.accuracy,(this||w).options.showUserLocation&&(this||w).options.showAccuracyCircle&&this._updateCircleRadius()}else(this||w)._userLocationDotMarker.remove(),(this||w)._accuracyCircleMarker.remove()},o.prototype._updateCircleRadius=function(){var tt=(this||w)._map._container.clientHeight/2,et=(this||w)._map.unproject([0,tt]),rt=(this||w)._map.unproject([1,tt]),it=et.distanceTo(rt),nt=Math.ceil(2*(this||w)._accuracy/it);(this||w)._circleElement.style.width=nt+"px",(this||w)._circleElement.style.height=nt+"px"},o.prototype._onZoom=function(){(this||w).options.showUserLocation&&(this||w).options.showAccuracyCircle&&this._updateCircleRadius()},o.prototype._onError=function(et){if((this||w)._map){if((this||w).options.trackUserLocation)if(1===et.code){(this||w)._watchState="OFF",(this||w)._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),(this||w)._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),(this||w)._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),(this||w)._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),(this||w)._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),(this||w)._geolocateButton.disabled=!0;var rt=(this||w)._map._getUIString("GeolocateControl.LocationNotAvailable");(this||w)._geolocateButton.title=rt,(this||w)._geolocateButton.setAttribute("aria-label",rt),void 0!==(this||w)._geolocationWatchID&&this._clearWatch()}else{if(3===et.code&&xc)return;this._setErrorState()}"OFF"!==(this||w)._watchState&&(this||w).options.showUserLocation&&(this||w)._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new tt.Event("error",et)),this._finish()}},o.prototype._finish=function(){(this||w)._timeoutId&&clearTimeout((this||w)._timeoutId),(this||w)._timeoutId=void 0},o.prototype._setupUI=function(et){var it=this||w;if((this||w)._container.addEventListener("contextmenu",(function(w){return w.preventDefault()})),(this||w)._geolocateButton=rt.create("button","mapboxgl-ctrl-geolocate",(this||w)._container),rt.create("span","mapboxgl-ctrl-icon",(this||w)._geolocateButton).setAttribute("aria-hidden",!0),(this||w)._geolocateButton.type="button",!1===et){tt.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var nt=(this||w)._map._getUIString("GeolocateControl.LocationNotAvailable");(this||w)._geolocateButton.disabled=!0,(this||w)._geolocateButton.title=nt,(this||w)._geolocateButton.setAttribute("aria-label",nt)}else{var ot=(this||w)._map._getUIString("GeolocateControl.FindMyLocation");(this||w)._geolocateButton.title=ot,(this||w)._geolocateButton.setAttribute("aria-label",ot)}(this||w).options.trackUserLocation&&((this||w)._geolocateButton.setAttribute("aria-pressed","false"),(this||w)._watchState="OFF"),(this||w).options.showUserLocation&&((this||w)._dotElement=rt.create("div","mapboxgl-user-location-dot"),(this||w)._userLocationDotMarker=new gc((this||w)._dotElement),(this||w)._circleElement=rt.create("div","mapboxgl-user-location-accuracy-circle"),(this||w)._accuracyCircleMarker=new gc({element:(this||w)._circleElement,pitchAlignment:"map"}),(this||w).options.trackUserLocation&&((this||w)._watchState="OFF"),(this||w)._map.on("zoom",(this||w)._onZoom)),(this||w)._geolocateButton.addEventListener("click",(this||w).trigger.bind(this||w)),(this||w)._setup=!0,(this||w).options.trackUserLocation&&(this||w)._map.on("movestart",(function(w){w.geolocateSource||"ACTIVE_LOCK"!==it._watchState||w.originalEvent&&"resize"===w.originalEvent.type||(it._watchState="BACKGROUND",it._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),it._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),it.fire(new tt.Event("trackuserlocationend")))}))},o.prototype.trigger=function(){if(!(this||w)._setup)return tt.warnOnce("Geolocate control triggered before added to a map"),!1;if((this||w).options.trackUserLocation){switch((this||w)._watchState){case"OFF":(this||w)._watchState="WAITING_ACTIVE",this.fire(new tt.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":vc--,xc=!1,(this||w)._watchState="OFF",(this||w)._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),(this||w)._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),(this||w)._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),(this||w)._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),(this||w)._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new tt.Event("trackuserlocationend"));break;case"BACKGROUND":(this||w)._watchState="ACTIVE_LOCK",(this||w)._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),(this||w)._lastKnownPosition&&this._updateCamera((this||w)._lastKnownPosition),this.fire(new tt.Event("trackuserlocationstart"))}switch((this||w)._watchState){case"WAITING_ACTIVE":(this||w)._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),(this||w)._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":(this||w)._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":(this||w)._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),(this||w)._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":(this||w)._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":(this||w)._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),(this||w)._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===(this||w)._watchState&&void 0!==(this||w)._geolocationWatchID)this._clearWatch();else if(void 0===(this||w)._geolocationWatchID){var et;(this||w)._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),(this||w)._geolocateButton.setAttribute("aria-pressed","true"),++vc>1?(et={maximumAge:6e5,timeout:0},xc=!0):(et=(this||w).options.positionOptions,xc=!1),(this||w)._geolocationWatchID=tt.window.navigator.geolocation.watchPosition((this||w)._onSuccess,(this||w)._onError,et)}}else tt.window.navigator.geolocation.getCurrentPosition((this||w)._onSuccess,(this||w)._onError,(this||w).options.positionOptions),(this||w)._timeoutId=setTimeout((this||w)._finish,1e4);return!0},o.prototype._clearWatch=function(){tt.window.navigator.geolocation.clearWatch((this||w)._geolocationWatchID),(this||w)._geolocationWatchID=void 0,(this||w)._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),(this||w)._geolocateButton.setAttribute("aria-pressed","false"),(this||w).options.showUserLocation&&this._updateMarker(null)},o}(tt.Evented),wc={maxWidth:100,unit:"metric"},jr=function(et){(this||w).options=tt.extend({},wc,et),tt.bindAll(["_onMove","setUnit"],this||w)};function qr(w,tt,et){var rt=et&&et.maxWidth||100,it=w._container.clientHeight/2,nt=w.unproject([0,it]),ot=w.unproject([rt,it]),at=nt.distanceTo(ot);if(et&&"imperial"===et.unit){var st=3.2808*at;st>5280?Vr(tt,rt,st/5280,w._getUIString("ScaleControl.Miles")):Vr(tt,rt,st,w._getUIString("ScaleControl.Feet"))}else et&&"nautical"===et.unit?Vr(tt,rt,at/1852,w._getUIString("ScaleControl.NauticalMiles")):at>=1e3?Vr(tt,rt,at/1e3,w._getUIString("ScaleControl.Kilometers")):Vr(tt,rt,at,w._getUIString("ScaleControl.Meters"))}function Vr(w,tt,et,rt){var it,nt,ot,at=(it=et,(nt=Math.pow(10,(""+Math.floor(it)).length-1))*(ot=(ot=it/nt)>=10?10:ot>=5?5:ot>=3?3:ot>=2?2:ot>=1?1:function(w){var tt=Math.pow(10,Math.ceil(-Math.log(w)/Math.LN10));return Math.round(w*tt)/tt}(ot)));w.style.width=tt*(at/et)+"px",w.innerHTML=at+"&nbsp;"+rt}jr.prototype.getDefaultPosition=function(){return"bottom-left"},jr.prototype._onMove=function(){qr((this||w)._map,(this||w)._container,(this||w).options)},jr.prototype.onAdd=function(tt){return(this||w)._map=tt,(this||w)._container=rt.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",tt.getContainer()),(this||w)._map.on("move",(this||w)._onMove),this._onMove(),(this||w)._container},jr.prototype.onRemove=function(){rt.remove((this||w)._container),(this||w)._map.off("move",(this||w)._onMove),(this||w)._map=void 0},jr.prototype.setUnit=function(tt){(this||w).options.unit=tt,qr((this||w)._map,(this||w)._container,(this||w).options)};var Gr=function(et){(this||w)._fullscreen=!1,et&&et.container&&(et.container instanceof tt.window.HTMLElement?(this||w)._container=et.container:tt.warnOnce("Full screen control 'container' must be a DOM element.")),tt.bindAll(["_onClickFullscreen","_changeIcon"],this||w),"onfullscreenchange"in tt.window.document?(this||w)._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in tt.window.document?(this||w)._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in tt.window.document?(this||w)._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in tt.window.document&&((this||w)._fullscreenchange="MSFullscreenChange")};Gr.prototype.onAdd=function(et){return(this||w)._map=et,(this||w)._container||((this||w)._container=(this||w)._map.getContainer()),(this||w)._controlContainer=rt.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():((this||w)._controlContainer.style.display="none",tt.warnOnce("This device does not support fullscreen mode.")),(this||w)._controlContainer},Gr.prototype.onRemove=function(){rt.remove((this||w)._controlContainer),(this||w)._map=null,tt.window.document.removeEventListener((this||w)._fullscreenchange,(this||w)._changeIcon)},Gr.prototype._checkFullscreenSupport=function(){return!!(tt.window.document.fullscreenEnabled||tt.window.document.mozFullScreenEnabled||tt.window.document.msFullscreenEnabled||tt.window.document.webkitFullscreenEnabled)},Gr.prototype._setupUI=function(){var et=(this||w)._fullscreenButton=rt.create("button","mapboxgl-ctrl-fullscreen",(this||w)._controlContainer);rt.create("span","mapboxgl-ctrl-icon",et).setAttribute("aria-hidden",!0),et.type="button",this._updateTitle(),(this||w)._fullscreenButton.addEventListener("click",(this||w)._onClickFullscreen),tt.window.document.addEventListener((this||w)._fullscreenchange,(this||w)._changeIcon)},Gr.prototype._updateTitle=function(){var tt=this._getTitle();(this||w)._fullscreenButton.setAttribute("aria-label",tt),(this||w)._fullscreenButton.title=tt},Gr.prototype._getTitle=function(){return(this||w)._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Gr.prototype._isFullscreen=function(){return(this||w)._fullscreen},Gr.prototype._changeIcon=function(){(tt.window.document.fullscreenElement||tt.window.document.mozFullScreenElement||tt.window.document.webkitFullscreenElement||tt.window.document.msFullscreenElement)===(this||w)._container!==(this||w)._fullscreen&&((this||w)._fullscreen=!(this||w)._fullscreen,(this||w)._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),(this||w)._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Gr.prototype._onClickFullscreen=function(){this._isFullscreen()?tt.window.document.exitFullscreen?tt.window.document.exitFullscreen():tt.window.document.mozCancelFullScreen?tt.window.document.mozCancelFullScreen():tt.window.document.msExitFullscreen?tt.window.document.msExitFullscreen():tt.window.document.webkitCancelFullScreen&&tt.window.document.webkitCancelFullScreen():(this||w)._container.requestFullscreen?(this||w)._container.requestFullscreen():(this||w)._container.mozRequestFullScreen?(this||w)._container.mozRequestFullScreen():(this||w)._container.msRequestFullscreen?(this||w)._container.msRequestFullscreen():(this||w)._container.webkitRequestFullscreen&&(this||w)._container.webkitRequestFullscreen()};var Sc={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},Tc=function(et){function o(rt){et.call(this||w),(this||w).options=tt.extend(Object.create(Sc),rt),tt.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this||w)}return et&&(o.__proto__=et),(o.prototype=Object.create(et&&et.prototype)).constructor=o,o.prototype.addTo=function(et){return(this||w)._map&&this.remove(),(this||w)._map=et,(this||w).options.closeOnClick&&(this||w)._map.on("click",(this||w)._onClose),(this||w).options.closeOnMove&&(this||w)._map.on("move",(this||w)._onClose),(this||w)._map.on("remove",(this||w).remove),this._update(),(this||w)._trackPointer?((this||w)._map.on("mousemove",(this||w)._onMouseMove),(this||w)._map.on("mouseup",(this||w)._onMouseUp),(this||w)._container&&(this||w)._container.classList.add("mapboxgl-popup-track-pointer"),(this||w)._map._canvasContainer.classList.add("mapboxgl-track-pointer")):(this||w)._map.on("move",(this||w)._update),this.fire(new tt.Event("open")),this||w},o.prototype.isOpen=function(){return!!(this||w)._map},o.prototype.remove=function(){return(this||w)._content&&rt.remove((this||w)._content),(this||w)._container&&(rt.remove((this||w)._container),delete(this||w)._container),(this||w)._map&&((this||w)._map.off("move",(this||w)._update),(this||w)._map.off("move",(this||w)._onClose),(this||w)._map.off("click",(this||w)._onClose),(this||w)._map.off("remove",(this||w).remove),(this||w)._map.off("mousemove",(this||w)._onMouseMove),(this||w)._map.off("mouseup",(this||w)._onMouseUp),(this||w)._map.off("drag",(this||w)._onDrag),delete(this||w)._map),this.fire(new tt.Event("close")),this||w},o.prototype.getLngLat=function(){return(this||w)._lngLat},o.prototype.setLngLat=function(et){return(this||w)._lngLat=tt.LngLat.convert(et),(this||w)._pos=null,(this||w)._trackPointer=!1,this._update(),(this||w)._map&&((this||w)._map.on("move",(this||w)._update),(this||w)._map.off("mousemove",(this||w)._onMouseMove),(this||w)._container&&(this||w)._container.classList.remove("mapboxgl-popup-track-pointer"),(this||w)._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this||w},o.prototype.trackPointer=function(){return(this||w)._trackPointer=!0,(this||w)._pos=null,this._update(),(this||w)._map&&((this||w)._map.off("move",(this||w)._update),(this||w)._map.on("mousemove",(this||w)._onMouseMove),(this||w)._map.on("drag",(this||w)._onDrag),(this||w)._container&&(this||w)._container.classList.add("mapboxgl-popup-track-pointer"),(this||w)._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this||w},o.prototype.getElement=function(){return(this||w)._container},o.prototype.setText=function(w){return this.setDOMContent(tt.window.document.createTextNode(w))},o.prototype.setHTML=function(w){var et,rt=tt.window.document.createDocumentFragment(),it=tt.window.document.createElement("body");for(it.innerHTML=w;et=it.firstChild;)rt.appendChild(et);return this.setDOMContent(rt)},o.prototype.getMaxWidth=function(){return(this||w)._container&&(this||w)._container.style.maxWidth},o.prototype.setMaxWidth=function(tt){return(this||w).options.maxWidth=tt,this._update(),this||w},o.prototype.setDOMContent=function(tt){return this._createContent(),(this||w)._content.appendChild(tt),this._update(),this||w},o.prototype.addClassName=function(tt){(this||w)._container&&(this||w)._container.classList.add(tt)},o.prototype.removeClassName=function(tt){(this||w)._container&&(this||w)._container.classList.remove(tt)},o.prototype.toggleClassName=function(tt){if((this||w)._container)return(this||w)._container.classList.toggle(tt)},o.prototype._createContent=function(){(this||w)._content&&rt.remove((this||w)._content),(this||w)._content=rt.create("div","mapboxgl-popup-content",(this||w)._container),(this||w).options.closeButton&&((this||w)._closeButton=rt.create("button","mapboxgl-popup-close-button",(this||w)._content),(this||w)._closeButton.type="button",(this||w)._closeButton.setAttribute("aria-label","Close popup"),(this||w)._closeButton.innerHTML="&#215;",(this||w)._closeButton.addEventListener("click",(this||w)._onClose))},o.prototype._onMouseUp=function(w){this._update(w.point)},o.prototype._onMouseMove=function(w){this._update(w.point)},o.prototype._onDrag=function(w){this._update(w.point)},o.prototype._update=function(et){var it=this||w;if((this||w)._map&&((this||w)._lngLat||(this||w)._trackPointer)&&(this||w)._content&&((this||w)._container||((this||w)._container=rt.create("div","mapboxgl-popup",(this||w)._map.getContainer()),(this||w)._tip=rt.create("div","mapboxgl-popup-tip",(this||w)._container),(this||w)._container.appendChild((this||w)._content),(this||w).options.className&&(this||w).options.className.split(" ").forEach((function(w){return it._container.classList.add(w)})),(this||w)._trackPointer&&(this||w)._container.classList.add("mapboxgl-popup-track-pointer")),(this||w).options.maxWidth&&(this||w)._container.style.maxWidth!==(this||w).options.maxWidth&&((this||w)._container.style.maxWidth=(this||w).options.maxWidth),(this||w)._map.transform.renderWorldCopies&&!(this||w)._trackPointer&&((this||w)._lngLat=Lr((this||w)._lngLat,(this||w)._pos,(this||w)._map.transform)),!(this||w)._trackPointer||et)){var nt=(this||w)._pos=(this||w)._trackPointer&&et?et:(this||w)._map.project((this||w)._lngLat),ot=(this||w).options.anchor,at=function e(w){if(w){if("number"==typeof w){var et=Math.round(Math.sqrt(.5*Math.pow(w,2)));return{center:new tt.Point(0,0),top:new tt.Point(0,w),"top-left":new tt.Point(et,et),"top-right":new tt.Point(-et,et),bottom:new tt.Point(0,-w),"bottom-left":new tt.Point(et,-et),"bottom-right":new tt.Point(-et,-et),left:new tt.Point(w,0),right:new tt.Point(-w,0)}}if(w instanceof tt.Point||Array.isArray(w)){var rt=tt.Point.convert(w);return{center:rt,top:rt,"top-left":rt,"top-right":rt,bottom:rt,"bottom-left":rt,"bottom-right":rt,left:rt,right:rt}}return{center:tt.Point.convert(w.center||[0,0]),top:tt.Point.convert(w.top||[0,0]),"top-left":tt.Point.convert(w["top-left"]||[0,0]),"top-right":tt.Point.convert(w["top-right"]||[0,0]),bottom:tt.Point.convert(w.bottom||[0,0]),"bottom-left":tt.Point.convert(w["bottom-left"]||[0,0]),"bottom-right":tt.Point.convert(w["bottom-right"]||[0,0]),left:tt.Point.convert(w.left||[0,0]),right:tt.Point.convert(w.right||[0,0])}}return e(new tt.Point(0,0))}((this||w).options.offset);if(!ot){var st,ct=(this||w)._container.offsetWidth,pt=(this||w)._container.offsetHeight;st=nt.y+at.bottom.y<pt?["top"]:nt.y>(this||w)._map.transform.height-pt?["bottom"]:[],nt.x<ct/2?st.push("left"):nt.x>(this||w)._map.transform.width-ct/2&&st.push("right"),ot=0===st.length?"bottom":st.join("-")}var ft=nt.add(at[ot]).round();rt.setTransform((this||w)._container,mc[ot]+" translate("+ft.x+"px,"+ft.y+"px)"),Rr((this||w)._container,ot,"popup")}},o.prototype._onClose=function(){this.remove()},o}(tt.Evented),Ic={version:tt.version,supported:et,setRTLTextPlugin:tt.setRTLTextPlugin,getRTLTextPluginStatus:tt.getRTLTextPluginStatus,Map:fc,NavigationControl:Dr,GeolocateControl:bc,AttributionControl:yr,ScaleControl:jr,FullscreenControl:Gr,Popup:Tc,Marker:gc,Style:ls,LngLat:tt.LngLat,LngLatBounds:tt.LngLatBounds,Point:tt.Point,MercatorCoordinate:tt.MercatorCoordinate,Evented:tt.Evented,config:tt.config,prewarm:function(){Ft().acquire(ua)},clearPrewarmedResources:function(){var w=ca;w&&(w.isPreloaded()&&1===w.numActive()?(w.release(ua),ca=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return tt.config.ACCESS_TOKEN},set accessToken(w){tt.config.ACCESS_TOKEN=w},get baseApiUrl(){return tt.config.API_URL},set baseApiUrl(w){tt.config.API_URL=w},get workerCount(){return kt.workerCount},set workerCount(w){kt.workerCount=w},get maxParallelImageRequests(){return tt.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(w){tt.config.MAX_PARALLEL_IMAGE_REQUESTS=w},clearStorage:function(w){tt.clearTileCache(w)},workerUrl:""};return Ic}));return rt}));var et=tt;export default et;

