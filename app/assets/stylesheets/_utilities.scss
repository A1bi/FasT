@mixin utility-class($name, $property, $value) {
  .#{$name} {
    #{$property}: $value !important;
  }
}

@mixin utility-set($name, $property, $value) {
  %#{$name} {
    #{$property}: $value;
  }

  @include utility-class($name, $property, $value);
}

@mixin utility-media-queries($prefix, $suffix, $property, $value) {
  @each $size in map-keys($media-queries) {
    @include media-query($size) {
      @include utility-class(#{$prefix}-#{$size}-#{$suffix}, $property, $value);
    }
  }
}

@each $step, $factor in $spacing-steps {
  @each $property, $abbreviation in (margin: m, padding: p) {
    @each $side, $side-abbreviation in (top: t, bottom: b, left: s, right: e) {
      .#{$abbreviation}#{$side-abbreviation}-#{$step} {
        #{$property}-#{$side}: spacing($step);
      }
    }

    .#{$abbreviation}x-#{$step} {
      @extend .#{$abbreviation}s-#{$step};
      @extend .#{$abbreviation}e-#{$step};
    }

    .#{$abbreviation}y-#{$step} {
      @extend .#{$abbreviation}t-#{$step};
      @extend .#{$abbreviation}b-#{$step};
    }

    .#{$abbreviation}-#{$step} {
      #{$property}: spacing($step);
    }
  }
}

@each $class, $alignment in (start: left, center: center, end: right) {
  @include utility-set(text-#{$class}, text-align, $alignment);
  @include utility-media-queries(text, $class, text-align, $alignment);
}

@each $display in (none, block, inline, inline-block, flex) {
  @include utility-set(d-#{$display}, display, $display);
  @include utility-media-queries(d, $display, display, $display);
}

@each $alignment in (start, center, end, stretch) {
  @include utility-set(align-items-#{$alignment}, align-items, $alignment);
}

@each $alignment in (start, center, end) {
  @include utility-set(justify-content-#{$alignment}, justify-content, $alignment);
}

@each $alignment in (middle) {
  @include utility-set(align-#{$alignment}, vertical-align, $alignment);
}
