<% ticket = info[:ticket] %>
<% date = ticket.date.date.to_formatted_s(:w3c) %>
{
  "formatVersion": 1,
  "description": "Ticket für das Theaterstück ticket.date.event.name",
  "organizationName": "Freilichtbühne am schiefen Turm",
  "passTypeIdentifier": "pass.de.theater-kaisersesch.FasT",
  "groupingIdentifier" : "<%= ticket.order.number.to_s %>",
  "voided": <%= ticket.cancelled? %>,
  "teamIdentifier": "V48L6BF6M3",
  "webServiceURL": "<%= api_passbook_root_url %>",
  "relevantDate": "<%= date %>",
  "barcode": {
    "format": "PKBarcodeFormatQR",
    "message": "<%= ticket.signed_info(2) %>",
    "messageEncoding": "utf-8",
    "altText": "<%= ticket.number %>"
  },
  "locations": [
    {
      "latitude": 50.23089,
      "longitude": 7.141626
    }
  ],
  "eventTicket": {
    "primaryFields": [
      {
        "key": "date",
        "label": "Datum",
        "value": "<%= date %>",
        "dateStyle": "PKDateStyleFull",
        "changeMessage": "Ihr Ticket wurde auf folgendes Datum umgebucht: %@"
      }
    ],
    "secondaryFields": [
      {
        "key": "block",
        "label": "Block",
        "value": "<%= ticket.seat.block.name %>",
        "changeMessage": "Ihr Sitzplatz befindet sich nun in Block %@."
      },
      {
        "key": "seat",
        "label": "Sitzplatz",
        "value": "<%= ticket.seat.number %>",
        "textAlignment": "PKTextAlignmentLeft",
        "changeMessage": "Ihre neue Sitznummer lautet %@."
      },
      {
        "key": "time",
        "label": "Beginn",
        "value": "<%= date %>",
        "timeStyle": "PKDateStyleShort",
        "changeMessage": "Der Beginn der Aufführung wurde geändert auf %@."
      },
      {
        "key": "opens",
        "label": "Einlass",
        "value": "<%= (ticket.date.date - 1.hour).to_formatted_s(:w3c) %>",
        "timeStyle": "PKDateStyleShort"
      }
    ],
    "auxiliaryFields": [
      {
        "key": "location",
        "label": "Ort",
        "value": "Historischer Ortskern, Kaisersesch"
      }
    ],
    "backFields": [
      {
        "key": "locationAdress",
        "label": "Adresse der Spielstätte",
        "value": "Burgstraße 1, 56759 Kaisersesch\n\nEine Karte mit Parkmöglichkeiten finden Sie auf unserer Website unter \"Informationen\"."
      },
      {
        "key": "website",
        "label": "Website",
        "value": "<%= root_url %>"
      },
      {
        "key": "hotline",
        "label": "Hotline",
        "value": "(02653) 28 27 09"
      },
      {
        "key": "order",
        "label": "Ihre Bestellnummer",
        "value": "<%= ticket.order.number %>"
      }
    ]
  },
  "backgroundColor": "rgb(243, 241, 236)",
  "foregroundColor": "rgb(204, 0, 58)",
  "labelColor": "rgb(0, 0, 0)"
}
